{
    "text": "Introduction to\nFinancial Mathematics\nConcepts and Computational Methods\nArash Fahim Introduction to Financial\nMathematics\nConcepts and Computational Methods\nArash Fahim\nFlorida State University\nJuly 8, 2019 Copyright \u00a9 2019, Arash Fahim\nThis work is licensed under a Creative Commons Attribution-NonCommercial-\nShareAlike 4.0 International License.\nYou are free to:\nShare\u2014copy and redistribute the material in any medium or format\nAdapt\u2014remix, transform, and build upon the material\nUnder the following terms:\nAttribution\u2014You must give appropriate credit, provide a link to the license, and\nindicate if changes were made. You may do so in any reasonable manner, but not\nin any way that suggests the licensor endorses you or your use.\nNonCommercial\u2014You may not use the material for commercial purposes.\nShareAlike\u2014If you remix, transform, or build upon the material, you must\ndistribute your contributions under the same license as the original.\nThis publication was made possible by an Alternative Textbook Grant issued by Florida\nState University Libraries. This work is published by Florida State University\nLibraries, 116 Honors Way, Tallahassee, FL 32306.\nDOI: 10.33009/financialmath1 ii Dedicated to Nasrin, Sevda and Idin. iv Notations\nv Table 1: Table of Notation\nAY(cid:4) B (cid:28) union of two disjoint set A and B\nRd (cid:28) d-dimensional Euclidean space\nRd (cid:28) All points in Rd with nonnegative coordinates\n(cid:0)\nx P Rd (cid:28) d-dimensional column vector\nminpx,yq (cid:16) (cid:28) component-wise minimum of two vectors\npminpx ,y q,...,minpx ,y qq\n1 1 n n\nx (cid:16) minpx,0q (cid:28) component-wise minimum of a vector with zero\n(cid:0)\nvector\nAT (cid:28) transpose of matrix A\nx(cid:4)y (cid:16) xTy (cid:28) inner (dot) product in Euclidean space\nA (cid:16) 0 (cid:28) all the entities of the matrix (vector) A are zero\nA (cid:24) 0 (cid:28) at least of the entities of the matrix (vector) A\nis nonzero\nA \u011b 0 (A \u0105 0) (cid:28) all the entities of the matrix (vector) A are non-\nnegative (positive)\n\u2207f (cid:28) column vector of gradient for a differentiable\nfunction f : Rd (cid:209) R\n\u22072f (cid:28) Hessianmatrixforatwicedifferentiablefunction\nf : Rd (cid:209) R\nP or P\u02c6 (cid:28) Probability\nPpAq (resp. P\u02c6 pAq) (cid:28) Probability of an event A under probability P\n(resp. P\u02c6)\nErXs (resp. E\u02c6 rXs) (cid:28) Expected value of a random variable X under\nprobability P (resp. P\u02c6)\nvi Preface\nThestoryofthisbookstartedwhenIwasassignedtoteachanintroductoryfinancialmath-\nematics course at Florida State University. Originally, this course was all measure theory,\nintegration and stochastic analysis. Then, it evolved to cover theory of measures, some\nprobabilitytheory, andoptionpricinginthebinomialmodel. WhenItookoverthiscourse,\nI was not sure what I was going to do. However, I had a vision to educate students about\nsome new topics in financial mathematics, while keeping the classical risk management\nmaterial. My vision was to include some fundamental ideas that are shared between all\nmodels in financial mathematics, such as martingale property, Makrovian property, time-\nhomogeneity, and the like, rather than studying a comprehensive list of models. To start,\nI decided to seek advise from a colleague to use a textbook by two authors, a quantitative\nfinancial analysts and a mathematician. The textbook was a little different and covered\nvarious models that quants utilize in practice. The semester started, and as I was going\nthrough the first couple of sections from the textbook, I realized that the book was unus-\nable; many grave mistakes and wrong theorems, sloppy format, and coherency issues made\nit impossible to learn from this textbook. It was my fault that I only skimmed the book\nbefore the start of semester. A few months later, I learned that another school had had\nthe same experience with the book as they invited one of the authors to teach a similar\ncourse. Therefore, I urgently needed a plan to save my course. So, I decided to write my\nown lecture notes based on my vision, and, over the past three years, these lecture notes\ngrew and grew to include topics that I consider useful for students to learn. In 2018, the\nFlorida State University libraries awarded me the \u201cAlternative Textbook Grant\u201d to help\nme make my lecture notes into an open access free textbook. This current first edition is\nthe result of many hours of effort by my library colleagues and myself.\nMany successful textbooks on financial mathematics have been developed in the recent\ndecades. My favorite ones are the two volumes by Steven Shreve, Stochastic Calculus for\nFinance I and II; [27, 28]. They cover a large variety of topics in financial mathematics\nwithemphasisontheoptionpricing, theclassicalpracticeofquantitativefinancialanalysts\n(quants). It also covers a great deal of stochastic calculus which is a basis for modeling\nalmostallfinancialassets. Optionpricingremainsamust-knowforeveryquantandstochas-\ntic calculus is the language of the quantitative finance. However over time, a variety of\nother subjects have been added to the list of what quants need to learn, including efficient\nvii computer programming, machine learning, data mining, big data, and so on. Many of\nthese topics were irrelevant in 70s, when the quantitative finance was initially introduced.\nSince then, financial markets has changed in the tools that the traders use, and the speed\nof transactions. This is a common feature of many disciplines that the amount of data that\ncan be used to make business decisions is too large to be handled by classical statistical\ntechniques. Also, financial regulations has been adjusted to the new market environment.\nTheynowrequirefinancialinstitutionstoprovidestructuredmeasurementsofsomeoftheir\nrisks that is not included in the classical risk management theory. For instance, after the\nfinancial meltdown in 2007, systemic risk and central clearing became important research\nareas for the regulator. In addition, a demand for more robust evaluation of risks led to\nresearches in the robust risk management and model risk evaluations.\nAs the financial mathematics career grows to cover the above-mentioned topics, the\nprospect of the financial mathematics master\u2019s programs must also become broader in\ntopics. In the current book, I tried to include some new topics in an introductory level.\nSince this is an open access book, it has the ability to include more of the new topics in\nfinancial mathematics.\nOneofthemajorchallengesinteachingfinancialmathematicsisthediversebackgroundof\nstudents, at least in some institutions such as Florida State University. For example, some\nstudents whom I observed during the last five years, have broad finance background but\nlackthenecessarymathematicalbackground. Theyverymuchwanttolearnthemathemat-\nical aspects, but with fewer details and stepping more quickly into the implementational\naspects. Other students have majors in mathematics, engineering or computer science who\nneed more basic knowledge in finance. One thing that both groups need is to develop\ntheir problem-solving abilities. Current job market favors employees who can work inde-\npendently and solve hard problems, rather than those who simply take instructions and\nimplement them. Therefore, I designed this book to serve as an introductory course in\nfinancial mathematics with focus on conceptual understanding of the models and problem\nsolving,incontrasttotextbooksthatincludemoredetailsofthespecificmodels. Itincludes\nthe mathematical background needed for risk management, such as probability theory, op-\ntimization, and the like. The goal of the book is to expose the reader to a wide range\nof basic problems, some of which emphasize analytic ability, some requiring programming\ntechniques and others focusing on statistical data analysis. In addition, it covers some\nareas which are outside the scope of mainstream financial mathematics textbooks. For\nexample, it presents marginal account setting by the CCP and systemic risk, and a brief\noverview of the model risk.\nOne of the main drawbacks of commercial textbooks in financial mathematics is the lack\nof flexibility to keep up with changes of the discipline. New editions often come far apart\nand with few changes. Also, it is not possible to modify them into the course needed for\na specific program. The current book is a free, open textbook under a creative common\nlicense with attribution. This allows instructors to use parts of this book to design their\nown course in their own program, while adding new parts to keep up with the changes and\nviii the institutional goals of their program.\nThe first two chapters of this book only require calculus and introductory probability\nand can be taught to senior undergraduate students. There is also a brief review of these\ntopics in Sections A.1 and B of the appendix. I tried to be as brief as possible in the\nappendix; many books, including Stochastic Calculus for Finance I ([27, 28]) and Convex\nOptimization ([8]), cover these topics extensively. My goal to include these topics is only\nto make the current book self-sufficient. The main goal of Chapter 1 is to familiarize\nthe reader with the basic concepts of risk management in financial mathematics. All\nthese concepts are first introduced in a relatively nontechnical framework of one-period\nsuch as Markowitz portfolio diversification or the Arrow-Debreu market model. Chapter\n2 generalizes the crucial results of the Arrow-Debreu market model to the multiperiod\ncase and introduces the multiperiod binomial model and the numerical methods based on\nit. Chapter 3 discusses more advanced subjects in probability, which are presented in the\nremainder of Section B and Section C of the appendix. This chapter is more appropriate\nfor graduate students. In Section 3.2, we first build important concepts and computational\nmethods in continuous-time through the Bachelier model. Then, we provide the outline\nfor the more realistic Black-Scholes model in Section 3.3. Chapter 4 deals with pricing a\nspecifictypeoffinancialderivative: Americanoptions. Sections4.0.1and4.1canbestudied\ndirectly after finishing Chapter 2. The rest of this section requires an understanding of\nSection 3.3 as a prerequisite. The inline exercises and various examples can help students\nto prepare for the exams on this book. Many of the exercises and the examples are brand\nnew and are specifically created for the assignments and exams during the three last years\nof teaching the course.\nAcknowledgements\nI am grateful to the staff of Florida State University libraries who awarded me the Alter-\nnative Textbook Grant and guided me through the process of creating this book from my\nlecturenotes;especiallymythanksgoestoDevinSoperwhointroducedmetothegrantand\nwalked me through the process. I learned all I know about different licenses of intellectual\nmaterial from him. The copyedit was also managed by Devin. Laura Miller, a library in-\ntern, hasbeenveryhelpfulwithPandoc, asoftwarethatconvertsLATEXintoMSWord. She\nalso created some designs of the verso page for me to chose. Matthew Hunter helped me to\nfindtherightoptionwhenIneededtodoindexingandotherthingthatIneverdidbefore.\nix x TABLE OF CONTENTS TABLE OF CONTENTS\nTable of Contents\n1 Preliminaries of finance and risk management 1\n1.1 Basic financial derivatives . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n1.1.1 Futures and forward contracts . . . . . . . . . . . . . . . . . . . . . 2\n1.1.2 Eisenberg-Noe model CCP . . . . . . . . . . . . . . . . . . . . . . . 7\n1.1.3 Vanilla call and put options . . . . . . . . . . . . . . . . . . . . . . . 10\n1.1.4 American options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n1.1.5 Bond and forward rate agreements . . . . . . . . . . . . . . . . . . . 14\n1.1.6 Credit derivatives. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n1.2 Optimization in finance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n1.3 No-dominance principle and model-independent arbitrage . . . . . . . . . . 33\n2 Modeling financial assets in discrete-time markets 39\n2.1 Arrow-Debreu market model . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n2.1.1 Arbitrage portfolio and the fundamental theorem of asset pricing . . 41\n2.1.2 Arrow-Debreu market model with a risk-free bond . . . . . . . . . . 44\n2.1.3 One-period binomial model . . . . . . . . . . . . . . . . . . . . . . . 51\n2.1.4 One-period trinomial model . . . . . . . . . . . . . . . . . . . . . . . 55\n2.1.5 Replication and complete market . . . . . . . . . . . . . . . . . . . . 56\n2.1.6 Superreplication and model risk. . . . . . . . . . . . . . . . . . . . . 58\n2.2 Multiperiod discrete-time markets . . . . . . . . . . . . . . . . . . . . . . . 64\n2.2.1 A discussion on the sample space for multiperiod asset price process 64\n2.2.2 Arbitrage and trading in multiperiod discrete-time markets . . . . . 66\n2.3 Binomial model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n2.3.1 No-arbitrage condition . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n2.3.2 Basic properties of the binomial model . . . . . . . . . . . . . . . . . 77\n2.3.3 Arbitrage pricing and replicating European contingent claims in the\nbinomial model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n2.3.4 Dividend-paying stock . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n2.4 Calibrating the parameters of the model to market data: the binomial model 93\nxi TABLE OF CONTENTS TABLE OF CONTENTS\n3 Modeling financial assets in continuous-time 101\n3.1 Trading and arbitrage in continuous-time markets . . . . . . . . . . . . . . 102\n3.2 Bachelier\u2019s continuous-time market . . . . . . . . . . . . . . . . . . . . . . . 104\n3.2.1 Pricing and replicating contingent claims in the Bachelier model . . 105\n3.2.2 Numerical methods for option pricing in the Bachelier model . . . . 117\n3.2.3 Discussion: drawbacks of the Bachelier model . . . . . . . . . . . . . 129\n3.3 Continuous-time market of Black-Scholes . . . . . . . . . . . . . . . . . . . 129\n3.3.1 The Black-Scholes model: limit of binomial under risk-neutral prob-\nability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129\n3.3.2 Pricing contingent claims in the Black-Scholes model . . . . . . . . . 135\n3.3.3 Delta hedging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137\n3.3.4 Completeness of the Black-Scholes model . . . . . . . . . . . . . . . 140\n3.3.5 Error of discrete hedging in the Black-Scholes model and Greeks . . 140\n3.3.6 Time-varying B-S. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147\n3.3.7 Black-Scholes with yield curve and forward interest rate . . . . . . . 150\n3.3.8 Black-Scholes model and Brownian motion . . . . . . . . . . . . . . 151\n3.3.9 Physical versus risk-neutral in the Black-Scholes model . . . . . . . 154\n3.3.10 Black-Scholes partial differential equation . . . . . . . . . . . . . . . 156\n3.3.11 Numerical methods for the Black-Scholes price of a European option 158\n3.3.12 Stock price with dividend in the Black-Scholes model. . . . . . . . . 162\n4 American options 167\n4.0.1 Pricing American option in the binomial model via examples . . . . 168\n4.1 Pricing American option in the binomial model; problem formulation . . . . 172\n4.2 Pricing American option in the Black-Scholes model . . . . . . . . . . . . . 179\nAppendices\nA Convex optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191\nA.1 Convex functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191\nA.2 Convex constrained optimization . . . . . . . . . . . . . . . . . . . . 193\nB A review of probability theory . . . . . . . . . . . . . . . . . . . . . . . . . . 199\nB.1 Basic concepts and definitions of discrete probability . . . . . . . . . 204\nB.2 General probability spaces . . . . . . . . . . . . . . . . . . . . . . . . 213\nB.3 Martingales . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 240\nB.4 Characteristic functions and weak convergence . . . . . . . . . . . . 247\nB.5 Donsker Invariance Principle and Brownian motion . . . . . . . . . . 252\nC Stochastic analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 256\nC.1 Stochastic integral with respect to Brownian motion and It\u00f4 formula 257\nC.2 It\u00f4 formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261\nC.3 Martingale property of stochastic integral and partial differential\nequations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 262\nxii TABLE OF CONTENTS TABLE OF CONTENTS\nC.4 Stochastic integral and Stochastic differential equation . . . . . . . . 263\nC.5 It\u00f4 calculus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 266\nxiii TABLE OF CONTENTS TABLE OF CONTENTS\nxiv 1. PRELIMINARIES\n1\nPreliminaries of finance and risk\nmanagement\nA risky asset is an asset with an uncertain future price, e.g. the stock of a company in an\nexchange market. Unlike a risky asset, a bank account with a fixed interest rate has an ab-\nsolutelypredictablevalue, andiscalledarisk-free asset. Riskyassetsareclassifiedinmany\ndifferentcategories. Amongthem, financial securities, whichconstitutethelargestbodyof\nrisky assets, are traded in the exchange markets and are divided into three subcategories:\nequity, debt, and derivatives.\nAn equity is a claim of ownershipof a company. If it is issued bya corporation, it is called\ncommon stock, stock, or share. Debt, sometimes referred to as a fixed-income instrument,\npromisesafixedcashflowuntilatimecalledmaturity andisissuedbyanentityasameans\nof borrowing through its sale. The cash flow from a fixed-income security is the return of\nthe borrowed cash plus interest and is subject to default of the issuer, i.e., if the issuer is\nnot able to pay the cash flow at any of the promised dates. A derivative is an asset whose\npricedependsonacertainevent. Forexample, aderivativecanpromiseapayment(payoff)\ndependent on the price of a stock, the price of a fixed-income instrument, the default of a\ncompany, or a climate event.\nAn important class of assets that are not financial securities are described as commodities.\nBroadly speaking, a commodity is an asset which is not a financial security but is still\ntraded in a market, for example crops, energy, metals, and the like. Commodities are in\nparticular important because our daily life depends on them. Some of them are storable\nsuch as crops, which some others, such as electricity, are not. Some of them are subject\nto seasonality, such as crops or oil. The other have a constant demand throughout the\nyear, for instance aluminum or copper. These various features of commodities introduce\nchallenges in modeling commodity markets. There are other assets that are not usually\nincluded in any of the above classes, for instance real estate.\nIf the asset is easily traded in an exchange market, it is called liquid. Equities are the\n1 1.1. BASIC FINANCIAL DERIVATIVES 1. PRELIMINARIES\nmostliquidofassets;fixed-incomeinstrumentsandderivativesarelessliquid. Commodities\nhavebecomeveryliquid,partlyduetotheintroductionofemergingeconomiesintheglobal\nmarketplace. Real estate is one of the most illiquid of assets.\nAsset\nRisky Riskfree: Governmentbond\nSecurities Commodities Realestate ...\nEquity Debt Derivatives\nFigure 1.0.1: Classification of assets\n1.1 Basic financial derivatives\nFinancial risk is defined as the risk of loss of investment in financial markets. Two of the\nmain categories of financial risk are market risk, causes by the changes in the price of\nmarket equities, and credit risk, caused by the default of a party in meeting its obligations.\nFinancialderivativesaredesignedtocoverthelosscausedbythemarketriskandthecredit\nrisk. Thereareotherimportantformsoffinancialrisksuchasoperationalriskandsystemic\nrisk. However, these are irrelevant to the study of financial derivatives. Therefore, in this\nsection, we cover the basics of some simple financial derivatives on the market risk, bonds\nand some credit derivatives. In practice, bonds are not considered as derivative. However,\ntheoretically, a bond is a derivative on the interest rate.\n1.1.1 Futures and forward contracts\nForward and futures contracts are the same in principle, but they differ in operational\naspects. In both contracts, the two parties are obliged to exchange a specific asset at a\nspecific date in the future at a fair price that they have agreed upon. The asset subject\nto exchange is called the underlying asset; the date of exchange is called the maturity\ndate; and the price is called the forward/futures price. In other words, futures and forward\ncontracts lock the price at the moment of a deal in the future.\nForward contracts are simpler than futures. They are nontradable contracts between two\nspecific parties, one of whom is the buyer of the underlying asset, or the long position, and\nthe other is the seller of the underlying asset, or the short position. The buyer (seller) is\n2 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nRisk\nNon-\nFinancial\n(cid:12)nancial\nMarket Credit Operational Systemic Insurance\nFigure 1.1.1: A classification of risks\nobliged to buy (sell) a determined number of units of the underlying asset from the seller\n(to the buyer) at a price specified in the forward contract, called the forward price. The\nforward price is usually agreed upon between two parties at the initiation of the contract.\nThe forward contract price is not universal and depend upon what the two parties agree\nupon. Two forward contracts with the same maturity on the same underlying asset can\nhave two different forward prices. Usually, one party is the issuer of the forward contract\nand quotes the forward price to the other party, or the holder, who faces a decision to\nagree or decline to enter the deal. Generally, the issuer is a financial firm and the holder\nis a financial or industrial firm. Unlike forward contracts, futures contracts are tradable\nOver-the-counter: Long position Short position\nCentral clearing: Long position CCP Short position\nFigure 1.1.2: Forward (top) versus futures (bottom). In futures markets, the CCP\nregulates the contracts to eliminate the counterparty risk.\nin specialized markets. Therefore, given a fixed underlying asset and a fixed maturity T,\nacross the market there is only one futures price, a price listed in the futures market. In\nother words, the futures price at time t for delivery date (maturity) T is not agreed upon\nbetween two parties only; rather, it reflects the cumulative attitude of all investors toward\nthe price of the underlying asset at maturity T. The futures price is different from the\ncurrent price of the underlying, the spot price. For a specific underlying asset, we denote\nby F pTq the futures price at time t for delivery at T and by S the spot price at time t .\nt t\n3 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nF pTq and S are related through\nt t\nlim F pTq (cid:16) S .\nt T\nt(cid:209)T\nTo avoid counterparty risk, i.e., the risk that either of the parties might be unable to meet\ntheir obligation on the futures, the market has a central counterparty clearinghouse (CCP).\nWhen a trader enters the futures market, per the CCP regulation, he or she is required\nto open a marginal account that is managed by the CCP. The marginal account works as\ncollateral; if the holder cannot meet her obligation, the CCP closes the account to cover\nthe failure of the party. A holder of a futures contract is supposed to keep the amount\nof money in the marginal account above a level variable with changes in the futures price.\nTo understand the operation of a marginal account, consider a long position, the party\nwho is obliged to buy the underlying at time T at price F pTq. The financial gain/loss\n0\nfrom a derivative is called the payoff of the derivative. Her financial payoff at time T is\nS (cid:1)F pTq, because she is obliged to buy the underlying at price F pTq while the market\nT 0 0\nprice is S . See Figure 1.1.3. While F pTq is fixed and remains unchanged over the term\nT 0\nof the contract, the underlying price S is unknown. If at time T, F pTq \u0105 S , then she\nT 0 T\nloses the amount of F pTq(cid:1)S . The aim of the CCP is to make sure that the long position\n0 T\nS (cid:0) K K (cid:0) S\nT T\nS S\nT T\nK K\nFigure 1.1.3: The payoff of forward/futures at maturity T as a function of the price of\nunderlying S . K is the forward/futures price, i.e., K (cid:16) F pTq. Left: long position. Right:\nT 0\nshort position.\nholds at least F pTq (cid:1) S in her marginal account when is in the loosing position, i.e.,\n0 T\nF pTq \u0105 S . To do this, the CCP asks her to always rebalance her marginal account to\n0 T\n4 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nkeep it above pF pTq(cid:1)S q 1 at any day t (cid:16) 0,...,T to cover the possible future loss. An\n0 t (cid:0)\nexample of marginal account rebalancing is shown in Table 1.1.\nTime t 0 1 2 3 4\nUnderlying asset price S 87.80 87.85 88.01 88.5 87.90\nt\nMarginal account .20 .15 0 0 .10\nChanges to the marginal account \u2013 -.05 -.15 0 +.10\nTable 1.1: RebalancingthemarginalaccountofalongpositioninfutureswithF pTq=$88\n0\nin four days.\nThe marginal account can be subject to several regulations, including minimum cash\nholdings. In this case, the marginal account holds the amount of pF pTq(cid:1)S q plus the\n0 t (cid:0)\nminimum cash requirement. For more information of the mechanism of futures markets,\nsee [16, Chapter 2].\nThe existence of the marginal account creates an opportunity cost; the fund in the\nmarginal account can alternatively be invested somewhere else for profit, at least in a\nrisk-free account with a fixed interest rate. The following example illustrates the opportu-\nnity cost.\nExample 1.1.1 (Futures opportunity cost). Consider a futures contract with maturity T\nof 2 days, a futures price equal to $99.95, and a forward contract with the same maturity\nbut a forward price of $100. Both contracts are written on the same risky asset with spot\nprice S (cid:16) $99.94. The marginal account for the futures contract has a $10 minimum cash\n0\nrequirement and should be rebalanced daily thereafter according to the closing price. We\ndenote the day-end price by S and S for day one and day two, respectively. Given that\n1 2\nthe risk-free daily compound interest rate is 0.2%, we want to find out for which values\nof the spot price of the underlying asset, pS ,S q, the forward contract is more interesting\n1 2\nthan the futures contract for long position.\nTime t 0 1 2\nUnderlying asset price S 99.94 S S\nt 1 2\nMarginal account 10.01 10+p99.95(cid:1)S q closed\n1 (cid:0)\nThepayoffoftheforwardcontractforthelongpositionisS (cid:1)100, whilethesamequantity\nT\nfor the futures is S (cid:1)99.95. Therefore, the payoff of futures is worth .05 more than the\nT\npayoff of the forward on the maturity date T (cid:16) 2.\nHowever, there is an opportunity cost associated with futures contract. On day one, the\nmarginal account must have $10.01; the opportunity cost of holding $10.01 in the marginal\n1pxq :(cid:16)maxtx,0u\n(cid:0)\n5 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\naccount for day one is\np10.01qp1(cid:0).002q(cid:1)10.01 (cid:16) p10.01qp.002q (cid:16) .02002,\nwhich is equivalent to p.02002qp1.002q (cid:16) .02006004 at the end of day two. On day two, we\nhave to keep $10 plus p99.95(cid:1)S q in the marginal account which creates an opportunity\n1 (cid:0)\ncost of p.002qp10(cid:0)p99.95(cid:1)S q q. Therefore, the actual payoff of the futures contract is\n1 (cid:0)\ncalculated at maturity as\nS (cid:1)99.95(cid:1)p1.002q p.002qp10.01q (cid:1)p.002qp10(cid:0)p99.95(cid:1)S q q\nT 1 (cid:0)\nloooooomoooooon loooooooooooomoooooooooooon\nOpportunity cost of day 1 Opportunity cost of day 2\n(cid:16) S (cid:1)99.99006004(cid:1)p.002qp99.95(cid:1)S q .\nT 1 (cid:0)\nThe total gain/loss of futures minus forward is\nfpS q :(cid:16)S (cid:1)99.99006004(cid:1)p.002qp99.95(cid:1)S q (cid:1)S (cid:0)100\n1 T 1 (cid:0) T\n(cid:16).00993996(cid:1)p.002qp99.95(cid:1)S q\n1 (cid:0)\nshown in Figure 1.1.4,\nf(S )\n1\n:00993996\nS\n99:95 1\n94:98002\n(cid:0):18996004\nFigure 1.1.4: The difference between the gain of the futures and forward in Example\n1.1.1.\nExercise 1.1.1. Consider a futures contract with maturity T (cid:16) 2 days and futures price\nequal to $100, and a forward contract with the same maturity and forward price of $99;\nboth are written on a risky asset with price S (cid:16) $99. The marginal account for the\n0\nfutures contract needs at least $20 upon entering the contract and should be rebalanced\nthereafter according to the spot price at the beginning of the day. Given that the risk-free\ndaily compound interest rate is 0.2%, for which values of the spot price of the underlying\nasset, pS ,S q, is the forward contract is more interesting than the futures contract for the\n1 2\nshort position?\nA futures market provides easy access to futures contracts for a variety of products and\nfor different maturities. In addition, it makes termination of a contract possible. A long\nposition in a futures can even out his position by entering a short position of the same\ncontract.\n6 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nOne of the practices in the futures market is rolling over. Imagine a trader who needs\nto have a contract on a product at a maturity T far in the future, such that there is no\ncontract in the futures market with such maturities. However, there is one with maturity\nT \u0103 T. The trader can enter the futures with maturity T and later close it when a\n1 1\nmaturity T \u0105 T become available. Then, he can continue thereafter until he reaches\n2 1\ncertain maturity T.\nItiswellknownthatinanidealsituation,thespotpriceS oftheunderlyingislessthanor\nt\nequal to the forward/futures price F pTq which is referred to as contango; see Proposition\nt\n1.3.1foralogicalexplanationofthisphenomena. Inreality,thisresultcannolongerbetrue;\nespecially for futures and forwards on commodities which typically incur storage cost or\nmaynotevenbestorable. Asituationinwhichthefuturespriceofacommodityislessthan\nthe spot price is called normal backwardation or simply backwardation. Backwardation is\nmore common in commodities with relatively high storage cost; therefore, a low futures\nprice provides an incentive to go into a futures contract. In contrast, when the storage cost\nis negligible, then contango occurs. We close the discussion on futures and forward with\nS\nT\nForwardprice(Contango)\nSpotprice\nForwardprice(Backwardation)\n0 T\nFigure 1.1.5: Contango vs backwardation. Recall that lim F pTq (cid:16) S implies that\nt(cid:209)T t T\nthe forward price and spot price must converge at maturity.\na model for CCP to determine the marginal account. Notice that the material in 1.1.2 is\nnot restricted to futures market CCP and can be generalized to any market monitored by\nthe CCP.\n1.1.2 Eisenberg-Noe model CCP\nThe CCP can be a useful tool to control and manage systemic risk by setting capital\nrequirements for the entities in a network of liabilities. Because if the marginal account\n7 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nis not set properly, default of one entity can lead directly to a cascade of defaults. Legal\naction against a defaulted entity is the last thing the CCP wants to do.\nAssume that there are N entities in a market and that L represents the amount that\nij\nentity i owes to entity j. Entity i has an equity (cash) balance of c \u011b 0 in a marginal\ni\naccount with the CCP. The CCP wants to mediate by billing entity i amount p as a\ni\nclearing payment and use it to pay the debt of entity i to other entities. We introduce the\nliability matrix L consisting of all mutual liabilities L . It is obvious that L (cid:16) 0, since\nij ii\nthere is no self-liability.\n(cid:20) (cid:28)\n0 L (cid:4)(cid:4)(cid:4) L L\n1,2 1,N(cid:1)1 1,N\n(cid:22) L 2,1 0 (cid:4)(cid:4)(cid:4) (cid:4)(cid:4)(cid:4) L 2,N ffi\n(cid:22) ffi\nL (cid:16) (cid:22) (cid:22) . . . ... . . . ffi ffi\n(cid:22) ffi\n(cid:21)L N(cid:1)1,1 (cid:4)(cid:4)(cid:4) (cid:4)(cid:4)(cid:4) 0 L N(cid:1)1,N(cid:29)\nL L (cid:4)(cid:4)(cid:4) L 0\nN,1 N,2 N,N(cid:1)1\n\u0159N Lji\nWedefineL :(cid:16) L tobethetotalliabilityofentityj anddefinetheweights\u03c0 :(cid:16)\nj i(cid:16)1 ji ji Lj\nas the portion of total liability of entity j that is due to entity i. If a clearing payment p\nj\nis made by entity j to the CCP, then entity i receives \u03c0 p from the CCP. Therefore, after\nji j\n\u0159N\nall clearing payments p ,...,p are made, the entity i receives total of \u03c0 p . In [11],\n1 N j(cid:16)1 ji j\nthe authors argue that a clearing payment p must not exceed either the total liability L\ni i\nor the total amount of cash available by entity i.\nFirst, the Eisenberg-Noe model assume that the payment vector cannot increase the lia-\nbility, i.e., p \u010f L for all i. Secondly, if the equity (cash) of entity i is given by c , then\ni i i\n(cid:0)\u0159N\naftertheclearingpayment, thebalanceoftheentityi, i.e., c \u03c0 p (cid:1)p mustremain\ni j(cid:16)1 ji j i\nnonnegative. Therefore, the model suggests that the clearing payment p satisfies\n# +\nN\n\u201a\np (cid:16) min L , c (cid:0) \u03c0 p for all i.\ni i i ji j\nj(cid:16)1\nIn other word, the clearing payment vector p (cid:16) pp ,...,p q is therefore a fixed point of\n1 N\nthe map \u03a6ppq (cid:16) p\u03a6 ppq,...,\u03a6 pp qq, where the function \u03a6 : r0,L s (cid:2) (cid:4)(cid:4)(cid:4) (cid:2) r0,L s (cid:209)\n1 N N 1 N\nr0,L s(cid:2)(cid:4)(cid:4)(cid:4)(cid:2)r0,L s is given by\n1 N\n# +\nN\n\u201a\n\u03a6 ppq :(cid:16) min L , c (cid:0) \u03c0 p for i (cid:16) 1,..,N.\ni i i ji j\nj(cid:16)1\nIn general, the clearing payment vector p (cid:16) pp ,...,p q is not unique. The following\n1 N\ntheorem characterizes important properties of the clearing vector.\nTheorem 1.1.1 ([11]). There are two clearing payment vectors pmax and pmin such that\nfor any clearing payment p, we have pmin \u010f p \u010f pmax for all i (cid:16) 1,...,N.\ni i i\n8 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nInaddition, thevalueoftheequityofeachentityremainsunaffectedbythechoiceofclearing\nvector payment; i.e., for all i (cid:16) 1,...,N and for all clearing vector payments p,\nN N N\n\u201a \u201a \u201a\nc (cid:0) \u03c0 p (cid:1)p (cid:16) c (cid:0) \u03c0 pmax(cid:1)pmax (cid:16) c (cid:0) \u03c0 pmin(cid:1)pmin\ni ji j i i ji j i i ji j i\nj(cid:16)1 j(cid:16)1 j(cid:16)1\nRemark 1.1.1. The above theorem asserts that if by changing the clearing payment, entity\ni pays more to other entities, it is going to receive more so the total balance of the equity\nremains the same.\nIf an entity cannot clear all its liability with a payment vector, i.e., L \u0105 p , then we say\ni i\nthat the entity has defaulted. Obviously, the equity of a defaulted entity vanishes. The\n(cid:0)\u0159N\nvanishing of an equity can also happen without default when c \u03c0 p (cid:16) p (cid:16) L .\ni j(cid:16)1 ji j i i\nA condition for the uniqueness of the clearing payment vector is provided in the original\nwork of Eisenberg-Noe,[11]. However, the condition is restrictive and often hard to check\nin a massive network of liabilities. On the other hand, the equity of each entity does not\ndepend on the choice of the payment vector. In a massive network, the problem of finding\nat least one payment vector can also be challenging. One of the ways to find a payment\nvector is through solving a linear programming problem.\nTheorem 1.1.2 ([11]). Let f : RN (cid:209) R be a strictly increasing function. Then, the\nminimizer of the following linear programming problem is a clearing payment vector.\nmaxfppq subject to p \u011b 0,p \u010f L and p \u010f c(cid:0)p\u03a0, (1.1.1)\nwhere c (cid:16) pc ,...,c q is the vector of the equities of the entities, L (cid:16) pL ,...,L q is the\n1 N 1 N\nvector of the total liability of the entities, and \u03a0 is given by\n(cid:20) (cid:28)\n0 \u03c0 (cid:4)(cid:4)(cid:4) \u03c0 \u03c0\n1,2 1,N(cid:1)1 1,N\n(cid:22) \u03c0 2,1 0 (cid:4)(cid:4)(cid:4) (cid:4)(cid:4)(cid:4) \u03c0 2,N ffi\n(cid:22) ffi\n\u03a0 (cid:16) (cid:22) (cid:22) . . . ... . . . ffi ffi\n(cid:22) ffi\n(cid:21)\u03c0 N(cid:1)1,1 (cid:4)(cid:4)(cid:4) (cid:4)(cid:4)(cid:4) 0 \u03c0 N(cid:1)1,N(cid:29)\n\u03c0 \u03c0 (cid:4)(cid:4)(cid:4) \u03c0 0\nN,1 N,2 N,N(cid:1)1\nExercise 1.1.2. Consider the liability matrix below by solving the linear programming\n\u0159N\nproblem (1.1.1) with fppq (cid:16) p . Each row/column is an entity.\ni(cid:16)1 i\n(cid:20) (cid:28)\n0 1 0 1\n(cid:22)0 0 2 0ffi\nL (cid:16) (cid:22) ffi\n(cid:21)2 0 0 1(cid:29)\n0 5 0 0\nThe initial equities are given by c (cid:16) 1, c (cid:16) 2, c (cid:16) 0, and c (cid:16) 0.\n1 2 3 4\n9 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\na) By using a linear programming package such as linprog in MatLab, find a clearing\npayment vector.\nb) Mark the entities that default after applying the clearing payment vector found in part\n(a).\nc) Increase the value of the equity of the defaulted entities just as much as they do not\ndefault anymore.\n1.1.3 Vanilla call and put options\nA call option gives the holder the right but not the obligation to buy a certain asset at\na specified time in the future at a predetermined price. The specified time is called the\nmaturityoption!maturity and often is denoted by T, and the predetermined price is called\nthe strike price and is denoted by K. Therefore, a call option protects its owner against\nany increase in the price of the underlying asset above the strike price at maturity. The\nasset price at time t is denoted by S and at the maturity by S . Call options are available\nt T\nin the specialized options markets at a price that depends, among other factors, on time\nt, T, K, and spot price at current time S (cid:16) S. To simplify, we denote the price of a\nt\ncall option by CpT,K,S,tq2 to emphasize the main factors, i.e., t, T, K, and spot price at\ncurrent time S. Another type of vanilla option, the put option, protects its owner against\nany increase in the price of the underlying asset above the strike price at the maturity; i.e.,\nit promises the seller of the underlying asset at least the strike price at maturity. The price\nof put option is denoted by PpT,K,S,tq, or simply P when appropriate.\nThe payoff of an option is the owner\u2019s gain in a dollar amount. For instance, the payoff\nof a call option is pS (cid:1)Kq . This is because, when the market price at maturity is S\nT (cid:0) T\nand the strike price is K, the holder of the option is buying the underlying asset at lower\nprice K and gains S (cid:1)K, provided S \u0105 K. Otherwise, when S \u010f K, the holder does\nT T T\nnot exercise the option and buys the asset from the market directly. Similarly, the payoff\nof a put option is pK (cid:1)S q .\nT (cid:0)\nSimilar to futures, options are also traded in specialized markets. You can see option\nchain for Tesla in Figure 1.1.7. The columns\u201cbid\u201d and \u201cask\u201d indicate the best buy and sell\nprices in the outstanding orders, and column\u201cOpen Int\u201d (open interest) shows the total\nvolume of outstanding orders.\nWhen the spot price S of the underlying asset is greater than K, we say that the call\nt\noptions are in-the-money and the puts options are outof-the-money . Otherwise, when\nS \u0103 K, the put options are in-the-money and the call options are out-of-the-money. If the\nt\nstrikepriceK is(approximately)thesameasspotpriceS ,wecalltheoptionat-the-money\nt\n(or ATM).\nFar in-the-money call or put options are behave like forward contracts but with a wrong\nforward price! Similarly, far out-of-the-money call or put options have negligible worth.\n2We will see later that C only depends on T (cid:1)t in many models.\n10 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nS S\nT T\nK K\nFigure 1.1.6: Left: the payoff pS (cid:1)Kq of a call option with strike K. Right: the payoff\nT (cid:0)\npK (cid:1)S q of a put option with strike K.\nT (cid:0)\nFigure 1.1.7: Call and put option quotes on Tesla stocks on January 11, 2016. The first\ncolumn is the price of the underlying asset (NASDAQ:TSLA). The bid price is the price at\nwhich trades are willing to buy the options and the ask price is the price at which trades\nare willing to sell. The spot price at the time was $206.11. Source: Google Finance.\nThe holder of an option is called a long position, and the issuer of the option is called a\nshort position. While the holder has the privilege of exercising the option when profitable,\nthe issuer has the obligation to pay the holder the amount of payoff upon exercise.\nA European option is an option whose payoff is a function gpS q of the asset price at\nT\nmaturity S . The function g : R (cid:209) R is called a European payoff function. Call and\nT (cid:0)\nput options are particularly important because any piecewise linear continuous European\npayoff can be written as a linear combination (possibly infinite!) of call option payoffs\nwith possibly different strikes but the same maturity and a constant cash amount; or,\nequivalently, a linear combination of call option payoffs and a put option payoff. Therefore,\n11 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nFigure 1.1.8: Call and put option quotes on IBM stocks on January 13, 2016. In-the-\nmoney options are highlighted. Source: Google Finance.\n\u0159\nthe price of payoff gpS q (cid:16) a (cid:0) a pS (cid:1)K q is given by\nT 0 i i T i (cid:0)\n\u201a\nB pTqa (cid:0) a CpT,K ,S ,tq.\nt 0 i i t\ni\nIn the above, a is the constant cash amount, and for each i, pS (cid:1)K q is the payoff of a\n0 T i (cid:0)\ncall option with the strike price K and the maturity T.\ni\nRemark 1.1.2. The underlying asset S at time T is a call option with strike K (cid:16) 0.\nT\nExample 1.1.2. Put-call parity suggests that the payoff pK(cid:1)S q of a put option can be\nT (cid:0)\nwritten as the summation of payoffs of a long position in K amount of cash, a long position\nin a call option with payoff pS (cid:1)Kq , and a short position in an underlying asset. By\nT (cid:0)\nRemark 1.1.2, a long position in the underlying asset is a call option with strike 0. See\nFigure 1.1.9.\n= + +\nST ST ST ST\nK K K\nFigure 1.1.9: pK (cid:1)S q (cid:16) K (cid:0)pS (cid:1)Kq (cid:1)S .\nT (cid:0) T (cid:0) T\n12 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nExample 1.1.3. An option that promises the payoff gpS q :(cid:16) |S (cid:1)K|, as shown in Figure\nT T\n1.1.10, is made of a long position in a call option with strike K, and long position in a\nput with strike K, both with the same maturity. Equivalently, this payoff can be written as\nK amount of cash, a short position in underlying, and two long positions in a call option\nwith strike K, all with the same maturity.\nK\nS\nT\nK\nFigure 1.1.10: Payoff gpS q (cid:16) |S (cid:1)K| from Example 1.1.3\nT T\nExample 1.1.4. A put option with payoff pK(cid:1)S q can be written as K amount of cash,\nT (cid:0)\na short position in a call option with strike 0, and a long position on a call option with\nstrike K.\nExercise 1.1.3. Consider the payoff gpS q shown in Figure 1.1.6.\nT\ng(S )\nT\nK (cid:0)K\n2 1\n2\nS\nK K T\n1 K +K 2\n1 2\n2\nFigure 1.1.11: Payoff for Exercise 1.1.3\na) Write this payoff as a linear combination of the payoffs of some call options and a\nput option with different strikes and the same maturity.\nb) Repeat part (a) with call options and cash. (No put option is allowed.)\n13 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\n1.1.4 American options\nEuropean options can only be exercised at a maturity for the payoff gpS q. An American\nT\noption gives its owner the right but not the obligation to exercise at any date before or\nat maturity. Therefore, at the time of exercise \u03c4 P r0,Ts, an American call option has an\nexercisevalueequaltopS (cid:1)Kq . WeusethenotationC pT,K,S,tqandP pT,K,S,tq\n\u03c4 (cid:0) Am Am\nto denote the price of an American call and an American put, respectively.\nThe exercise time \u03c4 is not necessarily deterministic. More precisely, it can be a random\ntimethatdependsupontheoccurrenceofcertaineventsinthemarket. Anoptimalexercise\ntime can be found among those of threshold type; the option is exercised before maturity\nthe first time the market price of option becomes equal to the exercise value, whereas the\noption usually has a higher market value than the exercise value. Notice that both of these\nquantities behave randomly over time.\n1.1.5 Bond and forward rate agreements\nA zero-coupon bond (or simply zero bond) is a fixed-income security that promises a fixed\namountofcashinaspecifiedcurrencyatacertaintimeinthefuture, e.g., $100onJanuary\n30. The promised cash is called the principle, face value or bond!face value and the time\nof delivery is called the maturity. All bonds are traded in specialized markets at a price\noften lower than the principle3.\nFor simplicity, throughout this book, a zero bond means a zero bond with principle of $1,\nunless the principle is specified; for example, a zero bond with principle of $10 is ten zero\nbond s. At a time t, we denote the price of a zero bond maturing at T by B pTq.\nt\nWe can use the price of a zero bond to calculate the present value of a future payment\nor cashflow. For example, if an amount of $x at time T is worth x at an earlier time\nBtpTq\nt. This is because, if we invest $ x in a zero bond with maturity T, at the maturity we\nBtpTq\nreceive a dollar amount of x B pTq (cid:16) x.\nBtpTq t\nThe price of the zero bond is the main indicator of the interest rate. While the term\n\u201cinterest rate\u201d is used frequently in news and daily conversations, the precise definition\nof the interest rate depends on the time horizon and the frequency of compounding. An\ninterestratecompoundedyearlyissimplyrelatedtothezerobondpriceby1(cid:0)R(yr) (cid:16) 1 ,\nB0p1q\n(cid:0) R(mo)(cid:8)12\nwhile for an interest rate compounded monthly, we have 1(cid:0) (cid:16) 1 . Therefore,\n12 B0p1q\n(cid:1) R(mo)(cid:9)12\n1(cid:0)R(yr) (cid:16) 1(cid:0) .\n12\nGenerally, an n-times compounded interest rate during the time interval rt,Ts, denoted\n(cid:1) tpnqpTq(cid:9)n\nby Rpnq pTq, satisfies 1 (cid:0) R (cid:16) 1 . When the frequency of compounding n\nt n BtpTq\n3There have been instances when this has not held, e.g., the financial crisis of 2007.\n14 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\napproaches infinity, we obtain\nB tpTq (cid:16) e(cid:1)R tp8qpTq.\nThis motivates the definition of the zero-bond yield. The yield (or yield curve) R pTq of\nt\nthe zero bond B pTq is defined by\nt\n1\nB pTq (cid:16) e(cid:1)pT(cid:1)tqRtpTq or R pTq :(cid:16) (cid:1) lnB pTq. (1.1.2)\nt t t\nT (cid:1)t\nThe yield is a bivariate function R : pt,Tq P D (cid:209) R where D is given by tpt,Tq : T \u0105\n\u011b0\n0 and t \u0103 Tu. Yield is sometimes referred to as the term structure of the interest rate since\nboth variables t and T are time.\nIf the yield curve is a constant, i.e., R pTq (cid:16) r for all pt,Tq P D, then, B pTq (cid:16) e(cid:1)rpT(cid:1)tq.\nt t\nIn this case, r is called the continuously compounded, instantaneous, spot, or short rate.\nHowever, the short rate does not need to be constant. A time-dependent short interest\nrate is a function r : r0,Ts (cid:209) R such that for any T \u0105 0, and t P r0,Ts we have\n(cid:0)\ne(cid:1)\u015f tTrsds;\nB tpTq (cid:16) or equivalently, short rate can be defined as\nBlnB pTq(cid:7) BlnB pTq\nr :(cid:16) (cid:1) t (cid:7) (cid:16) t .\nt BT (cid:7) T(cid:16)t Bt\nThe short rate r or r is an abstract concept; it exists because it is easier to model the\ns\nshort rate than the yield curve. In practice, the interest rate is usually given by the yield\ncurve.\nBesideszerobonds,thereareotherbondsthatpaycoupons onaregularbasis,forexample\na bond that pays the principle of $100 in 12 months and $20 every quarter. A coupon-\ncarrying bond, or simply, a coupon bond, can often be described as a linear combination\nof zero bonds; i.e., a bond with coupon payments of $ c at date T with T \u0103 ... \u0103 T\ni i 1 n(cid:1)1\nand principle payment P at maturity T (cid:16) T is the same as a portfolio of zero bonds with\nn\nprinciple c and maturity T for i (cid:16) 1,...,n and is worth\ni i\nn(cid:1)1 n(cid:1)1\n\u201a \u201a\nc B pT q(cid:0)PB pT q (cid:16) c e(cid:1)pTi(cid:1)tqRtpTiq(cid:0)Pe(cid:1)pTn(cid:1)tqRtpTnq.\ni t i t n i\ni(cid:16)1 i(cid:16)1\nTherefore, zero bonds are the building blocks of all bonds, and the yield curve is the main\nfactor in determining the price of all bonds.\nExample 1.1.5. A risk-free 1-year zero bond with $20 principle is priced B p1q (cid:16) $19 and\n0\na risk-free 2-year zero bond with $20 principle is priced B p2q (cid:16) $17. Then, the yield R p2q\n0 1\nis given by\nR p2q (cid:16) lnB p1q(cid:1)lnB p2qlnB p1q (cid:16) ln19(cid:1)ln17 (cid:19) 0.1112,\n1 0 0 0\nand the price of a risk-free zero bond that start in one year and ends at in two years with\n15 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nprinciple $20 is given by\n1700\nB p2q (cid:16) 100e(cid:1)R1p2q (cid:16) (cid:19) 89.47.\n1\n19\nThe price of a bond that pays a $30 coupon at the end of the current year and $100 as the\nprinciple in two years equals to\nB p1q B p2q\n0 0\n30 (cid:0)100 (cid:16) 5.9(cid:0)17 (cid:16) 22.9.\n100 100\nExercise 1.1.4. a) If a risk-free 1-year zero bond with $100 principle is priced B p1q (cid:16)\n0\n$96 and a risk-free 2-year zero bond with $100 principle is priced B p2q (cid:16) $92, find\n0\nthe price of a risk-free zero bond B p2q and yield curve R p2q.\n1 1\nb) What is the price of a bond that pays a $30 coupon at the end of the current year and\n$100 as the principle in two years?\nIn the above discussion, we implicitly assumed that the issuer of the bond is not subject\nto default on payment of coupons or principle. This type of bonds are called sovereign\nbonds and are often issued by the Federal Reserve or central bank of a given country in\nthatcountry\u2019sowncurrency. Forexample, sovereignbondsintheUnitedStatesareT-bills,\nT-notes, and T-bonds. T-bills are bonds that have a maturity of less than a year, T-notes\nhaveamaturityofmorethanayearuptotenyears, andT-bondshavematuritymorethan\nten years. Bonds issued by other entities or governments in a foreign currency are usually\ncalled corporate bonds. The word \u201ccorporate\u201d emphasizes the default risk of the issuer\non the payments. In addition, sovereign bonds in a foreign currency are subject to the\nmarket risk that is caused by fluctuating exchange rates in the foreign exchange market4.\nTherefore, what is considered a risk-free bond in the United States is not risk-free in the\nEuropean Union.\nThe zero bond price B pTq can directly be used to discount a payment or a cashflow at\nt\ntime T without appealing to a specific short rate model. For example, a cashflow of $10 at\ntime T (cid:16) 1 is worth $ 10B p1q now.\n0\nSimilar to the yield curve, the forward rate F pTq5 of a zero bond is defined by\nt\ne(cid:1)\u015f tTFtpuqdu (cid:1)BlnB tpTq\nB tpTq (cid:16) or F tpTq :(cid:16) .\nBT\nTheforwardratereflectsthecurrentperceptionamongtradersaboutthefuturefluctuations\nof the interest rates. More precisely, at time t, we foresee the continuously compounded\n4Theforeignexchangemarketisadecentralizedover-the-countermarketwheretradersacrosstheworld\nuse to trade currencies.\n5The notation for forward rate is the same as the notation for futures price or forward price in Section\n1.1.1.\n16 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\ninterest rates for N time intervals rt ,t s, rt ,t s, ..., rt ,Ts in the future as F ptq,\n0 1 1 2 N(cid:1)1 t\nF pt q, ..., F pt q, respectively. Here, for n (cid:16) 0,...,N, t (cid:16) t (cid:0) n\u03b4 and \u03b4 (cid:16) T(cid:1)t.\nt 1 t N(cid:1)1 n N\nThen, $1 at time T is worth e(cid:1)FtptN(cid:1)1q\u03b4q at time t N(cid:1)1, e(cid:1)pFtptN(cid:1)1q(cid:0)FtptN(cid:1)2qq\u03b4 at time t N(cid:1)2,\ne(cid:1)pFtptN(cid:1)1q(cid:0)...(cid:0)Ftptnqq\u03b4 at time t n, and e(cid:1)pFtptN(cid:1)1q(cid:0)...(cid:0)Ftpt1q(cid:0)Ftptqq\u03b4 at time t. As n goes to\ninfinity, the value B pTq of the zero bond converges to\nt\ne(cid:1)\u0159N n(cid:16)(cid:1) 01Ftptnq\u03b4 e(cid:1)\u015f tTFtpuqdu.\nlim (cid:16)\nn(cid:209)8\nThe forward rates are related to so-called forward rate agreements. A forward rate agree-\nment is a contract between two parties both committed to exchanging a specific loan (a\nzero bond with a specified principle and a specific maturity) in a future time (called the\ndelivery date) with a specific interest rate. We can denote the agreed rate by fpt ,t,Tq\n0\nwhere t is the current time, t is the delivery date, and T is the maturity of the bond. As\n0\nalways, we take principle to be $1. Then, the price of the underlying bond at time t should\nequalB pTq (cid:16) Bt0pTq . Thisisbecause,ifweinvest$xinB ptqattimet ,wehave x at\nt Bt0ptq t0 0 Bt0ptq\ntime t. Then, at time t, we reinvest this amount in B pTq. At time T, we have x .\nt Bt0ptqBtpTq\nAlternatively, if we invest in B pTq from the beginning, we obtain x , which must be\nt0 Bt0pTq\nthe same as the value of the two-step investment described above6. Therefore, the fair\nforward rate in a forward rate agreement must satisfy\nlnB pTq(cid:1)lnB ptq\nt0 t0\nf pt,Tq (cid:16) (cid:1) .\nt0\nT (cid:1)t\nIf we let T (cid:211) t, we obtain lim f pt,Tq (cid:16) F ptq. In terms of yield, we have\nT(cid:211)t t0 t0\npT (cid:1)t qR pTq(cid:1)pt(cid:1)t qR ptq\n0 t0 0 t0\nf pt,Tq (cid:16) .\nt0\nT (cid:1)t\nF ptq is the instantaneous forward rate. However, f pt,Tq is the forward rate at time t\nt0 t0 0\nfor time interval rt,Ts and is related to the instantaneous forward rate by\n\u017cT\nf pt,Tq (cid:16) F puqdu.\nt0 t0\nt\nUnlike the forward rate and short rate r , yield curve R pTq is accessible through market\nt t\ndata. Forexample,LIBOR7istherateatwhichbanksworldwideagreetolendtoeachother\nand is considered more or less a benchmark interest rate for international trade. Or, the\nUnited States treasury yield curve is considered a risk-free rate for domestic transactions\nwithin the United States. The quotes of yield curve R pTq for LIBOR and the United\nt\n6A more rigorous argument is provided in Section 1.3 Example 1.3.2\n7London Interbank Offered Rate\n17 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nStates treasuries at different maturities are given in Tables 1.2 and 1.3, respectively.\nCurrent date t\nTime-to-maturity T (cid:1)t\n02-19-2016 02-18-2016 02-17-2016 02-16-2016 02-15-2016\nUSD LIBOR - overnight 0.37090 % 0.37140 % 0.37000% 0.37100 % -\nUSD LIBOR - 1 week 0.39305 % 0.39200 % 0.39160% 0.39050 % 0.39340 %\nUSD LIBOR - 1 month 0.43350 % 0.43200 % 0.43005 % 0.42950 % 0.42925 %\nUSD LIBOR - 2 months 0.51720 % 0.51895 % 0.51675 % 0.51605 % 0.51580 %\nUSD LIBOR - 3 months 0.61820 % 0.61820 % 0.61940 % 0.61820 % 0.61820 %\nUSD LIBOR - 6 months 0.86790 % 0.87040 % 0.86660 % 0.86585 % 0.86360 %\nUSD LIBOR - 12 months 1.13975 % 1.14200 % 1.13465 % 1.13215 % 1.12825 %\nTable 1.2: LIBOR yield curve for US dollars. Source: www.global-rates.com. The the\ndate format in the table is DD-MM-YYYY, contrary to the date format MM/DD/YYYY\nin the United States.\nTime-to-maturity T (cid:1)t\nDate t\n1 Mo 3 Mo 6 Mo 1 Yr 5 Yr 10 Yr 20 Yr 30 Yr\n02/22/16 0.28% 0.33% 0.46% 0.55% 1.25% 1.77% 2.18% 2.62%\n02/23/16 0.28% 0.32% 0.47% 0.55% 1.23% 1.74% 2.16% 2.60%\n02/24/16 0.28% 0.33% 0.46% 0.55% 1.21% 1.75% 2.16% 2.61%\nTable 1.3: Treasury yield curve for US dollar. Source: https://www.treasury.gov.\nTheforwardratesf pt,Tqcanalsobeobtainedfromthedataonforwardrateagreements,\nt0\nbut this data is not publicly available.\nWeshouldclarifythatthereisaslightdifferencebetweentheyieldcurvedefinedby(1.1.2)\nand the yield curve data in Tables 1.2 and 1.3. The recorded data on the yield curve comes\nfrom\n(cid:2) (cid:10) 1\nB pTq (cid:16) p1(cid:0)R \u02c6 pTqqT(cid:1)t, or R\u02c6 pTq :(cid:16) 1 T(cid:1)t (cid:1)1, (1.1.3)\nt t t\nB pTq\nt\nwhere the time-to-maturity T (cid:1)t measured in years. Therefore,\n(cid:1) (cid:1) (cid:9)(cid:9) 1 (cid:1) (cid:9)\nR\u02c6 pTq (cid:16) exp R pTqpT (cid:1)tq T(cid:1)t (cid:1)1 (cid:16) exp R pTq (cid:1)1 (cid:19) R pTq,\nt t t t\nwhen R pTqissmall. Forexample, inTable1.3, theyieldofa zerobond thatexpiresinone\nt\nmonth is given by 0.28% (cid:16) .0028 and the price of such a bond is equal to p1.0028q(cid:1)1{12 (cid:16)\n0.9996.\nIt is also important to know that an interpolation method is used to generate some of\nthe yield curve data in Tables 1.2 and 1.3. This is because a bond that expires exactly\n18 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nin one month, three months, six months, or some other time does not necessarily always\nexist. A bond that expires in a month will be a three-week maturity bond after a week.\nTherefore, after calculating the yield for the available maturities, an interpolation gives\nus the interpolated yields of the standard maturities in the yield charts. For example, in\nTable 1.3, The Treasury Department uses the cubic Hermite spline method to generate\ndaily yield curve quotes.\nRemark 1.1.3. While the market data on the yield of bonds with different maturity is\nprovided in the discrete-time sense, i.e., (1.1.3), the task of modeling a yield curve in\nfinancial mathematics is often performed in continuous-time. Therefore, it is important to\nlearn both frameworks and the relation between them.\nSensitivity analysis of the bond price\nWe measure the sensitivity of the zero bond price with respect to changes in the yield\nor errors in the estimation of the yields by dBtpTq (cid:16) (cid:1)pT (cid:1) tqB pTq. As expected, the\ndRtpTq t\nsensitivity is negative, which means that the increase (decrease) in yield is detrimental\n(beneficial) to the bond price. It is also proportional to the time-to-maturity of the bond;\ni.e., the duration of the zero bond is equal to (cid:1)dBtpTq{dRtpTq. For a coupon bond, the\nBtpTq\nsensitivity is measured after defining the yield of the bond; the yield of a coupon bond\nwith coupons payments of $ c at date T with T \u0103 ... \u0103 T and principle payment\ni i 1 n(cid:1)1\nP (cid:16) c at maturity T (cid:16) T is a number y\u02c6such that ppy\u02c6q equals the price of the bond, and\nn n\nppyq is the function defined below:\nn\n\u201a\nppyq :(cid:16) c e(cid:1)pTi(cid:1)tqy.\ni\ni(cid:16)1\nTherefore, the yield of a bond is the number y that satisfies\nn n\n\u201a \u201a\nc e(cid:1)pTi(cid:1)tqy\u02c6 (cid:16) c B pT q.\ni i t i\ni(cid:16)1 i(cid:16)1\n\u0159n(cid:1)1c\nThe function ppyq is a strictly decreasing function with pp(cid:1)8q (cid:16) 8, pp0q (cid:16) (cid:0)P,\ni(cid:16)1 i\nand pp8q (cid:16) 0. Therefore, for a bond with a positive price, the yield of the bond exists as\na real number. In addition, if the price of the bond is in the range p0,pp0qq, the yield of\nthe bond is a positive number.\nTherefore, the yield y\u02c6 depends on all parameters t, c , T , and R pT q, for i (cid:16) 1,...,n.\ni i t i\nMotivated from the zero bond, the duration the coupon bond is given by\ndp{dy \u201an c ie(cid:1)pTi(cid:1)tqy\u02c6\nD :(cid:16) (cid:1) py\u02c6q (cid:16) pT (cid:1)tq ,\ni\np ppy\u02c6q\ni(cid:16)1\n19 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\ncie(cid:1)pTi(cid:1)tqy\u02c6\na naturally weighted average of the duration of payments, with weights , for\nppy\u02c6q\ni (cid:16) 1,...,n.\nd2BtpTq{dRtpTq2\nTheconvexity ofazerobondisdefinedbyusingthesecondderivativeC :(cid:16) (cid:16)\nBtpTq\npT (cid:1)tq2, and for a coupon bond is expressed as\nd2p{dy2 \u201an (cid:1)tq2c ie(cid:1)pTi(cid:1)tqy\u02c6\nC :(cid:16) py\u02c6q (cid:16) pT .\ni\np ppy\u02c6q\ni(cid:16)1\nRecall that a function f is convex if and only if fp\u03bbx(cid:0)p1(cid:1)\u03bbqyq \u010f\n\u03bbfpxq (cid:0) p1 (cid:1) \u03bbqfpyq for all \u03bb P p0,1q. If the function is twice dif-\nferentiable, convexity is equivalent to f2 \u011b 0. For more details on\nconvexity, see Section A.1.\nWhile the duration indicates a negative relation between changes in yield y\u02c6 and price of\nthe bond ppy\u02c6q, the convexity tells more about the magnitude of this change. For example,\nconsidering two bonds with the same duration, the one with higher convexity is more\nsensitive to changes in the yield. See Figure 1.1.12.\n\u2206p(y) \u2206p(y)\np(y) Bond1 p(y) Bond1\nBond2 Bond2\n\u2206y \u2206y\nFigure 1.1.12: The relative price change of the bond \u2206ppyq (cid:16) ppyq(cid:1)ppy\u02c6q with change in the\nppy\u02c6q ppy\u02c6q\nyield \u2206y (cid:16) y(cid:1)y\u02c6. Left: Bond 1 is longer in duration and therefore less sensitive than bond\n2. Right: Both bonds are the same duration, but bond 1 is less convex and more sensitive.\nRemark 1.1.4. While in practice bonds are not considered derivatives, they are bets on\nthe interest rate and therefore can mathematically be considered as derivatives. Forward\ninterest agreements are derivatives on bond.\n1.1.6 Credit derivatives\nFinancial instruments are issued by financial companies such as banks. There is always a\nrisk that the issuer will go bankrupt or at least default on some payments and be unable to\n20 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nRating Moody\u2019s S&P Fitch\nPrime Aaa AAA AAA\nSubprime Ba1 and lower BB+ and lower BB+ and lower\nDefault C D D\nTable 1.4: A brief table of rating by Moody, S&P and Fitch.\nmeet its obligation. The same situation holds when a debt such as a mortgage is issued. In\nsuch cases, the beneficiary of the issued security is exposed to credit risk. Therefore, it is\nimportant to know about the creditworthiness of individual and corporate loan applicants.\nThere are three major credit rating companies for corporations and other institutions,\nincluding governments: Moody\u2019s, Standard and Poor\u2019s (S&P), and Fitch. The rates are\nusually shown by letters similar to letter grading of a university course. Regardless of\nthe notation used, the highest level of creditworthiness is called prime rating and the\nlowest is given to a defaulted entity. Lower-half rates are usually referred to subprime\nwhich indicates higher exposure to credit risk. See Table 1.4 for a sample of a ratings\ntable and its notations. To cover credit risk, financial institutes issue credit derivatives.\nThere are two well-known credit derivatives in the market: credit default swap (CDS) and\ncollateralized debt obligation (CDO). Both derivatives are written on defaultable loans\n(such as bonds). For simplicity, we only consider CDOs and CDSs on defaultable zero\nbonds, i.e., the simplest of all defaultable assets. First, we introduce defaultable zero\nbonds and explain how the yield of a defaultable zero bond is calculated.\nDefaultable zero bond\nConsider a zero bond with a face value $1. If the bond is sovereign with the yield R pTq,\nt\nthen the value of the bond is\nB pTq (cid:16) e(cid:1)RtpTqpT(cid:1)tq.\nt\nWe assume that in case of default, the value of the bond vanishes instantly. The default\nof a company and the time of default are random. If we denote the (random) time of the\ndefault by \u03c4 and assume that the default has not occurred yet, i.e., \u03c4 \u0105 t, we define the\nsurvival rate of the defaultable bond by \u03bb pTq, which satisfies\nt\nPp\u03c4 \u0105 T | \u03c4 \u0105 tq (cid:16) 1(cid:1)Pp\u03c4 \u010f T | \u03c4 \u0105 tq (cid:16) 1(cid:1)e(cid:1)\u03bbtpTqpT(cid:1)tq.\nIn the above Pp(cid:4) | \u03c4 \u0105 tq represents the probability measure (function) conditional on\n\u03c4 \u0105 t, i.e., the default has not occurred until time t. Notice that \u03bb pTq always exists as a\nt\nnonnegative number, or (cid:0)8, and is given by\n1\n\u03bb pTq (cid:16) (cid:1) lnPp\u03c4 \u010f T | \u03c4 \u0105 tq.\nt\nT (cid:1)t\n21 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nIf \u03bb pTq (cid:16) 0, the bond is sovereign and never defaults. Otherwise, if \u03bb pTq (cid:16) (cid:0)8, the\nt t\nprobability of default is 1 and the default is a certain event. The payoff of a defaultable\nbond is given by the indicator random variable below:\n#\n1 when \u03c4 \u0105 T,\n1 :(cid:16)\nt\u03c4\u0105Tu\n0 when \u03c4 \u010f T.\nAcommonformalisminpricingfinancialsecuritieswitharandompayoffistotakeexpecta-\ntion from the discounted payoff. More precisely, the value of the defaultable bond is given\nby the expected value of the discounted payoff, i.e.,\n(cid:1) (cid:9)\nB\u03bbpTq :(cid:16) E(cid:16) B pTq1 | \u03c4 \u0105 t(cid:24) (cid:16) B pTqPp\u03c4 \u0105 T | \u03c4 \u0105 tq (cid:16) e(cid:1)RtpTqpT(cid:1)tq 1(cid:1)e(cid:1)\u03bbtpTqpT(cid:1)tq .\nt t t\u03c4\u0105Tu t\nThe risk-adjusted yield of a defaultable bond is defined by the value R\u03bbpTq such that\nt\n(cid:1) (cid:9)\ne(cid:1)R t\u03bbpTqpT(cid:1)tq (cid:16) B\u03bbpTq (cid:16) e(cid:1)RtpTqpT(cid:1)tq 1(cid:1)e(cid:1)\u03bbtpTqpT(cid:1)tq .\nt\nEquivalently,\n1 (cid:1) (cid:9)\nR\u03bbpTq (cid:16) R pTq(cid:1) ln 1(cid:1)e(cid:1)\u03bbtpTqpT(cid:1)tq\nt t T (cid:1)t\nFor a defaultable bond, we always have R\u03bbpTq \u0105 R pTq. Notice that when \u03bb pTq (cid:210) 8,\nt t t\nR\u03bbpTq (cid:211) R pTq, and when \u03bb pTq (cid:211) 0, R\u03bbpTq (cid:210) 8. .\nt t t t\nThe higher the probability of default, the higher the adjusted yield of\nthe bond.\nExercise 1.1.5. Consider a defaultable zero bond with T (cid:16) 1, face value $1, and survival\nrate 0.5. If the current risk-free yield for maturity T (cid:16) 1 is 0.2, find the adjusted yield of\nthis bond.\nCredit default swap (CDS)\nA CDS is a swap that protects the holder of a defaultable asset against default before a\ncertain maturity time T by recovering a percentage of the nominal value specified in the\ncontract in case the default happens before maturity. Usually, some percentage of the\nloss can be covered by collateral or other assets of the defaulted party, i.e., a recovery\nrate denoted by R. The recovery rate R is normally a percentage of the face value of the\ndefaultable bond and is evaluated prior to the time of issue. Therefore, the CDS covers\n1(cid:1)R percent of the value of the asset at the time of default. In return, the holder makes\nregular, constant premium payments \u03ba until the time of default or maturity, whichever\nhappens first. The maturity of a CDS is often the same as the maturity of the defaultable\n22 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\nasset, if there is any. For example, a CDS on a bond with maturity T also expires at time\nT.\nTo find out the fair premium payments \u03ba for the CDS, let\u2019s denote the time of the default\nby \u03c4 and the face value of the defaultable bond by P. If the default happens at \u03c4 \u010f T, the\nCDS pays the holder an amount of p1(cid:1)RqP. The present value of this amount is obtained\nby discounting it with a sovereign zero bond, i.e., p1(cid:1)RqPB pT ^\u03c4q. If the issuer of the\n0\nbond defaults after time T, the CDS does not pay any amount. Thus, the payment of the\nCDS is a random variable expressed as\np1(cid:1)RqPB pT ^\u03c4q1 .\n0 t\u03c4\u010fTu\nThe holder of the CDS makes regular payments of amount \u03ba at points 0 (cid:16) T \u0103 T \u0103 (cid:4)(cid:4)(cid:4) \u0103\n0 1\nT in time with T \u0103 T. Then, the present value of payment of amount \u03ba, paid at time T\nn n i\nis\n\u03ba1 B pT q.\ntTi\u0103\u03c4u 0 i\nThe total number of premium payments is N :(cid:16) maxti(cid:0)1 : T \u0103 \u03c4 ^Tu, which is also\ni\na random variable with values 1,...,n (cid:0) 1. Therefore, the present value of all premium\npayments is given by\nN\n\u201a\n\u03ba B pT q.\n0 i\ni(cid:16)1\nThe discounted payoff of the CDS starting at time t is given by\nN\n\u201a\np1(cid:1)RqPB pT ^\u03c4q1 (cid:1)\u03ba B pT q (1.1.4)\n0 t\u03c4\u010fTu 0 i\ni(cid:16)1\nThe only source of randomness in the above payoff is the default time, i.e., \u03c4. This makes\n\u0159N\nthe terms B pT ^\u03c4q1 and B pT q random variables. Notice that, although each\n0 t\u03c4\u010fTu i(cid:16)1 0 i\n\u0159N\nindividual term in the summation B pT q is not random, the number of terms N in\ni(cid:16)1 0 i\nthe summation is.\nBecause of the presence of randomness, we follow the formalism that evaluates the price\nof an asset with random payoff by taking the expected value of the discounted payoff. In\ncase of a CDS, the price is known to be zero; either party in a CDS does not pay or receive\nany amount by entering a CDS contract. Therefore, the premium payments \u03ba should be\nsuch that the expected value of the payoff (1.1.4) vanishes. To do so, first we need to know\nthe probability distribution of the time of default. The task of finding the distribution of\ndefault can be performed through modeling the survival rate, which is defined in Section\n1.1.6. Provided that the distribution of default is known, \u03ba can be determined by taking\n23 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\nthe expected value as follows:\nE(cid:16) (cid:24)\nB pT ^\u03c4q1\n0 t\u03c4\u010fTu\n\u03ba (cid:16) p1(cid:1)RqP E(cid:16)\u0159 q(cid:24) . (1.1.5)\nB pT\n0\u010fTi\u0103\u03c4 0 i\nExercise 1.1.6. Consider a CDS on a defaultable bond with maturity T (cid:16) 1 year and\nrecovery rate R at 90%. Let the default time \u03c4 be a random variable with the Poisson\ndistributionwithmean6months. Assumethattheyieldofarisk-freezerobondisaconstant\n1 for all maturities within a year. Find the monthly premium payments of the CDS in terms\nof the principle of the defaultable bond P (cid:16) $1.\nCollateralized debt obligation (CDO)\nA CDO is a complicated financial instrument. For illustrative purposes, we present a sim-\nplifiedstructureofaCDOinthissection. OnelegofCDOisaspecial-purposeentity(SPE)\nthat holds a portfolio of defaultable assets such as mortgage-backed securities, commercial\nreal estate bonds, and corporate loans. These defaultable assets serve as collateral; there-\nfore we call the portfolio of these assets a collateral portfolio. Then, SPE issues bonds,\nwhich pay the cashflow of the assets to investors in these bonds. The holders of these\nspecial bonds do not uniformly receive the cashflow. There are four types of bonds in\nfour trenches: senior, mezzanine, junior, and equity. The cashflow is distributed among\ninvestors first to the holders of senior bonds, then mezzanine bond holders, then junior\nbond holders, and finally equity bond holders. In case of default of some of the collateral\nassetsintheportfolio, equityholdersarethefirsttoloseincome. Therefore, aseniortrench\nbond is the most expensive and an equity trench bond is the cheapest. CDOs are traded\nin specialized debt markets, derivative markets, or over-the-counter (OTC).\nACDOcanbestructurallyverycomplicated. Forillustrationpurpose,inthenextexample\nwe focus on a CDO that is written only on zero bonds.\nExample 1.1.6. Consider a collateral portfolio of 100 different defaultable zero bonds\nwith the same maturity. Let\u2019s trenchize the CDO in four equally sized trenches as shown\nin Figure 1.1.13. If none of the bonds in the collateral portfolio default, the total $100\ncashflow will be evenly distributed among CDO bond holders. However, if ten bonds default,\nthen total cashflow is $90; an amount of $75 to be evenly distributed among the junior,\nmezzanine, and senior holders, and the remaining amount of $15 dollars will be evenly\ndistributed among equity holders. If 30 bonds default, then total cashflow is $70; an amount\nof $50 to be evenly distributed among the mezzanine and senior holders, and the remaining\namount of $5 dollars will be evenly distributed among mezzanine holders. Equity holders\nreceive $0. If there are at least 50 defaults, equity and junior holders receive nothing. The\nmezzanine trench loses cashflow, if and only if the number of defaults exceed 50. The senior\ntrench receives full payment, if and only if the number of defaults remains at 75 or below.\n24 1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\n100\nstluafedfo#\nsenior\n75\nmezzanine\n50\njunior\n25\nequity\n0 %ofloss\n%100\nFigure 1.1.13: Simplification of CDO structure\nAbove 75 defaults, equity, junior, and mezzanine trenches totally lose their cashflow, and\nsenior trench experiences a partial loss.\nExercise 1.1.7. Consider a credit derivative on two independently defaultable zero bonds\nwith the same face value at the same maturity, which pays the face value of either bond in\ncase of default of that bond. A credit derivative of this type is written on two independently\nbonds: one of the bonds has a risk-adjusted yield of 5% and the other has a risk-adjusted\nyield of 15%. Another credit derivative of this type is written on two other independently\ndefaulted bonds, both with a risk-adjusted yield of 10%. If both credit derivatives are offered\natthesameprice, whichoneisbetter? Hint: TheprobabilityofdefaultisPp\u03c4 \u010f T | \u03c4 \u0105 tq (cid:16)\n(cid:1) (cid:9)\ne(cid:1)\u03bbtpTqpT(cid:1)tq and the risk-adjusted yield satisfies R t\u03bbpTq (cid:16) R tpTq(cid:1) T1 ln 1(cid:1)e(cid:1)\u03bbtpTqpT(cid:1)tq .\n(cid:1)t\nTherefore, the probability of default satisfies Pp\u03c4 \u010f T | \u03c4 \u0105 tq (cid:16) 1(cid:1)e(cid:1)pR t\u03bbpTq(cid:1)RtpTqqpT(cid:1)tq.\nLoss distribution and systemic risk\nWelearnedfromthe2007financialcrisisthatevenaseniortrenchbondofaCDOcanyield\nyield an unexpectedly low cashflow caused by an unexpectedly large number of defaults in\nthe collateral portfolio, especially when the structure of the collateral portfolio creates a\nsystemic risk. To explain the systemic risk, consider a collateral portfolio, which is made\nup of mortgages and mortgage-based securities. These assets are linked through several\n25 1.1. FINANCIAL DERIVATIVES 1. PRELIMINARIES\ncommon risk factors, some are related to the real estate market, and the others are related\nto the overall situation of the economy. These risk factors create a correlation between\ndefaults of these assets. Most of the risk factor that were known before the 2007 financial\ncrisis can only cause a relatively small group of assets within the collateral portfolio to\ndefault. If risk factor can significantly increase the chance of default of a large group of\nassets within the collateral portfolio, then it is a systemic risk factor. If we only look at the\ncorrelation between the defaults of the assets in the collateral portfolio, we can handle the\nnonsystemic risk factors. However, a systemic risk factor can only be found by studying\nthe structure of the collateral portfolio beyond the correlation between the defaults.\nA difference between systemic and nonsystemic risk can be illustrated by the severity of\nloss. In Figure 1.1.14, we show the distribution of loss in three different cases: independent\ndefaultable assets, dependent defaultable assets without a systemic factor, and dependent\ndefaultable assets with systemic factor. The loss distribution, when a systemic risk factor\nexists has at least one spike at a large loss level. It is important to emphasize that the\nempirical distribution of loss does not show the above-mentioned spike and the systemic\nriskfactordoesnotleaveatraceinacalmsituationofamarket. Relyingononlyaperiodof\nmarketdata,inwhichsystemiclosseshavenotoccurred,leadsusintoadangerousterritory,\nsuch as the financial meltdown of 2007\u20132008. Even having the data from a systemic event\nmay not help predict the next systemic event, unless we have a sound understanding of the\nfinancial environment. Therefore, we can only find systemic risk factors through studying\nthe structure of a market.\nTake the following example, as extreme and hypothetical as it is, as an illustration of\nsystemic risk. Consider a CDO made up of a thousand derivatives on a single defaultable\nasset. If the asset does not default, all trenches collect even shares of the payoff of the\nderivatives. However,incaseofdefault,alltrenchesbecomeworthless. Evenifyouincrease\nthe number of assets to, ten, it only takes a few simultaneously defaulted assets to blow up\nthe CDO. Even when the number of assets becomes large, their default may only depend\non few factors; i.e., when a few things go wrong, the CDO can become worthless.\nExercise 1.1.8. Consider a portfolio of 1000 defaultable asset with the same future value\n$1. Let Z represent the loss from asset i which is 1 when asset i defaults and 0 otherwise.\ni\n\u01591000Z\nTherefore, the total loss of the portfolio is equal to L :(cid:16) . Plot the probability\ni(cid:16)1 i\ndensity function (pdf) of L in the following three cases.\na) Z ,...,Z are i.i.d. Bernoulli random variables with probability p (cid:16) .01.\n1 1000\nb) Z ,...,Z are correlated in the following way. Given the number of defaults N \u011b 0,\n1 1000\nthe defaulted assets can with equal likelihood be any combination of N out of 100\nassets, and N is distributed as a negative binomial with parameters pr,pq (cid:16) p90,.1q.\nWhen N \u011b 1000, all assets have defaulted. See Example B.14. Plot the pdf of L.\nc) Now let X be a Bernoulli random variable with probability p (cid:16) .005. Given X (cid:16) 0,\nthe new set of random variables Z ,...,Z are i.i.d. Bernoulli random variables\n1 1000\n26 Spike\nFattail\n?\ny\n?\ny\n1. PRELIMINARIES 1.1. FINANCIAL DERIVATIVES\n(cid:1)10(cid:0)2\n.15 .02\nUncorrelated Uncorrelated\nCorrelated Correlated\nCorrelated with systemic risk\n.1\n.01\n.05\nSp?ike\nF?attail y\ny\n0 20 40 60 80 100 22 24 26 28 30\nSeverity of total loss Fat tail of correlated losses\nFigure 1.1.14: Distributionofloss: Correlationincreasestheprobabilityatthetailofthe\ndistribution of loss. Systemic risk adds a spike to the loss distribution. All distributions\nhave the same mean. The fat-tailed loss distribution and the systemic risk loss distribution\nhave the same correlation of default.\nwith probability p (cid:16) .01, and given X (cid:16) 1, random variables Z ,...,Z are i.i.d.\n1 1000\nBernoulli random variables with probability p (cid:16) .3. The structure is illustrated in\nFigure 1.1.15.\nPlot the distribution of the loss.\nX\nZ1 Z2 Z3 (cid:1)(cid:1)(cid:1) Z88 Z99 Z100\nFigure 1.1.15: Variable X represents a systemic factor for variables Z ,...,Z . When\n1 100\nX (cid:16) 1, the chance of Z (cid:16) 1 increases drastically. Since Z (cid:16) 1 represents the loss from\ni i\nasset i, when the systemic factor X is passive, i.e., X (cid:16) 0, the loss distribution is similar\nto one for a portfolio of independent defaultable assets.\nThere are two main approaches to modeling a financial environment. Some studies, such\nas (Acemoglu, Ozdaglar, and Tahbaz-Salehi 2015; Cont, Moussa, and Santos 2011; Amini,\nFilipovi\u0107, and Minca 2015), model a complex financial network of loans by a random\ngraph. Others, such as (Garnier, Papanicolaou, and Yang 2013), use the theory of mean\n27 1.2. OPTIMIZATION IN FINANCE 1. PRELIMINARIES\nfieldgamestomodelthestructureofafinancialenvironment. Whiletheformeremphasizes\nthe contribution of the heterogeneity of the network in systemic risk, the latter shows that\nsystemic risk can also happen in a homogeneous environment. An example of such a\nnetwork method, that most central banks and central clearinghouses use to assess systemic\nrisk to the financial networks they oversee is the Eisenberg-Noe model, which is discussed\nin Section 1.1.2.\n1.2 Optimization in finance\nOptimization is a regular practice in finance: a hedge fund wants to increase its profit,\na retirement fund wants to increase its long-term capital gain, a public company wants\nto increase its share value, and so on. One of the early applications of optimization in\nfinance is the Markowitz mean-variance analysis on diversification; [20]. This leads to\nquadratic programming and linear optimization with quadratic constraint. Once we define\ntheconditionfortheoptimalityofaportfolioinareasonablesense,wecanbuildanoptimal\nportfolio, or an efficient portfolio. Then, the efficient portfolio can be used to analyze\nother investment strategies or price new assets. For example, in the capital asset pricing\nmodel (CAPM), we evaluate an asset based on its correlation with the efficient market. In\nthis section, we present a mean-variance portfolio selection problem as a classical use of\noptimization methods in finance.\nConsider a market with N assets. Assume that we measure the profit of the asset over a\nperiod r0,1s by its return:\nSpiq (cid:1)Spiq\nR (cid:16) 1 0 .\ni\nSpiq\n0\nSpiq Spiq\nHere, and are the current price and the future price of the asset i, respectively.\n0 1\nThe return on an asset is the relative gain of the asset. For instance, if the price of an asset\nincreases by 10%, the return is 0.1. Since the future price is unknown, we take return as a\nrandom variable and define the expected return by the expected value of the return, i.e.,\nR :(cid:16) ErR s.\ni i\nThe risk of an asset is defined as the standard deviation of the return \u03c3 , where\ni\n\u03c32 :(cid:16) varpR q.\ni i\nExpected return and risk are two important factors in investment decisions. An investor\nwith a fixed amount of money wants to distribute her wealth over different assets to make\nan investment portfolio. In other words, she wants to choose weights p\u03b8 ,...,\u03b8 q P RN such\n1 N (cid:0)\n\u0159N\nthat \u03b8 (cid:16) 1 and invest \u03b8 fraction of her wealth on asset i. Then, her expected return\ni(cid:16)1 i i\n28 1. PRELIMINARIES 1.2. OPTIMIZATION IN FINANCE\non this portfolio choice is given by\nN\n\u201a\nR :(cid:16) \u03b8 R .\n\u03b8 i i\ni(cid:16)1\nHowever,theriskofherportfolioisalittlemorecomplicatedanddependsonthecorrelation\nbetween the assets\nN\n\u201a \u201a\n\u03c32 :(cid:16) \u03b82\u03c32(cid:0)2 \u03b8 \u03b8 \u03f1 \u03c3 \u03c3 .\n\u03b8 i i i j ij i 2\ni(cid:16)1 1\u010fi\u0103j\u010fN\nHere \u03f1 is the correlation between the returns of assets i and j.\nij\nExample1.2.1(Twoassets). AssumethatN (cid:16) 2andR andR areassetswithcorrelated\n1 2\nreturns, and that correlation is given by \u03f1 . Thus, for \u03b8 P r0,1s, we invest \u03b8 portion of\n12\nthe wealth in asset 1 and the rest in asset 2. Then, the expected return and the risk of the\nportfolio as a function of \u03b8 are given by\nR (cid:16) \u03b8R (cid:0)p1(cid:1)\u03b8qR and \u03c32 (cid:16) \u03b82\u03c32(cid:0)p1(cid:1)\u03b8q2\u03c32(cid:0)2\u03b8p1(cid:1)\u03b8q\u03f1 \u03c3 \u03c3 .\n\u03b8 1 2 \u03b8 1 2 12 1 2\nTherefore, by eliminating \u03b8, \u03c32 becomes a quadratic function of R ; see the red parabola in\n\u03b8 \u03b8\nFigure 1.2.1.\n\u03c32\nExercise 1.2.1. Show that when \u03b8 (cid:16) 2 , the portfolio with two uncorrelated assets in\n\u03c32(cid:0)\u03c32\n1 2\nExample 1.2.1 takes the minimum risk \u03c32. Find the minimum value. Repeat the result for\n\u03b8\nthe positively and negatively correlated assets.\nAs seen in Figure 1.2.1 and shown in Exercise 1.2.1, there is a portfolio with minimum\nrisk \u03c3 and return R(cid:6) that is higher than the minimum return between the two assets. If\nmin\nthe goal is to minimize risk regardless of the return of the portfolio, there is a better option\nthan fully investing in the lower-risk asset. Even if the assets are correlated, negatively or\npositively, the minimum risk portfolio exists. The only exception is when the two assets\nare positively correlated with \u03f1 (cid:16) 1, where the least risky option is to invest fully in\n12\nthe asset with lower risk. Notice that in the dotted parts of the red and green curves, all\nportfolios are worse than the minimum risk portfolio. In other words, the minimum risk\nportfolio has higher return than all dotted portfolios while it maintains the lowest risk. By\nchoosing a portfolio in the solid part of the curve, we accept to take higher risk than the\nminimum risk portfolio. In return, the return of the chosen portfolio also is higher than\nthe return of the minimum risk portfolio. The solid part of the curve is called the efficient\nfrontier.\nThe collection of all portfolios made up of more than two assets is not represented simply\nby a one-dimensional curve; such a portfolio is represented by a point in a two-dimensional\nregion that is not always easy to find. However, Robert Merton in [21] shows that the\n29 1.2. OPTIMIZATION IN FINANCE 1. PRELIMINARIES\nR\n(cid:18)\nR\n2\nR\n1\n(cid:27)2\n(cid:18)\n(cid:27)2 (cid:27)2\n1 2\nFigure 1.2.1: The risk of a portfolio with two assets as a function of expected return.\n\u03c32 as a function of R is a quadratic curve. The green curve indicates when the returns\n\u03b8 \u03b8\nof assets are negatively correlated with correlation (cid:1)1, the green curve indicates when the\nreturns of assets are negatively correlated with correlation less than (cid:1)1, the red curve\nindicates uncorrelated assets, the gray curve indicates when they are positively correlated,\nand the black curve indicates when the returns of assets are positively correlated with\ncorrelation 1.\n30 1. PRELIMINARIES 1.2. OPTIMIZATION IN FINANCE\nFigure 1.2.2: Left: the risk vs return of all portfolios on three assets. The assets are\nmarked by blue dots. The bi-asset risk-return curves are plotted with blue, green and red\ncolors. Right: The efficient frontier for three assets is shown in orange.\nefficient frontier always exists regardless of the number of assets. In Figure 1.2.2, we\nsketched the risk-return region for three assets and marked the efficient frontier for them.\nTo define the efficient frontier, we impose a natural partial order among all portfolios\nbased on their risk and return: \u03b8 \u0105 \u03b8\u02c6if and only if R \u0105 R and \u03c3 \u010f \u03c3 , or R \u011b R and\n\u03b8 \u03b8\u02c6 \u03b8 \u03b8\u02c6 \u03b8 \u03b8\u02c6\n\u03c3 \u0103 \u03c3 . In other words, one portfolio is better than another if it has either a lower risk\n\u03b8 \u03b8\u02c6\nwith at least the same return, or a higher return with at most the same risk. The efficient\nfrontier is the set of all maximal portfolios under this order; i.e., there is no portfolio that\nis better.\nMinimum risk portfolio\nThe portfolio with the least risk \u03c3 is located in the lowest end of the efficient frontier.\nmin\nTo find the lowest-risk portfolio, we solve the following problem.\n\u201a\nmin\u03c3 subject to \u03b8 \u011b 0 and \u03b8 (cid:16) 1.\n\u03b8 i\ni\nNoticethattheaboveoptimizationproblem isequivalenttosolvingthe quadraticprogram-\nming problem.\n\u201a\nmin\u03c32 subject to \u03b8 \u011b 0 and \u03b8 (cid:16) 1. (1.2.1)\n\u03b8 i\ni\nRecall that\nN\n\u201a \u201a\n\u03c32 :(cid:16) \u03b82\u03c32(cid:0)2 \u03b8 \u03b8 \u03f1 \u03c3 \u03c3\n\u03b8 i i i j ij i 2\ni(cid:16)1 1\u010fi\u0103j\u010fN\nwhichcanbewritteninmatrixformby\u03b8TC\u03b8. Here,thematrixC isthevariance-covariance\nmatrix between assets given by\nC (cid:16) \u03f1 \u03c3 \u03c3 .\nij ij i j\n31 1.2. OPTIMIZATION IN FINANCE 1. PRELIMINARIES\nIfallassetsarelinearlyuncorrelated, thenC ispositive-definite. Therefore, problem(1.2.1)\nis similar to those studied in Section A.2.\nMinimizing risk subject to return constraint\nIf we want to have a return higher than the return from the portfolio, we have to take more\nrisk than \u03c3 . This can be achieved by adding the constraint of a minimum return.\nmin\n\u201a\nmin\u03c3 subject to \u03b8 \u011b 0 \u03b8 (cid:16) 1 and R \u011b R . (1.2.2)\n\u03b8 i \u03b8 0\ni\nThe constant R is the desired return from the portfolio.\n0\nExercise 1.2.2. Consider a portfolio of ten assets with the expected return given by\n(cid:16) (cid:24)\n.1 .2 .3 .5 .2 .1 .05 .1 .2 .1\nand the variance-covariance matrix by\n(cid:20)1 .2 0 0 0 0 0 0 0 0(cid:28)\n(cid:22).2 1 .2 0 0 0 0 0 0 0ffi\n(cid:22) ffi\n(cid:22)0 .2 1 .2 0 0 0 0 0 0ffi\n(cid:22) ffi\n(cid:22)0 0 .2 1 .2 0 0 0 0 0ffi\n(cid:22) ffi\n(cid:22)0 0 0 .2 2 .1 0 0 0 0ffi\n(cid:22) ffi\n(cid:22)0 0 0 0 .1 2 .1 0 0 0ffi\n(cid:22) ffi\n(cid:22)0 0 0 0 0 .1 2 .1 0 0ffi\n(cid:22) ffi\n(cid:22)0 0 0 0 0 0 .1 2 .1 0ffi\n(cid:22) ffi\n(cid:21)0 0 0 0 0 0 0 .1 2 .1(cid:29)\n0 0 0 0 0 0 0 0 .1 2\nUse CVX under MatLab or CVXOPT under Python, introduced in Section A.2, to numerically\nsolve problems (1.2.1) and (1.2.2).\nMaximizing return subject to risk constraint\nItisobviousthatthehighestreturncomesfromtheassetwiththehighestreturn. However,\nitmaybetooriskytoinvestallone\u2019sresourcesinoneriskyasset. Therefore,thereisusually\na risk constraint:\n\u201a\nmaxR subject to \u03b8 \u011b 0 \u03b8 (cid:16) 1 and \u03c32 \u010f \u03c3 . (1.2.3)\n\u03b8 i \u03b8 0\ni\nThe constant \u03c3 is the maximum risk of the portfolio.\n0\n32 11..3.PRNEOLI-MDIONMARIINEASNCE PRINCIPLE AND MODEL-INDEPENDENT ARBITRAGE\nExercise 1.2.3. Assume that all assets are uncorrelated. Use the Cauchy-Schwartz in-\nequality to show that an optimal solution for problem (1.2.3) is obtained when \u03b8 (cid:16) Ri\ni a\u03c32\nwhere a (cid:16) \u0159 Ri. i\ni \u03c32\ni\nNow consider the general case where the assets are correlated with a positive-definite\nvariance-covariance matrix. Use the Cholesky decomposition for the positive-definite ma-\ntrices to find an optimal solution to the problem. Is the optimal solution unique?\n1.3 No-dominance principle and model-independent arbitrage\nIn this section, we focus on the market properties that hold true objectively regardless\nof the choice of the model. Therefore, here we do not make any assumption about the\ndynamics of the assets, the yield of zero bonds, and the like. Instead, we only impose two\nbasic assumptions and ignore any friction in the market such as transaction cost, liquidity\nrestriction, and nontradability of assets. Some of the contents of this section can be found\nin [30, Section 1.2].\nWe consider a sample space \u2126 that includes the collection of all possible events in the\nmarket at future time T, and let \u03c7 be given set of portfolios (a collection of assets and\nstrategies on how to trade them dynamically) in the market. For any portfolio in \u03c7, the\npayoff of the portfolio is what it is worth at time T, and is a random variable from \u2126 to R.\nWe assume that there exists a pricing function \u03a0 : \u03c7 (cid:209) R; i.e., the price of portfolio P is\ngiven by \u03a0pPq. We denote the payoff of portfolio P at the event \u03c9 P \u2126 by Pp\u03c9q.\nThe first assumption that we impose is the following:\nAssumption 1.3.1 (No-dominance). If P P \u03c7 has a nonnegative payoff, i.e., Pp\u03c9q \u011b 0\nfor all \u03c9 P \u2126, then the price \u03a0pPq of portfolio P is nonnegative.\nRemark1.3.1. No-dominanceprincipleimpliesthattwoportfoliosP andP withP p\u03c9q (cid:16)\n1 2 1\nP p\u03c9q for all \u03c9 P \u2126 have the same price.\n2\nThe second assumption is the linearity of the pricing function. For any two portfolios\nP and P , define P \u2018 P is the portfolio made by combining the two. We impose the\n1 2 1 2\nfollowing natural assumption of linearity.\nAssumption 1.3.2. For P ,P P \u03c7, we have\n1 2\n\u03a0pP \u2018P q (cid:16) \u03a0pP q(cid:0)\u03a0pP q.\n1 2 1 2\nLet\u2019s first fix some terminology that we\u2019ll be using. By \u201cbeing in a long position\u201d in an\nasset, a bond, or the like, we mean that we hold the asset, bond, etc. Similarly, by \u201cbeing\nin a short position\u201d in an asset, a bond, or the like, we mean that we owe the asset, bond,\netc. For a bond or an option, the issuer is in the short position. Having a short position\nin an asset means borrowing that asset and then selling it for cash or keeping it for other\n33 1.3. MODEL-INDEPENDENT EVALUATION 1. PRELIMINARIES\nreasons. Thisisoftenreferredtoasshort selling,whichisacommonpracticeinthemarket.\nUsually, the borrower is obliged to pay the short-sold security back upon the request of the\nlender or in an agreed time.\nExample 1.3.1. The forward price K satisfies\nS\nt\nF pTq (cid:16) .\nt\nB pTq\nt\nTo see this, consider a portfolio made of a long position in the underlying asset and a\nshort position in a (cid:16) F pTq zero bonds at time t. The value of this portfolio at time T is\nt\nS (cid:1)F pTq. This value is the same as the payoff of a long position in forward contract.\nT t\nTherefore, by the no-dominance principle (Remark 1.3.1), we obtain that the value of the\nportfolioisthesameasthepriceoftheforwardcontract, whichiszero; S (cid:1)B pTqF pTq (cid:16) 0.\nt t t\nOn the other hand, the price of the forward is zero and therefore we have the result.\nRemark 1.3.2. Proposition 1.3.1 explains a market condition called contango in the fu-\ntures markets; the futures price is larger than the spot price. If holding an underlying\nasset incurs storage cost, then the result of Proposition 1.3.1 may be violated and we have\nF pTq \u0103 S . This market condition is called backwardation. Backwardation can also occur\nt t\nif the underlying of the futures contract is not even storable, for instance electricity.\nExample 1.3.2. Forward rate f pt,Tq for delivery at time t of a zero bond with maturity\n0\nT satisfies\nlnB ptq(cid:1)lnB pTq\n0 0\nf pt,Tq (cid:16) .\n0\nT (cid:1)t\nTo see this, consider a portfolio made of a zero bond with a principle of $1 at time T. The\npriceofthisportfolioisB pTq. Ontheotherhand, consideranotherportfoliomadeofafor-\n0\nward rate agreement on a bond with the principle of $1 starting at time t, maturing at time\nT, and with a forward rate f 0pt,Tq; and a bond with a principle of $e(cid:1)f0pt,TqpT(cid:1)tq maturing\nat time t. The price of such a portfolio is $B 0ptqe(cid:1)f0pt,TqpT(cid:1)tq. Since both portfolios have\nthe same payoff of $1, they must have the same price. Thus, B 0ptqe(cid:1)f0pt,TqpT(cid:1)tq (cid:16) B 0pTq.\nExercise 1.3.1. Consider a zero bond BdpTq in the domestic currency and another zero\n0\nbond Bf pTq in a foreign currency. At the current time t (cid:16) 0, the domestic-to-foreign\n0\nexchange rate is denoted by rd/f , and the forward domestic-to-foreign exchange rate8 for\n0\nd/f\ntime T is denoted by f pTq. Show that\n0\nBdpTqrd/f (cid:16) Bf pTqfd/f pTq.\n0 0 0 0\nProposition 1.3.1. The price of an American option is always greater than or equal to\nthe price of a European option with the same payoff.\n8The forward exchange rate is guaranteed at maturity.\n34 1. PRELIMINARIES 1.3. MODEL-INDEPENDENT EVALUATION\nProof. An American option can always be exercised, but not necessarily optimally, at\nmaturity, and generates the same payoff as a European option.\nProposition 1.3.2. The price of vanilla options satisfies\nCpT,K ,S,tq \u010f CpT,K ,S,tq and PpT,K ,S,tq \u011b PpT,K ,S,tq,\n1 2 1 2\nwhere K \u011b K .\n1 2\nProof. Consider a portfolio that consists of a long position in a call option with strike price\nK and a short position in a call option with strike K , both maturing at T. Then, the\n2 1\nterminal value of the portfolio is pS (cid:1)K q (cid:1)pS (cid:1)K q , which is nonnegative. By the\nT 2 (cid:0) T 1 (cid:0)\nno-dominance principle, we have CpT,K ,S,tq(cid:1)CpT,K ,S,tq \u011b 0. For a put options, a\n2 1\nsimilar argument works.\nExercise 1.3.2. Show that the price of an American call or put option is an increasing\nfunction of maturity T.\nExercise 1.3.3. Let \u03bb P p0,1q. Then,\nCpT,\u03bbK (cid:0)p1(cid:1)\u03bbqK ,S,tq \u010f \u03bbCpT,K ,S,tq(cid:0)p1(cid:1)\u03bbqCpT,K ,S,tq.\n1 2 1 2\nIn other words, the price of a call option is convex in K.\nShow the same claim for the price of a put option, an American call option, and an Amer-\nican put option.\nExercise 1.3.4. It is well known that a convex function has right and left derivatives at\nall points. From the above exercise it follows that the right and the left derivatives of a\ncall option price with respect to strike price, B CpT,K,S,tq, exists. Use no-dominance\nK(cid:8)\nto show that\n(cid:1)B pTq \u010f B CpT,K,S,tq \u010f 0\nt K(cid:8)\nHint: Consider a portfolio made of a long position in a call with strike K , a long position\n2\nin K (cid:1)K bonds, and a short position in a call option with strike K .\n2 1 1\nProposition 1.3.3 (Put-call parity). The price of a call option and the price of a put\noption with the same strike and maturity satisfy\nCpT,K,S,tq(cid:0)KB pTq (cid:16) S (cid:0)PpT,K,S,tq.\nt\nProof. Since pS (cid:1)Kq (cid:0)K (cid:16) S (cid:0)pK (cid:1)S q , according to no-dominance principle, a\nT (cid:0) T T (cid:0)\nportfolio consisting of a call option and K units of zero bond B pTq is worth as much as a\nt\nportfolio made of a put option and one unit of underlying asset.\n35 1.3. MODEL-INDEPENDENT EVALUATION 1. PRELIMINARIES\nExercise 1.3.5. A portfolio of long positions in call options with the same maturity and\nstrikes on different assets is worth more than a call option on a portfolio of the same assets\nwith the same weight; i.e.,\nn\n\u201a\n\u03bb CpT,K ,Spiq,tq \u011b CpT,K\u02c6,S\u02c6,tq, (1.3.1)\ni i\ni(cid:16)1\nwhere \u03bb \u011b 0 is the number of units invested in the call option on the ith underlying asset,\ni\nK \u011b 0 is the strike of the call option on the ith underlying asset , Spiq denotes the current\ni\nprice of the ith asset, K\u02c6 (cid:16) \u0159n \u03bb K , and S\u02c6 (cid:16) \u0159n \u03bb Spiq is the value of a portfolio that\ni(cid:16)1 i i i(cid:16)1 i\nhas \u03bb units of ith asset for i (cid:16) 1,...,n.\ni\nRemark 1.3.3. Exercise 1.3.5 demonstrates an important implication about the risk of\na portfolio. A portfolio made of different assets can be insured against the risk of price\nincreaseintwoways: bypurchasingacalloptionforeachunitofeachassetorbypurchasing\na call option on the whole portfolio. It follows from (1.3.1) that the latter choice is cheaper\nthan the former. An option on a portfolio is called a basket option.\nProposition 1.3.4 (Arbitrage bounds for the price of a call option). The price of a call\noption should satisfy\npS (cid:1)B pTqKq \u010f CpT,K,S,tq \u010f S.\nt (cid:0)\nProof. Since pS (cid:1)Kq \u010f S , no-dominance implies that CpT,K,S,tq \u010f S. To see the\nT (cid:0) T\nright-hand side inequality, first notice that since 0 \u010f pS (cid:1)Kq , 0 \u010f CpT,K,S,tq. On the\nT (cid:0)\nother hand, a portfolio of along position in the underlying asset and a short position in K\nunits of zero bond has a payoff S (cid:1)K which is less than or equal to the payoff of call\nT\noption pS (cid:1)Kq . Therefore, S(cid:1)KB pTq \u010f CpT,K,S,tq. As a result, pS(cid:1)B pTqKq (cid:16)\nT (cid:0) 0 t (cid:0)\nmaxt0,S (cid:1)B pTqKu \u010f CpT,K,S,tq.\nt\nThe notion of model-specific arbitrage will later be explored in Section 2.1. However, in\nthis section, we present model-independent arbitrage, which is in the same context as the\nno-dominance principle.\nDefinition 1.3.1. A portfolio P with a positive payoff and a zero price is called a model-\nindependent arbitrage. In other words, a portfolio P is called model-independent arbitrage\nif Pp\u03c9q \u0105 0 for all \u03c9 P \u2126, and \u03a0pPq (cid:16) 0.\nBy Definition 1.3.1, a portfolio with \u03c7p\u03c91q (cid:16) 0 for some \u03c91 P \u2126 and Pp\u03c9q \u0105 0 \u03c9 (cid:24) \u03c91 is\nnot a model-independent arbitrage. This leads to a weaker notion of arbitrage.\nDefinition 1.3.2. A portfolio P with a nonnegative payoff such that for some \u03c9 P \u2126\nPp\u03c9q \u0105 0 and zero price is called a weak arbitrage. In other words, a portfolio P is called\na weak arbitrage if Pp\u03c9q \u011b 0 for all \u03c9 P \u2126, Pp\u03c91q \u0105 0 for some \u03c91 P \u2126 and \u03a0pPq (cid:16) 0.\n36 1. PRELIMINARIES 1.3. MODEL-INDEPENDENT EVALUATION\nExample1.3.3. LetK \u0105 K andCpT,K ,S,tq \u0105 CpT,K ,S,tq. Aportfoliothatconsists\n1 2 1 2\nof a short position in a call with strike K , a long position in a call with strike K , and the\n1 2\ndifference ofCpT,K ,S,tq(cid:1)CpT,K ,S,tq in cash is a model-independent arbitrage. This\n1 2\nis because, the value of such a portfolio is zero. However, the payoff is pS (cid:1)K q(cid:1)pS (cid:1)\nT 2 T\nK q (cid:0)CpT,K ,S,tq(cid:1)CpT,K ,S,tq, which is strictly positive, and therefore we have a\n1 (cid:0) 1 2\nmodel-independent arbitrage.\nOn the other hand, if CpT,K ,S,tq (cid:16) CpT,K ,S,tq, the same portfolio described in the\n1 2\nprevious paragraph has a positive value whenever S \u0105 K , and a zero value otherwise.\nT 2\nTherefore, it is only a weak arbitrage.\nExample 1.3.4. As a result of Exercise 1.3.4, if the price of the option is smaller that\npS(cid:1)B pTqKq , orlargerthantheassetpriceS, thenthereisamodel-independentarbitrage.\nt (cid:0)\nFor example, if CpT,K,S,tq \u0105 S, one can have a portfolio of a short position in a call\nand a long position in the underlying asset, and the difference CpT,K,S,tq(cid:1)S in cash.\nThe value of this portfolio is zero. However, the payoff is strictly positive, i.e., S (cid:1)pS (cid:1)\nT T\nKq (cid:0)CpT,K,S,tq(cid:1)S \u0105 0.\n(cid:0)\nRemark 1.3.4. When CpT,K,S,tq (cid:16) S and K \u0105 0, Example 1.3.4 suggests that we\nstill have a model-independent arbitrage, unless the event S (cid:16) 0 is legitimate. Therefore,\nT\nchoice between the model-independent arbitrage or weak arbitrage depends on whether the\nevent S (cid:16) 0 is included in \u2126 or not.\nT\nProposition 1.3.5. If there is no model-independent arbitrage, then the no-dominance\nprinciple holds.\nProof. Assume that no-dominance does not hold; i.e., there is a portfolio P with nonneg-\native payoff with a negative price \u03a0pPq. Then, consider a new portfolio made of a long\nposition in the old portfolio P and holding a zero bond with face value (cid:1)\u03a0pPq. The new\nportfolio has a positive payoff of Pp\u03c9q(cid:1)\u03a0pPq for each \u03c9 P \u2126 and a zero price. Therefore,\nit is a model-independent arbitrage.\nExercise 1.3.6. For 0 \u0103 t \u0103 T, show that if B ptqB pTq \u0105 B pTq (equiv. B ptqB pTq \u0103\n0 t 0 0 t\nB pTq), there is a model-independent arbitrage.\n0\nExercise 1.3.7. Consider a zero bond BdpTq on the domestic currency and another zero\n0\nbond Bf pTq on a foreign currency. At the current time t (cid:16) 0, the domestic-to-foreign\n0\nd/f\nexchange rate is denoted by r and the forward domestic-to-foreign exchange rate for time\n0\nd/f\nT is denoted by f pTq. Show that if\n0\nBdpTqrd/f \u0105 Bf pTqfd/f pTq,\n0 0 0 0\nthen there exists a model-independent arbitrage.\n37 1.3. MODEL-INDEPENDENT EVALUATION 1. PRELIMINARIES\n38 2. DISCRETE-TIME MARKETS\n2\nModeling financial assets in\ndiscrete-time markets\nSection 2.1 deals with a single-period market in which there are only two trading dates,\none at the beginning of the period and one at maturity. In this section, an introductory\nknowledge of probability theory is required; more specifically, the reader needs the theory\nof probability on discrete sample spaces that is provided in Section B.1. A few times in\nSection 2.2, we mention concepts form the general theory of probability. However, these\ncases are not crucial for understanding of the content of this sections and can simply be\nskipped. In Section 2.3, we extend the results of Section 2.1 to a multiperiod market with\nafocusonthebinomialmodel. Thisisalsoimportantinourlaterstudyofcontinuous-time\nmarkets, which can be seen as the limit of discrete-time markets. A key concept from the\nappendix is the notion of martingales that is explained in Section B.3. The last section,\nSection 2.4, deals with the problem of tuning the parameters of a model to match the data\nin the specific context of binomial model.\n2.1 Arrow-Debreu market model\nThe ideas and concepts behind pricing derivatives are easier to explain in a single-period\nframework with finite number of outcomes, i.e., Arrow-Debreu market model. According\nto the Arrow-Debreu market model, an asset has a given price and a set of possible values.\nThere are N assets with prices arranged in a column vector p (cid:16) pp ,...,p qT1. For each\n1 N\ni (cid:16) 1,...,N, the possible future values or payoff of asset i is given by tP : j (cid:16) 1,...,Mu.\ni,j\nP is the jth state of future value of asset i and M is a universal number for all assets.\ni,j\n1AT is the transpose of matrix A.\n39 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nThen, one can encode the payoffs of all assets into a N-by-M matrix\n(cid:20) (cid:28)\nP (cid:4)(cid:4)(cid:4) P\n1,1 1,M\nP :(cid:16) rP i,js i(cid:16)1,...,N,j(cid:16)1,...,M (cid:16) (cid:22) (cid:21) . . . ... . . . ffi (cid:29).\nP (cid:4)(cid:4)(cid:4) P\nN,1 N,M\nIn the Arrow-Debreu market model, row P of the matrix P represents all future prices\ni,(cid:4)\nof asset i for different states of the market, and column P represents prices of all assets\n(cid:4),j\nin future state j of the market.\nP\ni;1\nP\ni;2\np .\ni .\n.\nP\ni;M(cid:0)1\nP\ni;M\nFigure 2.1.1: Arrow-Debreu market model\nExample 2.1.1 (Game of chance). Let N (cid:16) 1, M (cid:16) 2 and P (cid:16) (cid:1)P (cid:16) 1. In other\n1,1 1,2\nwords, there is a fee p to enter a game of chance in which the player either gains or loses\n1\na dollar based on the outcome of flipping a coin. Notice that for now we do not specify\nthe heads-tails probability for the coin. This probability determines whether the price of the\ngame p is a fair price or not.\n1\nP = 1\n1;1\np\n1\nP = (cid:0)1\n1;2\nFigure 2.1.2: Game of chance described in the Arrow-Debreu market model\n40 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\n2.1.1 Arbitrage portfolio and the fundamental theorem of asset pricing\nA portfolio is a row vector \u03b8 (cid:16) p\u03b8 ,(cid:4)(cid:4)(cid:4) ,\u03b8 q where \u03b8 P R which represents the number of\n1 N i\nunits of asset i in the portfolio. The total price of the portfolio is then given by\nN\n\u201a\n\u03b8p (cid:16) \u03b8 p .\ni i\ni(cid:16)1\nHere, the notation of product is simply the matrix product. Notice that if \u03b8 \u0105 0, the\ni\nposition of the portfolio in asset i is called long, and otherwise if \u03b8 \u0103 0, it is called short.\ni\nArbitrage is a portfolio that costs no money but gives a nonnegative future value and for\nsome states positive values. More precisely, we have the following definition.\nDefinition 2.1.1. \u03b8 is called a weak arbitrage portfolio or weak arbitrage opportunity if\na) \u03b8p (cid:16) 0\nb) \u03b8P \u011b 0 for all j (cid:16) 1,...,M\n(cid:4),j\nc) \u03b8P \u0105 0 for at least one j.\n(cid:4),j\nNotice that for a given \u03b8 (cid:16) p\u03b8 ,(cid:4)(cid:4)(cid:4) ,\u03b8 q, the portfolio represented by \u03b8 is itself an asset\n1 N\nwith value \u03b8P at the state j of the market.\n(cid:4)j\nWe say that a market model is free of weak arbitrage or that it satisfies no weak arbitrage\ncondition (NWA for short), if there is no weak arbitrage opportunity in this model.\nSometimes, an arbitrage opportunity starts with a zero-valued portfolio and ends up with\npositive values at all states of the market. This defined an strong arbitrage:\nDefinition 2.1.2. \u03b8 is called a strong arbitrage portfolio or arbitrage opportunity if\na) \u03b8p \u0103 0\nb) \u03b8P \u011b 0 for all j (cid:16) 1,...,M\n(cid:4),j\nRemark 2.1.1. Notice that if we remove some of the states of the market, then weak\narbitrage can disappear. However, strong arbitrage does not.\nNotice that model-independent arbitrage as defined in Definition 1.3.1 is even stronger\nthan strong arbitrage.\nThe following theorem is the most important in financial mathematics that characterizes\nthenotionofarbitrageinasimpleway. Basically,itpresentsasimplecriteriontodetermine\nif a market model is free of weak or strong arbitrage.\nTheorem 2.1.1 (Fundamentaltheoremofassetpricing(FTAP)). The Arrow-Debreu mar-\nket model is free of weak (respectively strong) arbitrage opportunity if and only if there exist\na column vector of positive (respectively nonnegative) numbers \u03c0 (cid:16) p\u03c0 ,...,\u03c0 qT such that\n1 M\np (cid:16) P\u03c0. (2.1.1)\n41 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nNotice that Theorem 2.1.1 does not claim that the vector \u03c0 is unique, and therefore there\ncan be several solutions \u03c0 such that (2.1.1) holds.\nProof. The proof for the strong arbitrage case is the result of the so-called Farkas\u2019 lemma\nwhich asserts that\nGiven an n(cid:2)m matrix A and a vector b P Rm. Then, exactly one of\nthe following two statements is true:\n1) There exists a \u03c0 P Rn such that A\u03c0 (cid:16) b and \u03c0 \u011b 0.\n2) There exists a \u03b8 P Rm such that \u03b8A \u011b 0 and \u03b8b \u0103 0.\nWe apply Farkas\u2019 lemma for A (cid:16) P and b (cid:16) p. Strong arbitrage is equivalent to (2) in\nFarkas\u2019 lemma. Therefore, lack of strong arbitrage is equivalent to (1).\nTo show the result for weak arbitrage, we consider the following extension of Farkas\u2019s\nlemma.\nGiven an n(cid:2)m matrix A and a vector b P Rm. Then, exactly one of\nthe following two statements is true:\n1\u2019) There exists a \u03c0 P Rn such that A\u03c0 (cid:16) b and \u03c0 \u0105 0.\n2\u2019) There exists a \u03b8 P Rm such that \u03b8A \u011b 0, \u03b8A (cid:24) 0 and \u03b8b \u010f 0.\nFor A (cid:16) P and b (cid:16) p, weak arbitrage is equivalent to (2\u2019). Therefore, lack of weak\narbitrage is equivalent to (1\u2019).\nRemark 2.1.2. The Farkas\u2019 lemma and its extension that are used in the proof of Theorem\n2.1.1arecorollariesoftheseparatinghyperplanetheorem. Formoredetailsaboutseparating\nhyperplane theorem and Farkas\u2019 lemma see [8, Section 5.8.3, Section 2.5.1 and Exercise\n2.20].\nLack of strong arbitrage does not imply that the vector \u03c0 in Theorem 2.1.1 has some\npositive entities. For instance, when p (cid:16) 0, i.e., all the assets in the market have zero\nprice, there is no strong arbitrage. In such a case, a trivila solution to equation (2.1.1) is\n\u03c0 (cid:16) 0. If p (cid:24) 0, then no-arbitrage condition implies that \u03c0 has at least a positive entity.\nTherefore, one can normalize it by\n1\n\u03c0\u02c6 (cid:16) \u03c0.\n\u0159M\n\u03c0\nj(cid:16)1 j\n\u03c0\u02c6 is a probability. The probability vector \u03c0\u02c6 (cid:16) p\u03c0\u02c6 ,...,\u03c0\u02c6 qT is referred to as a risk-neutral\n1 M\nor risk-adjusted probability.\n42 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nExample 2.1.2. Consider a game in which you pay a fee of $.20 to enter. Then, a coin flip\ndetermines whether you win or lose a dollar. We also include a zero bond with a face value\nof $1 and a price $.80. See Figure 2.1.3. It follows from the FTAP that the no-arbitrage\ncondition is equivalent to the existence of a positive vector p\u03c0 ,\u03c0 qT satisfying\n1 2\n#\n\u03c0 (cid:1)\u03c0 (cid:16) .2,\n1 2\n\u03c0 (cid:0)\u03c0 (cid:16) .8.\n1 2\nIn fact, such a vector (uniquely) exists and is given by p5{8,3{8q. If we exclude the zero\nP = 1 P = 1\n1;1 2;1\np = :2 p = :8\n1 2\nP = (cid:0)1 P = 1\n1;2 2;2\nFigure2.1.3: AnArrow-Debreumarketmodelwithtwoassetsandtwostatesrepresenting\na coin game and a zero bond\nbond from the market, the FTAP criterion for no-arbitrage is reduced to the existence of a\npositive solution to \u03c0 (cid:1)\u03c0 (cid:16) .2. There are obviously infinitely many positive solutions.\n1 2\nExample 2.1.3. Consider a game of chance using two coins; to enter the game, you pay\na $1 fee. If both coins turn heads (tails), you win (lose) a dollar. Otherwise, the gain is\nzero. There is also a zero bond with a face value of $1 and a price of $.80. It follows from\nFTAP that there is an arbitrage opportunity. Notice that the system of equation\n#\n\u03c0 (cid:1)\u03c0 (cid:16) 1\n1 4\n\u03c0 (cid:0)\u03c0 (cid:0)\u03c0 (cid:0)\u03c0 (cid:16) .8\n1 2 3 4\nimplies \u03c0 (cid:16) (cid:1)\u03c0 (cid:1).2(cid:1)2\u03c0 , whichexcludesthepossibilityofapositivesolution. Therefore,\n3 2 4\nthere is an arbitrage in this game.\nFTAP predicts the existence of arbitrage but does not provide any. Knowing an arbitrage\nopportunity exists, finding one is sometimes a challenging problem, even in the toy Arrow-\nDebreu market model.\nExercise 2.1.1. Find an arbitrage opportunity in Example 2.1.3.\nRemark 2.1.3. The weak and strong arbitrage are model specific. If we change the model,\nthe arbitrage opportunity can disappear. However, model-independent arbitrage remains a\nstrong arbitrage opportunity in any possible model.\n43 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nP =1 P =1\n1;1 2;1\nP =0 P =1\n1;2 2;2\np =1 p =:8\n1 2\nP =0 P =1\n1;3 2;3\nP =(cid:0)1 P =1\n1;4 2;4\nFigure 2.1.4: An Arrow-Debreu market model with two assets and four states represent-\ning a coin game and a zero bond\n2.1.2 Arrow-Debreu market model with a risk-free bond\nIf we intend to add a new asset with price p1 and values P1,...,P1 to the current Arrow-\n1 M\nDebreu market model, the new asset does not create an arbitrage opportunity if and only\nif at least one of the existing positive solutions \u03c0 of (2.1.1) satisfies\nM\n\u201a\np1 (cid:16) P1\u03c0 .\nj j\nj(cid:16)1\nMore specifically, assume that the new asset is a zero bond with yield (interest rate) R\nand face value 1. Therefore, its price is given by p (cid:16) 1 . See Figure 2.1.5. For no-\n0 1(cid:0)R\nP0;1 = 1\nP0;2 = 1\np = 1 .\n0 1+R .\n.\nP0;M(cid:0)1 = 1\nP0;M = 1\nFigure 2.1.5: Risk-free asset in Arrow-Debreu market model\narbitrage condition to hold for the market with the new bond, at least one of the positive\nsolutions of (2.1.1) implies that p (cid:16) 1 (cid:16) \u0159M \u03c0 . Therefore, no-arbitrage condition for\n0 1(cid:0)R j(cid:16)1 j\nan Arrow-Debreu market model with a zero bond is equivalent to existence of a positive\n44 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nvector \u03c0 such that (2.1.1) holds and\nM\n\u201a 1\n\u03c0 (cid:16) ,\nj\n1(cid:0)R\nj(cid:16)1\nholds for all such \u03c0. Therefore, any positive vector \u03c0 can be normalized to a risk-neutral\nprobability through\n\u03c0\n\u03c0\u02c6 (cid:16) (cid:16) p1(cid:0)Rq\u03c0.\n\u0159M\n\u03c0\nj(cid:16)1 j\nThen, the price p of each asset is given by\ni\nM N\n\u201a 1 \u201a\np (cid:16) P \u03c0 (cid:16) P \u03c0\u02c6 . (2.1.2)\ni i,j j i,j j\n1(cid:0)R\nj(cid:16)1 j(cid:16)1\nTheright-handsideabovehasanimportantinterpretation: providedthattheno-arbitrage\nconditionholds,thepriceoftheassetisequaltothediscountedexpectedpayoffwithrespect\nto risk-neutral probability, i.e.,\n1\np (cid:16) E\u02c6 rP s.\ni i(cid:4)\n1(cid:0)R\nHere, E\u02c6 rP s :(cid:16) \u0159M \u03c0\u02c6 P is the expected payoffof asset i with respect to the risk-neutral\ni(cid:4) j(cid:16)1 j i,j\nprobability \u03c0\u02c6. Factor 1 is the discount factor.\n1(cid:0)R\nBy rearranging (2.1.2), one obtains\nM\n\u201a P i,j (cid:1)p i\nR (cid:16) \u03c0\u02c6 .\nj\np\ni\nj(cid:16)1\nPi,j\nThe term (cid:1)1 in RHS is the realized return of asset i if the state j of the market occurs.\npi\nTherefore, the interpretation of the above equality is that the expected return of each asset\nunder the risk-neutral probability \u03c0\u02c6 is equal to the risk-free interest rate R.\nExample 2.1.4. Consider an Arrow-Debreu market model with a risky asset shown below\nand a risk-free asset with interest rate R (cid:16) .5. To see if there is no arbitrage in this model,\n1\n:3\n:5\n45 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nwe should investigate the solutions to the system\n#\n1 (cid:16) \u03c0\u02c6 (cid:0)\u03c0\u02c6\n1 2\n.3 (cid:16) 1 p\u03c0\u02c6 (cid:0).5\u03c0\u02c6 q\n1.5 1 2\nThe first equation accounts for that \u03c0\u02c6 is a probability vector, and the second equation comes\nfrom (2.1.2). However, the only solution is \u03c0\u02c6 (cid:16) p(cid:1).1,1.1qT, which is not a probability.\nExample 2.1.5. Consider an Arrow-Debreu market model with a risky asset shown below\nand a risk-free asset with interest rate R (cid:16) .5. To see if there is no arbitrage in this model,\n2\n1 1\n:5\nwe should investigate the solutions to the system\n1 (cid:16) \u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6\n1 2 3\n1\n1 (cid:16) p2\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0).5\u03c0\u02c6 q\n1 2 3\n1.5\nOne of the infinitely many solutions to the above system is \u03c0\u02c6 (cid:16) p.6,.2,.2qT, which implies\nno-arbitrage condition.\nIf a second risky asset, shown below, is added to the market, we still do not have arbitrage\nbecause vector \u03c0\u02c6 (cid:16) p.6,.2,.2qT works for the new market.\n1\n:4 0\n0\nExercise 2.1.2. Consider an Arrow-Debreu market model with two risky assets shown\nbelow and a risk-free asset with interest rate R (cid:16) .5. Find all the values for p such that the\nmarket is arbitrage free.\nRemark 2.1.4. A zero bond is a risk-free asset in the currency of reference. For example,\na zero bond that pays $1 is risk-free under the dollar. However, it is not risk-free if the\ncurrency of reference is the euro. In the latter case, a euro zero bond is subject to the risk\ncaused by the foreign exchange rate and is a risky asset. See Exercise (2.1.3) below.\n46 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\n2 1\n1 1 p 0\n:5 0\nExercise 2.1.3. Consider an Arrow-Debreu market model with two assets and two states;\none is a zero bond in the domestic currency with interest rate R under the domestic\nd\ncurrency, and the other is a zero bond in a foreign currency with interest rate R under\nf\nforeign currency.\na) Given that the domestic-to-foreign exchange rate at time 0 is F 2, and at time 1 takes\n0\nnonnegative values F and F , what is the Arrow-Debreu market model description\n1 2\nof a foreign zero bond in the domestic currency?\nb) A currency swap is a contract that guarantees a fixed domestic-to-foreign exchange\nrate, or a forward exchange rate for maturity. The forward exchange rate is\nagreed upon between two parties such that the value of the contract is zero. Express\nthe forward exchange rate of a currency swap maturing at 1 in terms of F , R , F ,\n0 d 1\nR , and F .\nf 2\nRemark 2.1.5. The risk-neutral probability \u03c0\u02c6 has little to do with the actual probability\n(or physical probability) with which each state of the market happens. The probabilities\nf :(cid:16) Pp state j occursq can be obtained through statistical analysis on historical market\nj\ndata. However, the risk-neutral probability \u03c0\u02c6 depends only on the matrix P and vector p\nand not on historical market data. The one and only genuine relevance between physical\nprobability f (cid:16) pf ,...,f qT and risk-neutral probability \u03c0\u02c6 (cid:16) p\u03c0\u02c6 ,...,\u03c0\u02c6 qT is that they both\n1 m 1 M\nassign nonzero probability to each of the states of the market; i.e., f \u0105 0 if and only if\nj\n\u03c0\u02c6 \u0105 0 for at least one risk-neutral probabilities \u03c0\u02c6.\nj\nOne can interpret \u03c0\u02c6 as an investor\u2019s preference toward the different states of the market.\nTo see this, let\u2019s rewrite (2.1.2) as the following\n1 \u201aM (cid:1)\u03c0\u02c6 j(cid:9) 1 E(cid:17)(cid:1)\u03c0\u02c6 (cid:4)(cid:9) (cid:25)\np (cid:16) f P (cid:16) P . (2.1.3)\ni j i,j i,(cid:4)\n1(cid:0)R f 1(cid:0)R f\nj(cid:16)1 j (cid:4)\nHere, E is the expectation with respect to the physical probability. The quotient \u03c0\u02c6j is the\nfj\nrisk preference of the investor toward the state j of the market, which is also referred to\nas the state-price deflator. The state-price deflator shows that, apart from the physical\nprobability of a certain state, an investor may be keen or averse toward the appearance of\n\u03c0\u02c6j\nthat state. For instance, f can be a very high probability, but state-price deflator can be\nj fj\n21 unit of domestic is worth F units of foreign.\n0\n47 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nsmall, which means that the probable event of appearance of state j has little value to the\ninvestor.\nOne can analyze the Arrow-Debreu market model by introducing M new elementary\nsecurities to the market; for i (cid:16) N (cid:0)1,...,N (cid:0)M, asset N (cid:0)j pays $1 if market state j\nhappens and pays $0 otherwise. See Figure 2.1.6. Then, it is straightforward to see that \u03c0\u02c6\nj\nis the arbitrage free price of asset N (cid:0)j. Therefore, the cashflow from asset i is equivalent\nto the cashflow of a basket of P units of asset N (cid:0)1, P units of asset N (cid:0)2, ..., and\ni,1 i,2\nP asset s . Recall from (2.1.2) that\ni,M N(cid:0)M\nM\n1 \u201a\np (cid:16) P \u03c0\u02c6 .\ni i,j j\n1(cid:0)R\nj(cid:16)1\nP =0\nN+j;1\n.\n.\n.\n(cid:25)^ P =1\nj N+j;j\n.\n.\n.\nP =0\nN+j;M\nFigure 2.1.6: Elementary asset s\nN(cid:0)j\nExample 2.1.6. Consider an Arrow-Debreu market model with a risky asset shown below\nand a zero bond with interest rate R (cid:16) .5.\n2\n1\n1\n:5\n(cid:0):5\na) A risk-neutral probability \u03c0\u02c6 (cid:16) p\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 qT must satisfy\n1 2 3 4\n#\n\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1\n1 2 3 4\n.\n2\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0) 1\u03c0\u02c6 (cid:1) 1\u03c0\u02c6 (cid:16) 3\n1 2 2 3 2 4 2\nNotice that we have two equations and four unknown; there are two more vari-\nables than equations. Therefore, we shall represent all risk-neutral probabilities as\na parametrized surface with two parameters. For example, we take \u03c0\u02c6 (cid:16) s and \u03c0\u02c6 (cid:16) t.\n1 2\n48 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nt\n1\n.8\n2\n3\n.5\ns\n.1 .5 1\nFigure 2.1.7: The hatched region represents the values for t and s which gener-\nate all risk-neutral probabilities in Example 2.1.6. The specific risk-neutral probability\np0.7,0.1,0.1,0.1qT is shown as a black dot. Each orange line corresponds to a arbitrage-\nfree price for the new asset that is described in Part (b) of the example.\nThen, we write \u03c0\u02c6 and \u03c0\u02c6 is terms of t and s as follows:\n3 4\n#\n\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1(cid:1)t(cid:1)s\n3 4\n\u03c0\u02c6 (cid:1)\u03c0\u02c6 (cid:16) 3(cid:1)4t(cid:1)2s.\n3 4\nYou also have to specify the suitable range for the parameters t and s such that vector\n\u03c0\u02c6 is nonnegative. More specifically, we must have the following four inequalities\n$\n\u20190 \u010f t\n\u2019\n\u2019\n\u2019\n&0 \u010f s\n,\n\u20190 \u010f 2(cid:1) 5t(cid:1) 3s\n\u2019 \u2019 2 2\n\u2019 %0 \u010f (cid:1)1(cid:0) 3t(cid:0) 1s\n2 2\nwhich specify the region plotted in Figure 2.1.7. The region can also be specified in\nthe following simpler way:\n#\n0 \u010f s \u010f 1\n2 . (2.1.4)\n2 (cid:1) 1s \u010f t \u010f 4 (cid:1) 3s\n3 3 5 5\nb) We introduce the new asset below.\n49 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\n1\n1\np\n(cid:0)1\n(cid:0)1\nWe shall find the range for the price p of the new asset such that the market remains\nfree of arbitrage; strong or weak. By FTAP, Theorem 2.1.1, p must satisfy\n1 (cid:1) 5 3 3 1 (cid:9) 2(cid:1) (cid:9)\np (cid:16) t(cid:0)s(cid:1)2(cid:0) t(cid:0) s(cid:0)1(cid:1) t(cid:1) s (cid:16) 2t(cid:0)2s(cid:1)1 ,\n1.5 2 2 2 2 3\nforatleastonevalueofpt,sqintheinterioroftheregionfoundinPart(a). Therefore,\nvalid range for p is pA,Bq, where\n2(cid:1) (cid:9)\nA :(cid:16) min 2t(cid:0)2s(cid:1)1 subject to constraints (2.1.4)\n3\nand\n2(cid:1) (cid:9)\nB :(cid:16) max 2t(cid:0)2s(cid:1)1 subject to constraints (2.1.4).\n3\nBoth of the above values are the values of linear programming problems which can\nbe solved by comparing the values of p2{3qp2t (cid:0) 2s (cid:1) 1q at the three nodes of the\nhatched triangle that represents all risk-neutral probabilities, i.e., p.5,.5q, p0,.7q, and\np0,2{3q. The smallest value is 2{9 which is attained at p0,2{3q, and the greatest value\nis 2{3 which is attained at p.5,.5q. Therefore, (weak) no-arbitrage for the new asset\nis equivalent to p P p2{9,2{3q.\nc) Lack of strong arbitrage is when the asset price is such that all the risk-neutral prob-\nabilities have some zero component. In this case, price p should be such that the\nrisk-neutral probabilities are only on one of the edges of the hatched triangle and does\n(cid:1) (cid:9)\nnot include any interior point. In Figure 2.1.7, the orange lines are p (cid:16) 2 2t(cid:0)2s(cid:1)1\n3\nfor different values of p. The only values of p which does not have an intersection\nwith the interior of the triangle are p (cid:16) 2{9 and p (cid:16) 2{3. Therefore, the lack of\nstrong arbitrage implies that p P r2{9,2{3s.\nExercise 2.1.4. Consider an Arrow-Debreu market model with N (cid:16) 3 and M (cid:16) 4 shown\nin Figure 2.1.8 and take the bond yield R (cid:16) 0, where v and v are two (distinct) real\n1 2\nnumbers.\na) Find all risk-neutral probabilities.\nb) Recall the notion of independent random variables. Find a risk-neutral probability\nthat makes the random variables of the prices of two assets independent.\n50 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nP =v P =v\n1;1 1 2;1 1\nP =v P =v\n1;2 2 2;2 1\np = v1+v2 p = v1+v2\n1 2 2 2\nP =v P =v\n1;3 1 2;3 2\nP =v P =v\n1;4 2 2;4 2\nFigure 2.1.8: Exercise 2.1.4\n2.1.3 One-period binomial model\nLet M (cid:16) 2 and N (cid:16) 2 with one risk-free zero bond and a risky asset with price S :(cid:16) p ,\n0 1\nand future cash flow given byP (cid:16) S u and P (cid:16) S \u2113 where S and \u2113 \u0103 u are all positive\n1,1 0 1,2 0 0\nreal numbers. By Theorem 2.1.1, in a one-period binomial model, no-arbitrage condition\nS u\n0\nS\n0\nS \u2113\n0\nFigure 2.1.9: One-period binomial model\nis equivalent to \u2113 \u0103 1(cid:0)R \u0103 u and \u03c0 (cid:16) p\u03c0 ,\u03c0 qT with \u03c0 (cid:16) 1(cid:0)R(cid:1)\u2113 and \u03c0 (cid:16) u(cid:1)1(cid:1)R .\n\u2113 u u pu(cid:1)\u2113qp1(cid:0)Rq \u2113 pu(cid:1)\u2113qp1(cid:0)Rq\nThe risk-neutral probability is then given by \u03c0\u02c6 (cid:16) 1(cid:0)R(cid:1)\u2113 and \u03c0\u02c6 (cid:16) u(cid:1)1(cid:1)R.\nu u(cid:1)\u2113 \u2113 u(cid:1)\u2113\nExercise 2.1.5. Show the above claims.\nFrom FTAP, we know that \u2113 \u0103 1(cid:0)R \u0103 u is equivalent to the no-arbitrage condition. But,\nit is often insightful to construct an arbitrage portfolio when \u2113 \u0103 1(cid:0)R \u0103 u is violated.\nFor example, consider the case when u \u010f 1(cid:0)R. Then, consider a portfolio with a short\nposition in one unit of the asset and a long position in S units of bonds. To construct\n0\nthis portfolio, no cash is needed, and it is worth zero. However, the two possible future\noutcomes are either S p1 (cid:0) Rq (cid:1) S u \u011b 0 or S p1 (cid:0) Rq (cid:1) S \u2113 \u0105 0, which matches with\n0 0 0 0\nthe definition of (weak) arbitrage in Definition 2.1.1. If we assume the strict inequality\nu \u0103 1(cid:0)R, then the arbitrage is strong.\n51 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nNext, we consider the addition of a new asset into the market with payoff P and P in\n1 2\nstates 1 and 2, respectively. Then, no-arbitrage condition implies that the price p of this\nasset is must be given by\n1\np (cid:16) p\u03c0\u02c6 P (cid:0)\u03c0\u02c6 P q.\nu 1 \u2113 2\n1(cid:0)R\nIn particular, if the new asset is an option with payoff function gpS q, the no arbitrage\n1\nprice VpS q of the option is given by\n0\n1 (cid:1) (cid:9) 1\nVpS q :(cid:16) \u03c0\u02c6 gpS uq(cid:0)\u03c0\u02c6 gpS \u2113q (cid:16) E\u02c6 rgpS qs. (2.1.5)\n0 u 0 \u2113 0 1\n1(cid:0)R 1(cid:0)R\nHere, E\u02c6 is the expectation under probability \u03c0\u02c6, and S is a random variable of the price\n1\nof asset at time t (cid:16) 1 that takes the values S \u2113 and S u. For instance, a call option with\n0 0\npayoff pS (cid:1)Kq with \u2113S \u010f K \u0103 uS , shown in figure 2.1.10, has a \u201cno-arbitrage price\u201d:\n(cid:0) 0 0\n1(cid:0)R(cid:1)\u2113\nCpKq (cid:16) puS (cid:1)Kq.\n0\npu(cid:1)\u2113qp1(cid:0)Rq\nS u(cid:0)K\n0\nC(K)\n0\nFigure 2.1.10: Cashflow of a call option in a one-period binomial model\nWe shall now see why any price other than puS0(cid:1)Kq\u03c0\u02c6 for the call option causes arbitrage\np1(cid:0)Rq u\nin the binomial market with a zero bond, a risky asset and a call option on the risky asset.\nFor this reason, we need to first introduce the notion of a replicating portfolio. Consider a\nportfolio with \u03b8 investment in a zero bond and \u03b8 units of risky asset. Then, this portfolio\n0 1\ngenerates the cashflow shown in Figure 2.1.11. We want to choose p\u03b8 ,\u03b8 q such that the\n0 1\npayoff of this portfolio matches the payoff of the call option, i.e.\n#\n\u03b8 (cid:0)\u03b8 S u (cid:16) S u(cid:1)K\n0 1 0 0\n(2.1.6)\n\u03b8 (cid:0)\u03b8 S \u2113 (cid:16) 0\n0 1 0\n52 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nTherefore, we have to choose\nlpS u(cid:1)Kq S u(cid:1)K\n0 0\n\u03b8 (cid:16) (cid:1) and \u03b8 (cid:16) .\n0 1\nu(cid:1)\u2113 S pu(cid:1)\u2113q\n0\n(cid:18) +(cid:18) S u=S u(cid:0)K\n0 1 0 0\n(cid:18)0 +(cid:18) S\n1+R 1 0\n(cid:18) +(cid:18) S \u2113=0\n0 1 0\nFigure 2.1.11: Replicating portfolio in a one-period binomial model\nThen, one can see that the value of the replicating portfolio is equal to the price of the\ncall option, i.e.,\n\u03b8 lpS u(cid:1)Kq S u(cid:1)K 1\n0 0 0\n(cid:0)\u03b8 S (cid:16) (cid:1) (cid:0) (cid:16) pS (cid:1)Kq\u03c0\u02c6 .\n1 0 0 u\n1(cid:0)R p1(cid:0)Rqpu(cid:1)\u2113q u(cid:1)\u2113 1(cid:0)R\nNow, we return to building an arbitrage in the case where the price of call option C is\ndifferentfrom puS0(cid:1)Kq\u03c0\u02c6 . WeonlycoverthecaseC \u0103 puS0(cid:1)Kq\u03c0\u02c6 . Consideraportfoliothat\np1(cid:0)Rq u p1(cid:0)Rq u\nconsists of a long position in a call option and a short position in a replicating portfolio\non the same call option. Shorting a replicating portfolio is equivalent to a (cid:1)\u03b8 position\n0\nin cash, and a (cid:1)\u03b8 position in the underlying asset. Then, the value of such a portfolio\n1\nis equal to C (cid:1) puS0(cid:1)Kq\u03c0\u02c6 \u0103 0. This means that there is some extra cash in the pocket,\np1(cid:0)Rq u\nwhile the payoff of the call option can be used to clear off the shorted replicating portfolio\nin full. Here, the arbitrage is in the strong sense of Definition 2.1.2.\nAreplicatingportfoliocanbebuiltforanypayoffgpS qbysolvingthesystemofequations\n1\n#\n\u03b8 (cid:0)\u03b8 S u (cid:16) gpS uq\n0 1 0 0\n(2.1.7)\n\u03b8 (cid:0)\u03b8 S \u2113 (cid:16) gpS \u2113q\n0 1 0 0\nto obtain\nugpS \u2113q(cid:1)\u2113gpS uq gpS uq(cid:1)gpS \u2113q\n0 0 0 0\n\u03b8 (cid:16) and \u03b8 (cid:16) .\n0 1\nu(cid:1)\u2113 S pu(cid:1)\u2113q\n0\nThe value of the replicating portfolio is given by\n\u03b8 ugpS \u2113q(cid:1)\u2113gpS uq gpS uq(cid:1)gpS \u2113q 1\n0 0 0 0 0\n(cid:0)\u03b8 S (cid:16) (cid:0) (cid:16) p\u03c0\u02c6 gpS uq(cid:0)\u03c0\u02c6 gpS \u2113qq,\n1 0 u 0 \u2113 0\n1(cid:0)R p1(cid:0)Rqpu(cid:1)\u2113q u(cid:1)\u2113 1(cid:0)R\n53 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nwhich is equal to the expected value of the discounted payoff under risk-neutral probability.\nExercise 2.1.6. Consider a one-period binomial model with parameters \u2113, u and R and\nlet K P pS \u2113,S us. Find a replicating portfolio for a put option with strike K. Verify that\n0 0\nthe value of the replicating portfolio is equal to the no-arbitrage price of the put option\nPpKq (cid:16) \u03c0 pK (cid:1)S \u2113q. Then, find an arbitrage portfolio when the price of the put option\n\u2113 0\nwith strike K is less than PpKq.\nExercise 2.1.7. Consider an Arrow-Debreu market model with M (cid:16) 2 that consists of a\nrisk-free bond with interest rate R (cid:16) .01 and a forward contract3 on a nonstorable asset4\nwith forward price K and maturity of one period. Given that the payoff of the forward\ncontract for the long position takes values P (cid:16) 4, and P (cid:16) (cid:1)2 respective to the state\n1,1 1,2\nof the market at maturity, is there any arbitrage?\nNow assume that the underlying asset is storable and has price p (cid:16) 10. Given that there is\nno arbitrage, find K, and binomial model parameters u and d for the underlying asset.\nExample 2.1.7. Consider the binomial model with S (cid:16) 4, R (cid:16) .05, u (cid:16) 1.45, and \u2113 (cid:16) .85.\n0\nWe shall price and replicate the payoff g in Figure 2.1.12 . To find the replicating portfolio,\nwe solve the system of equations (2.1.7)\n#\n\u03b8 (cid:0)5.8\u03b8 (cid:16) gp5.8q (cid:16) .8\n0 1\n\u03b8 (cid:0)3.4\u03b8 (cid:16) gp3.4q (cid:16) .6\n0 1\nto obtain \u03b8 (cid:16) 1.9 and \u03b8 (cid:16) 1 . The price can be found in two ways: either by using the\n0 6 1 12\ng(S )\nT\n2\nS\n2 4 5 7 T\nFigure 2.1.12: Payoff of Example 2.1.7\nreplicating portfolio or by the risk-neutral probability. The former gives the price by the\n3In the context of this exercise, the forward can be replaced by a futures contract.\n4E.g. electricity.\n54 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nvalue of the replicating portfolio:\n\u03b8 1.9 1 2\n0\n(cid:0)\u03b8 S (cid:16) (cid:0)p4q (cid:16) .\n1 0\n1(cid:0)R 6p1.05q 12 3.15\nFor the latter, we use the risk-neutral probability \u03c0\u02c6 (cid:16) 1 and \u03c0\u02c6 (cid:16) 2 to obtain\nu 3 \u2113 3\n(cid:2) (cid:10)\n1 1 1 1 2 2\nE\u02c6 rgpS qs (cid:16) p\u03c0\u02c6 gpS uq(cid:0)\u03c0\u02c6 gpS \u2113qq (cid:16) p.8q(cid:0) p.6q (cid:16) .\n1 u 0 \u2113 0\n1(cid:0)R 1(cid:0)R 1.05 3 3 3.15\n2.1.4 One-period trinomial model\nIn a one-period trinomial model, M (cid:16) 3, N (cid:16) 2, S :(cid:16) p , u :(cid:16) P {S , m :(cid:16) P {S\n0 1 1,1 0 1,2 0\nand \u2113 :(cid:16) P {S , where S , P , P and P are all positive real numbers. By Theorem\n1,3 0 0 1,1 1,2 1,3\nS u\n0\nS S m\n0 0\nS \u2113\n0\nFigure 2.1.13: One-period trinomial model\n2.1.1, no-arbitrage condition is equivalent to the existence of a positive probability vector\n\u03c0\u02c6 (cid:16) p\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 q such that\n\u2113 m u\n\"\n\u2113\u03c0\u02c6 (cid:0) m\u03c0\u02c6 (cid:0) u\u03c0\u02c6 (cid:16) 1(cid:0)R\n\u2113 m u (2.1.8)\n\u03c0\u02c6 (cid:0) \u03c0\u02c6 (cid:0) \u03c0\u02c6 (cid:16) 1.\n\u2113 m u\nIt is not hard to see that the no-arbitrage condition has the same condition as the one-\nperiod binomial model, i.e., \u2113 \u0103 1(cid:0)R \u0103 u. The intersection of two planes with equations\n(2.1.8) in R3 is a line parametrized by\n$ \u03c0\u02c6 (cid:16) u(cid:1)p1(cid:0)Rq (cid:1) m(cid:1)\u2113t\n\u2019 & \u2113 u(cid:1)\u2113 u(cid:1)\u2113\n\u03c0\u02c6 (cid:16) t\nm\n\u2019\n%\u03c0\u02c6 (cid:16) 1(cid:0)R(cid:1)\u2113 (cid:1) u(cid:1)mt\nu u(cid:1)\u2113 u(cid:1)\u2113\n55 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nThe no-arbitrage condition is equivalent to the existence of a segment of this line in the\npositive octane; i.e., there exists a t such that\n$ \u03c0\u02c6 (cid:16) u(cid:1)p1(cid:0)Rq (cid:1) m(cid:1)\u2113t \u0105 0\n\u2019 & \u2113 u(cid:1)\u2113 u(cid:1)\u2113\n\u03c0\u02c6 (cid:16) t \u0105 0 ,\nm\n\u2019\n%\u03c0\u02c6 (cid:16) 1(cid:0)R(cid:1)\u2113 (cid:1) u(cid:1)mt \u0105 0\nu u(cid:1)\u2113 u(cid:1)\u2113\n! )\nwhichisguaranteedifandonlyif0 \u0103 min 1(cid:0)R(cid:1)\u2113, u(cid:1)p1(cid:0)Rq . Orequivalently,\u2113 \u0103 1(cid:0)R \u0103 u.\nu(cid:1)m m(cid:1)\u2113\n! )\nNotice that the positive segment is given by 0 \u0103 t \u0103 min 1(cid:0)R(cid:1)\u2113, u(cid:1)p1(cid:0)Rq .\nu(cid:1)m m(cid:1)\u2113\n(cid:25)^\nu\n1\nu\n1+R\n1\nm\n1\n1+R\n\u2113 (cid:25)^\n1+R m\n(cid:25)^\n\u2113\nFigure 2.1.14: The positive segment of line given by (2.1.8) when \u2113 \u0103 1(cid:0)R \u0103 u\nExercise 2.1.8. Derive the no-arbitrage condition for the multinomial model in Figure\n2.1.15. Here, u \u0103 u \u0103 (cid:4)(cid:4)(cid:4) \u0103 u are positive numbers.\n1 2 M\n2.1.5 Replication and complete market\nA contingent claim (or simply a claim) on an underlying asset S is a new asset with a\npayoff given by a function g : R (cid:209) R on the price S of the underlying asset at maturity\n(cid:0) T\nT; i.e., the payoff is gpS q. Call and put options are examples of contingent claims with\nT\npayoff functions gpS q :(cid:16) pS (cid:1)Kq and gpS q :(cid:16) pK(cid:1)S q , respectively. A replicating\nT T (cid:0) T T (cid:0)\n56 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nS u\n0 1\nS u\n0 2\n.\nS .\n0 .\nS u\n0 M(cid:0)1\nS u\n0 M\nFigure 2.1.15: The description of the asset price in the multinomial model\n(or hedging) portfolio for a contingent claim is a portfolio with the same future value as\nthe payoff of the claim at all states of the market. For example, in the binomial model in\nSection 2.1.3, any arbitrary claim can be replicated. More precisely, a payoff gpS uq and\n0\ngpS \u2113q for states u and \u2113, respectively, is replicated by a portfolio p\u03b8 ,\u03b8 q, given by\n0 0 1\nugpS \u2113q(cid:1)\u2113gpS uq gpS uq(cid:1)gpS \u2113q\n0 0 0 0\n\u03b8 (cid:16) and \u03b8 (cid:16) .\n0 1\nu(cid:1)\u2113 S pu(cid:1)\u2113q\n0\nContrary to the binomial model, in the trinomial model, several claims may not be replica-\nble. Forinstance,thereplicationofacalloptionwithK P rS m,S uqleadstothefollowing\n0 0\nsystem of three equations and two unknowns:\n$\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S u (cid:16) S u(cid:1)K\n\u2019 0 1 0 0\n&\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S m (cid:16) 0 ,\n0 1 0\n\u2019\n%\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S \u2113 (cid:16) 0\n0 1 0\nwhich obviously does not have any solutions for p\u03b8 ,\u03b8 q. A market model in which every\n0 1\nclaim is replicable is called a complete market. A binomial model is a complete market,\nwhereas a trinomial model is an incomplete market.\nFor a general Arrow-Debreu market model, the condition of completeness is expressed in\nthe following theorem.\nTheorem 2.1.2. Assume that there is no arbitrage, i.e., there exits a risk-neutral probabil-\nity \u03c0\u02c6. Then, the market is complete if and only if there is a unique risk-neutral probability;\ni.e., if and only if the system of linear equation (2.1.1)\np (cid:16) P\u03c0\nhas a unique positive solution.\nWhile in the binomial model there is only one risk-neutral probability and therefore the\n57 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nmarket is complete, in the trinomial model there are infinitely many risk-neutral probabil-\nities and therefore the market is incomplete.\n2.1.6 Superreplication and model risk\nReplication (or hedging) is a normal practice for the issuer of an option to manage the risk\nof issuing that option. When the market is not complete, one cannot perfectly replicate all\nclaims and the issuer of a claim should take another approach: a nonperfect replication.\nIn practice, the replication starts only after pricing the claim. The issuer first picks up\na pricing model, i.e., a risk-neutral probability \u03c0\u02c6(cid:6) (cid:16) p\u03c0\u02c6(cid:6),...,\u03c0\u02c6(cid:6) qT, to price the claim\n1 M\nby 1 E\u02c6(cid:6)rgpS qs. Then, she tries to use the fund raised by selling the option to find a\n1(cid:0)R T\nnonperfect replication strategy. Genuinely, the higher the price of the claim, the less the\nissuer is exposed to the risk. Therefore, the chosen risk-neutral probability \u03c0\u02c6(cid:6) to price\nthe claims represents some level of exposure to the risk. In this section, we would like to\nprovide a method to measure this risk, namely model risk.\nThe choice of a replication strategy usually depends on many variables, including the\nrisk preference of the issuer, which are outside the context of this section. However, for\nthe purpose of model risk, we introduce one specific choice of a nonperfect replication\nstrategy, namely superreplication. A superreplication strategy prepares the issuer for the\nworst-case scenario. The superreplication price of an option is defined as the cheapest price\nof a portfolio that generates a payoff greater than or equal to the payoff the option for all\nstates of the market. In the Arrow-Debreu market model for asset shown in Figure 2.1.15,\nwe want to make a portfolio p\u03b8 ,\u03b8 q such that\n0 1\n\u03b8 (cid:0)\u03b8 S u \u011b gpS u q for all j (cid:16) 1,...,M.\n0 1 0 j 0 j\nThen, among all such portfolios we want to choose the one that has the least cost, i.e.,\nmin \u03b80 (cid:0) \u03b8 S . For instance, in the trinomial model, the superreplication price of an\n1(cid:0)R 1 0\noption with payoff gpS q is defined by\n1\n\u03b8\n0\nmin (cid:0)\u03b8 S (2.1.9)\n1 0\n1(cid:0)R\nover all \u03b8 and \u03b8 subject to the constraints\n0 1\n$\n\u03b8 (cid:0)\u03b8 S u \u011b gpS uq\n\u2019 0 1 0 0\n&\n\u03b8 (cid:0)\u03b8 S m \u011b gpS mq . (2.1.10)\n0 1 0 0\n\u2019\n%\u03b8 (cid:0)\u03b8 S \u2113 \u011b gpS \u2113q\n0 1 0 0\n58 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nThe superreplication price of a claim is the smallest value that en-\nables the issuer to build a portfolio which dominates the payoff of\nthe claim, in other words, to remove all risk exposure from issuing\nthe claim.\nFor simplicity, we build the rest of this section in the context of the trinomial model.\nHowever, extension to multinomial model is straightforward. Subreplication price can be\ndefined similarly by\n\u03b8\n0\nmax (cid:0)\u03b8 S (2.1.11)\n1 0\n1(cid:0)R\nover all \u03b8 and \u03b8 subject to the constraints\n0 1\n$\n\u03b8 (cid:0)\u03b8 S u \u010f gpS uq\n\u2019 0 1 0 0\n&\n\u03b8 (cid:0)\u03b8 S m \u010f gpS mq . (2.1.12)\n0 1 0 0\n\u2019\n%\u03b8 (cid:0)\u03b8 S \u2113 \u010f gpS \u2113q\n0 1 0 0\nSub or superreplication is a linear programming problem that can be solved using some\nstandard algorithms. However, for the trinomial model, the solution is simple: for su-\nperreplication the minimum is attained in one of the at most three points of intersection\nbetween the lines\n$\n\u03b8 (cid:0)\u03b8 S u (cid:16) gpS uq\n\u2019 0 1 0 0\n&\n\u03b8 (cid:0)\u03b8 S m (cid:16) gpS mq .\n0 1 0 0\n\u2019\n%\u03b8 (cid:0)\u03b8 S \u2113 (cid:16) gpS \u2113q\n0 1 0 0\nAs shown in Figure 2.1.16, we only need to\n(1) find these three points,\n(2) exclude those that do not satisfy the inequalities (2.1.10), and\n(3) check which one of the remaining yields the smallest value for \u03b80 (cid:0)\u03b8 S .\n1(cid:0)R 1 0\nExample 2.1.8. In trinomial model, let S (cid:16) 1, R (cid:16) .5, u (cid:16) 2, m (cid:16) 1, and \u2113 (cid:16) 1{2.\n0\nConsider an option with payoff g shown in Figure 2.1.17.\na) Notice that payoff gp2q (cid:16) 0 and gp1q (cid:16) gp1{2q (cid:16) 1. We shall find the superreplication\nprice for this option.\n2\u03b8\n0\nmin (cid:0)\u03b8\n1\n3\nover all \u03b8 and \u03b8 subject to the constraints\n0 1\n$\n\u03b8 (cid:0)2\u03b8 \u011b 0\n\u2019 0 1\n&\n\u03b8 (cid:0)\u03b8 \u011b 1 .\n0 1\n\u2019\n%\u03b8 (cid:0) \u03b81 \u011b 1\n0 2\n59 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\n(cid:18)\n1\n(cid:18)\n0\nFigure 2.1.16: The linear programing problem for superhedging. The hatched region is\ndeterminedbyconstraints(2.1.10). Thedashedlinesarethecontoursofthelinearfunction\n\u03b80 (cid:0)\u03b8 S in (2.1.9). The point marked by (cid:12) is where the minimum is attained.\n1(cid:0)R 1 0\ng(S )\nT\n1\nS\nT\n1 2\nFigure 2.1.17: Payoff of Example 2.1.8\nThis linear programing problem matches the one sketched in Figure 2.1.16 with the\nminimizer given by p2,(cid:1)1q. Therefore, the superreplication price is given by 1.\n3\nb) We next find all risk-neutral probabilities. Notice that any risk-neutral probability\n\u03c0\u02c6 (cid:16) p\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 qT satisfies\nu m \u2113\n$\n2\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0) \u03c0\u02c6 \u2113 (cid:16) 3{2\n\u2019 & u m 2\n\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1\nu m \u2113\n\u2019\n%\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 \u0105 0\nu m \u2113\n60 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nBy eliminating \u03c0\u02c6 , we obtain \u03c0\u02c6 (cid:16) 1 (cid:0) \u03c0\u02c6 \u2113. Then, we parametrize the line of inter-\nm u 2 2\nsection of the two planes 2\u03c0 (cid:0)\u03c0 (cid:0) \u03c0 \u2113 (cid:16) 3{2 and \u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1.\nu m 2 u m \u2113\n$\n\u03c0\u02c6 (cid:16) 1 (cid:0) t\n\u2019 & u 2 2\n\u03c0\u02c6 (cid:16) 1 (cid:1) 3t\nm 2 2\n\u2019\n%\u03c0\u02c6 (cid:16) t\n\u2113\nIt is easy to see that \u03c0 ,\u03c0 ,\u03c0 \u0105 0 if and only if t P p0, 1q. The positive segment is\nu m \u2113 3\nshown in Figure 2.1.18.\n(cid:25)^\nu\n1\n:75\n1\n1 1:5\n(cid:25)^\n(cid:25)^ 3 m\n\u2113\nFigure 2.1.18: Thepositivesegmentoftheintersectionoftwolinesgivenby\u03c0\u02c6 u(cid:0)\u03c0\u02c6 m(cid:0)\nu m\n\u03c0\u02c6 \u2113 (cid:16) 1(cid:0)R and \u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1. The mark on the segment represents a chosen pricing\n\u2113 u m \u2113\nmodel \u03c0\u02c6(cid:6).\nc) Next, we find the range of prices for the option described in Part (a) generated by\ndifferent risk-neutral probabilities. Notice that in Part (b), all risk-neutral probabili-\nties are generated by a single parameter t P p0, 1q. Thus, the risk-neutral price of this\n3\noption is given by\n(cid:3) (cid:11)\n2 (cid:1)1 t(cid:9) (cid:1)1 3t(cid:9) 1 2t 1 t\n(cid:0) gp2q(cid:0) (cid:1) gp1q(cid:0)tgp1{2q (cid:16) (cid:1)t(cid:0) (cid:16) (cid:1)\n3 2 2 2 2 3 3 3 3\nAs t changes in p0, 1q, the price changes in p2, 1q.\n3 9 3\nNotice that in Example 2.1.8, the superreplication price 1 is the same as the supremum\n3\nof the price range given by risk-neutral probabilities p2, 1q. This is not a coincidence. One\n9 3\ncan see the relation between the superreplication problem and risk neural pricing through\nthe linear programming duality in Theorem A.3.\n61 2.1. ARROW-DEBREU 2. DISCRETE-TIME MARKETS\nThe problem of superreplication is a linear programming problem (A.3) that has a dual\nproblem given by (A.4). Theorem A.3 suggests that both problems have the same value.\nIn the context of superreplication for the trinomial model, the dual problem is given by\nmax\u03c0 gpS uq(cid:0)\u03c0 gpS mq(cid:0)\u03c0 gpS mq\nu 0 m 0 \u2113 0\nover all \u03c0 , \u03c0 , and \u03c0 subject to the constraints\n\u2113 m u\n$\n\u03c0 S u(cid:0)\u03c0 S m(cid:0)\u03c0 S m (cid:16) S\n\u2019 u 0 m 0 \u2113 0 0\n&\n\u03c0 (cid:0)\u03c0 (cid:0)\u03c0 (cid:16) 1\nu m \u2113 1(cid:0)R\n\u2019\n%\u03c0 ,\u03c0 ,\u03c0 \u011b 0\nu m \u2113\nBy change of variable \u03c0\u02c6 (cid:16) p1(cid:0)Rq\u03c0, the dual problem turns into\n1\nPpgq :(cid:16) max \u03c0\u02c6 gpS uq(cid:0)\u03c0\u02c6 gpS mq(cid:0)\u03c0\u02c6 gpS mq, subject to\nu 0 m 0 \u2113 0\n1(cid:0)R\n$\n\u2019\u03c0\u02c6 uu(cid:0)\u03c0\u02c6 mm(cid:0)\u03c0\u02c6 \u2113\u2113 (cid:16) 1(cid:0)R (2.1.13)\n&\n\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1 .\nu m \u2113\n\u2019\n%\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 \u011b 0\nu m \u2113\nGivenno-arbitragecondition,thelineofintersectionoftwoplanes\u03c0\u02c6 u(cid:0)\u03c0\u02c6 m(cid:0)\u03c0\u02c6 \u2113 (cid:16) 1(cid:0)R\nu m \u2113\nand \u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:0)\u03c0\u02c6 (cid:16) 1 has a segment in the positive octane, shown in Figure 2.1.14. Then,\nu m \u2113\nthe value of Ppgq in (2.1.13) is attained at one of endpoints of this segment. This segment\nrepresents the set of all risk-neutral probabilities. According to Theorem 2.1.1, the lack of\nweak arbitrage implies that this segment is inside the first octane with to endpoints on two\ndifferentcoordinateplanes, andthelackofstrongarbitrageonlyimpliesthattheendpoints\nof the segment are on the coordinate planes, possibly the same coordinate plane.\nLet\u2019s recall what we presented at the beginning of this section: the issuer of the option\nchooses a risk-neutral probability \u03c0\u02c6(cid:6) inside the positive segment to price the option. The\nendpoints of this segment, one of which maximizes and the other minimizes the value\n1 max \u03c0\u02c6 gpS uq(cid:0)\u03c0\u02c6 gpS mq(cid:0)\u03c0\u02c6 gpS mq, provide the super and subreplication price of\n1(cid:0)R u 0 m 0 \u2113 0\nthe option with payoff g, respectively. While the issuer has priced the claim by\n1\nE\u02c6(cid:6)rgpS qs,\n1\n1(cid:0)R\nto completely cover the risk, he needs P in (2.1.13). Therefore, he is short as much as\n1\n\u0398p\u03c0\u02c6(cid:6)q :(cid:16) Ppgq(cid:1) E\u02c6(cid:6)rgpS qs\n1\n1(cid:0)R\nin order to cover the risk of issuing the claim. The value \u0398p\u03c0\u02c6(cid:6)q is called superreplication\n62 2. DISCRETE-TIME MARKETS 2.1. ARROW-DEBREU\nmodel risk measureindexsuperreplication model risk measure.\nExample 2.1.9. In Example 2.1.8, if the pricing probability \u03c0\u02c6(cid:6) (cid:16) p7{12,1{4,1{6qT is\nchosen, then the superreplication model risk is measured by\n(cid:3) (cid:11)\n1 1 2 7 1 1 1 5 1\nPpgq(cid:1) E\u02c6(cid:6)rgpS qs (cid:16) (cid:1) gp2q(cid:0) gp1q(cid:0) gp1{2q (cid:16) (cid:1) (cid:16) .\n1\n1(cid:0)R 3 3 12 4 6 3 18 18\nExercise 2.1.9. In the trinomial model, let S (cid:16) 1, R (cid:16) 0, u (cid:16) 2, m (cid:16) 1, and \u2113 (cid:16) 1{2.\n0\na) Find all the risk-neutral probabilities and the range of prices generated by them for a\ncall option with strike K (cid:16) 1.\nb) Find the superreplication price and sub-replication price for this call option and com-\npare them to the lowest and highest prices in Part (a).\nExample 2.1.10. In Example 2.1.8, if we modify the yield by setting R (cid:16) 1, then there\nwill be an arbitrage. This can be seen through the absence of risk-neutral probabilities. On\nthe other hand, the superreplication problem is still feasible, i.e., problem (2.1.11) with\nconstraint (2.1.10) still has a finite value. But this value is zero. This is because we\nminimize \u03b80 (cid:0)\u03b8 subject to \u03b8 (cid:0)2\u03b8 \u011b 0, \u03b8 (cid:0)\u03b8 \u011b 1 and \u03b8 (cid:0)\u03b81 \u011b 1, which obviously takes\n2 1 0 1 0 1 0 2\nminimum value zero.\nOn the other hand, if we set R \u0105 1, then the superreplication problem is not feasible\nanymore and the minimum is (cid:1)8.\nExample 2.1.11. Consider the trinomial model with S (cid:16) 4, R (cid:16) .05, u (cid:16) 1.45, m (cid:16)\n0\n1.25 and \u2113 (cid:16) .85. To price payoff g in Figure 2.1.12, the risk-neutral probability \u03c0\u02c6 (cid:16)\np\u03c0\u02c6 ,\u03c0\u02c6 ,\u03c0\u02c6 qT (cid:16) p5{18,1{12,23{36qT has been chosen. In order to find the model risk, we\nu m \u2113\nfind the superreplication price by solving the following linear programming problem.\n$\n\u03b8 (cid:0)5.8\u03b8 \u011b gp5.8q (cid:16) .8\n\u2019 0 1\n\u03b8 &\n0\nmin 1.05 (cid:0)4\u03b8 1 subject to \u03b8 0(cid:0)5\u03b8 1 \u011b gp5q (cid:16) 0\n\u2019\n%\u03b8 (cid:0)3.4\u03b8 \u011b gp3.4q (cid:16) .6\n0 1\nThe minimizer is given by \u03b8 (cid:16) 19 and \u03b8 (cid:16) 1 , and the superreplication price is given by\n0 6 1 12\n2 . Then, the model risk is \u0398pgq :(cid:16) 1 E\u02c6 rgpS qs(cid:1)P.\n3.15 1(cid:0)R 1\n(cid:2) (cid:10)\n2 1 2 1 5 1 23\n\u0398pgq (cid:16) (cid:1) p\u03c0\u02c6 gpS uq(cid:0)\u03c0\u02c6 gpS mq(cid:0)\u03c0\u02c6 gpS \u2113qq (cid:16) (cid:1) p.8q(cid:0) p0q(cid:0) p.6q\nu 0 m 0 \u2113 0\n3.15 1(cid:0)R 3.15 1.05 18 12 36\nWe leave the treatment of the general multinomial model as an exercise.\nExercise 2.1.10. Write the linear programming problem associated with the superreplica-\ntion of a contingent claim in the multinomial model in Exercise 2.1.8 and its dual.\n63 2.2. MULTIPERIOD DISCRETE-TIME MARKETS 2. DISCRETE-TIME MARKETS\nRemark 2.1.6. The superhedging price and therefore the model risk is not linear in the\npayoff. The superreplication price of payoff g (cid:0)g is less than the sum of the superrepli-\n1 2\ncation price of payoff g and the superreplication price of payoff g . To see this, recall that,\n1 2\nby Theorem A.3, the superreplication price of a payoff g is\n\" *\n1\nPpgq :(cid:16) sup E\u02c6 rgpS qs : over all risk-neutral probabilities \u03c0\u02c6 .\n1\n1(cid:0)R\nBecause suptfpxq(cid:0)gpxqu \u010f supfpxq(cid:0)supgpxq, we have\nPpg (cid:0)g q \u010f Ppg q(cid:0)Ppg q.\n1 2 1 2\n2.2 Multiperiod discrete-time markets\n2.2.1 A discussion on the sample space for multiperiod asset price pro-\ncess\nConsider a discrete-time market with time horizon T in which trading occurs only at time\nt (cid:16) 0,...,T, and there are d (cid:0) 1 assets. We shall denote the price of asset i at time\nSpiq,\nt (cid:16) 0,...,T by for i (cid:16) 0,...,d. The price of each risky asset in a multiperiod market\nt\nmodel is a stochastic process; this means for each t (cid:16) 1,...,T, the price at time t, denoted\nby S is a random variable. In this section, we set up a sample space to host stochastic\nt\nprocesses that represent the price of assets in a discrete-time market.\nFor a single period market with one asset whose price is a random variable with discrete\nvalues, a finite or countably infinite sample space which matches the states to the values\nof a random variable may suffice. For instance, if the future price S of an asset is given\n1\nby three values 2, 1, and 0.5, one can assume a sample space with three outcomes, namely\n\u2126 (cid:16) t\u03c9 ,\u2126 ,\u03c9 u with S p\u03c9 q (cid:16) 2, S p\u03c9 q (cid:16) 1, and S p\u03c9 q (cid:16) 0.5. When we have a\n1 2 3 1 1 1 2 1 3\nmultiperiod market with a single asset, the price of the asset is a stochastic process, more\nthan one random variable, and we need a more complicated construction for sample space.\nThe following examples elaborate on this situation.\nExample 2.2.1. Let the price S of an asset at time t (cid:16) 1,2 be given by the diagram in\nt\nthe figure below. The random variable S takes values 1 and (cid:1)1 and the random variable\n1\n!\n1\nS =1 S =2\n1;1 2;1\n!\n2\nS =1 S =0\n1;2 2;2\n!\nS =(cid:0)1 3 S =0\n1;3 2;3\n!\nS =(cid:0)1 4 S =(cid:0)2\n1;4 2;4\n64 2. DISCRETE-TIME MARKETS 2.2. MULTIPERIOD DISCRETE-TIME MARKETS\nS takes values 2, 0, and (cid:1)1. However, a suitable sample to host both random variables is\n1\none with only four members, \u2126 (cid:16) t\u03c9 ,\u03c9 ,\u03c9 ,\u03c9 u with S p\u03c9 q (cid:16) 1, S p\u03c9 q (cid:16) 2, S p\u03c9 q (cid:16) 1,\n1 2 3 4 1 1 2 1 1 2\nS p\u03c9 q (cid:16) 0, S p\u03c9 q (cid:16) (cid:1)1, S p\u03c9 q (cid:16) 0, and S p\u03c9 q (cid:16) (cid:1)1, S p\u03c9 q (cid:16) (cid:1)2. This sample space\n2 2 1 3 2 3 1 4 2 4\nis made up of all possible states of the market; here there are four states that are shown\nwith arrows. These states are also called the paths of the price process, which represents\nthe evolution of the price process in time for each outcome.\nThe above example is a standard random walk with two periods; see Example B.13.\nExample 2.2.2. We modify Example 2.2.1 as shown below. Unlike Example 2.2.1, a\n!\nS =1 1 S =2\n1;1 2;1\n!5\n!\nS =1 2 S =0\n1;2 2;2\nS =(cid:0)1 S =0\n1;3 ! 2;3\n3\n!\n6\nS =(cid:0)1 S =(cid:0)2\n1;4 ! 2;4\n4\nsample space needs more than four members, exactly six. There are six different paths that\nthe price of the asset can evolve in time. \u2126 (cid:16) t\u03c9 ,\u03c9 ,\u03c9 ,\u03c9 ,\u03c9 ,\u03c9 u with S p\u03c9 q (cid:16) 1,\n1 2 3 4 5 6 1 1\nS p\u03c9 q (cid:16) 2, S p\u03c9 q (cid:16) 1, S p\u03c9 q (cid:16) 0, S p\u03c9 q (cid:16) (cid:1)1, S p\u03c9 q (cid:16) 0, and S p\u03c9 q (cid:16) (cid:1)1,\n2 1 1 2 2 2 1 3 2 3 1 4\nS p\u03c9 q (cid:16) (cid:1)2, S p\u03c9 q (cid:16) (cid:1)1, S p\u03c9 q (cid:16) 2, and S p\u03c9 q (cid:16) 1, S p\u03c9 q (cid:16) (cid:1)2.\n2 4 1 5 2 5 1 6 2 6\nInamoregeneralcase, asamplespaceneedstoatleasthavethesetofallprobablesample\npathssuperreplicationmodelriskmeasure. ofthepriceprocess. IntheArrow-Debreumodel,\nthe set of all sample paths is the set of all states of the market, regardless of the number\nof assets. In a market with T periods and one asset that takes values V at time t with\nt\nt (cid:16) 0,...T, we can have the sample space\n\u2423 (\n\u2126 (cid:16) px ,...,x q : x P V , t (cid:16) 1,...,T .\n1 T t t\n\u015bT\nThis sample space have V samples paths. We can use the sample-path methodology\nt(cid:16)1 t\nto write one single sample space for both Example 2.2.1 and Example 2.2.2, namely\n\u2423 (\n\u2126 (cid:16) pa,bq : a (cid:16) (cid:1)1 or 1, and b (cid:16) (cid:1)2,0, or 2 .\nFor a market with T periods and d (cid:0) 1 assets such that at time t the vector of assets\npSp0q,...,Spdq q takes values in the set V \u010e Rd(cid:0)1 for each t (cid:16) 0,...T, the set of all sample\nt t t (cid:0)\npaths is the collection of all functions of the form\n\u03c9 : t1,...,Tu (cid:209) V (cid:2)(cid:4)(cid:4)(cid:4)(cid:2)V\n1 T\n65 2.2. TRADING AND ARBITRAGE 2. DISCRETE-TIME MARKETS\nNoticethatsomeofthesamplepathsmayhaveprobabilityzero. InExample2.2.1,thesam-\nple path p(cid:1)1,2q has probability zero, but in Example 2.2.2, no sample path has probability\nzero.\nA unifying approach to set a sample space for the asset price process is by extending the\nset of values of the price to include all positive real numbers, V (cid:16) Rd(cid:0)1, \u2126 (cid:16) \u015bT V (cid:16)\nt (cid:0) t(cid:16)1 t\npRd(cid:0)1qT5 equipped with the Borel \u03c3-field BppRd(cid:0)1qTq. The random variable Spiq which\n(cid:0) (cid:0) t\nrepresents the price of asset i at time t is then defined by the canonical mapping\nSpiq : \u03c9 (cid:16) p\u03c9 ,...,\u03c9 q P pRd(cid:0)1qT (cid:222)(cid:209) \u03c9piq, where \u03c9 (cid:16) p\u03c9p0q,...,\u03c9pdq q P Rd(cid:0)1.\nt 1 T (cid:0) t t t t (cid:0)\nHere, we assume that the price of an asset only takes positive values \u03c9piq P R . If it\nt (cid:0)\ntakes negative values, then we can extend the sample space to \u2126 :(cid:16) pRd(cid:0)1qT. If asset\n0 is a risk-free asset, then we can remove its contribution in the sample space and write\n\u2126 :(cid:16) pRdqT.\n(cid:0)\nThe choice of canonical space allows us to cover all types of models for asset price with\ndiscrete or nondiscrete distribution. For the rest of this section, we do not need to empha-\nsize on choice the sample space, we assume that the sample space is finite. Some of\nthe result can be generalized to countably infinite or even uncountable sample spaces. But,\nthe treatment of such cases needs more advance tools form martingale theory.\n2.2.2 Arbitrage and trading in multiperiod discrete-time markets\nConsider a market with multiple assets. There are three ways to represent a portfolio\nthat is made up of these assets: based on the proportion of each asset in the portfolio,\nthe number of units of each asset in the portfolio, and the value invested in each asset.\nWe start to define a portfolio based on the proportion, because it is easier to understand,\nthen we provide the equivalent representations on the number of units of each asset in the\nportfolio and the value invested in each asset.\nPortfolio\nA self-financing portfolio, or simply a portfolio, is represented by the sequence of vectors\n\u03b8 (cid:16) p\u03b8p0q,...,\u03b8pdq qT for t (cid:16) 0,...,T (cid:1)1 with \u0159d \u03b8piq (cid:16) 1, for t (cid:16) 0,...,T (cid:1)1. Here, \u03b8piq\nt t t i(cid:16)0 t t\n\u03b8piq Wpiq, Wpiq\nis the ratio of the value of portfolio invested in asset i at time t; (cid:16) where\nt Wt t\nis the proportion of the value of portfolio invested in asset i at time t and W is the total\nt\nWpiq \u2206piqSpiq, \u2206piq\nvalue of the portfolio at time t. Equivalently, (cid:16) where is the number of\nt t t t\n5We prefer to write pRd(cid:0)1qT and not Rpd(cid:0)1qT.\n(cid:0) (cid:0)\n66 2. DISCRETE-TIME MARKETS 2.2. TRADING AND ARBITRAGE\nSpiq\nshares of asset i in the portfolio and is the current price of asset i. More precisely,\nt\nd d\n\u201a Wpiq \u201a \u2206piqSpiq Wpiq \u03b8piqW \u2206piqSpiq.\nW (cid:16) (cid:16) and (cid:16) (cid:16)\nt t t t t t t t t\ni(cid:16)0 i(cid:16)0\n\u03b8piq, \u2206piq, Wpiq\nand can be positive, negative, or zero, representing long, short, or no-\nt t t\ninvestment positions in asset i, respectively. In addition, they do not need to be determin-\nistic; in general, a portfolio strategy can be a sequence of random vector that depends on\n\u03b8piq\nthe information obtained from the assets\u2019 prices before or at time t. In other words, is\nt\nSpjq\na function of random variables for i (cid:16) 1,...,t and j (cid:16) 1,...,d. More rigorously:\ni\nDefinition 2.2.1. A self-financing portfolio strategy is given by a sequence of vector func-\ntions \u03b8 (cid:16) p\u03b8p0q,...,\u03b8pdq qT such that \u03b8 P Rd is a real vector and for any t (cid:16) 1,...,T (cid:1)1,\nt t t 0\n\u03b8 (cid:16) p\u03b8p0q,...,\u03b8pdq qT is a function that maps\nt t t\n(cid:20) (cid:28)\nS0 (cid:4)(cid:4)(cid:4) S0\n1 t\nS t :(cid:16) (cid:22) (cid:21) . . . ... . . . ffi (cid:29) (2.2.1)\nSd (cid:4)(cid:4)(cid:4) Sd\n1 t\ninto a vector in Rd that satisfies\nd\n\u201a \u03b8piq\n(cid:16) 1, for t (cid:16) 0,...,T (cid:1)1.\nt\ni(cid:16)0\n\u03b8piq\nIn other words, the function depends only on the prices of all assets from time t (cid:16) 0\nt\nuntil time t, not the future prices at points t(cid:0)1,...,T in time. This is in line with the\nintuition that a portfolio strategy can only depend on the information gathered up to the\npresent time.\nIn different applications, different representation of a portfolio strategy are proved useful.\nFor example in the portfolio theory, it is easier to write the portfolio in terms of the ratio,\nwhile in the replicating portfolio of an option, the number of shares in each asset happens\nto provide a more convenient representation. If \u2206 is known, the value of portfolio at time\nt\nt is given by\nd\n\u201a \u2206piqSpiq.\nW (cid:16)\nt t t\ni(cid:16)0\n\u2206piq pSpiq (cid:1)Spiq\nThen, the value invested in asset i changes by q from time t to time t(cid:0)1.\nt t(cid:0)1 t\n67 2.2. TRADING AND ARBITRAGE 2. DISCRETE-TIME MARKETS\nTime # of units of asset (j) Value of the portfolio\n\u2206pjq \u03b8 tpjqWt \u2206p0qSp0q (cid:0)(cid:4)(cid:4)(cid:4)(cid:0)\u2206pdqSpdq\nt (cid:16) W (cid:16)\nt Spjq t t t t t\nt\n\u03b8 tpjqWt(cid:0)1 \u2206p0qSp0q (cid:0)(cid:4)(cid:4)(cid:4)(cid:0)\u2206pdqSpdq\nt(cid:0)1 before rebalancing W (cid:16)\nSpjq t(cid:0)1 t t(cid:0)1 t t(cid:0)1\nt(cid:0)1\n\u2206pjq \u03b8 tp (cid:0)jq 1Wt(cid:0)1 \u2206p0q Sp0q (cid:0)(cid:4)(cid:4)(cid:4)(cid:0)\u2206pdq Spdq\nt(cid:0)1 after rebalancing (cid:16) W (cid:16)\nt(cid:0)1 Spjq t(cid:0)1 t(cid:0)1 t(cid:0)1 t(cid:0)1 t(cid:0)1\nt(cid:0)1\nTable 2.1: Rebalancing a portfolio strategy from time t to time t(cid:0)1.\nTherefore, the total wealth at time t(cid:0)1 changes to\nd\n\u201a \u2206piqSpiq\nW (cid:16) ,\nt(cid:0)1 t t(cid:0)1\ni(cid:16)0\nand the change in the value of portfolio is given by\nd\n\u201a \u2206piq pSpiq (cid:1)Spiq\nW (cid:1)W (cid:16) q, (2.2.2)\nt(cid:0)1 t t t(cid:0)1 t\ni(cid:16)0\nHowever, at time t(cid:0)1, we need to change the investment ratio \u03b8 to a different value \u03b8 ,\nt t(cid:0)1\nand as a consequence, \u2206 should be changed to \u2206 accordingly. Since the sum of ratios\nt t(cid:0)1\nis always one,\nd\n\u201a \u03b8piq\n(cid:16) 1, for t (cid:16) 0,...,T (cid:1)1,\nt(cid:0)1\ni(cid:16)0\n\u03b8piq \u2206 tpiqS tpiq\nand (cid:16) , the vector \u2206 must satisfy\nt Wt t(cid:0)1\nd d\n\u201a \u2206piq Spiq \u201a \u2206piqSpiq\n(cid:16) W (cid:16) , for t (cid:16) 0,...,T (cid:1)1.\nt(cid:0)1 t(cid:0)1 t(cid:0)1 t t(cid:0)1\ni(cid:16)0 i(cid:16)0\nStochastic integral: discrete-time markets\nFor ease of calculation, we consider the case d (cid:16) 1, i.e., i (cid:16) 0 and 1. Recall from (2.2.2)\nthat the change in the value of the portfolio satisfies\n\u2206p0q pSp0q (cid:1)Sp0q \u2206p1q pSp1q (cid:1)Sp1q\nW (cid:1)W (cid:16) q (cid:0) q .\nloot o(cid:0)oo1 mooooont loot ooooooot o(cid:0)m1 ooooooot loot ooooooot o(cid:0)m1 ooooooot\nooon ooon\nchangeinthevalueoftheportfolio changeduetoriskyasset(0) changeduetoriskyasset(1)\n68 2. DISCRETE-TIME MARKETS 2.2. TRADING AND ARBITRAGE\nGiven initial wealth W , we sum up the above telescopic summation to obtain\n0\nt(cid:1)1 t(cid:1)1\n\u201a \u2206p0q pSp0q (cid:1)Sp0q \u201a \u2206p1q pSp1q (cid:1)Sp1q\nW (cid:16) W (cid:0) q(cid:0) q.\nt 0 i i(cid:0)1 i i i(cid:0)1 i\ni(cid:16)0 i(cid:16)0\nIn the right-hand side above, either of the summations corresponds to the cumulative\nchanges in the value of the portfolio due to investment in one of the assets.\nIf asset Sp0q denotes a risk-free asset with discrete yield R in the time period from i to\nSp0q (cid:1)Sp0q RSp1q. \u2206p0qSp0q (cid:1)\u2206p1qSp1q.\ni(cid:0)1, then (cid:16) On the other hand, (cid:16) W Therefore,\ni(cid:0)1 i i i i i i i\n\u2206p0q pSp0q (cid:1)Sp0q (cid:1)\u2206p1qSp1q\nq (cid:16) RpW q.\ni i(cid:0)1 i i i i\nIn this case, we can simply drop the superscript of the risky asset to write\nW (cid:1)W (cid:16) RpW (cid:1)\u2206 S q (cid:0) \u2206 pS (cid:1)S q .\nloot o(cid:0)oo1 mooooont loooooot omoooot ooot loot oooot o(cid:0) m1 ooooooot\nn n\nchangeinthevalueoftheportfolio changeduetorisk-freeasset changeduetoriskyasset\nTherefore, the total wealth satisfies\nt(cid:1)1 t(cid:1)1\n\u201a \u201a\nW (cid:16) W (cid:0)R pW (cid:1)\u2206 S q(cid:0) \u2206 pS (cid:1)S q. (2.2.3)\nt 0 i i i i i(cid:0)1 i\ni(cid:16)0 i(cid:16)0\nIn (2.2.3), the first summation is the cumulative changes in the value of the portfolio due\ntoinvestmentintherisk-freeasset,andthesecondsummationisthecumulativeinvestment\nin the portfolio due to changes in the risky asset.\nAn important consequence of this formula is that a self-financing portfolio is only charac-\nterized by trading strategy \u2206 (cid:16) p\u2206 ,...,\u2206 q and the initial wealth W , since there is no\n0 T(cid:1)1 0\ninflow and outflow of cash to or from the portfolio. The term\nt(cid:1)1\n\u201a\np\u2206(cid:4)Sq :(cid:16) \u2206 pS (cid:1)S q\nt i i(cid:0)1 i\ni(cid:16)0\nis called a discrete stochastic integral6.\nExercise 2.2.1. Let W\u02dc :(cid:16) p1(cid:0)Rq(cid:1)tW and S\u02dc :(cid:16) p1(cid:0)Rq(cid:1)tS be, respectively, discounted\nt t t t\nwealth process and discounted asset price.Then, show that\nt(cid:1)1\n\u201a\nW\u02dc (cid:16) W (cid:0) \u2206 pS\u02dc (cid:1)S\u02dc q, W\u02c6 (cid:16) W .\nt 0 i i(cid:0)1 i 0 0\ni(cid:16)0\n6AccordingtoPhilipProtter,thisnotationwasdevisedbytheprominentFrenchprobabilistPaul-Andr\u00e9\nMeyer to simplify the task of typing with old-fashioned typewriters.\n69 2.2. TRADING AND ARBITRAGE 2. DISCRETE-TIME MARKETS\nTo understand the meaning of stochastic integral p\u2206(cid:4)Sq , we provide the following exam-\nt\nple.\nExample 2.2.3. Recall from Example B.13 that a random walk W is the wealth of a player\nin a game of chance in which he wins or loses $1 in each round based on the outcome of\nflipping a coin. If we denote the amount of bet of the player in round i by \u2206 , then the\ni(cid:1)1\ntotal wealth W\u2206 from the betting strategy \u2206 (cid:16) p\u2206 ,\u2206 ,...q in t rounds is given by\n0 1\nt(cid:1)1\n\u201a\nW\u2206 (cid:16) W\u2206(cid:0) \u2206 \u03be\nt 0 i i(cid:0)1\ni(cid:16)0\nwhere t\u03be u is a sequence of i.i.d. random variables with values 1 and (cid:1)1. Since \u03be (cid:16)\ni i i\nW (cid:1)W , we have\ni(cid:0)1 i\nt(cid:1)1\n\u201a\nW\u2206 (cid:16) \u2206 pW (cid:1)W q (cid:16) p\u2206(cid:4)Wq .\nt i i(cid:0)1 i t\ni(cid:16)0\nIn particular, if \u2206 (cid:17) 1, W\u2206 (cid:16) W is merely a random walk.\ni\nExample 2.2.4 (Saint Petersburg paradox and doubling strategy). In the setting of Ex-\nample 2.2.3, we consider the following strategy: \u2206 (cid:16) 1 and \u2206 (cid:16) 2i, for i \u0105 0, if the\n0 i\nplayer has lost all the past rounds from 1 to i(cid:1)1. Otherwise, if the first winning occurs\nat round i, we set \u2206 (cid:16) 0 for j \u011b i. For example, if the player\u2019s outcome in the first five\nj\nrounds are given by \"loss, loss, loss, loss, win\", then his bets are given by \"1, 2, 4, 8, 16, 0\n, ...\", respectively. Then, the wealth of the player after five rounds is given by\nW (cid:16) 1p(cid:1)1q(cid:0)2p(cid:1)1q(cid:0)4p(cid:1)1q(cid:0)8p(cid:1)1q(cid:0)16p1q (cid:16) 1.\n5\nHowever, his wealth before the fifth round is always negative.\nW (cid:16) (cid:1)1, W (cid:16) (cid:1)3, W (cid:16) (cid:1)7, W (cid:16) (cid:1)15.\n1 2 3 4\nMore generally, if the player loses first i(cid:1)1st rounds and win the ith round, the wealth of\nthe player satisfies\ni(cid:1)1\n\u201a\nW (cid:16) (cid:1)1,...,W (cid:16) 2j (cid:16) 2i(cid:1)1 and W (cid:16) 1.\n1 i(cid:1)1 i(cid:1)1\nj(cid:16)0\nExercise 2.2.2. In Example 2.2.4, we showed that if the player has the opportunity to\nborrow with no limitation and continue the game until the first win, he will always end up\nwith terminal wealth equal to $1.\na) Assume that the player has a credit line, denoted by C. He stops playing if either he\nreaches his credit limit or he wins for the first time. Find the possible values for the\nterminal wealth of the player.\n70 2. DISCRETE-TIME MARKETS 2.2. TRADING AND ARBITRAGE\nb) Find the expected value of the terminal wealth of the player, given that the probability\nof winning is p P p0,1q.\nArbitrage strategy\nIn this section, we present the definition of an arbitrage opportunity and a version of the\nFTAP7 for multistep discrete-time markets. In order to define arbitrage, we first fix the\nsample space \u2126 of all samples paths of the price process and we define a \u03c3-field F of all\nevents on the sample paths space. When \u2126 is a finite or countably infinite set, we can\nchoose F to be the \u03c3-field of all subsets of \u2126. When \u2126 (cid:16) pRd(cid:0)1qT, we set F (cid:16) BppRd(cid:0)1qTq.\n(cid:0) (cid:0)\nTo define arbitrage, it is crucial to to determine the set of all events on the sample paths\nspace that are believed to have a chance to occur. This is a part of modeling a financial\nmarket. Relevant events are those that basically represent our beliefs about the market\nbehavior. Equivalently, one can determine the set of all events on the sample paths space\nthat are deemed impossible to occur. We define such events below.\nDefinition 2.2.2. We call a collection of events N \u010e F a polar collection if it satisfies\na) H P N.\nb) If B P N and A \u010e B, then A P N.\nc) If tA u8 \u010e N, then \u01648 A P N.\nn n(cid:16)1 n(cid:16)1 n\nThe members of a polar collection are called polar sets .\nAs discussed in examples below, the polar collection depends on the choice of the space\nsample paths.\nExample 2.2.5 (polar set). In the binomial model in Section 2.1.3, if we set the sample\nspace to be \u2126 (cid:16) R , the polar collection N is given by all subsets of \u2126 that do not contain\n(cid:0)\nany of the points S u or S \u2113. However, if we set the sample space to \u2126 (cid:16) tu,\u2113u, then\n0 0\nN (cid:16) tHu. Similarly, in the trinomial model in Section 2.1.4, \u2126 (cid:16) R is the canonical\n(cid:0)\nspace and the polar collection N is the collection of all events A that do not contain any of\nthe points S u, S m, or S \u2113. If we set the sample space to \u2126 (cid:16) tu,m,\u2113u, then N (cid:16) tHu.\n0 0 0\nExample 2.2.6. In Example 2.2.1, consider the sample paths space given by \u2126 (cid:16) tpx,yq :\nx (cid:16) (cid:1)1 or (cid:0)1 and y (cid:16) (cid:1)2, 0, or 2u. Then, the set of polar collection is\n! )\nH,tp1,(cid:1)2qu,tp(cid:1)1,2qu,tp1,(cid:1)2q,p(cid:1)1,2qu .\nThe arbitrage relative to the polar collection N is defined below.\n7A fundamental theorem of asset pricing\n71 2.2. TRADING AND ARBITRAGE 2. DISCRETE-TIME MARKETS\nDefinition 2.2.3. A (weak) arbitrage opportunity is a portfolio \u2206 such that\na) W (cid:16) 0,\n0\nb) tW \u0103 0u P N, and\nT\nc) tW \u0105 0u R N.\nT\nA strong arbitrage opportunity is a portfolio \u2206 such that\na) W \u0103 0, and\n0\nb) tW \u0103 0u P N.\nT\nBy tW \u0103 0u P N, we mean that the event tW \u011b 0u will surely happen. tW \u0105 0u R N\nT T T\nmeans that tW \u0105 0u is likely to happen with a possibly small chance.\nT\nIn the above, we did not assign any probability to the events, except the polar collection;\nthe polar collection is the collection of all events that are believe to have probability zero.\nOutside polar collection, all the events have nonzero probability, which may not be known.\nTo extend FTAP to discrete-time multiperiod market models, we need the probabilistic\nnotion of martingale, which is introduced in Section B.3. Risk-neutral probability in a\nmultiperiod market can be defined in terms of the martingale property for the discounted\nasset price: S\u02c6 :(cid:16) p1(cid:0)Rq(cid:1)tS ; we assume implicitly that there is a zero bond with yield R\nt t\nin the market.\nDefinition 2.2.4. We call a probability P\u02c6 a risk-neutral probability if the discounted asset\nprice is a martingale with respect to the \u03c3-field generated by the price process tS : t \u011b 0u\nt\nunder the probability measure P\u02c6; i.e.,\nE\u02c6 rS\u02c6 | S ,S ,...,S s (cid:16) S\u02c6. (2.2.4)\nt(cid:0)1 t t(cid:1)1 1 t\nHere, E\u02c6 is the expectation with respect to P\u02c6.\nWe can also use the notion of \u03c3-field FS :(cid:16) \u03c3pS ,...,S q generated by S ,...,S to write\nt t 0 t 0\nE\u02c6 rS\u02c6 | FSs (cid:16) S\u02c6.\nt(cid:0)1 t t\nFor a single-period binomial model, the martingale property with respect to risk-neutral\nprobability is expressed and verified in Section 2.1.3; see (2.1.5).\nExercise 2.2.3. Let t\u2206 u8 be a bounded portfolio strategy; i.e., there exists a number\nt t(cid:16)0\nC such that |\u2206 | \u0103 C for all t (cid:16) 0,1,.... Show that if the discounted price S\u02c6 (cid:16) St\nt t p1(cid:0)Rqt\nis a martingale with respect to probability P\u02c6, then the stochastic integral p\u2206(cid:4)S\u02c6 q and the\nt\ndiscounted wealth process W\u02dc are martingales with respect to P\u02c6.\nt\n72 2. DISCRETE-TIME MARKETS 2.2. TRADING AND ARBITRAGE\nThe following result extends Theorem 2.1.1 into multiple periods. In order to have a\nfundamental theorem of asset pricing in a general form, we need to impose the following\nassumption.\nAssumption2.2.1(Dominatingprobability). ThereexistsaprobabilityPsuchthatA P N\nif and only if PpAq (cid:16) 0.\nAssumption 2.2.1 holds trivially if the sample space of all paths are finite or countably\ninfinite. It is a nontrivial assumption when the sample path space is uncountable.\nThe probability P can be regarded as the physical probability in the market. Therefore,\none can equivalently define the collection of all polar sets as the set of all events that have\nzero probability under P. However, as seen in Theorem 2.2.1, the only relevant information\nabout probability P is the no-arbitrage condition is the polar collection; the actual value\nof the probability of an event does not matter as long as it has a nonzero probability. In\nthis case, we say that the polar sets are generated by P.\nDefinition 2.2.5. Two probabilities P and P\u02c6 are called equivalent if they generate the same\npolar sets. We denote the equivalency by P (cid:17) P\u02c6.\nTheorem 2.2.1 (Fundamental theorem of asset pricing (FTAP)). Let Assumption 2.2.1\nhold. Then, there is no weak arbitrage opportunity in the discrete-time market model if\nand only if there exists a probability measure P\u02c6 such that\na) P\u02c6 (cid:17) P, and\nb) the discounted asset price S\u02c6 is a (local) martingale(local) martingale8 under P\u02c6.\nt\nThe probability measure P\u02c6 is called a risk-neutral probability.\nA market model with no arbitrage is called a complete market model if any contingent\nclaim is replicable. In other words, for a contingent claim with payoff g : pRd(cid:0)1qT (cid:209) R\n(cid:0)\nwhich maps the history of an underlying asset price, S ,S ,...,S into gpS ,S ,...,S q,\n0 1 T 0 1 T\nthere exists a portfolio \u2206 ,...,\u2206 such that\n0 T(cid:1)1\np\u2206(cid:4)Sq (cid:16) gpS ,S ,...,S q.\nT 0 1 T\nAs an extension to Theorem 2.2.1, we have the following condition for the completeness of\na market.\nCorollary 2.2.1. Let Assumption 2.2.1 and no-weak-arbitrage condition hold. Then, The\nmarket is complete if and only if there is a unique risk-neutral probability measure.\n8local martingale is roughly a martingale without condition (a) in Definition B.15.\n73 2.2. TRADING AND ARBITRAGE 2. DISCRETE-TIME MARKETS\nOne direction of Theorem 2.2.1 is easy to prove. Here is a glimpse of the proof. Assume\nthat a risk-neutral probability P\u02c6 exists, and consider an arbitrage strategy \u2206 with the\ncorresponding discounted wealth process W integrable. Then,\nt\nW\u02c6 (cid:16) p\u2206(cid:4)S\u02c6 q . pRecall that W (cid:16) 0.q\nt t 0\nSince S\u02c6 is a P\u02c6-martingale, then by Exercise 2.2.1, W\u02c6 is a martingale and we have\nt t\nE\u02c6 rW\u02c6 s (cid:16) W (cid:16) 0.\nt 0\nThis is in contradiction to condition (c) in the definition of arbitrage 2.2.3. For a complete\nproof of this result, see [13, Pg. 7, Theorem 1.7]. A very general form of this theorem can\nbe found in a seminal paper by Delbaen and Schachermayer [9].\nRemark 2.2.1. Assumption 2.2.1 can be relaxed by assuming that the polar sets are gener-\nate by a convex collection of probabilities P. More precisely A P N if and only if PpAq (cid:16) 0\nfor all P P P. Then, the fundamental theorem of asset pricing should be modified: there is\nno weak arbitrage opportunity in the discrete-time model if and only if\na) Q :(cid:16) tP\u02c6 : S\u02c6 is a P\u02c6-martingaleu is nonempty, and\nt\nb) P and Q generate the same polar sets.\nFor more on the relaxation of Assumption 2.2.1, see [6].\nBy Theorem 2.2.1, the existence of risk-neutral probability eliminates the possibility of\narbitrage. However when T (cid:16) 8, the Saint Petersburg Paradox still holds even though a\nrisk-neutral probability exists. This is a different issue and is related to the notion of an\nadmissible portfolio strategy. The following corollary suggest a practical way around this\nparadox.\nCorollary 2.2.2. Let tM u8 be a martingale, t\u2206 u8 a portfolio strategy, and C be a\nt t(cid:16)0 t t(cid:16)0\nconstant such that p\u2206(cid:4)Mq \u011b C for all t \u011b 0. Then, for any stopping time \u03c4 such that\nt\n\u03c4 \u0103 8 a.s., we have\nErp\u2206(cid:4)Mq | F s (cid:16) p\u2206(cid:4)Mq .\n\u03c4 t \u03c4^t\nIn particular, Erp\u2206(cid:4)Mq s \u010f 0.\n\u03c4\nDefinition 2.2.6 (Admissible strategy). A portfolio strategy is called admissible if there\nexists a C be a constant such that p\u2206(cid:4)Sq \u011b C for all t \u011b 0.\nt\nrestriction to admissible strategies is not necessary when there are only finite number\nof periods, T \u0103 8. For T (cid:16) 8, we need to restrict the portfolio strategy choices to\nadmissible strategies. In addition, this happens to be necessary when we pass to a limit\nfrom a discrete-time market to a continuous-time market by sending the number of periods\nto infinity.\n74 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\n2.3 Binomial model\nLet H ,H ,... be an i.i.d.9 sequence of random variables with values u and \u211310. Let T be\n1 2\nthe maturity, and let the time variable t take values 0,1,...,T. At time 0, the price of the\nasset is S . At time t (cid:16) 1,...,T, the price of the asset satisfies S (cid:16) S H . The binomial\n0 t t(cid:1)1 t\nmodel is shown in Figure 2.3.1.\nS uT\n0\nS u3 S uT(cid:0)1\u2113\n0 0\nS u2\n0\nS u S u2\u2113 S uT(cid:0)2\u21132\n0 0 0\n.\nS S u\u2113 .\n0 0 .\nS \u2113 S u\u21132 S u2\u2113T(cid:0)2\n0 0 0\nS \u21132\n0\nS \u21133 S u\u2113T(cid:0)1\n0 0\nS \u2113T\n0\nFigure 2.3.1: Asset price in the binomial model\nWe label the nodes of the binomial model by the time and the state of the asset price. For\nexample, at time t when the asset price is equal to S :(cid:16) S uj\u2113t(cid:1)j, the node is labeled\nt,j(cid:0)1 0\npt,j (cid:0)1q. The only node at time 0 is labeled 0 for simplicity. See Figure 2.3.2.\n9Independent identically distributed\n10The probabilities of these values are irrelevant at this moment.\n75 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\n(3;4)\n(2;3)\n(1;2) (3;3)\n(0) (2;2)\n(1;1) (3;2)\n(2;1)\n(3;1)\nFigure 2.3.2: Label of the nodes in a three-period binomial model\n2.3.1 No-arbitrage condition\nTheno-arbitrageconditionforthemultiperiodbinomialmodelisthesameasforthesingle-\nperiod. There is no arbitrage in the multiperiod binomial model if and only if there is no\narbitrage for the single-period model with the same parameters.\nProposition 2.3.1. There is no arbitrage in the multiperiod binomial model if and only\nif \u2113 \u0103 1 (cid:0) R \u0103 u. In this case, the multiperiod binomial market is complete, and the\nrisk-neutral probability is given by assigning the following distribution to each H .\ni\n1(cid:0)R(cid:1)\u2113 u(cid:1)1(cid:1)R\nP\u02c6 pH (cid:16) uq (cid:16) and P\u02c6 pH (cid:16) \u2113q (cid:16) .\ni i\nu(cid:1)\u2113 u(cid:1)\u2113\nProof. By Theorem 2.2.1 (FTAP), no-arbitrage condition is equivalent to the existence of\na risk-neutral probability. We first show that given \u2113 \u0103 1 (cid:0) R \u0103 u, the probability P\u02c6\ndefined in the theorem is a risk-neutral probability. In other words, we shall show that\nthe discounted asset price is a martingale. Notice that since S (cid:16) H S , we have\nt(cid:0)1 t(cid:0)1 t\nS\u02c6 (cid:16) Ht(cid:0)1S\u02c6. Therefore,\nt(cid:0)1 1(cid:0)R t\n1\nE\u02c6 rS\u02c6 | FSs (cid:16) E\u02c6 rS\u02c6H | FSs,\nt(cid:0)1 t 1(cid:0)R t t(cid:0)1 t\nwhere FS (cid:16) \u03c3pS\u02c6,...,S\u02c6 q. Since S\u02c6 is known given FS, if follows from Corollary B.6 that\nt t 0 t t\nS\u02c6\nE\u02c6 rS\u02c6H | FSs (cid:16) t E\u02c6 rH\u02c6 | FSs.\nt t(cid:0)1 t 1(cid:0)R t(cid:0)1 t\nOn the other hand, since H ,H ,... is a sequence of independent random variables, H\n1 2 t(cid:0)1\n76 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\nis independent of FS, and we have\nt\nE\u02c6 rH\u02c6 | FSs (cid:16) E\u02c6 rH\u02c6 s (cid:16) \u03c0\u02c6 u(cid:0)\u03c0\u02c6 \u2113 (cid:16) 1(cid:0)R.\nt(cid:0)1 t t(cid:0)1 u \u2113\nThus,\nE\u02c6 rS\u02c6 | FSs (cid:16) S\u02c6.\nt(cid:0)1 t t\nFor the other direction, assume by contraposition that either u \u010f 1(cid:0)R or \u2113 \u011b 1(cid:0)R.\nThen, Section 2.1.3 shows that there is an arbitrage in the first period. Then, one can\nliquidate the position to cash after the first period to carry over the arbitrage until time\nT.\nThe above proof is also presented in Example B.41 in a different way.\nAs shown in Figure 2.3.1, the random variable S only takes values S un(cid:1)k\u2113k for k (cid:16)\nn 0\n0,...,n. Under the risk-neutral probability,\n(cid:2) (cid:10)\nn\nP\u02c6 pS (cid:16) S un(cid:1)k\u2113kq (cid:16) p\u03c0\u02c6 qn(cid:1)k p\u03c0\u02c6 qk.\nn 0 u \u2113\nk\n(cid:0)n(cid:8)\nTo see this, notice that in the binomial model in Figure 2.3.1, there are paths from\nk\nthe node S to node S un(cid:1)k\u2113k, and the probability of each path is p\u03c0\u02c6 qn(cid:1)k p\u03c0\u02c6 qk11. For\n0 0 u \u2113\nsimplicity, we denote S ut(cid:1)i\u2113i by S piq.\n0 t\nRemark 2.3.1 (Recombination in the binomialmodel). The binomial model has a feature\nthat allows reduce the number of values that S can take. For example, consider a two\nn\nperiod market with one asset whose price process is given below:\nS (cid:16) 1,S (cid:16) H , and S (cid:16) H H ,\n0 1 1 2 1 2\nwhere H takes values u and \u2113 for i (cid:16) 1,2. At time t (cid:16) 2, the S takes values u u ,\ni i i 2 1 2\nu \u2113 , u \u2113 , and \u2113 \u2113 . All these values are distinct unless u \u2113 (cid:16) u \u2113 . In the binomial\n1 2 2 1 1 2 1 2 2 1\nmodel u (cid:16) u (cid:16) u and \u2113 (cid:16) \u2113 (cid:16) \u2113. Therefore, u \u2113 (cid:16) u \u2113 (cid:16) u\u2113. Therefore, the values\n1 2 1 2 1 2 2 1\nfor S binomial model reduces to three, because the values u \u2113 and u \u2113 recombine. See\n2 1 2 2 1\nFigure 2.3.3. In general for a T period binomial market model, the recombination allows\nthat the price S takes only t(cid:0)1 values, whereas in a nonrecombining market model, there\nt\nare potentially 2t distinct values for S .\nt\n2.3.2 Basic properties of the binomial model\nThe binomial model described above has some properties that are the common features in\nmany models in finance. These features allows to perform risk management evaluations in\na reasonable time. In this section, we discuss these properties.\n11This is an elementary combinatorics problem.\n77 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\nu1u2 u1u2\nu1 u1\nu1\u21132\nS0=1 S0=1 u1\u21132=\u21131u2\n\u21131u2\n\u21131 \u21131\n\u21131\u21132 \u21131\u21132\nFigure 2.3.3: Recombining binomial market model (right) versus a nonrecombining one\n(left).\nTime homogeneity\n\u015bt\nSince tH u8 is an i.i.d. sequence of random variables, then for t \u0105 s, H has the\ni t(cid:16)1 i(cid:16)s(cid:0)1 i\n\u015bt(cid:1)sH \u015bt\nsame distribution as . Therefore, given S (cid:16) S, S (cid:16) S H has the same\ni(cid:16)1 i s t s i(cid:16)s(cid:0)1 i\nS\u015bt(cid:1)sH\ndistribution as S (cid:16) . In other words, the conditional distribution of S given\nt(cid:1)s i(cid:16)1 i t\n\u015bt(cid:1)sH\nS (cid:16) S is the same as conditional distribution of S (cid:16) S given S (cid:16) S.\ns t(cid:1)s 0 i(cid:16)1 i 0\nMarkovian property\nThe Markovian property for a stochastic process asserts that in order to determine the\nprobability of future scenarios of the value of the process, for example the value at a time\nin the future, the only relevant information from the past history of the price process is the\nmost recent one. In other words,\nDefinition 2.3.1. A stochastic process tX : t \u011b 0u with values in Rd is called Markovian\nt\nif for any A \u0102 R and s \u0105 t, we have\nPpX P A | X ,...,X q (cid:16) PpX P A | X s.\ns t 0 s t\nEquivalently, onecanwritetheMarkovianpropertyofintermsofconditionalexpectation:\nErgpX q | X ,...,X s (cid:16) ErgpX q | X s. (2.3.1)\ns t 0 s t\nThe binomial model is Markovian under risk-neutral probability; given S ,...,S ,S\nt 1 0\n(cid:17) (cid:1) \u017as (cid:9) (cid:25)\nE\u02c6 rgpS q | S ,...,S s (cid:16) E\u02c6 g S H | S ,...,S .\ns t 0 t i t 0\ni(cid:16)t(cid:0)1\n78 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\ns\n\u015b\nSince H is independent of S ,...,S , by Proposition B.6, we have\ni t 0\ni(cid:16)t(cid:0)1\n(cid:17) (cid:1) \u017as (cid:9) (cid:25) (cid:17) (cid:1) \u017as (cid:9)(cid:25) (cid:17) (cid:1) \u017as (cid:9) (cid:25)\nE\u02c6 g S H | S (cid:16) s ,...,S (cid:16) s (cid:16) E\u02c6 g s H (cid:16) E\u02c6 g S H | S (cid:16) s .\nt i t t 0 0 t i t i t t\ni(cid:16)t(cid:0)1 i(cid:16)t(cid:0)1 i(cid:16)t(cid:0)1\nTherefore,\nE\u02c6 rgpS q | S ,...,S s (cid:16) E\u02c6 rgpS q | S s.\ns t 0 s t\nSee Figure2.3.4 for the illustration of the Markovian property in the binomial model in one\nperiod. Given S (cid:16) S piq, the probability that S (cid:16) S pi(cid:0)1q is \u03c0\u02c6 , and the probability\nt t t(cid:0)1 t(cid:0)1 u\nthat S (cid:16) S piq is \u03c0\u02c6 . Given S (cid:24) S piq, both of the probabilities are 0.\nt(cid:0)1 t(cid:0)1 \u2113 t t\nS (i+1):=S (i)u\nt+1 t\nS (i)\nt\nS (i):=S (i)\u2113\nt+1 t\nFigure 2.3.4: Conditioning of the binomial model\nWhy is Markovian property important? The Markovian property is often useful in reduc-\ningthecomputationaleffort, andmodelswiththeMarkovianpropertyarecomputationally\nefficient. A reason for this reduction lies in the solution to the exercise below.\nExercise 2.3.1. How many paths are there in a binomial model from time t (cid:16) 0 to time\nt (cid:16) n? How many nodes (values of asset price process at all points in time) are there?\nIf we don\u2019t have Markovian property, we need to evaluate the conditional expectation\nE\u02c6 rgpS q | S ,...,S s once for each sample path; E\u02c6 rgpS q | S ,...,S s is a random variable\ns t 0 s t 0\nthat has as many values as the process pS ,...,S q does. However, Markov property allows\n0 t\nus to reduce the conditional expectation to E\u02c6 rgpS q | S s, and therefore, the number of\ns t\nvalues that E\u02c6 rgpS q | S s can take is as many as the number of values of the ranvom\ns t\nvariable S .\nt\n79 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\n2.3.3 Arbitrage pricing and replicating European contingent claims in\nthe binomial model\nAs in Section 2.1, the introduction of a new asset can create arbitrage if and only if the\ndiscounted price of the new asset does not satisfy\n1\nE\u02c6 rP1 s (cid:16) p1,\n1(cid:0)R (cid:4)j\nfor at least one risk-neutral probability. In the one-period binomial model, since there is\nonly one risk-neutral probability provided that there is no arbitrage, one can readily find\nthe no-arbitrage price of any new asset including all derivatives.\nThesamemethodologyappliestothemultiperiodbinomialmodel, withaslightdifference:\nthe discounted price of the newly introduced asset must be a martingale with respect to\nthe risk-neutral probability.\nWe start by illustrating the idea in a two-period binomial model in the following example.\nExample 2.3.1. Consider a two-period binomial model with S (cid:16) 1, u (cid:16) 2, \u2113 (cid:16) 1, and\n0 2\nR (cid:16) .5 (for simplicity). We consider a European call option with strike K (cid:16) .8; the payoff\nis gpS q (cid:16) pS (cid:1).8q . Therefore, \u03c0\u02c6 (cid:16) 2 and \u03c0\u02c6 (cid:16) 1.\n2 2 (cid:0) u 3 \u2113 3\nS2(3)=4 (4(cid:0)K)+=3:2\nS1(2)=2 V1;2\nS0=1 S2(2)=1 V0 (1(cid:0)K)+=:2\nS1(1)=1 2 V1;1\nS2(1)=1 4 (1 4(cid:0)K)+=0\nFigure 2.3.5: European call option in a two-period binomial model. Left: asset price.\nRight: option price\nWe first argue that the price of the European call option mimics the binomial model for\nthe asset and takes a similar form shown on the right-hand-side in Figure 2.3.5. At the\nmaturity, the value of the option is given by V (cid:16) pS (cid:1)Kq . Since S takes three values,\n2 2 (cid:0) 2\nso does V . At time t (cid:16) 1,\n2\nWe assume that there is no arbitrage. Therefore, the discounted price of the option must\nbe a martingale with respect to the asset price under the risk-neutral probability:\n1 1\nV (cid:16) E\u02c6 rV | S ,S s (cid:16) E\u02c6 rpS (cid:1)Kq | S ,S s.\n1 2 1 0 2 (cid:0) 1 0\n1(cid:0)R 1(cid:0)R\n80 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\nBy the Markovian property of the asset price, we have,\n1\nV (cid:16) E\u02c6 rpS (cid:1)Kq | S s.\n1 2 (cid:0) 1\n1(cid:0)R\nTherefore, V is a function of S , and since S takes two values, the value V of the op-\n1 1 1 1\ntion takes two values V and V when S takes values S p2q (cid:16) S u and S p1q (cid:16) S \u2113,\n1,2 1,1 1 1 0 1 0\nrespectively. More precisely,\n1 1 (cid:7)\nV (cid:16) E\u02c6 rpS (cid:1)Kq | S (cid:16) S us (cid:16) p\u03c0\u02c6 pS u(cid:1)Kq (cid:0)\u03c0\u02c6 pS \u2113(cid:1)Kq q(cid:7)\n1,2 1(cid:0)R 2 (cid:0) 1 0 1(cid:0)R u 1 (cid:0) \u2113 1 (cid:0) (cid:7) S1(cid:16)S0u\n(cid:2) (cid:10)\n1 2 1 4.4\n(cid:16) p3.2q(cid:0) p.2q (cid:16) (cid:19) 1.4666.\n1.5 3 3 3\nSimilarly at node p1,1q, where t (cid:16) 1 and state is 1, we have\n1 1 (cid:7)\nV (cid:16) E\u02c6 rpS (cid:1)Kq | S (cid:16) S \u2113s (cid:16) p\u03c0\u02c6 pS u(cid:1)Kq (cid:0)\u03c0\u02c6 pS l(cid:1)Kq q(cid:7)\n1,1 1(cid:0)R 2 (cid:0) 1 0 1(cid:0)R u 1 (cid:0) \u2113 1 (cid:0) (cid:7) S1(cid:16)S0\u2113\n(cid:2) (cid:10)\n1 2 1 .8\n(cid:16) p.2q(cid:0) p0q (cid:16) (cid:19) 0.8888.\n1.5 3 3 9\nTo evaluate the option price V at time t (cid:16) 0, we use that the no-arbitrage implies the\n0\nmartingale property for the option:\n(cid:2) (cid:10)\n1 1 2 2 4.4 1 .8\nV (cid:16) E\u02c6 rV s (cid:16) p\u03c0\u02c6 V (cid:0)\u03c0\u02c6 V q (cid:16) p q(cid:0) p q (cid:19) .6716.\n0 1 u 1,2 \u2113 1,1\n1(cid:0)R 1(cid:0)R 3 3 3 3 9\nTo replicate the option, we need to solve the same system of equations as in 2.1.7 at each\nnode of the binomial model in a backward manner. At node p1,2q,\n# #\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S p2qu (cid:16) p4(cid:1)Kq 1.5\u03b8 (cid:0)4\u03b8 (cid:16) 3.2\n0 1 1 (cid:0) 0 1\nor .\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S p2q\u2113 (cid:16) p1(cid:1)Kq 1.5\u03b8 (cid:0)\u03b8 (cid:16) .2\n0 1 1 (cid:0) 0 1\nThus, \u03b8 (cid:16) 1 and \u03b8 (cid:16) (cid:1)1.6. In other words, to replicate the claim at node p1,2q we need\n1 0 3\nto keep one unit of the risky asset and borrow 1.6 units of the risk-free zero bond. This\n3\nleads to the price \u03b8 (cid:0)\u03b8 S p2q (cid:16) 2(cid:1) 1.6 (cid:16) 4.4, the same price we found with risk-neutral\n0 1 1 3 3\nprobability.\nThe same method should be used in the other node, p1,1q, to obtain the system of equation\n#\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 (cid:16) .2\n0 1\n.\n\u03b8 p1(cid:0)Rq(cid:0) 1\u03b8 (cid:16) 0\n0 4 1\n(cid:0) (cid:8)\nThus, \u03b8 (cid:16) .8 and \u03b8 (cid:16) (cid:1).4. The price \u03b8 \u03b8 S p1q (cid:16) 1 .8 (cid:1) .4 (cid:16) .8 is again the same as\n1 3 0 9 0 1 1 2 3 9 9\n81 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\nthe risk-neutral price.\nAt node 0, the replicating portfolio needs to reach the target prices of the claim at time\nt (cid:16) 1, i.e.\n# #\n\u03b8 (cid:0)\u03b8 S u (cid:16) V (cid:16) 4.4 \u03b8 p1(cid:0)Rq(cid:0)2\u03b8 (cid:16) 4.4\n0 1 0 1,2 3 or 0 1 3 .\n\u03b8 (cid:0)\u03b8 S \u2113 (cid:16) V (cid:16) .8 \u03b8 p1(cid:0)Rq(cid:0) 1\u03b8 (cid:16) .8\n0 1 0 1,1 9 0 2 1 9\nBy solving the above system, we obtain \u03b8 (cid:16) 24.8 units of the risky asset and \u03b8 (cid:16) (cid:1)20\n1 27 0 81\nunits of the risk-free bond in the replicating portfolio. This is the structure of the replicating\nportfolio at the beginning of the replication. If the price moves up, we have to restructure\nthe portfolio to keep one unit of the risky asset and (cid:1)1.6 units of the risk-free bond. If it\n3\nmoves down, we need to readjust the position to .8 units of the risky asset and (cid:1).4 units\n3 9\nof the risk-free bond.\nNext, consider a general European claim with payoff gpS q, where g : R (cid:209) R is a\nT (cid:0)\nfunction that assigns a value to the payoff based on the price S of the asset at terminal\nT\ntime T. Such European claims are also called Markovian claims. Let V ,...,V be random\n0 T\nvariables representing the price of this European claim at time t (cid:16) 0,...,T, respectively.\nThen, in order to avoid arbitrage, the derivative price must remain martingale, i.e.\n1\nV (cid:16) E\u02c6 rV | S ,...,S s.\nt t(cid:0)1 t 0\n1(cid:0)R\nLet\u2019s assume that at time t(cid:0)1, V is a function Vpt(cid:0)1,(cid:4)q and S . This assumption\nt(cid:0)1 t(cid:0)1\nis true for T, where V (cid:16) gpS q. We use induction to show that V is a function of S .\nT T t t\nIt follows from the Markovian property of the binomial model that E\u02c6 rV | S ,...,S s (cid:16)\nt(cid:0)1 t 0\nE\u02c6 rVpt(cid:0)1,S q | S ,...,S s (cid:16) E\u02c6 rVpt(cid:0)1,S q | S s, and therefore\nt(cid:0)1 t 0 t(cid:0)1 t\n1\nVpt,S q :(cid:16) E\u02c6 rVpt(cid:0)1,S q | S s. (2.3.2)\nt t(cid:0)1 t\n1(cid:0)R\nTherefore, one needs to evaluate function Vpt,Sq over the binomial model, as shown in\nFigure 2.3.6.\nWe can also show bu induction that\n1\nVpt,S q (cid:16) E\u02c6 rE\u02c6 rgpS q | S s.\nt p1(cid:0)RqT(cid:1)t T t\nThis holds for t (cid:16) T (cid:1)1:\n1\nVpT (cid:1)1,S q (cid:16) E\u02c6 rgpS q | S s.\nT(cid:1)1 T T(cid:1)1\n1(cid:0)R\n82 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\nV V V V (cid:1)(cid:1)(cid:1) V = g(S )\n0 1 2 3 T T\n( )\ng S uT\n0\n( ) ( )\nV 3;S (4) g S uT(cid:0)1\u2113\n3 0\n( )\nV 2;S (3)\n2\n( ) ( ) ( )\nV 1;S (2) V 3;S (3) g S uT(cid:0)2\u21132\n1 3 0\n( )\n.\nV V 2;S (2) .\n0 2 .\n( ) ( ) ( )\nV 1;S (1) V 3;S (2) g S u2\u2113T(cid:0)2\n1 3 0\n( )\nV 2;S (1)\n2\n( ) ( )\nV 3;S (1) g S u\u2113T(cid:0)1\n3 0\n( )\ng S \u2113T\n0\nFigure 2.3.6: The price of a Markovian European contingent claim in the binomialmodel\nNow assume that\n1\nVpt(cid:0)1,S q (cid:16) E\u02c6 rE\u02c6 rgpS q | S s.\nt(cid:0)1 p1(cid:0)RqT(cid:1)pt(cid:0)1q T t(cid:0)1\nThen, by the tower property of the conditional expectation, we can write\n1\nVpt,S q :(cid:16) E\u02c6 rVpt(cid:0)1,S q | S s\nt t(cid:0)1 t\n1(cid:0)R\n1 (cid:17) 1 (cid:25) 1\n(cid:16) E\u02c6 E\u02c6 rgpS q | S ,...,S s | S (cid:16) E\u02c6 rgpS q | S s.\n1(cid:0)R p1(cid:0)RqT(cid:1)pt(cid:0)1q T t(cid:0)1 0 t p1(cid:0)RqT(cid:1)t T t\n83 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\nTherefore, for any t (cid:16) 0,...,T (cid:1)1, we have\n1\nVpt,S q (cid:16) E\u02c6 rgpS q | S s. (2.3.3)\nt p1(cid:0)RqT(cid:1)t T t\nRemark 2.3.2. Since the binomial model is time homogeneous, E\u02c6 rgpS q | S (cid:16) Ss in\nT t\n(2.3.3) is equal to E\u02c6 rgpS q | S (cid:16) Ss. This suggests that the price function Vpt,Sq is a\nT(cid:1)t 0\nfunction of S and time-to-maturity \u03c4 :(cid:16) T (cid:1)t, Vp\u03c4,Sq. Time-to-maturity is often used\ninstead of time in financial literature regarding the evaluation of contingent claims.\nExample 2.3.2. Consider a four-period binomial model for a risky asset with each period\nequal to a year, and take S (cid:16) $10, u (cid:16) 1.06, \u2113 (cid:16) 0.98, and R (cid:16) .02. We shall find the\n0\nprice V of the option with the payoff shown in figure below. By 2.3.3, the value Vp0,S q\n0 0\ng(S )\nT\n1\nS\n0 10 11 12 T\nof the option is the expected value of the discounted payoff under risk-neutral probability;\n1\nVp0,S q (cid:16) E\u02c6 rgpS qs.\n0 p1(cid:0)Rq4 4\nSince the random variable S takes values 9.2236816, 9.9766352, 10.7910544, 11.6719568,\n4\nand 12.6247696. Therefore, the only nonzero value of the payoff is obtained when S (cid:16)\n4\n10.7910544 and is gp10.7910544q (cid:16) 1. The risk-neutral probability of S (cid:16) 10.7910544 is\nT\n(cid:0)2(cid:8)\nsimply p\u03c0\u02c6 q2p\u03c0\u02c6 q2 (cid:16) 3. Thus,\n4 u \u2113 8\n3\nVp0,S q (cid:16) (cid:19) 0.34644203476.\n0 8p1.02q4\nReplication of European option in the binomial model\nWe show that any European contingent claim (even non-Markovian ones) are perfectly\nreplicable in the binomial model. The argument follows inductively: let the replicating\nportfolio is built at each node of the binomial model at all points t(cid:0)1 or later in time. As\na result of this assumption, at each node the value of the replicating portfolio is the same\nas the value of the option. We continue by replicating the price of the option at time t(cid:0)1;\n84 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\ni.e., we need to solve the following system of equations for each i (cid:16) 1,...,t(cid:0)1:\n#\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S pi(cid:0)1q (cid:16) Vpt(cid:0)1,S pi(cid:0)1qq\n0 1 t(cid:0)1 t(cid:0)1\n.\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 S piq (cid:16) Vpt(cid:0)1,S pi(cid:0)1qq\n0 1 t(cid:0)1 t(cid:0)1\nThe solution is given by\nuVpt(cid:0)1,S piqlq(cid:1)lVpt(cid:0)1,S piquq Vpt(cid:0)1,S piquq(cid:1)Vpt(cid:0)1,S piqlq\nt t t t\n\u03b8 (cid:16) and \u03b8 (cid:16) .\n0 1\npu(cid:1)\u2113qp1(cid:0)Rq S piqpu(cid:1)\u2113q\nt\n\u03b8 isthenumberofunitsoftheriskyassetinthereplicatingportfolio, and\u03b8 isthenumber\n1 0\nof units of the risk-free bond in the replicating portfolio. In other words, the replicating\nportfolio is a self-financing portfolio given by (2.2.3) with initial wealth V and portfolio\n0\nstrategy given by t\u2206pt,S quT(cid:1)1.\nt t(cid:16)0\nVpt(cid:0)1,Suq(cid:1)Vpt(cid:0)1,S\u2113q\n\u2206pt,Sq :(cid:16) . (2.3.4)\nSpu(cid:1)\u2113q\nThenumberofunitsoftheriskyassetinthereplicatingportfolio, givenby (2.3.4), iscalled\nthe Delta of the contingent claim at time t. Basically, (2.3.4) suggests that the Delta of a\nEuropeanMarkoviancontingentclaimisafunctionoftimetandthepriceoftheunderlying\nasset at time t.\nRemark 2.3.3. As you can see from (2.3.4), the Delta of the contingent claim at time t\nmeasures the sensitivity of the value of the contingent claim with respect to changes in the\nprice of the underlying asset, i.e., changes in the price of the option due to changes in the\nprice of the underlying asset.\nBy (2.2.3), the replicating portfolio for the binomial model takes the form\nt(cid:1)1 t(cid:1)1\n\u201a \u201a\nVpt,S q (cid:16) Vp0,S q(cid:0)R pVpi,S q(cid:1)\u2206pi,S qS q(cid:0) \u2206pi,S qpS (cid:1)S q,\nt 0 i i i i i(cid:0)1 i\ni(cid:16)0 i(cid:16)0\nwhere Vpi,S q is the price of the contingent claim at time i when the underlying price\ni\nR\u0159t(cid:1)1\nis S . The term pVpi,S q(cid:1)\u2206 pS qS q represents accumulated changes in the risk-\ni i(cid:16)0 i i i i\nfree zero bond in the replicating portfolio caused by compounding of the interest, and\n\u0159t(cid:1)1\u2206\npS qpS (cid:1) S q represents the accumulated changes in the replicating portfolio\ni(cid:16)0 i i i(cid:0)1 i\ncaused by changes in the risky asset price. The act of constructing a replicating portfolio\nfor a contingent claim is ofter referred to as Delta hedging.\nThe above discussion is summarized in the following algorithm.\nRemark 2.3.4. Given that functions \u2206 and V are calculated, one has to plug time t\nand asset price S into the function to find the price and adjust the replicating portfolio\nt\n85 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\nBackward pricing and replicating European options in the binomialmodel\n1: At time T, the value of the option is gpS Tpjqq.\n2: for each t (cid:16) T (cid:1)1,...,0 do\n3: for each j (cid:16) 1,...,t(cid:0)1 do\n4: The value of the option Vpt,S tpjqq (cid:16) 1(cid:0)1 RE\u02c6 rVpt(cid:0)1,S t(cid:0)1q | S t (cid:16) S tpjqs.\n5: Thereplicatingportfolioismadeof\u2206pt,S tpjqqunitsoftheriskyassetandVpt,S tpjqq(cid:1)\nS pjq\u2206pt,S pjqq is the risk-free bond.\nt t\n6: end for\n7: end for\nof the contingent claim. However, there is no guarantee that quoted prices in the market\nwill match the prices in the binomial (or any other) model. In such case, interpolation\ntechniques can be exploited to find the price and adjust the replicating portfolio.\nExercise 2.3.2. In the binomial model, show that the Delta of a call option \u2206call and the\nDelta of a put option \u2206put with the same maturity and strike satisfy\n\u2206call(cid:1)\u2206put (cid:16) 1, for all t (cid:16) 0,...,T (cid:1)1.\nt t\nIs this result model-independent? Hint: consider the put-call parity.\nExercise 2.3.3. Consider a two-period binomial model for a risky asset with each period\nequal to a year and take S (cid:16) $1, u (cid:16) 1.03 and \u2113 (cid:16) 0.98.\n0\na) If the interest rate for both periods is R (cid:16) 0.01, find the price of the option with\nthe payoff shown in Figure 2.3.7 with K (cid:16) 1.00 and K (cid:16) 1.05 at all nodes of the\n1 2\nbinomial model.\ng(S )\nT\nK (cid:0)K\n2 1\nS\nK K T\n1 2\nFigure 2.3.7: Payoff of Exercise 2.3.3\nb) Find the replicating portfolio at each node of the binomial model.\nExercise 2.3.4. Consider a two-period binomial model for a risky asset with each period\nequal to a year and take S (cid:16) $1 u (cid:16) 1.05 and \u2113 (cid:16) 1.00. Each year\u2019s interest rate comes\n0\nfrom Exercise 1.1.4.\n86 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\na) Is there any arbitrage? Why or why not? Give an arbitrage portfolio if you find out\nthere is one.\nb) Now consider a two-period binomial model for a risky asset with each period equal to\na year and take S (cid:16) $1 u (cid:16) 1.05 and \u2113 (cid:16) 0.95.\n0\nFind the price of the option with the payoff shown in Figure 2.3.7 with K (cid:16) 1.00\n1\nand K (cid:16) 1.05 at all nodes of the binomial model. Find the interest rates for each\n2\nperiod from information in Part (a).\nc) Find the replicating portfolio and specifically \u2206 at all nodes of the binomial model.\nRemark2.3.5. 2.3.2suggeststhatthepriceofaMarkovianclaiminabinomialmodeldoes\nnot depend on past movements of the price and only depends on the current price S. This\nis not indeed true for non-Markovian claims. For example, a look-back option with payoff\n(cid:0) max S (cid:1)K(cid:8) or an Asian option (cid:0) 1 \u0159T S (cid:1)K(cid:8) are non-Markovian options\nt(cid:16)0,...,T t (cid:0) T(cid:0)1 t(cid:16)0 t (cid:0)\nwith the price depending to some extent on the past history of the price movement rather\nthan only the current price of the underlying. Evaluation of these type of non-Markovian\npayoffs, namely path-dependent payoffs, cannot benefit fully from the Markovian property\nof the model.\nExample 2.3.3. Consider the setting of Exercise 2.3.3: R (cid:16) 0.01, S (cid:16) $1, u (cid:16) 1.03\n0\n(cid:0) (cid:8)\nand \u2113 (cid:16) 0.98 To price a look-back option with payoff max S (cid:1)1 , first notice that\nt(cid:16)0,1,2 t\n(cid:0)\nthe payoff of the option at time T (cid:16) 2 is path-dependent: the paths pS ,S u,S u\u2113q and\n0 0 0\npS ,S \u2113,S u\u2113q generate the same value S u\u2113 for S . However, the payoff for the former is\n0 0 0 0 2\n(cid:0) (cid:8) (cid:0) (cid:8)\nmaxtS ,S u,S u\u2113u(cid:1)1 (cid:16) maxt1,1.03,1.0094u(cid:1)1 (cid:16) 0.03;\n0 0 0\n(cid:0) (cid:0)\nwhile the latter has payoff\n(cid:0) (cid:8) (cid:0) (cid:8)\nmaxtS ,S \u2113,S u\u2113u(cid:1)1 (cid:16) maxt1,0.98,1.0094u(cid:1)1 (cid:16) 0.0094.\n0 0 0\n(cid:0) (cid:0)\nTherefore, the binomial model should be shown as in Figure 2.3.8 It follows from no arbi-\n87 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\n( )\nu2 maxfS0;S0u;S0u2g(cid:0)1 +=0:0609\nu V(1;u)\n( )\nmaxfS0;S0u;S0u\u2113g(cid:0)1 +=0:03\nu\u2113\nS0=1 V0\n( )\nmaxfS0;S0\u2113;S0u\u2113g(cid:0)1 +=0:0094\n\u2113u\n\u2113 V(1;\u2113)\n( )\n\u21132 maxfS0;S0\u2113;S0\u21132g(cid:0)1 +=0\nFigure 2.3.8: Look-back option in the binomial model in Example 2.3.3\ntrage that the price of the look-back option must be a martingale, and therefore,\n1 E\u02c6(cid:16) 1(cid:24)\nVp1,uq (cid:16) gpS ,S ,S q | S (cid:16) u,S (cid:16)\n0 1 2 1 0\n1(cid:0)R\n1 (cid:1) (cid:9)\n(cid:16) \u03c0\u02c6 p0.0609q(cid:0)\u03c0\u02c6 p0.03q (cid:19) 0.0480594,\nu \u2113\n1.01\n1 E\u02c6(cid:16) 1(cid:24)\nVp1,\u2113q (cid:16) gpS ,S ,S q | S (cid:16) \u2113,S (cid:16)\n0 1 2 1 0\n1(cid:0)R\n1 (cid:1) (cid:9)\n(cid:16) \u03c0\u02c6 p0.0094q(cid:0)\u03c0\u02c6 p0q (cid:19) 0.0055841, and\nu \u2113\n1.01\n1 E\u02c6(cid:16) 1(cid:24)\nV (cid:16) gpS ,S ,S q | S (cid:16)\n0 p1(cid:0)Rq2 0 1 2 0\n1 (cid:1) (cid:9)\n(cid:16) \u03c0\u02c62p0.0609q(cid:0)\u03c0\u02c6 \u03c0\u02c6 p0.03q(cid:0)\u03c0\u02c6 \u03c0\u02c6 p0.0094q(cid:0)\u03c0\u02c62p0q (cid:19) 0.0307617.\np1.01q2 u u \u2113 \u2113 u \u2113\nReplicationissimilartothemarkoviancase. Forinstance, toreplicatedthelook-backoption\nat S (cid:16) u, we first need to solve the system of equations\n1\n#\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 u (cid:16) 0.0609\n0 1\n.\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 \u2113 (cid:16) 0.03\n0 1\nHowever, since the binomial model does not recombine, the number such systems of equa-\ntions to solve grows exponentially in the number of periods; whereas, in Markovian case the\nnumber of such systems of equations grows quadratic.\nExercise 2.3.5. Consider the setting of Exercise 2.3.3. Price and replicate an Asian\noption with payoff (cid:0) 1 \u0159T S (cid:1)K(cid:8) with K (cid:16) 10. Hint: The price is path dependent\nT(cid:0)1 t(cid:16)0 t (cid:0)\nand each path has a payoff.\n88 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\nExample 2.3.4 (Call and put option). Consider a call option with strike K and maturity\nT. Let the nonnegative integer k be such that S 0uk0(cid:1)1\u2113T(cid:1)k0(cid:0)1 \u0103 K \u010f S 0uk0\u2113T(cid:1)k0. Then,\n0\nV = S uT (cid:0)K\nT;T+1 0\nV t;t+1 . . .\nV 1;2 V t;t V T;k +1 = S 0uk 0lT(cid:0)k 0 (cid:0)K\n0\n.\nV .\n0 .\nV V 0\n1;1 t;2\nV t;1 . . .\n0\nFigure 2.3.9: Payoff of a call option in a binomial model; k is such that\n0\nS 0uk0(cid:1)1\u2113T(cid:1)k0(cid:0)1 \u0103 K \u010f S 0uk0\u2113T(cid:1)k0.\nby (2.3.3), we have\nT (cid:2) (cid:10)\n1 \u201a n\nVcall (cid:16) p\u03c0\u02c6 qn(cid:1)k p\u03c0\u02c6 qk pSk (cid:1)Kq.\n0 p1(cid:0)RqT k u \u2113 T\nk(cid:16)k0\nSimilarly, one can use (2.3.3) to obtain the price of a put option. However, given that we\nalready have the price of a call option in the above, one can find the price of a put option\n89 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\nby using the put-call parity (Proposition 1.3.3):\nK\nVput (cid:16) Vcall(cid:0) (cid:1)S\n0 0 p1(cid:0)RqT 0\n1 \u201aT (cid:2) n(cid:10) K (cid:1)E\u02c6 rS s\n(cid:16) p\u03c0\u02c6 qn(cid:1)k p\u03c0\u02c6 qk pSk (cid:1)Kq(cid:0) T\np1(cid:0)RqT k u \u2113 T p1(cid:0)RqT\nk(cid:16)k0\nk \u201a0(cid:1)1(cid:2) n(cid:10)\n(cid:16) p\u03c0\u02c6 qn(cid:1)k p\u03c0\u02c6 qk pK (cid:1)Skq.\nk u \u2113 T\nk(cid:16)0\nIn the above, we used the martingale property of the discounted asset price, (2.2.4), to write\nS (cid:16) E\u02c6 rS\u02c6 s (cid:16) E\u02c6rSTs . Then, we expanded the expectation to write\n0 T p1(cid:0)RqT\nT (cid:2) (cid:10)\n\u201a n\nK (cid:1)E\u02c6 rS s (cid:16) E\u02c6 rK (cid:1)S s (cid:16) p\u03c0\u02c6 qn(cid:1)k p\u03c0\u02c6 qk pK (cid:1)Skq.\nT T k u \u2113 T\nk(cid:16)0\n2.3.4 Dividend-paying stock\nStocks usually pay cash dividends to the shareholders. Then, it is up to the individual\nshareholders to decide whether to consume the cash dividend or invest it back into the\nmarket. The dividend policy is determined by the management of the company, but it\nis also influenced by the preference of the shareholders. Dividends are usually announced\nin advanced and are paid in a regular basis, quarterly, semiannually, annually and the\nlike. However, when the company announces unexpected high earnings, a special dividend\ncan be paid. Also, a regular dividend can be stopped if the earnings are unexpectedly\nlow. Dividends are announced as a cash amounts; however, for the ease of calculation, we\nmodel them as a percentage of the asset price, which is referred to as dividend yield and\nis a number in r0,1q. If the asset price at time t is S , then, after paying a dividend yield\nt\nof d P r0,1q, the asset price is reduced to p1(cid:1)d qS . Therefore, under the dividend policy\nt t t\nd ,...,d , the asset price dynamics in the binomial model follows\n1 n\nt\n\u017a\nS (cid:16) S H ...H p1(cid:1)d q,\nt 0 1 t i\ni(cid:16)1\nwhere H is a sequence of i.i.d. random variables with distribution\ni\n1(cid:0)R(cid:1)\u2113 u(cid:1)1(cid:1)R\nP\u02c6 pH (cid:16) uq (cid:16) and P\u02c6 pH (cid:16) \u2113q (cid:16) .\ni i\nu(cid:1)\u2113 u(cid:1)\u2113\n90 2. DISCRETE-TIME MARKETS 2.3. BINOMIAL MODEL\nIf we define H\u02dc (cid:16) H p1(cid:1)d q, the dividend policy makes the binomial model look like\ni i i\nS (cid:16) S H\u02dc ...H\u02dc .\nt 0 1 t\nSee Figure 2.3.10. Then, H\u02dc is distributed as\ni\n1(cid:0)R(cid:1)\u2113 u(cid:1)1(cid:1)R\nP\u02c6 pH\u02dc (cid:16) up1(cid:1)d qq (cid:16) and P\u02c6 pH\u02dc (cid:16) \u2113p1(cid:1)d qq (cid:16) .\ni i i i\nu(cid:1)\u2113 u(cid:1)\u2113\nRemark 2.3.6. It is important to notice that in this case, the no-arbitrage condition\nremains the same as \u2113 \u0103 1 (cid:0) R \u0103 u, the case where the underlying asset does not pay\nany dividend. Regarding the effect of dividend on the replicating portfolio, each dividend\npayment transfers the value invested in the risky asset into the risk-free zero bond. A period\nbefore a dividend yield of d P r0,1q, if the asset price is S, the investment in the risk-free\nzero bond is \u03b8 , and the investment in the risky asset is \u03b8 , the replicating portfolio solves\n0 1\na similar system of equations as for the case of no-dividend:\n$\n\u03b8 p1(cid:0)Rq(cid:0)\u03b8 dSu(cid:0)\u03b8 p1(cid:1)dqSu (cid:16) Vpt(cid:0)1,Sup1(cid:1)dqq\n\u2019 0 1 1\n\u2019loooooooooomoooooooooon loooooomoooooon\n\u2019\n&\nrisk-free risky .\n\u2019 \u2019 \u2019\u03b8 l0 oop o1 ooo(cid:0) oooR omq(cid:0) oooo\u03b8 o1 ood ooS on\u2113(cid:0)\u03b8 l1 oop o1 oo(cid:1) mod oq ooS on\u2113 (cid:16) Vpt(cid:0)1,S\u2113p1(cid:1)dqq\n%\nrisk-free risky\nOnewayofpricingcontingentclaimsondividend-payingassetsistointroduceanadjusted\nasset price with no dividend and transform the payoff in terms of the adjusted asset price.\nIf we define the adjusted asset price by S\u02dc :(cid:16) S H ...H , then S (cid:16) S\u02dc \u015bT p1(cid:1)d q. Then,\nt 0 1 t t t i(cid:16)1 i\nthe payoff of a European contingent claim given by gpS q is given in terms of S\u02dc by\nT T\ng(cid:0) S\u02dc \u015bT p1(cid:1)d q(cid:8) on the adjusted binomial asset S\u02dc . Then, the pricing of a contingent\nT i(cid:16)1 i T\nclaim with payoff gpS q at time t given S (cid:16) S is given by\nT t\nVpt,Sq :(cid:16) 1 E\u02c6 rgpS q | S (cid:16) Ss (cid:16) 1 E\u02c6(cid:17) g(cid:0) S\u02dc \u017aT p1(cid:1)d q(cid:8) | S (cid:16) S(cid:25)\np1(cid:0)RqT(cid:1)t T t p1(cid:0)RqT(cid:1)t T i t\nj(cid:16)t(cid:0)1\n1 \u201aT (cid:2) T (cid:1)t(cid:10) (cid:1) \u017aT (cid:9)\n(cid:16) \u03c0\u02c6i\u03c0\u02c6T(cid:1)t(cid:1)ig Sui\u2113T(cid:1)t(cid:1)i p1(cid:1)d q .\np1(cid:0)RqT(cid:1)t i u \u2113 j\ni(cid:16)t j(cid:16)t(cid:0)1\n(2.3.5)\nRemark 2.3.7. Notice that the price Vpt,Sq of a European contingent claim gpS q on a\nT\ndividend-paying underlying asset S is no longer a function of time-to-maturity \u03c4 (cid:16) T (cid:1)t.\n\u015bT\nThis is due to the term p1(cid:1)d q in (2.3.5), which cannot be expressed as a function\nj(cid:16)t(cid:0)1 i\nof \u03c4, unless d (cid:16) d for all i (cid:16) 1,...,T; then, \u015bT p1(cid:1)d q (cid:16) p1(cid:1)dq\u03c4.\ni j(cid:16)t(cid:0)1 i\n91 2.3. BINOMIAL MODEL 2. DISCRETE-TIME MARKETS\nS0un(1(cid:0)d1):::(1(cid:0)dn)\nS0u3(1(cid:0)d1)(1(cid:0)d2)(1(cid:0)d3) S0un(cid:0)1\u2113(1(cid:0)d1):::(1(cid:0)dn)\nS0u2(1(cid:0)d1)(1(cid:0)d2)\nS0u(1(cid:0)d1) S0u2\u2113(1(cid:0)d1)(1(cid:0)d2)(1(cid:0)d3) S0un(cid:0)2\u21132(1(cid:0)d1):::(1(cid:0)dn)\nS0 S0u\u2113(1(cid:0)d1)(1(cid:0)d2) . .\n.\nS0\u2113(1(cid:0)d1) S0u\u21132(1(cid:0)d1)(1(cid:0)d2)(1(cid:0)d3) S0u2\u2113n(cid:0)2(1(cid:0)d1):::(1(cid:0)dn)\nS0\u21132(1(cid:0)d1)(1(cid:0)d2)\nS0\u21133(1(cid:0)d1)(1(cid:0)d2)(1(cid:0)d3) S0u\u2113n(cid:0)1(1(cid:0)d1):::(1(cid:0)dn)\nS0\u2113n(1(cid:0)d1):::(1(cid:0)dn)\nFigure 2.3.10: Dividend-paying asset in a binomial model\nRemark 2.3.8. Recall that a regular dividend policy is announced in cash and not the\ndividend yield. This means for a high (low) asset price the cash dividend is equivalent to a\nsmall (large) dividend yield. A dividend cash of $D corresponds to a dividend yield of D,\nS\nwhere S is the predividend asset price. In addition, a bigger picture of dividend payments\nalso suggests that the companies can change their dividend policies based on certain random\nevents. Therefore, it is natural to assume that the divided policy is random. If the dividend\npolicy is Markovian, at each node of the binomial model at time t and price S pjq, the\nt\ndivided is a random variable dpt,S pjqq, for j (cid:16) 1,...,t (cid:0) 1, the pricing methodology is\nt\nsimilar to the Markovian European option. In the two-period binomial model in of Exercise\n2.3.6, Part (b) and Part (c) are special instances of Markovian dividends.\nIf the dividend policy is not Markovian, even for a Markovian asset-price model and a\nMarkovian contingent claim with payoff gpS q, the pricing is similar to pricing methodology\nT\n92 2.4. CALIBRATING THE PARAMETERS OF THE MODEL TO MARKET DATA:\n2. DISCRETE-TIME MARKETS THE BINOMIAL MODEL\nofpath-dependentoptions. Thisisbecausethemodifiedpayofftakestheformg(cid:0) S\u02dc \u015bT p1(cid:1)\n(cid:8) T t(cid:16)1\nd q , where d depends on S ,...,S . Therefore, pricing and hedging must be conducted\nt t t 0\nsimilar to Remark 2.3.5, Example 2.3.3 and Exercise 2.3.5.\nExercise 2.3.6. Consider a two-period binomial model for a risky asset with each period\nequal to a year and take S (cid:16) $10, u (cid:16) 1.15 and \u2113 (cid:16) 0.95. The interest rate for both periods\n0\nis R (cid:16) .05.\na) If the asset pays a 10% dividend yield in the first period and 20% in the second period,\nfind the price of a call option with strike K (cid:16) 8.\nb) Consider a more complicated dividend policy that pays a10% dividend yield only if\nthe price moves up and no dividend if the price moves down in each period. Find the\nprice of a call option with strike K (cid:16) 8.\nc) Finally, consider a dividend policy that pays $1 divided in the first period in each\nperiod. Find the price of a call option with strike K (cid:16) 8.\n2.4 Calibrating the parameters of the model to market data:\nthe binomial model\nCalibration is the practice of matching the parameters of a model to data. In the binomial\nmodel, the parameters are interest rate R, u, and \u2113. Calibrating the risk-free interest rate\nRisaseparatejobandusuallyusesthepricequotesofrisk-free(sovereign)zerobonds. For\nthe purposes of this section, we assume that the yield of a zero bond is already calibrated\nand satisfies R pt (cid:0) \u03b4q (cid:16) r\u03b4 (cid:0) op\u03b4q, where short rate r is constant and \u03b4 represents the\nt\nduration of one period in the binomial market. \u03b4 is usually small relative to the maturity\nT.\nData: price quote and return\nAssume that the asset price quotes are collected at \u03b4 time lapse; S ,...,S tabulates the\n(cid:1)m\u03b4 0\npast quotes of the asset price from time (cid:1)m\u03b4 until the present time t (cid:16) 0. We denote the\nquoted price by S to distinguish it from the random variable S for future price.\nThe arithmetic return and the logarithmic return at time t are defined by\nS (cid:1)S\nRarth :(cid:16) t(cid:0)\u03b4 t ,\nt S\nt\nand\n(cid:2) (cid:10)\nS\nRlog :(cid:16) ln t(cid:0)\u03b4 ,\nt S\nt\n93 2.4. CALIBRATION 2. DISCRETE-TIME MARKETS\nrespectively. If the time step \u03b4 is small, then the price movement S (cid:1)S is also small,\nt(cid:0)\u03b4 t\nand Rlog and Rarth are very close12. However, we will see that the small difference between\nt t\nthetworeturnswillshowupintheparameterestimation. Forthemoment, wefocusonthe\narithmeticreturnanddropthesuperscript\"arth\"forsimplicity. Wediscussthelogarithmic\nreturn (or log return) at the end of this section.\nFrom the data points S ,...,S , we obtain data points for the return, R ,...,R\n(cid:1)m\u03b4 0 (cid:1)m (cid:1)1\ngiven by\nS (cid:1)S\np(cid:1)k(cid:0)1q\u03b4 (cid:1)k\u03b4\nR :(cid:16) .\n(cid:1)k\nS\n(cid:1)k\u03b4\nNext, we will use this data to estimate some parameters of the market that are important\nin the calibration process.\nBinomial model with physical probability\nThe data on the quoted prices comes from the physical probability and not the risk-neutral\nprobability; see Remark 2.1.5. Therefore, for calibration, we need to present the binomial\nmodel with physical probability rather than the risk-neutral probability. While the nodes\nof the binomial model will not change, the probability must change; S (cid:16) S H and\nt(cid:0)1 t t(cid:0)1\ntH u8 is a sequence of i.i.d. random variables with the following distribution under\nt t(cid:16)1\nphysical measure\n#\nu with probability p\nH (cid:16) , for all t (cid:16) 0,1,.... (2.4.1)\nt\n\u2113 with probability 1(cid:1)p\nInthebinomialmodelunderphysicalprobabilitymeasure,thesequenceofreturnstR u8\nt t(cid:16)0\nalso makes a sequence of i.i.d. random variables. So, to proceed with calibration, we need\nto impose the same assumption on the data.\nAssumption 2.4.1. The return tR u8 is a sequence of i.i.d. random variables with the\nt t(cid:16)0\nmean and the variance given by by \u00b5\u03b4(cid:0)op\u03b4q and \u03c32\u03b4(cid:0)op\u03b4q, respectively.\nThedimensionlessquantities\u03c3 and\u00b5arerespectivelycalledthevolatility andmean return\nrate of the price.\nRemark 2.4.1. The assumption that volatility is a constant is not very realistic. However,\nthis assumption, which was widely used in practice in the 1970s and 1980s, makes the prob-\nlems more tractable. We will try later to test some approaches that relax this assumption\nin different directions.\n12lnp1(cid:0)xq(cid:19)x for small x\n94 2. DISCRETE-TIME MARKETS 2.4. CALIBRATION\nS u\n0\np\n8\n>>><U:=u(cid:0)1 withprobabilityp\nS R t=H t(cid:0)1=\n0 >>>:\nL:=\u2113(cid:0)1 withprobability1(cid:0)p\n1(cid:0)p\nS \u2113\n0\nFigure 2.4.1: Left: binomial model under physical probability. Right: arithmetic return\nR .\nt\nStatistical estimation of return and volatility\nWe proceed by introducing some basic statistical methods to estimate \u00b5 and \u03c3. The\nsimplest estimators for these parameters come from Assumption 2.4.1:\nm m\n1 \u201a 1 \u201a\n\u00b5\u02c6 (cid:16) R\u02c6 and \u03c3\u02c62 (cid:16) pR\u02c6 (cid:1)\u00b5\u02c6\u03b4q2.\n(cid:1)k (cid:1)k\n\u03b4m \u03b4pm(cid:1)1q\nk(cid:16)1 k(cid:16)1\nExercise2.4.1(Project). GotoGoogleFinance,YahooFinance,oranyotherfreedatabase\nthat provides free asset price quotes. Download a spreadsheet giving the daily price of a\nhighly liquid asset such as IBM, Apple, Alphabet, etc. Assuming Assumption 2.4.1, find the\nvolatility \u03c3 and the average return rate \u00b5 of the asset. Then, use these quantities to find\nthe daily, weekly, and yearly standard deviation and mean of the return.\nA calibration of the model parameters u, \u2113, and p\nWe match the first and second momentum of the binomial model with the mean return\nrate and volatility:\n#\npU (cid:0)p1(cid:1)pqL (cid:16) \u00b5\u03b4(cid:0)op\u03b4q\npU2(cid:0)p1(cid:1)pqL2(cid:1)ppU (cid:0)p1(cid:1)pqLq2 (cid:16) \u03c32\u03b4(cid:0)op\u03b4q\nOr, equivalently,\n#\npU (cid:0)p1(cid:1)pqL (cid:16) \u00b5\u03b4(cid:0)op\u03b4q\n(2.4.2)\npp1(cid:1)pqpU (cid:1)Lq2 (cid:16) \u03c32\u03b4(cid:0)op\u03b4q\nIn the above system of two equations, there are three unknowns U, L, and p, which give\nus one degree of freedom. We are going to use this degree of freedom by assuming that\nthe variance of return R under risk-neutral probability is also \u03c32\u03b4(cid:0)op\u03b4q;\nt\n\u03c0\u02c6 \u03c0\u02c6 pU (cid:1)Lq2 (cid:16) \u03c32\u03b4(cid:0)op\u03b4q, (2.4.3)\nu \u2113\n95 2.4. CALIBRATION 2. DISCRETE-TIME MARKETS\nwhere \u03c0\u02c6 (cid:16) 1(cid:0)R(cid:1)\u2113 (cid:16) R(cid:1)L.\nu u(cid:1)\u2113 U(cid:1)L\nRemark 2.4.2. Thisassumptionsuggeststhatthevarianceofreturnundertherisk-neutral\nprobability measure does not deviate significantly from the physical probability measure.\nWhether we are allowed to make such a strong assumption or not is debatable. However, ev-\nidences from financial economics as well as statistical modeling of financial markets suggest\nthatthisassumptionispracticalandsignificantlyuseful. Inaddition, inthecontinuous-time\nmodeling of financial markets, the assertion of this assumption becomes a conceptually deep\nresult. The reason this assumption will become clear later when we study continuous-time\nmodels, specifically the Black-Scholes model.\nTo simplify further, we also drop the op\u03b4q term from the equations. Therefore, we have a\nsystem of three equations and three unknowns.\n$\npU (cid:0)p1(cid:1)pqL (cid:16) \u00b5\u03b4\n\u2019\n&\npp1(cid:1)pqpU (cid:1)Lq2 (cid:16) \u03c32\u03b4\n\u2019\n% pU (cid:1)RqpR(cid:1)Lq (cid:16) \u03c32\u03b4\nFor the sake of simplicity, we set new variables\nU (cid:1)R R(cid:1)L R\n\u03b1 (cid:16) ? , \u03b2 (cid:16) ? , and r (cid:16) , (2.4.4)\n\u03b4\u03c3 \u03b4\u03c3 \u03b4\nwhere r is the annual interest rate (APR) calculated at periods \u03b4. Thus, we have\n$ ?\np\u03b1(cid:1)p1(cid:1)pq\u03b2 (cid:16) \u03bb \u03b4\n\u2019\n&\na\npp1(cid:1)pqp\u03b1(cid:0)\u03b2q (cid:16) 1 (2.4.5)\n\u2019\n%\u03b1\u03b2 (cid:16) 1\nHere \u03bb :(cid:16) \u00b5(cid:1)r.\n\u03c3\nRemark 2.4.3 (Riskpremium). The quantity \u00b5(cid:1)r is referred to as the risk premium of the\n\u03c3\nasset and measures the excess mean return of the asset adjusted with its level of riskiness\nmeasured by its volatility.\nThe solution to (2.4.5) is given by\nc 1(cid:1)p ? c p ? 1\n\u03b1 (cid:16) (cid:0)\u03bb \u03b4, \u03b2 (cid:16) (cid:1)\u03bb \u03b4, and p (cid:16) , (2.4.6)\np 1(cid:1)p 1(cid:0)x2\n0\nwhere x is the unique positive solution to the equation (see Figure 2.4.2)\n0\n1 ?\nx(cid:1) (cid:16) \u03bb \u03b4. (2.4.7)\nx\n96 2. DISCRETE-TIME MARKETS 2.4. CALIBRATION\nx(cid:0)x(cid:0)1\np\n(cid:21) (cid:14)\nx\nx\n0\n?\nFigure 2.4.2: Positive solution to equation x(cid:1) 1 (cid:16) \u03bb \u03b4.\nx\nThen, u and \u2113 are given by\n? ?\nu (cid:16) 1(cid:0)\u03b4r(cid:0) \u03b4\u03c3\u03b1, and \u2113 (cid:16) 1(cid:0)\u03b4r(cid:1) \u03b4\u03c3\u03b2. (2.4.8)\nRemark 2.4.4. The above calibration is well posed in the sense that, for any possible value\nof parameters \u03c3 \u0105 0, \u00b5, and r, one can find proper u and \u2113 such that \u2113 \u0103 1(cid:0)R \u0103 u in a\nunique fashion. Notice that in (2.3.3), the pricing of contingent claims is not affected by p,\nand thus p is the least important parameter in this context.\nExample 2.4.1 (Symmetric probabilities). We shall show that the following choice of\nparameters for the binomial model also provides a calibration; it satisfies the Assumption\n2.4.1.\nu (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3, \u2113 (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3 and p (cid:16) 1(cid:1) 1(cid:0)\u03bb? \u03b4(cid:9) .\n2\nFirst notice that\n$ &e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3 (cid:1)1 with probability 1(cid:1) 1(cid:0)\u03bb? \u03b4(cid:9)\n2\nR t (cid:16) %e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3 (cid:1)1 with probability 1(cid:1) 1(cid:1)\u03bb? \u03b4(cid:9)\n2\nTherefore,\nErR ts (cid:16)1(cid:2) (cid:1) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3 (cid:1)1(cid:9)(cid:1) 1(cid:0)\u03bb? \u03b4(cid:9) (cid:0)(cid:1) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3 (cid:1)1(cid:9)(cid:1) 1(cid:1)\u03bb? \u03b4(cid:9)(cid:10) .\n2\n97 2.4. CALIBRATION 2. DISCRETE-TIME MARKETS\nWe use ex (cid:16) 1(cid:0)x(cid:0) x2 (cid:0) x3 (cid:0)(cid:4)(cid:4)(cid:4), to write\n2! 3!\n1(cid:2) (cid:1) \u03c32 ? \u03b4\u03c32 (cid:9)(cid:1) ? (cid:9)\nErR s (cid:16) \u03b4pr(cid:1) q(cid:0) \u03b4\u03c3(cid:0) (cid:0)op\u03b4q 1(cid:0)\u03bb \u03b4\nt\n2 2 2\n(cid:1) \u03c32 ? \u03b4\u03c32 (cid:9)(cid:1) ? (cid:9)(cid:10)\n(cid:0) \u03b4pr(cid:1) q(cid:1) \u03b4\u03c3(cid:0) (cid:0)op\u03b4q 1(cid:1)\u03bb \u03b4\n2 2\n\u03c32 \u03c32\n(cid:16)\u03b4pr(cid:1) (cid:0) (cid:0)\u03bb\u03c3q(cid:0)op\u03b4q (cid:16) \u00b5\u03b4(cid:0)op\u03b4q\n2 2\nRecall that \u03bb\u03c3 (cid:16) \u00b5(cid:1)r. On the other hand,\nErR2 ts (cid:16)1 2(cid:2) (cid:1) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3 (cid:1)1(cid:9)2(cid:1) 1(cid:0)\u03bb? \u03b4(cid:9) (cid:0)(cid:1) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3 (cid:1)1(cid:9)2(cid:1) 1(cid:1)\u03bb? \u03b4(cid:9)(cid:10)\n1(cid:2) (cid:1) (cid:9)(cid:1) ? (cid:9) (cid:1) (cid:9)(cid:1) ? (cid:9)(cid:10)\n(cid:16) \u03b4\u03c32(cid:0)op\u03b4q 1(cid:0)\u03bb \u03b4 (cid:0) \u03b4\u03c32(cid:0)op\u03b4q 1(cid:1)\u03bb \u03b4 (cid:16) \u03c32\u03b4(cid:0)op\u03b4q.\n2\nExercise 2.4.2 (Subjective return). Show that the following choice of parameters for the\nbinomial model also provides a calibration; it satisfies the Assumption 2.4.1.\ne\u03b4\u03bd(cid:0)? e\u03b4\u03bd(cid:1)? 1(cid:1) 1(cid:0)(cid:0)\u00b5(cid:1)\u03bd \u03c3(cid:8)? \u03b4(cid:9)\nu (cid:16) \u03b4\u03c3, \u2113 (cid:16) \u03b4\u03c3 and p (cid:16) (cid:1) ,\n2 \u03c3 2\nwhere \u03bd is a real number. Find the range of \u03bd in terms of other parameters such that there\nis no arbitrage.\nCalibration the binomial model for the purpose of pricing contingent claims\nEstimating rate of return is often a more difficult task than estimating volatility. Methods\nsuch as the CAPM13 have been developed to approximate the rate of return. However,\nif the calibration is only used for option pricing, we often do not need the rate of return.\nRecall that under risk-neutral probability, the return of a binomial asset is equal to the\nyield of a zero bond, which is already estimated through the bond market data;\npu(cid:1)1qp1(cid:0)R(cid:1)\u2113q(cid:0)p\u2113(cid:1)1qpu(cid:1)1(cid:1)Rq\nE\u02c6 rR s (cid:16) E\u02c6 rH (cid:1)1s (cid:16) pu(cid:1)1q\u03c0\u02c6 (cid:0)p\u2113(cid:1)1q\u03c0\u02c6 (cid:16) (cid:16) R.\nt t u \u2113\nu(cid:1)\u2113\nTherefore, if we only calibrate the binomial model under risk-neutral probability, the rate\nof return under physical probability is irrelevant.\nWe impose the following assumption on the distribution of the return process under the\nrisk-neutral probability and use it to calibrate the binomial model under risk-neutral prob-\nability using data to estimate the volatility only.\n13the capital asset pricing model\n98 2. DISCRETE-TIME MARKETS 2.4. CALIBRATION\nAssumption 2.4.2. The arithmetic return tR u8 is a sequence of independent random\nt t(cid:16)0\nvariables under risk-neutral probability P\u02c6 with mean E\u02c6 rR s (cid:16) r\u03b4 (cid:0) op\u03b4q and v\u02c6arpR q (cid:16)\nt t\n\u03c32\u03b4(cid:0)op\u03b4q.\nThis assumption implies the assumption that we imposed earlier in (2.4.3).\nGiven r and R (cid:16) r\u03b4(cid:0)op\u03b4q, the only equation that we obtain is\npU (cid:1)RqpR(cid:1)Lq (cid:16) \u03c32\u03b4.\nHere, we drop the op\u03b4q term for simplicity. If we define \u03b1 (cid:16) U ?(cid:1)R and \u03b2 (cid:16) R ?(cid:1)L, we have\n\u03b4\u03c3 \u03b4\u03c3\n\u03b1\u03b2 (cid:16) 1. Any choice for \u03b1 leads to \u03b2 (cid:16) 1, and therefore, is a calibration of the binomial\n\u03b1\nmodel. We obtain a calibration similar to (2.4.8):\n? ?\nu (cid:16) 1(cid:0)\u03b4r(cid:0) \u03b4\u03c3\u03b1, and \u2113 (cid:16) 1(cid:0)\u03b4r(cid:1) \u03b4\u03c3\u03b2.\nHere, \u03b1 and \u03b2 are different than in 2.4.8.\nRemark 2.4.5. In practice, Assumption 2.4.2 is too good to be true. In fact, most of\nthe arguments for calibration of the parameters hold without appealing to such a strong\nassumption. The main use of this assumption in this section is to estimate parameters\n\u00b5 and \u03c3, the mean return and volatility. One can find estimation of these parameters by\nassuming that there exists a martingale tM u8 such that R (cid:1)r\u03b4 (cid:16) M (cid:1)M .\nt t(cid:16)0 t t(cid:0)1 t\nTime-varying return and volatility\nAssumption 2.4.1, which asserts that tR u is a sequence of i.i.d. random variables, is not\nt t\nrealistic in some situations and must be relaxed. Several empirical studies show that the\nvolatility is not constant. This removes the \"identical distribution\" of the return sequence.\nThe independence condition also does not have an empirical basis. In this section, we keep\ntheindependenceassumptionbutremovethepartthatsaystR u isidenticallydistributed.\nt t\nWealsoallowfortheinterestratetodependontimeR (cid:16) r \u03b4. Undereitherofthefollowing\nt t\nassumptions, we can derive a calibration of the form\n? ?\nu (cid:16) 1(cid:0)\u03b4r (cid:0) \u03b4\u03c3 \u03b1 , and \u2113 (cid:16) 1(cid:0)\u03b4r (cid:1) \u03b4\u03c3 \u03b2 . (2.4.9)\nt t t t t t t t\nAssumption 2.4.3. The arithmetic return tR u is a sequence of independent random\nt t\nvariables with mean ErR s (cid:16) \u00b5 \u03b4(cid:0)op\u03b4q and varpR q (cid:16) \u03c32\u03b4(cid:0)op\u03b4q.\nt t t t\nAssumption 2.4.4. The arithmetic return tR u is a sequence of independent random\nt t\nvariables under risk-neutral probability P\u02c6 with mean E\u02c6 rR s (cid:16) \u00b5 \u03b4 (cid:0) op\u03b4q and v\u02c6arpR q (cid:16)\nt t t\n\u03c32\u03b4(cid:0)op\u03b4q.\nt\n99 2.4. CALIBRATION 2. DISCRETE-TIME MARKETS\nAssumption 2.4.3 allows for the parameters \u00b5 and \u03c3 to vary over time. Therefore, the\ncalibrationinSection 2.4, shouldbemodifiedsuchthat \u03b1, \u03b2, and p varyintimeandsatisfy\n$ ?\np \u03b1 (cid:1)p1(cid:1)p q\u03b2 (cid:16) \u03bb \u03b4\n\u2019 t t t t t\n&\na\np p1(cid:1)p qp\u03b1 (cid:0)\u03b2 q (cid:16) 1 .\nt t t t\n\u2019\n%\u03b1 \u03b2 (cid:16) 1\nt t\nHere \u03bb :(cid:16) \u00b5t(cid:1)rt. If \u00b5, \u03c3, and r vary with time but \u03bb remain does not, the calibration in\nt \u03c3t\n(2.4.9), becomes slightly simpler, because \u03b1 and \u03b2 does not depend on time.\n? ?\nu (cid:16) 1(cid:0)\u03b4r (cid:0) \u03b4\u03c3 \u03b1, and \u2113 (cid:16) 1(cid:0)\u03b4r (cid:1) \u03b4\u03c3 \u03b2. (2.4.10)\nt t t t t t\nAssumption 2.4.4 provides a different calibration of the same form as (2.4.10) but without\nassuming that \u03bb is time-invariant. Here, we can arbitrarily choose \u03b1 and \u03b2 (cid:16) 1.\n\u03b1\nEstimating time-varying parameters falls into the time series analysis which is beyond the\nscope of this book. For more details on the estimation of financial time series, see [14].\n100 3. CONTINUOUS MARKETS\n3\nModeling financial assets in\ncontinuous-time\nIn 1900, Louis Bachelier introduced the first asset price model and pricing method for\nderivatives in his Ph.D. dissertation titled \u201cThe theory of speculation\u201d [2]. Although this\nmodel is now considered impractical, its educational implications of this model are still im-\nportant. Bachelier modeled the discounted asset price by a Brownian motion. As seen in\nSectionB.5,theBrownianmotionistheweaklimitofanormalizedrandomwalk. InBache-\nlier\u2019stime, theBrownianmotionhadnotyetbeenrigorouslydefined. However, manyofits\nproperties were well understood. Bachelier\u2019s contribution to the theory of probability and\nstochastic processes was to use heat equation in derivative pricing. However, this contribu-\ntion was neglected for about thirty years, until Andrey Nikolaevich Kolmogorov employed\npartial differential equations to describe a class of stochastic processes called diffusion pro-\ncesses. Kolmogorovisthefirstmathematiciantobringprobabilityintorigorbyestablishing\nits mathematical foundation. Other mathematicians who built upon Kolmogorov\u2019s work\ninclude Norbert Wiener, the first to discover the path properties of Brownian motion, Paul\nL\u00e9vy, who provided a simple characterization of Brownian motion, and Kiyosi It\u00f41, who\nintroduced a simple representation of diffusion processes in terms of Brownian motion.\nThe Bachelier model has a major drawback: asset price in this model can take negative\nvalues, which will be discussed in more details in Section 3.2.3. Almost fifty years after\nBachelier, Paul Samuelson, an economist, suggested to use geometric Brownian motion\n(GBM) to model the price of assets. GBM never takes nonpositive values for the asset\nprice, and therefore, does not suffer from the major drawback of Bachelier model. GBM is\nalso known as Black-Scholes model, named after Fischer Black and Myron Scholes. Black\nand Scholes in [5] and Robert Merton in [22] independently developed a pricing method for\nderivatives under the GBM. For a through review of Bachelier\u2019s efforts and contribution\n1You may find different romanization of Kiyosi such as Kiyoshi, and different romanization It\u00f4 such as\nIt\u00afo, Itoh, or Ito. According to Wikipedia, he himself ued the spelling Kiyosi It\u00f4.\n101 3.1. TRADING AND ARBITRAGE IN CONTINUOUS-TI3M. ECMONATRINKUEOTUSS MARKETS\nsee [26]. For a brief history of asset price models, see [25]. For Bachelier\u2019s biography of see\n[29].\n3.1 Trading and arbitrage in continuous-time markets\nRecall from Section II.2.2.2 that in a discrete-time market, where trading occurs at points\nt (cid:16) 0 \u0103 t \u0103 ... \u0103 t (cid:16) T in time, the value of the portfolio generated by the strategy\n0 1 N\n\u2206 ,\u2206 ,...,\u2206 is given by\n0 t1 tN(cid:1)1\nn(cid:1)1 n(cid:1)1\n\u201a \u201a\nW (cid:16) W (cid:0) R pW (cid:1)\u2206 S q(cid:0) \u2206 pS (cid:1)S q.\ntn 0 i ti ti ti ti ti(cid:0)1 ti\ni(cid:16)0 i(cid:16)0\nHere, R is the interest rate for the period of time rt ,t s which can be taken to be\ni i i(cid:0)1\nrpt (cid:1)t q, where r is the short rate. For i (cid:16) 0,...,N (cid:1)1, the strategy \u2206 is a function of\ni(cid:0)1 i ti\nthe history of the asset price, tS : u \u010f t u. Therefore,\nu i\nn(cid:1)1 n(cid:1)1\n\u201a \u201a\nW (cid:16) W (cid:0)r pW (cid:1)\u2206 S qpt (cid:1)t q(cid:0) \u2206 pS (cid:1)S q.\ntn 0 ti ti ti i(cid:0)1 i ti ti(cid:0)1 ti\ni(cid:16)0 i(cid:16)0\nIf we take t (cid:1)t :(cid:16) \u03b4 (cid:16) T and let \u03b4 (cid:209) 0, we obtain the Riemann integral\ni(cid:0)1 i N\nN \u201a(cid:1)1 \u017cT\nlimr pW (cid:1)\u2206 S qpt (cid:1)t q (cid:16) r pW (cid:1)\u2206 S qdt,\nti ti ti i(cid:0)1 i t t t\n\u03b4(cid:209)0 i(cid:16)0 0\nwhich is the accumulated net change in the portfolio due to investment in the risk-free\nasset. The limit of the second term\nn(cid:1)1\n\u201a\n\u2206 pS (cid:1)S q\nti ti(cid:0)1 ti\ni(cid:16)0\ndoes not necessarily exist unless we enforce proper assumptions on the asset price S. For\ninstance if the asset price follows Brownian motion (the Bachelier model) or GBM (the\nBlack-Scholesmodel), thenthelimitexistsandisinterpretedasastochasticIt\u00f4integral. If\nthe stochastic integral above is well defined, the wealth generated by the trading strategy\nt\u2206u follows\nt\u011b0\n\u017ct \u017ct\nW (cid:16) W (cid:0)r pW (cid:1)\u2206 S qds(cid:0) \u2206 dS . (3.1.1)\nt 0 s s s s s\n0 0\n\u015ft\nWe choose the same notion p\u2206(cid:4)Sq :(cid:16) \u2206 dS for the stochastic integral in continuous\nt 0 s s\ntime. Notice that in the discrete-time setting, the strategy \u2206 at time t is a function of the\ni\npast history of the asset price S ,...,S . When we pass to the limit, the trading strategy\n0 ti\n102 3. CONTINUOUS MARKETS 3.1. TRADING AND ARBITRAGE\n\u2206 at time t, depends only on the paths of the asset until time t, tS : u \u010f tu. In other\nt u\nwords, a trading strategy does not use any information from the future.\nFollowingthediscussioninSectionC.1,specifically(C.1),thestochasticintegralisdefined\nonly in the almost surely sense and can only be defined on the sample paths of the asset\nprice model S. Therefore, a probability space p\u2126,F,Pq is needed. It is convenient to take\nthe sample path space with a proper \u03c3-field and a probability measure:\n\u2126 :(cid:16) tS : t (cid:209) S p\u03c9q : for each outcome \u03c9u\nt\nThen, the notion of arbitrage is defined as follows:\nDefinition 3.1.1. A (weak) arbitrage opportunity is a portfolio \u2206 such that\na) W (cid:16) 0,\n0\nb) W \u011b 0 a.s., and\nT\nc) W \u0105 0 on a set of sample paths with positive P probability.\nT\nA strong arbitrage opportunity is a portfolio \u2206 such that\na) W \u0103 0 a.s., and\n0\nb) W \u011b 0 a.s.\nT\n\u015ft\nGiven that the stochastic integral p\u2206(cid:4)Sq (cid:16) \u2206 dS is defined in a probability space\nt 0 s s\np\u2126,Pq, the fundamental theorem of asset pricing (FTAP) for continuous time is as follows.\nTwo probabilities P\u02c6 and P are called equivalent if any event with probability zero under\none of them has probability zero under the other, i.e., P\u02c6 pAq (cid:16) 0 if and only if PpAq (cid:16) 0.\nTheorem 3.1.1 (Fundamental theorem of asset pricing (FTAP)). There is no weak ar-\nbitrage opportunity in a continuous-time model if and only if there exists a probability P\u02c6,\nnamely risk-neutral probability or martingale probability, equivalent to P such that S is a\nP\u02c6-(local) martingale2.\nRecall that a market model is called complete if any contingent claim is replicable, i.e.,\nfor any F-measurable payoff X, there exists a strategy \u2206 :(cid:16) t\u2206 uT such that the wealth\nt t(cid:16)0\nW generated by \u2206 in (3.1.1) satisfies W (cid:16) X.\nT\nCorollary 3.1.1. Under the same setting as in Theorem 3.1.1, the market is complete if\nand only if there is a unique risk-neutral probability.\n2local martingale is roughly a martingale without condition (a) in Definition B.15.\n103 3.2. BACHELIER\u2019S CONTINUOUS-TIME MARKET 3. CONTINUOUS MARKETS\n3.2 Bachelier\u2019s continuous-time market\nWe start by recalling the properties of a Brownian motion from Section B.5. A standard\nBrownian motion is a stochastic process such that B (cid:16) x P Rd and characterized by the\n0\nfollowing properties.\n1) B has continuous sample paths.\n2) When s \u0103 t, the increment B (cid:1)B is a normally distributed random variable with\nt s\nmean 0 and variance t(cid:1)s and is independent of tB : for all u \u010f su.\nu\nThe Bachelier model is based on an assumption made by Bachelier himself in his PhD\ndissertation\u201cTh\u00e9orie de la sp\u00e8culation\u201d ([2]):\nL\u2019esp\u00e8rance math\u00e9matique de l\u2019acheteur de prime est nulle (page 33) (3.2.1)\nwhichtranslatesas\u201cThemathematicalexpectationofthebuyeroftheassetiszero\u201d. Inthe\nmodern probabilistic language, what Bachelier meant is that the discounted asset price is\na martingale under a unique risk-neutral probability, which is equivalent to no arbitrage\ncondition by the FTAP in [9]. Without any discussion on the physical probability mea-\nsure, the Bachelier model simply takes the discounted asset price under the risk-neutral\nprobability as a factor of a standard Brownian motion, i.e.\nS\u02c6 (cid:16) e(cid:1)rtS (cid:16) S (cid:0)\u03c3B , \u03c3 \u0105 0. (3.2.2)\nt t 0 t\nTherefore under risk-neutral probability, S\u02c6 has a Gaussian distribution with mean S and\nt 0\nvariance \u03c32t, and the pdf of S\u02c6 is given by\nt\n(cid:2) q2(cid:10)\n1 px(cid:1)S\nf pxq (cid:16) ? exp (cid:1) 0 for x P R and t \u0105 0. (3.2.3)\nS\u02c6 t \u03c3 2\u03c0t 2\u03c32t\nThe price of the underlying asset in the Bachelier model is given by S (cid:16) ertpS (cid:0)\u03c3B q.\nt 0 t\nUnder risk-neutral probability, S is also a Gaussian random variable with\nt\nE\u02c6 rS s (cid:16) S ert, and varpS q (cid:16) \u03c32e2rtt.\nt 0 t\nTherefore, therisk-neutralexpectedvalueoftheassetpriceincreasesinasimilarfashionas\na risk-free asset. The variance of S increases exponentially quickly in time, too. It follows\nt\nfrom applying the It\u00f4 formula (C.4) to fpt,xq (cid:16) ertpS (cid:0)\u03c3xq that S satisfies the SDE\n0 t\ndS (cid:16) rS dt(cid:0)\u03c3ertdB . (3.2.4)\nt t t\nInherited from the Brownian motion, the Bachelier model possesses the same properties\nas the binomial model in Section 2.3.2:\n104 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\n1) time homogeneity and\nThe conditional distribution of S\u02c6 given S\u02c6 (cid:16) S equals the distri-\nt s\nbution of S\u02c6 with S\u02c6 (cid:16) S\nt(cid:1)s 0\n2) Markovian.\nIn using the available information up to time s to make\nprojections about the future, the only relevant part is\nthe asset price at current time S\u02c6 (or, equivalently S ).\ns s\nE\u02c6 rfpS\u02c6 q | S\u02c6 , u \u010f ss (cid:16) ErfpS\u02c6 q | S\u02c6 s, @0 \u010f s \u0103 t.\nt u t s\nThe condition tS\u02c6 , u \u010f su (or S\u02c6 ) in the above conditional expectations can simply be\nu s\nreplaced by tS , u \u010f su (or S ). Because both sets of random variables generate the same\nu s\n\u03c3-field F :(cid:16) \u03c3(cid:0) S : u \u010f s(cid:8) :\ns u\nE\u02c6 r(cid:4) | F s (cid:16) E\u02c6 r(cid:4) | S s.\ns s\nItisimportanttoknowthattheBacheliermodelisnot practicallyinterestinginmodeling\nfinancial markets. However, for educational purposes, it has all the basic components of\nthe more practical Black-Scholes model. Pricing a European option in the Bachelier model\nisequivalenttosolvingaheatequation, asimpleparabolicpartialdifferentialequation. On\none hand, the heat equation also appears in the simplification of the Black-Scholes model.\nOn the other hand, most of the knowledge and techniques used in the heat equation can\nalso be applied to other forms of parabolic partial differential equations that appear in\nmore general models.\n3.2.1 Pricing and replicating contingent claims in the Bachelier model\nAs a result of quote (3.2.1), Bachelier concluded that the price of a European contingent\nclaim with payoff gpS q is simply the discounted expectation of the payoff under the risk-\nT\nneutral probability, i.e.\nV (cid:16) e(cid:1)rTE\u02c6 rgpS qs. (3.2.5)\n0 T\nIn addition, given the past history of asset price F :(cid:16) \u03c3(cid:0) S : u \u010f t(cid:8) , the price of this\nt u\noption at time t is given by\nV (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS q | F s. (3.2.6)\nt T t\nThis is inline with the fundamental theorem of asset pricing that asserts the equivalency\nof no arbitrage condition with the existence of a risk-neutral probability. Precisely, the\ndiscounted price of an option with payoff gpS q must be a martingale:\nT\ne(cid:1)rtV (cid:16) e(cid:1)rTE\u02c6 rV | F s (cid:16) e(cid:1)rTE\u02c6 rgpS q | F s. (3.2.7)\nt T t T t\n105 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nPrice of a contingent claim at time zero\nSince under risk-neutral probability S (cid:16) erTS\u02c6 is a Gaussian random variable with mean\nT T\nerTS and variance e2rT\u03c32T, one can explicitly calculate V in cases where the following\n0 0\nintegral can be given in a closed-form:\n?e(cid:1)rT \u017c8 g(cid:0) erTx(cid:8) e(cid:1)px 2(cid:1) \u03c3S 20 Tq2\nV (cid:16) dx. (3.2.8)\n0\n\u03c3 2\u03c0T\n(cid:1)8\nWe start off by providing a closed-form solution for the Bachelier price of vanilla options.\nExample 3.2.1 (Price of call and put in the Bachelier model). Let gpS q (cid:16) pS (cid:1)Kq (cid:16)\nT T (cid:0)\nerTpS\u02c6 (cid:1)K\u02c6 q , where K\u02c6 (cid:16) e(cid:1)rTK. Since S\u02c6 (cid:18) NpS ,\u03c32Tq, the price Vcall can be calculated\nT (cid:0) T 0 0\nin closed form.\nV 0call (cid:16) \u03c3?e(cid:1) 2r \u03c0T \u017c8 (cid:0) erTx(cid:1)K(cid:8) (cid:0)e(cid:1)px 2(cid:1) \u03c3S 20 Tq2 dx\nT\n(cid:1)8\n?1 \u017c8 (cid:1) x(cid:1)K\u02c6(cid:9) e(cid:1)px 2(cid:1) \u03c3S 20 Tq2\n(cid:16) dx\n\u03c3 2\u03c0T (cid:1)8 (cid:0)\n?1 \u017c8(cid:1) x(cid:1)K\u02c6(cid:9) e(cid:1)px 2(cid:1) \u03c3S 20 Tq2\n(cid:16) dx.\n\u03c3 2\u03c0T K\u02c6\nBy the change of variable y (cid:16) x(cid:1)?S0, we obtain\n\u03c3 T\nV 0call (cid:16) ? ?1 \u017c p8 Tq(cid:1) \u03c3? Ty(cid:0)S 0(cid:1)K\u02c6(cid:9) e(cid:1)y 22 dy\n2\u03c0 K\u02c6(cid:1)S0q{p\u03c3?\n\u03c3 T \u017c8 ye(cid:1)y 22 S 0 ?(cid:1)K\u02c6 \u017c8 e(cid:1)y 22\n(cid:16) ? dy(cid:0) dy\n2\u03c0 pK\u02c6(cid:1)S0q{p\u03c3? 2\u03c0 pK\u02c6(cid:1)S0q{p\u03c3?\nTq Tq\nThe second integral above can be calculated in terms of the standard Gaussian cdf \u03a6pxq :(cid:16)\n?1 \u015fx e(cid:1)y2{2dy:\n2\u03c0 (cid:1)8\n?1 \u017c8 e(cid:1)y 22 1(cid:1)\u03a6(cid:1)K\u02c6 ?(cid:1)S 0(cid:9) \u03a6(cid:1)S 0 ?(cid:1)K\u02c6(cid:9)\ndy (cid:16) (cid:16) .\n\u03c3 2\u03c0T pK\u02c6(cid:1)S0q{p\u03c3? \u03c3 T \u03c3 T\nTq\nHere, we used \u03a6pxq (cid:16) 1(cid:1)\u03a6p(cid:1)xq.\n106 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\ny2\nThe first integral can be evaluated by the change of variable u (cid:16) .\n2\n\u017c8 \u017c8\n?1 ye(cid:1)y 22 ?1 ye(cid:1)y 22\ndy (cid:16) dy\n2\u03c0 pK\u02c6(cid:1)S0q{p\u03c3? 2\u03c0 |S0(cid:1)K\u02c6|{p\u03c3?\nTq Tq\n(cid:1)?1 e(cid:1)y 22(cid:7) (cid:7) (cid:7)8 ?1 e(cid:1)pS 20 \u03c3(cid:1) 2K T\u02c6q2 \u03a61(cid:1)S 0 ?(cid:1)K\u02c6(cid:9)\n(cid:16) (cid:16) (cid:16) ,\n2\u03c0 (cid:7) |S0(cid:1)K\u02c6|{p\u03c3? 2\u03c0 \u03c3 T\nTq\nwhere \u03a61pxq (cid:16) ?1 e(cid:1)x 22 is the standard Gaussian pdf.\n2\u03c0\nTo summarize, we have\n?\nVcall (cid:16) \u03c3 T (cid:0) \u03a61pdq(cid:0)d\u03a6pdq(cid:8) , (3.2.9)\n0\nS0?(cid:1)K\u02c6\nwhere d (cid:16) . By the put-call parity, we have\n\u03c3 T\n?\nVput (cid:16) K\u02c6 (cid:1)S (cid:0)Vcall (cid:16) \u03c3 T (cid:0) \u03a61pdq(cid:1)d\u03a6p(cid:1)dq(cid:8) .\n0 0 0\nExample 3.2.2. A digital call option is an option with payoff\n#\n1 S \u011b K\nT\ngpS q (cid:16) 1 (cid:16) .\nT tST\u011bKu\n0 S \u0103 K\nT\nA digital put has payoff 1 .\ntST\u010fKu\nThe Bachelier price of a digital call option with strike K is given by\n(cid:17) (cid:25) (cid:1) (cid:9)\nVdigit-c (cid:16) e(cid:1)rTE\u02c6 1 (cid:16) e(cid:1)rTP\u02c6 S \u011b K .\n0 tST\u011bKu T\nNotice that S \u011b K is equivalent to ?Bt (cid:16) S\u02c6 t(cid:1)?S0 \u011b e(cid:1)rtK ?(cid:1)S0, where B is the Brownian\nT t\nt \u03c3 t \u03c3 t\nmotion at time t. Therefore, S\u02c6 t?(cid:1)S0 (cid:16) ?Bt is a standard Gaussian random variable. We can\nt t\nwrite\n(cid:1) (cid:9)\nVdigit-c (cid:16) e(cid:1)rT 1(cid:1)\u03a6(cid:0) (cid:1)d(cid:8) (cid:16) e(cid:1)rT\u03a6(cid:0) d(cid:8) .\n0\nS0?(cid:1)K\u02c6\nHere, d (cid:16) is the same as in Example 3.2.1.\n\u03c3 T\nExercise 3.2.1. Find a closed-form solution for the Bachelier price of a digital put option\nwith strike K.\nExercise 3.2.2. Find a closed-form solution for the Bachelier price of a European option\nwith payoff in Figure (3.2.1)\n107 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\ng(S)\na\n15\nS\nK\nFigure 3.2.1: All slopes are -1 or 1.\nThe price at an arbitrary point in time: the Markovian property of the option\nprice\nRecall from (3.2.6) that the option price V at time t is a random variable given by\nt\nV (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgperTS\u02c6 q | F s (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgperTS\u02c6 q | S : u \u010f ts.\nt T t T u\nSince Brownian motion B is a Markovian process, the only relevant information from the\npast is the most recent asset price, S . Therefore,\nt\nV (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgperTS\u02c6 q | S\u02c6 s (cid:16): Vpt,S\u02c6 q,\nt T t t\nwhere the function Vpt,xq is given by\nVpt,xq (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgperTS\u02c6 q | S\u02c6 (cid:16) xs\nT t\ne(cid:1)r\u03c4 \u017c8 g(cid:0) erTy(cid:8) e(cid:1)px 2(cid:1) \u03c32y \u03c4q2 (3.2.10)\n(cid:16) a dy.\n2\u03c0pT (cid:1)tq\n(cid:1)8\nThesecondequalityintheaboveisbecausegivenS\u02c6 (cid:16) x, S\u02c6 isaGaussianrandomvariable\nt T\nwith pdf\nf S\u02c6 Tpy | S\u02c6 t (cid:16) xq (cid:16) a 2\u03c0p1 (cid:1)tqe(cid:1) 2\u03c3px 2(cid:1) pTy (cid:1)q2 tq.\nT\nThe function Vpt,xq is called a pricing function, which provides the price of the contingent\nclaim in terms of time t and the discounted price S .\nt\nRemark 3.2.1. It is simpler in the Bachelier model to write the pricing function V as a\nfunction of the discounted asset price, which is a Brownian motion, rather than the asset\nprice.\n108 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nTime homogeneity of the option price\nBythetimehomogeneityoftheBrownianmotion,thepricingfunctionisactuallyafunction\nof time-to-maturity \u03c4 (cid:16) T (cid:1)t and the discounted underlying price S\u02c6 (cid:16) x. Because, S\u02c6\nt T\nconditional on S\u02c6 (cid:16) x has the same distribution as S\u02c6 conditional on S\u02c6 (cid:16) x, then\nt \u03c4 0\nVpt,xq (cid:16) e(cid:1)r\u03c4E\u02c6 rgperTS\u02c6 q | S\u02c6 (cid:16) xs (cid:16): Up\u03c4,xq. (3.2.11)\n\u03c4 0\nExample 3.2.3 (Vanilla options). Recall that in the Bachelier model, we have S\u02c6 (cid:16)\nT\nS\u02c6 (cid:0)\u03c3pB (cid:1)B q. The payoff of the call option can be written as\nt T t\npS (cid:1)Kq (cid:16) erTpS\u02c6 (cid:1)K\u02c6 q (cid:16) erTpS\u02c6 (cid:0)\u03c3pB (cid:1)B q(cid:1)K\u02c6 q .\nT (cid:0) T (cid:0) t T t (cid:0)\nHere, K\u02c6 (cid:16) e(cid:1)rTK. Given S\u02c6 (cid:16) x,\nt\nUcallp\u03c4,xq (cid:16) e(cid:1)r\u03c4E\u02c6 rerTpS\u02c6 (cid:0)\u03c3pB (cid:1)B q(cid:1)K\u02c6 q | S\u02c6 (cid:16) xs.\nt T t (cid:0) t\nSince B (cid:1)B and S\u02c6 (cid:16) \u03c3B are independent random variables, we have\nT t t t\nUcallp\u03c4,xq (cid:16) e(cid:1)r\u03c4E\u02c6 rerTpx(cid:0)\u03c3pB (cid:1)B q(cid:1)K\u02c6 q s.\nT t (cid:0)\nBecause B (cid:1)B is a Gaussian random variable with mean zero and variance \u03c4 (cid:16) T (cid:1)t,\nT t\nwe have\nUcallp\u03c4,xq (cid:16) e ?(cid:1)r\u03c4 \u017c8 erT (cid:1) x(cid:0)y(cid:1)K\u02c6(cid:9) e(cid:1) 2\u03c3y 22 \u03c4dy\n\u03c3 2\u03c0\u03c4 (cid:1)8 (cid:0)\n(cid:16) e ?(cid:1)r\u03c4 \u017c8 erT (cid:1) x(cid:0)y(cid:1)K\u02c6(cid:9) e(cid:1) 2\u03c3y 22 \u03c4dy\n\u03c3 2\u03c0\u03c4 K\u02c6(cid:1)x (cid:0)\n(cid:16) erT (cid:2) px(cid:1)K\u02c6 q e ?(cid:1)r\u03c4 \u017c8 e(cid:1) 2\u03c3y 22 \u03c4dy(cid:0)\u017c8 ye(cid:1) 2\u03c3y 22 \u03c4dy.(cid:10)\n\u03c3 2\u03c0\u03c4 K\u02c6(cid:1)x K\u02c6(cid:1)x\nSimilar to the calculations in Example 3.2.1, a closed-form solution for the Bachelier price\nof a call option with strike K and maturity T at time t as a function of \u03c4 (cid:16) T (cid:1)t and\nS\u02c6 (cid:16) x is given by\nt\nUcallp\u03c4,xq (cid:16) erTe(cid:1)r\u03c4\u03c3? \u03c4 (cid:0) \u03a61(cid:0) dp\u03c4,xq(cid:8) (cid:0)dp\u03c4,xq\u03a6(cid:0) dp\u03c4,xq(cid:8)(cid:8) ,\nwhere\nx(cid:1)K\u02c6\ndp\u03c4,xq :(cid:16) ? .\n\u03c3 \u03c4\n109 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nExercise 3.2.3. By mimicking the method in Example 3.2.3, show that\nUdigit-cp\u03c4,xq (cid:16) erTe(cid:1)r\u03c4\u03a6(cid:0) dp\u03c4,xq(cid:8)\nis a closed form for the Bachelier price of a digital call option.\nExercise 3.2.4. Use the put-call parity to find a closed form for the Bachelier price\nUputp\u03c4,xq of a put option with strike K and maturity T.\nExercise 3.2.5. What is the Bachelier price of at-the-money put option (K (cid:16) S ) with\n0\nT (cid:16) 10, \u03c3 (cid:16) .5, R p10q (cid:16) .025 (yield), and S (cid:16) 1? What is the probability that the asset\n0 0\nprice takes a negative value at T?\nExercise 3.2.6. What is the Bachelier price of the payoff in Figure 3.2.6 with T (cid:16) 1,\n\u03c3 (cid:16) .1, R p1q (cid:16) .2 (yield), and S (cid:16) 2? What is the probability that the option ends up\n0 0\nout of the money?\ng(ST)\n1\nST\n1 2\nFigure 3.2.2: Payoff of Exercise 3.2.6.\nMartingale property of the option price and heat equation\nNo arbitrage condition assures that the discounted price of an option is also a martingale,\ne(cid:1)rtVpt,S\u02c6 q is a martingale. If we assume that the pricing function Vpt,xq is continuously\nt\ndifferentiable on t and twice continuously differentiable on x, by the It\u00f4 formula we obtain\n(cid:1) (cid:9) (cid:2) \u03c32 (cid:10)\nd e(cid:1)rtVpt,S\u02c6 q (cid:16) e(cid:1)rt B V (cid:0) B V (cid:1)rV pt,S\u02c6 qdt(cid:0)e(cid:1)rtB Vpt,S\u02c6 qdS\u02c6\nt t xx t x t t\n2\n(3.2.12)\n(cid:2) \u03c32 (cid:10)\n(cid:16) e(cid:1)rt B V (cid:0) B V (cid:1)rV pt,S\u02c6 qdt(cid:0)\u03c3e(cid:1)rtB Vpt,S\u02c6 qdB\nt xx t x t t\n2\n(cid:1) (cid:9) (cid:1) (cid:9)\nNotice that in the above, we used B e(cid:1)rtV (cid:16) e(cid:1)rt B V (cid:1)rV and dS\u02c6 (cid:16) \u03c3dB .\nt t t t\nThen, itfollowsfromSectionC.3thate(cid:1)rtVpt,S\u02c6 qisamartingaleifandonlyifV satisfied\nt\n110 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nthe following partial differential equation (PDE):\n\u03c32\nB V (cid:0) B V (cid:1)rV (cid:16) 0.\nt xx\n2\n(cid:1) (cid:9)\nThis is because d e(cid:1)rtVpt,S\u02c6 q reduces to the stochastic integral \u03c3e(cid:1)rtB Vpt,S\u02c6 qdB .\nt x t t\nA PDE needs appropriate boundary conditions be well-posed. The boundary conditions\nhere include the terminal condition given by the payoff g of the contingent claim\ng(cid:0) erTx(cid:8)\nVpT,xq (cid:16)\nand proper growth conditions as x (cid:209) (cid:8)83. The PDE above, always hold regardless of the\npayoff of the option. The option payoff only appears as the terminal condition. Therefore,\nthe problem of finding the pricing function Vpt,xq reduces to solving the boundary value\nproblem (BVP) below.\n#\n\u03c32\nB V (cid:0) B V (cid:1)rV (cid:16) 0\nt 2 xx (3.2.13)\n(cid:0) (cid:8)\nVpT,xq (cid:16) g erTx\nand the growth condition at infinity: |Vpt,xq| \u010f C|gpxq| for some constant C, as x (cid:209) (cid:8)8.\nThe BVP (3.2.13) is a backward heat equation; i.e., we video record the evolution of the\nheat over time and play it back in reverse. If we do the change of variable \u03c4 (cid:16) T (cid:1)t and\nUp\u03c4,xq (cid:16) Vpt,xq, then U satisfies the forward heat equation\n#\n\u03c32\nB U (cid:16) B U (cid:1)rU\n\u03c4 2 xx (3.2.14)\n(cid:0) (cid:8)\nUp0,xq (cid:16) g erTx\nTherefore, the price of a contingent claim at any time can be obtained by solving the BVP\n(3.2.14).\nExample 3.2.4. By bare-handed calculations, we can show that the function\nerpT(cid:1)\u03c4q\u03c3? (cid:0) \u03a61(cid:0) dp\u03c4,xq(cid:8) (cid:0)dp\u03c4,xq\u03a6(cid:0) dp\u03c4,xq(cid:8)(cid:8)\nUp\u03c4,xq (cid:16) \u03c4 ,\nwhere\nx(cid:1)K\u02c6\ndp\u03c4,xq :(cid:16) ? .\n\u03c3 \u03c4\nsatisfies\n\u03c32\nB U (cid:16) B U (cid:1)rU.\n\u03c4 xx\n2\n3In order for a PDE to have a unique solution, it is necessary to impose proper boundary conditions.\nThe terminal condition is not sufficient to make the boundary value problem well posed. We always need\nboundary conditions at other boundaries; here they are growth conditions at infinity.\n111 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nExercise 3.2.7. Show that the pricing function on nondiscounted price S :(cid:16) erpT(cid:1)tqS\u02c6,\nt t\nU\u02dc p\u03c4,xq :(cid:16) Up\u03c4,er\u03c4xq, satisfies\n#\nB U\u02dc (cid:16) rxB U\u02dc (cid:0) e2rt\u03c32 B U\u02dc (cid:1)rU\u02dc\n\u03c4 x 2 xx\nU\u02dc p0,xq (cid:16) gpxq\nExercise 3.2.8. Show that the discounted pricing function up\u03c4,xq (cid:16) e(cid:1)r\u03c4Up\u03c4,xq satisfies\nthe standard form of the heat equation below\n#\n\u03c32\nB u (cid:16) B u\n\u03c4 2 xx . (3.2.15)\n(cid:0) (cid:8)\nup0,xq (cid:16) g erTx\nRemark 3.2.2 (On regularity of the pricing function). To be able to apply It\u00f4 formula in\n(3.2.12), the pricing function Vpt,xq needs to be continuously differentiable on t and twice\ncontinuously differentiable on x. While the payoff of the option may not be differentiable\nor value function n continuous, the Vpt,xq is infinitely differentiable for all t \u0103 T and all\nx.\nReplication in the Bachelier model: Delta hedging\nBy (3.1.1), the dynamics of a portfolio in the Bachelier model are given by\n\u017ct \u017ct\nW (cid:16) W (cid:0)r pW (cid:1)\u2206 S qds(cid:0) \u2206 dS .\nt 0 s s s s s\n0 0\nSimilar to Exercise I.2.2.1, the discounted wealth from a portfolio strategy \u2206 satisfies\n\u017ct\nW\u02c6 (cid:16) e(cid:1)rtW (cid:16) W (cid:0) \u2206 dS\u02c6 ,\nt t 0 s s\n0\nand is a martingale. On the other hand, by applying the It\u00f4 formula to the discounted\noption price e(cid:1)rtVpt,S\u02c6 q, we obtain (3.2.12)\nt\n\u017ct (cid:2) \u03c32 (cid:10)\ne(cid:1)rtVpt,S\u02c6 q (cid:16)Vp0,S q(cid:0) e(cid:1)rs B V (cid:0) B V (cid:1)rV ps,S\u02c6 qds\nt 0 t xx s\n2\n0\n\u017ct\n(cid:0) e(cid:1)rsB Vps,S\u02c6 qdS\u02c6\nx s s\n0\n\u017ct\n(cid:16)Vp0,S q(cid:0) e(cid:1)rsB Vps,S\u02c6 qdS\u02c6 .\n0 x s s\n0\nThe last inequality above comes from the martingale property of discounted option price\nand (3.2.13).\n112 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nA replicating portfolio is a portfolio that generates the terminal wealth W equal to\nT\nthe payoff VpT,S\u02c6 q (cid:16) g(cid:0) erTS\u02c6(cid:8) . Since both W\u02c6 and e(cid:1)rtVpt,S\u02c6 q are martingales with\nT t t\nW\u02c6 (cid:16) e(cid:1)rTVpT,S\u02c6 q (cid:16) e(cid:1)rTg(cid:0) erTS\u02c6(cid:8) , then we must have W\u02c6 (cid:16) e(cid:1)rtVpt,S\u02c6 q (cid:16): V\u02c6 pt,S\u02c6 q for\nT T t t t\nall t P r0,Ts, Vp0,S q (cid:16) W , and \u2206 (cid:16) e(cid:1)rtB Vpt,S\u02c6 q (cid:16) B V\u02c6 pt,S\u02c6 q.\n0 0 t x t x t\n\u2206 represents the number of units of the underlying in the replicating portfolio. It follows\nt\nfrom (3.2.12) that \u2206 is a function of t and S\u02c6 and is given by\nt t\n\u2206pt,S\u02c6 q (cid:16) e(cid:1)rtB Vpt,S\u02c6 q.\nt x t\nNotice that since V is a function of \u03c4 (cid:16) T (cid:1)t, so is \u2206:\n\u2206p\u03c4,S\u02c6 q (cid:16) e(cid:1)rtB Vpt,S\u02c6 q (cid:16) e(cid:1)rpT(cid:1)\u03c4qB Up\u03c4,S\u02c6 q.\nt x t x t\nTo summarize, the issuer of the option must trade continuously in time to keep exactly\n\u2206 (cid:16) e(cid:1)rtB Vpt,S\u02c6 q number of units of the underlying asset at time t in the replicating\nt x t\nportfolio. \u2206 also accountsfor the sensitivityof the option price with respect to the change\nt\nin the price of the underlying.\nExample 3.2.5. The replicating portfolio for a call option in the Bachelier model is ob-\ntained by taking the partial derivative B of the function\nx\nVcallpt,xq (cid:16) Ucallp\u03c4,xq (cid:16) erpT(cid:1)\u03c4q\u03c3? \u03c4 (cid:0) \u03a61(cid:0) dp\u03c4,xq(cid:8) (cid:0)dp\u03c4,xq\u03a6(cid:0) dp\u03c4,xq(cid:8)(cid:8) ,\nwith\nx(cid:1)K\u02c6\ndp\u03c4,xq :(cid:16) ? .\n\u03c3 \u03c4\nWe have\n\u2206p\u03c4,xq (cid:16) erpT(cid:1)\u03c4qB Ucallp\u03c4,xq\nx\n? (cid:1) (cid:0) (cid:8) (cid:0) (cid:8) (cid:0) (cid:8)(cid:9)\n(cid:16) \u03c3 \u03c4 B dp\u03c4,xq\u03a62 dp\u03c4,xq (cid:0)B dp\u03c4,xq\u03a6 dp\u03c4,xq (cid:0)dp\u03c4,xqB dp\u03c4,xq\u03a61 dp\u03c4,xq\nx x x\n(cid:0) (cid:8) (cid:0) (cid:8) (cid:0) (cid:8)\n(cid:16) \u03a62 dp\u03c4,xq (cid:0)\u03a6 dp\u03c4,xq (cid:0)dp\u03c4,xq\u03a61 dp\u03c4,xq\n(cid:0) (cid:8)\n(cid:16) \u03a6 dp\u03c4,xq .\n(3.2.16)\nHere, \u03a61pxq (cid:16) ?1 e(cid:1)x 22 isthepdfofthestandardGaussian, andweused\u03a62pxq (cid:16) ?(cid:1)x e(cid:1)x 22 (cid:16)\n2\u03c0 2\u03c0\n(cid:1)x\u03a61pxq and B xdp\u03c4,xq (cid:16) \u03c3?1 \u03c4.\nExample 3.2.6. To find the Bachelier price of an option with payoff gpxq (cid:16) ex, we need\n113 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nto find the the pricing function U, which solves the following BVP:\n#\n\u03c32\nB U (cid:16) B U (cid:1)rU\n\u03c4 2 xx .\n(cid:0) (cid:8)\nUp0,xq (cid:16) exp erTx\n(cid:9)\n(cid:0)\nWe shall verify that the solution to this problem is if the form Up\u03c4,xq (cid:16) e\u03bb\u03c4 exp erTx ,\nand find the constant \u03bb by plugging it into the equation:\n\u03c32 (cid:2) \u03c32 (cid:10)\nB U (cid:1) B U (cid:0)rU (cid:16) \u03bb(cid:1)e2rT (cid:0)r Up\u03c4,xq (cid:16) 0.\n\u03c4 xx\n2 2\ne2rT\u03c32\nThus, for \u03bb (cid:16) (cid:1)r, Up\u03c4,xq satisfies the equation and the initial condition. Delta\n2\nhedging is obtained by\nexp(cid:1) e2rT\u03c32 \u03c4(cid:9) exp(cid:1) erTx(cid:9)\n\u2206p\u03c4,xq (cid:16) e(cid:1)rTer\u03c4B Up\u03c4,xq (cid:16) ep\u03bb(cid:0)rq\u03c4 exp(cid:0) erTx(cid:8) (cid:16) .\nx\n2\nExercise 3.2.9. Find a closed-form solution for the Bachelier price of an option with\n?\npayoff gpxq (cid:16) 2cosp 2xq(cid:1)3sinp(cid:1)xq. Hint: Search for the solution of the form Up\u03c4,xq (cid:16)\n?\n\u03b1 1e\u03bb1\u03c4 cosp 2xq(cid:0)\u03b1 2e\u03bb2\u03c4 sinp(cid:1)xq.\nExample3.2.7. LetS (cid:16) $10, \u03c3 (cid:16) .03, andr (cid:16) 0.03. TheBachelierDeltaofthefollowing\n0\nportfolio of vanilla options given in the table below is the linear combination of the Deltas,\n3\u2206callp\u03c4 (cid:16) .5,K (cid:16) 10q(cid:1)3\u2206putp\u03c4 (cid:16) 1,K (cid:16) 10q(cid:1)\u2206callp\u03c4 (cid:16) 2,K (cid:16) 8q.\nposition units type strike maturity\nlong 3 call $8 .5\nshort 3 put $10 1\nshort 1 call $8 2\nThe maturities are given in years. Then, (3.2.16) for the Delta of the call option in Example\n3.2.5 should be used to evaluate \u2206callp\u03c4 (cid:16) .5,K (cid:16) 10q, 3\u2206putp\u03c4 (cid:16) 1,K (cid:16) 10q and \u2206callp\u03c4 (cid:16)\n2,K (cid:16) 8q.\nExercise 3.2.10. Let S (cid:16) 10, \u03c3 (cid:16) .03, and r (cid:16) 0.03. Consider the portfolio below.\n0\nposition units type strike maturity\nlong 3 call $10 .25 yrs\nlong 4 put $5 .5 yrs\nHow many units x of the underlying are required to eliminate any sensitivity in the portfolio\nwith respect to changes in the price of the underlying?\nExample 3.2.8. Let S (cid:16) 10, r (cid:16) .01, \u03c3 (cid:16) .02, and T (cid:16) 1. Consider the payoff in Figure\n0\n3.2.3.\n114 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\ng(S )\nT\n1\nS\n9 10 11 12 T\nFigure 3.2.3: Payoff in Exercise 3.2.8.\na) Find the Delta of the payoff gpS q at t (cid:16) 0.\nT\nb) Find an appropriate portfolio of call options, put options and a short position in an\noption with payoff gpS q such that the portfolio has a constant \u2206 at all points in time.\nT\n(a) The payoff gpS q can be written as the following combination of call options\nT\ngpS q (cid:16) pS (cid:1)9q (cid:1)pS (cid:1)10q (cid:1)pS (cid:1)11q (cid:0)pS (cid:1)12q .\nT T (cid:0) T (cid:0) T (cid:0) T (cid:0)\nTherefore,\n\u2206gpt (cid:16) 0,x (cid:16) 10q (cid:16)\u2206callp\u03c4 (cid:16) 1,K (cid:16) 9q(cid:1)\u2206callp\u03c4 (cid:16) 1,K (cid:16) 10q(cid:1)\u2206callp\u03c4 (cid:16) 1,K (cid:16) 11q\n(cid:0)\u2206callp\u03c4 (cid:16) 1,K (cid:16) 12q.\nThen, (3.2.16) for the Delta of the call option in Example 3.2.5 should be used to evaluate\n\u2206callp\u03c4 (cid:16) 1,Kq, for K (cid:16) 9,10,11, and 12.\n(b) By part (a), if we add a long position in a put option with strike K (cid:16) 9, a long position\nin a put option with strike K (cid:16) 12, a short positions in a put option with strike K (cid:16) 10,\nand a short positions in a put option with strike K (cid:16) 11 all with maturity T (cid:16) 1, then the\ntotal payoff of the portfolio will be\np9(cid:1)S q (cid:1)p10(cid:1)S q (cid:1)p11(cid:1)S q (cid:0)p12(cid:1)S q (cid:1)gpS q (cid:16) 9(cid:1)S (cid:0)S (cid:1)10(cid:0)S (cid:1)11(cid:0)12(cid:1)S (cid:16) 0.\nT (cid:0) T (cid:0) T (cid:0) T (cid:0) T T T T T\nThus, the above portfolio is equivalent to zero position in cash and zero position in the\nunderlying over time, which has a Delta of zero.\nExercise 3.2.11. Let S (cid:16) 9, r (cid:16) .01, \u03c3 (cid:16) .05 and T (cid:16) 1. Consider the payoff gpS q\n0 T\nshown in Figure 3.2.4.\na) Find the Delta of the payoff gpS q at time t (cid:16) 0.\nT\n115 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\ng(S )\nT\n1\nS\n8 10 T\n9\nFigure 3.2.4: Payoff in Exercise 3.2.11.\nb) Find an appropriate portfolio of call options, put options, and a short position in an\noption with payoff gpS q such that the portfolio has \u2206 of 0 at all points in time.\nT\nExample 3.2.9. Consider the payoff gpS q shown in Figure 3.2.5. Take T (cid:16) 10, \u03c3 (cid:16) 0.05,\nT\ng(S )\nT\nK (cid:0)K\n2 1\nS\nT\nK K\n1 2\nFigure 3.2.5: Payoff in Example 3.2.9.\nR p10q (cid:16) 0.01 (yield), and S (cid:16) 1. In addition, we assume that K (cid:16) 0.8, but K is\n0 0 1 2\nunknown. However, assume that the Bachelier Delta of the contingent claim at time 0 is\n(approximately) equal to (cid:1)0.385. From this we shall find K . Notice that\n2\ngpS q (cid:16) pS (cid:1)K q (cid:1)2pS (cid:1)K q .\nT T 1 (cid:0) T 2 (cid:0)\n116 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nTherefore,\n\u2206gp\u03c4 (cid:16) 10,x (cid:16) 1q (cid:16) \u2206callp\u03c4 (cid:16) 10,K (cid:16) K ,x (cid:16) 1q(cid:1)2\u2206callp\u03c4 (cid:16) 10,K (cid:16) K ,x (cid:16) 1q\n1 2\n(cid:0)1(cid:1)0.8e(cid:1)0.1 (cid:8) (cid:0)1(cid:1)K 2e(cid:1)0.1 (cid:8) (cid:0)1(cid:1)K 2e(cid:1)0.1 (cid:8)\n(cid:16) \u03a6 ? q (cid:1)2\u03a6 ? (cid:16) 0.9596(cid:1)2\u03a6 ? .\n0.05 10 0.05 10 0.05 10\nThus,\nK (cid:16) 1.0963.\n2\nTo find the Bachelier price of the contingent claim at time 0, we simply use\nUp\u03c4 (cid:16) 10,x (cid:16) 1q (cid:16) Ucallp\u03c4 (cid:16) 10,K (cid:16) 0.8,x (cid:16) 1q(cid:1)2Ucallp\u03c4 (cid:16) 10,K (cid:16) 1.0963,x (cid:16) 1q.\nExercise 3.2.12. Consider the payoff gpS q shown in Figure 3.2.6.\nT\ng(S )\nT\nK (cid:0)1\nS\nT\n1 K\nFigure 3.2.6: Payoff in Exercise 3.2.12. All the slopes are 0, 1, or (cid:1)1.\nPart a) Take T (cid:16) 10, \u03c3 (cid:16) .05, R p10q (cid:16) .01 (yield), and S (cid:16) 1. Find K such that the\n0 0\nBachelier Delta of the contingent claim at time 0 is (approximately) equal to (cid:1)0.385\nPart b) Find the Bachelier price of the contingent claim at time 0.\n3.2.2 Numerical methods for option pricing in the Bachelier model\nThe BVP for the heat equation in (3.2.13), or, equivalently, (3.2.14) or (3.2.15), generates\nclosed-form solutions in some specific cases, such as a linear combination of call or put\noptions, an exponential payoff in Example 3.2.6, or a sin-cos payoff in Exercise 3.2.9. In\ngeneral, a closed-form solution can be obtained if the integral in (3.2.8) can precisely be\nevaluated, or, equivalently, if the BVP for the heat equation has a closed-form solution.\nThe class of payoffs with closed-form solutions is narrow, and therefore one needs to study\nnumerical methods for solving the heat equation in the Bachelier model. Even though\n117 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nthe Bachelier model is very far from being practically valuable, the numerical methods\npresented in this section can be applied indirectly to the Black-Scholes model in the next\nsection. In addition, studying this numerical models for the BVP for the heat equation\nestablishes the methodology for evaluations of more complicated models. Therefore, the\nreader is recommended to read this section to obtain a background on different methods\nof the evaluation for the BVPs in finance.\nFourier transform\nIn this section, we interpret that (3.2.11) as the Fourier transform of a function. The\nadvantage of such interpretation is that a class of methods called fast Fourier transform\n(FFT) algorithms can be deployed to efficiently approximate the Fourier transform and its\ninverse with highly accurately. The Fourier transform of a function upxq is defined by\n\u017c8\n1\nup\u03b8q :(cid:16) Frusp\u03b8q :(cid:16) ? upxqe(cid:1)x\u03b8idx,\np\n2\u03c0\n(cid:1)8\nand the inverse Fourier transform of a function up\u03b8q is given by\np\n\u017c8\n1\nF(cid:1)1ruspxq :(cid:16) ? up\u03b8qex\u03b8idx,\np p\n2\u03c0\n(cid:1)8\nIf u is integrable, i.e., \u015f8 |upxq|dx \u0103 8, then the Fourier transform Frusp\u03b8q exists and\n(cid:1)8\nis bounded uniformly on \u03b8. However, the inverse Fourier transform of a bounded function\ndoes not necessarily exists. If, in addition, we assume that u is square integrable, i.e.,\n\u015f8 |upxq|2dx \u0103 8, then the Fourier transform Frusp\u03b8q is also square integrable and\n(cid:1)8\nF(cid:1)1rFrusspxq (cid:16) upxq and FrF(cid:1)1russp\u03b8q (cid:16) up\u03b8q. For a twice continuously differentiable\np p\nsquare integrable function u, the Fourier transform of B upxq equals (cid:1)\u03b82up\u03b8q.\nxx p\nIn specific payoffs, one can apply Fourier transform and then inverse Fourier transform to\nfind a closed-from solution to the heat equation. However, for a wider class of payoffs, one\ncan only obtain a closed form only for the Fourier transform of the solution to the heat\nequation. Then, the inverse Fourier transform can be achieved numerically through a class\nof efficient algorithms, namely fast Fourier transform. Since these algorithms are numeri-\ncally highly efficient, a closed-form for the Fourier transform of the solution is as good as\na closed-form for the solution. Assuming that Up\u03c4,xq is twice continuously differentiable\nand square integrable on x, the Fourier transform of B xxUp\u03c4,xq equals (cid:1)p\u03b8q2Upp\u03c4,\u03b8q and\nUpp\u03c4,\u03b8q satisfies the ordinary differential equation (ODE)\n#\ndUp (cid:16) (cid:1)\u03c32\u03b82Up (cid:1)rUp\nd\u03c4 .\nUpp0,\u03b8q (cid:16) e(cid:1)rTg ppe(cid:1)rT\u03b8q (cid:16) ?1 \u015f (cid:1)8 8gperTxqe(cid:1)x\u03b8idx\n2\u03c0\n118 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nNotice that in the above ODE, \u03b8 is a parameter and therefore, the solution is given by\nUpp\u03c4,\u03b8q (cid:16) e(cid:1)rTe(cid:1)r\u03c4e(cid:1)\u03c32\u03b82\u03c4g ppe(cid:1)rT\u03b8q.\nIf Up\u03c4,(cid:4)q is square integrable, the inverse Fourier transform of Upp\u03c4,\u03b8q recovers the solution\nUp\u03c4,xq, i.e.\n(cid:17) (cid:25)\nUp\u03c4,xq (cid:16) F(cid:1)1rUpp\u03c4,(cid:4)qspxq (cid:16) e(cid:1)rTe(cid:1)r\u03c4F(cid:1)1 e(cid:1)\u03c32\u03b82\u03c4g ppe(cid:1)rT\u03b8q pxq. (3.2.17)\nIt follows from the convolution rule in Fourier transform that,\n(cid:3) (cid:11) (cid:3) (cid:11)\n(cid:17) (cid:25) (cid:17) (cid:25) (cid:17) (cid:25)\nF(cid:1)1 e(cid:1)\u03c32\u03b82\u03c4e(cid:1)rTgpe(cid:1)rT\u03b8q (cid:16) e(cid:1)rT F(cid:1)1 e(cid:1)\u03c32\u03b82\u03c4 (cid:6) F(cid:1)1 gpe(cid:1)rT\u03b8q .\np p\nHere (cid:6) is the convolution operator defined by\n\u017c8\nf (cid:6)gpxq :(cid:16) fpyqgpx(cid:1)yqdy.\n(cid:1)8\nSince F(cid:1)1(cid:17) e(cid:1)\u03c32\u03b82\u03c4(cid:25) pxq (cid:16) ?1 e(cid:1) 2\u03c3x 22 \u03c4, we derive the formula\n\u03c3 2\u03c0\u03c4\n?e(cid:1)r\u03c4 \u017c8 g(cid:0) erTy(cid:8) e(cid:1)px 2(cid:1) \u03c32y \u03c4q2\nUp\u03c4,xq (cid:16) dy,\n2\u03c0\u03c4\n(cid:1)8\nwhich is the same as (3.2.10).\nFinite-difference scheme for the heat equation\nIn this section, we introduce the finite-difference method for the classical heat equation\n(3.2.15), that is\n# \u03c32\nB u (cid:16) B u\n\u03c4 2 xx\n(cid:1) (cid:9)\nup0,xq (cid:16) g\u02dcpxq :(cid:16) g erTx\nFor educational purposes, despite the availability of analytical formulas, we restrict the\ndiscussion to call and put options only. Other types of payoffs should be treated with a\nsimilar but yet different analysis. We denote the price of a call (put) option with strike\nK as a function of time-to-maturity \u03c4 and the current discounted price of underlying x as\nup\u03c4,xq (cid:16) Cp\u03c4,xq (up\u03c4,xq (cid:16) Pp\u03c4,xq), which is the solution to the heat equation (3.2.14)\n(cid:0) (cid:8) (cid:0) (cid:8)\nwith initial condition up0,xq (cid:16) erTx (cid:1) K (up0,xq (cid:16) K (cid:1) erTx ). Finally, we set\n(cid:0) (cid:0)\nS (cid:16) 0 by considering the change of variable X (cid:16) S\u02c6 (cid:1)S , i.e., the shifted price equal to\n0 t t 0\nthe difference between the discounted price S\u02c6 and the initial price S .\nt 0\n119 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nAstheactualdomainoftheheatequationisinfinite, inordertoapplythefinite-difference\nscheme,firstweneedtochooseafinitecomputationaldomain p\u03c4,xq P r0,Ts(cid:2)r(cid:1)x ,x s,\nmax max\nfor a suitable choice of x \u0105 0. Now, since the computational domain is bounded,\nmax\nit induces more boundary conditions to the problem at the boundaries x (cid:16) x and\nmax\nx (cid:16) (cid:1)x . RecallthattosolveaBVPanalyticallyornumerically,theboundarycondition\nmax\nisnecessaryatalltheboundaries. Weshouldfindappropriateboundaryconditionsatboth\npoints x and (cid:1)x , which usually rely on the terminal payoff of the option. These\nmax max\ntypes of boundary conditions, which are induced by the computational domain and do not\nexist in the original problem are called artificial boundary conditions, or in short ABC.\nTo learn how to set the ABC, let\u2019s study the case of a call option with payoff gpxq (cid:16)\n(cid:0) (cid:8)\nerTx (cid:1) pK (cid:0) erTS q (cid:0), i.e., up0,xq (cid:16) perTx (cid:1) pK (cid:0) erTS qq . The idea is simply as\n0 0 (cid:0)\nfollows. If x is a very small negative number, then up0,xq (cid:16) 0. If the current discounted\nprice of the underlying is a sufficiently small negative number, the probability that the\nprice at maturity enters the in-the-money region rpK (cid:0) erTS q,8q is significantly small.\n0\nFor instance, since the discounted price S (cid:16) S (cid:0)\u03c3B is a Gaussian random variable, for\nt 0 t\nA \u0105 0 the probability that S \u011b A (or equivalently S \u010f (cid:1)A) is given by\nt t\n\u017c8\n?1 e(cid:1) 2\u03c4y \u03c32 2dy (cid:18) 1 e(cid:1) 2A \u03c4\u03c32 2, as A (cid:209) 8,\n\u03c3 2\u03c4\u03c0 2\nA\n?\nwhich is smaller than .006 for A \u0105 3\u03c3 T. In other words, far out-of-money options should\nhavealmostzeroprice. Ontheotherhand,whenS (cid:16) xissufficientlylarge,theprobability\nt\nthatthediscountedpriceoftheunderlyingwilldropbelowK(cid:0)erTS atmaturityT (out-of-\n0\nmoney) is significantly small, and therefore perTS\u02c6 (cid:1)Kq (cid:19) erTS\u02c6 (cid:1)K. Far in-the-money\nT (cid:0) T\noptions should have almost the same price as the price of payoff S (cid:1)K, that is one unit\nT\nof asset minus K units of cash.\nMore rigorously, we need the following estimation:\n?\n\u017c8\n?1 ye(cid:1) 2\u03c4y \u03c32 2dy (cid:18) \u03c3 ? \u03c4 e(cid:1) 2A \u03c4\u03c32 2, as A (cid:209) 8.\n\u03c3 2\u03c4\u03c0 2\u03c0\nA\nIf we set A :(cid:16) e(cid:1)rTK (cid:0)S (cid:0)e(cid:1)rTx , for sufficiently large x , we have\n0 max max\nup\u03c4,(cid:1)x maxq (cid:16) e ?(cid:1)r\u03c4 \u017c8 perTy(cid:1)pK (cid:0)erTS 0qq (cid:0)e(cid:1)py(cid:0) 2x \u03c4m \u03c3a 2xq2 dy\n\u03c3 2\u03c4\u03c0\n(cid:1)8\n(cid:16) e ?(cid:1)r\u03c4 \u017c8 perTy(cid:1)pK (cid:0)erTS 0qqe(cid:1)py(cid:0) 2x \u03c4m \u03c3a 2xq2 dy\n\u03c3 2\u03c4\u03c0\ne(cid:1)rTK(cid:0)S0\n(cid:16) er ?pT(cid:1)\u03c4q \u017c8 py(cid:1)Aqe(cid:1) 2\u03c4y \u03c32 2dy\n\u03c3 2\u03c4\u03c0\nA\n?\n\u010f er ?pT(cid:1)\u03c4q \u017c8 ye(cid:1) 2\u03c4y \u03c32 2dy (cid:18) erpT ?(cid:1)\u03c4q\u03c3 \u03c4 e(cid:1) 2A \u03c4\u03c32 2, as A (cid:209) 8.\n\u03c3 2\u03c4\u03c0 2\u03c0\nA\n120 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nIn other words, far out-of-money options should have zero price. This suggests that\nup\u03c4,(cid:1)x q (cid:19) 0 for sufficiently large x .\nmax max\nOn the other hand, if we set B :(cid:16) e(cid:1)rTK (cid:0)S (cid:1)e(cid:1)rTx , we obtain\n0 max\nup\u03c4,x maxq (cid:16) e ?(cid:1)r\u03c4 \u017c8 perTy(cid:1)pK (cid:0)erTS 0qq (cid:0)e(cid:1)py(cid:1) 2x \u03c4m \u03c3a 2xq2 dy\n\u03c3 2\u03c4\u03c0\n(cid:1)8\n(cid:16) er ?pT(cid:1)\u03c4q \u017c8 py(cid:1)Bqe(cid:1) 2\u03c4y \u03c32 2dy.\n\u03c3 2\u03c4\u03c0\nB\nNotice that since\n?\n\u017c8 \u017cB\n?1 ye(cid:1) 2\u03c4y \u03c32 2dy (cid:16) ?1 ye(cid:1) 2\u03c4y \u03c32 2dy (cid:18) \u03c3 ? \u03c4 e(cid:1) 2B \u03c4\u03c32 2,\n\u03c3 2\u03c4\u03c0 \u03c3 2\u03c4\u03c0 2\u03c0\nB (cid:1)8\nand\n\u017c8\n?1 e(cid:1) 2\u03c4y \u03c32 2dy (cid:18) 1\n\u03c3 2\u03c4\u03c0\nB\nas B (cid:209) (cid:1)8, we have\nup\u03c4,x q (cid:18) (cid:1)erpT(cid:1)\u03c4qB (cid:16) e(cid:1)r\u03c4px (cid:1)pK (cid:0)erTS qq.\nmax max 0\nFollowing this observation, we choose ABC for (3.2.18) for the call option given by\nup\u03c4,x q (cid:16) e(cid:1)r\u03c4perTx (cid:1)pK (cid:0)erTS qq and up\u03c4,(cid:1)x q (cid:16) 0.\nmax max 0 max\nForputoption,put-callparityProposition1.3.3impliesthattheABCisgivenbyup\u03c4,x q (cid:16)\nmax\n0 and up\u03c4,(cid:1)x q (cid:16) e(cid:1)r\u03c4ppK (cid:0)erTS q(cid:1)erTx q.\nmax 0 max\nTo summarize, we must solve the following BVP to numerically price a call option.\n$\n\u2019 \u2019B \u03c4up\u03c4,xq (cid:16) \u03c3 22 B xxup\u03c4,xq for x P p(cid:1)x amx,x maxq,t \u0105 0\n\u2019\n\u2019 &up0,xq (cid:16) perTx(cid:1)pK (cid:0)erTS qq for x P p(cid:1)x ,x q\n0 (cid:0) amx max\n. (3.2.18)\n\u2019 \u2019up\u03c4,x maxq (cid:16) e(cid:1)r\u03c4perTx max (cid:1)pK (cid:0)erTS 0qq for t \u0105 0\n\u2019\n\u2019\n%up\u03c4,(cid:1)x q (cid:16) 0 for \u03c4 \u0105 0\nmax\nThe next step is to discretize the BVP (3.2.18) in time and space. For time discretization,\nwe choose N as the number of time intervals and introduce the time step h :(cid:16) T and\nN\ndiscrete points \u03c4 in time for i (cid:16) 0,...,N (cid:1)1,N. Then, we choose a computational domain\ni\nr(cid:1)x ,x s. We discretize the computational domain by x :(cid:16) kj with k :(cid:16) xmax for\nmax max j M\nj (cid:16) (cid:1)M,...,M. The discretization leads to a grid including points pt ,x q for i (cid:16) 0,...,N\ni j\nand j (cid:16) (cid:1)M,...,M, shown in Figure 3.2.7.\nNext, we need to introduce derivative approximation. There are two ways to do this:\nexplicit and implicit. In both methods, the first derivative of a function up\u03c4 ,x q with\ni j\n121 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nx\nx\nmax\n(cid:28)\nT\nk\n(cid:0)x\nmax\nh\nFigure 3.2.7: Finite difference grid for the heat equation. In the explicit scheme the CFL\ncondition should be satisfied, i.e., h \u010f 1. Artificial boundary conditions are necessary on\nk2 \u03c3\nboth x and (cid:1)x .\nmax max\nrespect to time \u03c4 atanydiscretetimep\u03c4 ,x q, is approximated by\ni j\nup\u03c4 ,x q(cid:1)up\u03c4 ,x q\ni(cid:0)1 j i j\nB up\u03c4 ,x q (cid:19)\nt i j\nh\nThen, the second derivative with respect to x can be approximated by\nup\u03c4 ,x q(cid:0)up\u03c4 ,x q(cid:1)2up\u03c4 ,x q\ni j(cid:0)1 i j(cid:1)1 i j\nB up\u03c4 ,x q (cid:19) .\nxx i j k2\nNow, we have all the ingredients to present the explicit scheme for the heat equation.\nThe scheme is obtained from the heat equation (3.3.25) by simply plugging the above\napproximations for derivatives, i.e.\nup\u03c4 ,x q(cid:1)up\u03c4 ,x q \u03c32 up\u03c4 ,x q(cid:0)up\u03c4 ,x q(cid:1)2up\u03c4 ,x q\ni(cid:0)1 j i j i j(cid:0)1 i j(cid:1)1 i j\n(cid:16) (cid:4) .\nh 2 k2\n122 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nx\nx\nj+1\nx\nj\nx\nj(cid:0)1\nt\n(cid:28) (cid:28)\ni i+1\nFigure 3.2.8: Possible active points in the finite-difference scheme to evaluate up\u03c4 ,x q,\ni(cid:0)1 j\nmarked with a square. The function u is unknown at dark nodes and known at light nodes.\nAll six nodes are active for implicit scheme with \u03b8(cid:24)1. For explicit scheme, \u03b8 (cid:16) 1, only\nfilled-in nodes are active.\nWe can simplify the scheme by writing\n(cid:2) h\u03c32(cid:10) h\u03c32\nup\u03c4 ,x q (cid:16) 1(cid:1) up\u03c4 ,x q(cid:0) pup\u03c4 ,x q(cid:0)up\u03c4 ,x qq. (3.2.19)\ni(cid:0)1 j k2 i j 2k2 i j(cid:0)1 i j(cid:1)1\nIn order to use explicit finite-difference scheme in (3.2.19), we need to have the CFL4\ncondition\nh 1\n\u010f .\nk2 \u03c32\nOtherwise, the scheme does not converge. The right-hand side of the CFL condition is\nalways 1 times the inverse of the coefficient of the second derivative in the equation. For\n2\nimplicit schemes, this condition can be relaxed.\nNotice that in problem (3.2.18), at \u03c4 (cid:16) 0, the initial condition is known. Therefore, we\n0\nset\nup0,x q :(cid:16) e(cid:1)rTgperTx q for j (cid:16) (cid:1)M,...,M.\nj j\nThen, if up\u03c4 ,x q is known for all j (cid:16) (cid:1)M,...,M, the explicit scheme (3.2.19) suggests that\ni j\nup\u03c4 ,x q can be found for all j (cid:16) (cid:1)M (cid:0)1,...,M (cid:1)1. For j (cid:16) (cid:1)M and M, one can use\nj(cid:0)1 j\nABC to assign values to up\u03c4 ,x q and up\u03c4 ,x q.\ni (cid:1)M i M\n4Courant-Friedrichs-Lewy\n123 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nThe implicit scheme is a little more difficult than explicit scheme to implement. But it\nhas its own advantages; e.g., the CFL condition is not necessary. To present the implicit\nmethod we need to modify the approximation of the second derivative as follows.\nup\u03c4 ,x q(cid:0)up\u03c4 ,x q(cid:1)2up\u03c4 ,x q\ni j(cid:0)1 i j(cid:1)1 i j\nB up\u03c4 ,x q (cid:19) p1(cid:1)\u03b8q\nxx i j k2\nup\u03c4 ,x q(cid:0)up\u03c4 ,x q(cid:1)2up\u03c4 ,x q\ni(cid:0)1 j(cid:0)1 i(cid:0)1 j(cid:1)1 i(cid:0)1 j\n(cid:0)\u03b8 .\nk2\nIn the above, \u03b8 P r0,1s is a parameter. If \u03b8 (cid:16) 0, then the scheme is the same as the explicit\nscheme. If \u03b8 (cid:16) 1, we call it a pure implicit scheme. Then for \u03b8 (cid:24) 0, we can present the\nimplicit scheme as follows.\n(cid:2) h\u03c32(cid:10) h\u03c32\n1(cid:0)\u03b8 up\u03c4 ,x q(cid:1)\u03b8 pup\u03c4 ,x q(cid:0)up\u03c4 ,x qq (cid:16)\nk2 i(cid:0)1 j 2k2 i(cid:0)1 j(cid:0)1 i(cid:0)1 j(cid:1)1\n(cid:2) h\u03c32(cid:10) h\u03c32\n1(cid:1)p1(cid:1)\u03b8q up\u03c4 ,x q(cid:0)p1(cid:1)\u03b8q pup\u03c4 ,x q(cid:0)up\u03c4 ,x qq.\nk2 i j 2k2 i j(cid:0)1 i j(cid:1)1\n(3.2.20)\nIf up\u03c4 ,x q is known for all j (cid:16) (cid:1)M,...,M, then the right-hand side above is known. Lets\ni j\ndenote the right-hand side by\n(cid:2) h\u03c32(cid:10) h\u03c32\nRp\u03c4 ,x q :(cid:16) 1(cid:1)p1(cid:1)\u03b8q up\u03c4 ,x q(cid:0)p1(cid:1)\u03b8q pup\u03c4 ,x q(cid:0)up\u03c4 ,x qq.\ni j k2 i j 2k2 i j(cid:0)1 i j(cid:1)1\nFor j (cid:16) M (cid:1)1, up\u03c4 ,x q on the left-hand side is known. Thus, we move this term to\ni(cid:0)1 j(cid:0)1\nthe other side\n(cid:2) h\u03c32(cid:10) h\u03c32\n1(cid:0)\u03b8 up\u03c4 ,x q(cid:1)\u03b8 up\u03c4 ,x q (cid:16)\nk2 i(cid:0)1 M(cid:1)1 2k2 i(cid:0)1 M(cid:1)2\nh\u03c32\nRp\u03c4 ,x q(cid:0)\u03b8 up\u03c4 ,x q.\ni M(cid:1)1 2k2 i(cid:0)1 M\nSimilarly for j (cid:16) (cid:1)M (cid:0)1 we have\n(cid:2) h\u03c32(cid:10) h\u03c32\n1(cid:0)\u03b8 up\u03c4 ,x q(cid:1)\u03b8 up\u03c4 ,x q (cid:16)\nk2 i(cid:0)1 (cid:1)M(cid:0)1 2k2 i(cid:0)1 (cid:1)M(cid:0)2\nh\u03c32\nRp\u03c4 ,x q(cid:0)\u03b8 up\u03c4 ,x q.\ni (cid:1)M(cid:0)1 2k2 i(cid:0)1 (cid:1)M\nTo find up\u03c4 ,x q, one needs to solve the following tridiagonal equation for up\u03c4 ,x q,\ni(cid:0)1 j i(cid:0)1 j\n124 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nj (cid:16) (cid:1)M (cid:0)1,...,M (cid:1)1.\nAU (cid:16) R (cid:1)Y (3.2.21)\ni(cid:0)1 i i\nwhere A is a 2M (cid:1)1-by-2M (cid:1)1 matrix given by\n(cid:20) 1(cid:0)\u03b8h\u03c32 (cid:1)\u03b8h\u03c32 (cid:28)\n0 0 (cid:4)(cid:4)(cid:4) 0\nk2 2k2\n(cid:1)\u03b8h\u03c32 1(cid:0)\u03b8h\u03c32 (cid:1)\u03b8h\u03c32\n(cid:22) 0 (cid:4)(cid:4)(cid:4) 0 ffi\n(cid:22) 2k2 k2 2k2 ffi\n(cid:22) 0 (cid:1)\u03b8h\u03c32 1(cid:0)\u03b8h\u03c32 (cid:1)\u03b8h\u03c32 (cid:4)(cid:4)(cid:4) 0 ffi\n(cid:22) 2k2 k2 2k2 ffi\nA :(cid:16) (cid:22) (cid:22) . . . ... . . . ffi ffi,\n(cid:22) ffi\n(cid:22) (cid:22) 0 (cid:4)(cid:4)(cid:4) (cid:1)\u03b8h 2k\u03c3 22 1(cid:0)\u03b8h k\u03c3 22 (cid:1)\u03b8h 2k\u03c3 22 0 ffi ffi\n(cid:22) (cid:1)\u03b8h\u03c32 1(cid:0)\u03b8h\u03c32 (cid:1)\u03b8h\u03c32 ffi\n(cid:21) 0 (cid:4)(cid:4)(cid:4) 0 (cid:29)\n2k2 k2 2k2\n(cid:1)\u03b8h\u03c32 1(cid:0)\u03b8h\u03c32\n0 (cid:4)(cid:4)(cid:4) 0 0\n2k2 k2\nY is the column 2M (cid:1)1-vector\ni\nh\u03c32\nY :(cid:16) \u03b8 pup\u03c4 ,x q,0,(cid:4)(cid:4)(cid:4) ,0,up\u03c4 ,x qqT,\ni 2k2 i(cid:0)1 (cid:1)M i(cid:0)1 M\nR is the column 2M (cid:1)1-vector\ni\nR :(cid:16) pRp\u03c4 ,x q,(cid:4)(cid:4)(cid:4) ,Rp\u03c4 ,x qqT,\ni i (cid:1)M(cid:0)1 i M(cid:1)1\nand the unknown is the column 2M (cid:1)1-vector\nU :(cid:16) pup\u03c4 ,x q,(cid:4)(cid:4)(cid:4) ,up\u03c4 ,x qqT.\ni(cid:0)1 i(cid:0)1 (cid:1)M(cid:0)1 i(cid:0)1 M(cid:1)1\nNotice that the endpoints up\u03c4 ,x q and up\u03c4 ,x q are given by the ABC:\ni(cid:0)1 (cid:1)M i(cid:0)1 M\nup\u03c4 ,x q (cid:16) e(cid:1)r\u03c4perTx (cid:1)pK (cid:0)erTS qq and upt,x q (cid:16) 0.\ni(cid:0)1 M M 0 (cid:1)M\nThe CFL condition for the implicit scheme with \u03b8 P r0,1q is given by\nh 1\n\u010f .\nk2 p1(cid:1)\u03b8q\u03c32\nFor the pure implicit scheme (\u03b8 (cid:16) 1), no condition is necessary for convergence.\nMonte Carlo approximation for the Bachelier model\nRecall that in the Bachelier model Gaussian distribution with mean S and variance \u03c32T,\n0\nS\u02c6 is Npx,\u03c32\u03c4q, and the pricing formula is given by\n\u03c4\nUp\u03c4,xq (cid:16) e(cid:1)r\u03c4E\u02c6 rgperTS\u02c6 q | S\u02c6 (cid:16) xs.\n\u03c4 0\n125 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\nIn the Monte Carlo method, we generate samples based on the underlying probability\ndistribution to approximate the above expectation. Let the i.i.d. samples tx : j (cid:16)\nj\n1,...,Nu be taken from Np0,1q. Then, the expectation E\u02c6 rgperTS\u02c6 q | S\u02c6 (cid:16) xs can be\n\u03c4 0\napproximated by\n1 \u201aN ?\ngperTpx(cid:0)\u03c3 \u03c4x qq.\ni\nN\nj(cid:16)1\nHence, the price of the option Up\u03c4,t,xq can be approximated by\ne(cid:1)rpT(cid:1)tq \u201aN ?\nUapproxp\u03c4,xq (cid:16) gperTpx(cid:0)\u03c3 \u03c4x qq. (3.2.22)\ni\nN\nj(cid:16)1\nThe larger the number of samples N is, the more accurate the approximation Uapproxp\u03c4,xq\nis obtained. The plain Monte Carlo method is not as efficient as the finite-difference, at\nleast when there is only a single risky asset. However, some methods such as variance\nreduction or quasi Monte Carlo can be used to increase its performance.\nQuadrature approximation for the Bachelier model\nQuadrature methods are based on a deterministic (nonrandom) approximation of the inte-\ngral. In the Bachelier model the price of the option is given by\ne ?(cid:1)r\u03c4 \u017c8 g(cid:0) erTy(cid:8) e(cid:1)py 2(cid:1) \u03c32x \u03c4q2\nUp\u03c4,xq (cid:16) dy.\n\u03c3 2\u03c0\u03c4\n(cid:1)8\nAs an example of the quadrature method, one can first approximate the improper integral\nabove with the proper integral\ne ?(cid:1)r\u03c4 \u017cx(cid:0)A g(cid:0) erTy(cid:8) e(cid:1)py 2(cid:1) \u03c32x \u03c4q2\ndy\n\u03c3 2\u03c0\u03c4\nx(cid:1)A\nand then use Riemann sums to approximate the price of option by\nUapproxp\u03c4,xq (cid:16) e ?(cid:1)r\u03c4 N \u201a(cid:1)1 g(cid:0) erTy j(cid:6)(cid:8) e(cid:1)py 2j(cid:6) \u03c3(cid:1) 2x \u03c4q2 py j(cid:0)1(cid:1)y jq,\n\u03c3 2\u03c0\u03c4\nj(cid:16)0\nwhere y (cid:16) x(cid:1)A \u0103 y \u0103 (cid:4)(cid:4)(cid:4) \u0103 y (cid:16) x(cid:0)A. If the discrete points y for j (cid:16) 0,...,N are\n0 1 N j\ncarefully chosen, the quadrature method outperforms the plain Monte Carlo method.\nExercise 3.2.13 (Project). Consider the initial price S , \u03c3, r and payoff assigned to your\n0\ngroup.\n126 3. CONTINUOUS MARKETS 3.2. BACHELIER MODEL\nGroup 1 T S r \u03c3\n0\n1 1 10 .2 1\n2 10 100 .1 5\n3 1 2 .2 .5\n4 2 2 .5 .5\n5 2 2 .5 .5\n6 1 .5 .1 .001\nStep 1. Choose a computational domain around the initial price, rS (cid:1)x ,S (cid:0)x s.\n0 max 0 max\nStep 2. Set appropriate artificial boundary conditions (ABC) at the boundary points S (cid:1)x\n0 max\nand S (cid:0)x .\n0 max\nStep 3. Write a program that implements the implicit finite-difference code. The time and\nspace discretization parameters ph,kq must be set to satisfy\nh 1\n\u010f .\nk2 p1(cid:1)\u03b8q\u03c32\nStep 4. To make sure that your code is correct, run the program for a call (or a put) option\nand compare it to the closed-form solution in (3.2.9).\nStep 5. Run the program for \u03b8 (cid:16) 0 (explicit), \u03b8 (cid:16) 1 (semi-implicit) and \u03b8 (cid:16) 1 (implicit) and\n2\nrecord the results.\nStep 6. Simulate a discrete sample path of the price of the underlying asset with the same\ntime discretization parameter h. Use the following algorithm:\nSimulating a sample paths of underlying in the Bachelier model\n1: Discretize time by t 0 (cid:16) 0, t i (cid:16) ih, and T (cid:16) hN.\n2: for each j (cid:16) 1,...,N do\n3: Generate a rand ?om number w j from standard Gaussian distribution Np0,1q to repre-\nsent pB (cid:1)B q{ h\ntj j?\n4: S\u02c6 j (cid:16) S\u02c6 j(cid:1)1(cid:0)\u03c3 hw j\n5: s j (cid:16) ertjS\u02c6 j\n6: end for\nOutput: vector ps (cid:16) S ,s ,...,s ,s q is a discretely generated sample path of the\n0 0 t1 tN(cid:1)1 T\nBachelier model.\nStep 7. Recall that the hedging is given by the derivative B V\u00af pt,S\u02c6 q (cid:16) ertB Vpt,ertS q. Eval-\nx t x t\nuate the hedging strategy discretely at each node of the discretely generated sample\n127 3.2. BACHELIER MODEL 3. CONTINUOUS MARKETS\npath ps (cid:16) S ,s ,...,s q in Step 7, i.e.,\n0 0 t1 tN(cid:1)1\npB xVp0,erts 0q,B xVpt 1,ert1s t1q,...,ertN(cid:1)1B xVpt N(cid:1)1,ertN(cid:1)1s tN(cid:1)1qq.\nNote that some interpolation may be needed in this step.\nSubmit the following outputs:\nOutput 1. The program\nOutput 2. A comparison with the closed-form solution for a call at p0,S q.\n0\nOutput 3. The price and hedging strategy at the points of the discrete grid.\ng(ST) g(ST)\n10 80 100\nGroup1 ST Group2 ST\n5 15 40 140\n-5 -40\ng(ST) g(ST)\n1\n1\nGroup3 Group4\nST ST\n1 2 3 1 2 3\ng(ST) g(ST)\n1\n.25\n..7755\nGroup5 ST Group6 ST\n.25 .5\n1 2 3\n-.25\nFigure 3.2.9: Different payoffs of the group project\n128 3. CONTINUOUS MARK3E.3T.S CONTINUOUS-TIME MARKET OF BLACK-SCHOLES\n3.2.3 Discussion: drawbacks of the Bachelier model\nOne of the drawbacks of the Bachelier model is the possibility of negative realization of the\nassetprice. However, thisisnotthemainconcern, asinmanyotherapplications; Gaussian\nrandomvariablesareusedtomodelpositivequantitiessuchashumanweight. Thenegative\nasset price can be problematic if the ratio S ?0 is not sufficiently large. For instance, if the\n\u03c3 T\nratio S ?0 (cid:16) 1, then the chance of a negative price at maturity T is significant, i.e., higher\n\u03c3 T\nthan .3.\nIn addition, the return of an asset in the Bachelier model is not integrable. The return of\nan asset in the Bachelier model is given by\nerpt(cid:0)\u03b4qS\u02c6 (cid:1)ertS\u02c6 er\u03b4B (cid:1)B er\u03b4pB (cid:1)B q\nRarth :(cid:16) t(cid:0)\u03b4 t (cid:16) t(cid:0)\u03b4 t (cid:16) t(cid:0)\u03b4 t (cid:0)er\u03b4 (cid:1)1.\nt ertS\u02c6 B B\nt t t\nGivenB , thereturnintheBacheliermodelisaGaussianrandomvariable. Someempirical\nt\nstudies support the Gaussian distribution for the return. However, the random variable 1\nBt\nis not integrable:\n(cid:18) \u0237 \u017c\nE\u02c6 1 (cid:16) ?1 1 e(cid:1)x 22 tdx (cid:16) 8.\n|B t| 2t\u03c0 R |x|\n3.3 Continuous-time market of Black-Scholes\nTheBlack-Scholesmodelcanbeobtainedbyasymptoticmethodsfromthebinomialmodel.\nTo do this, we first present some asymptotic properties of the binomial model.\n3.3.1 The Black-Scholes model: limit of binomial under risk-neutral\nprobability\nLet T \u0105 0 be a real number and N be a positive integer. We divide T units of time into\nN time intervals, each of size \u03b4 :(cid:16) T 5. Then, consider a binomial model with N periods\nN\ngiven by the times t (cid:16) 0 \u0103 t (cid:16) \u03b4,...,t (cid:16) k\u03b4,...t (cid:16) T. Recall from binomial model that\n0 1 k N\nS (cid:16) S H , for k (cid:16) 0,...,N (cid:1)1\npk(cid:0)1q\u03b4 k\u03b4 k(cid:0)1\nwhere, in accordance with Assumption 2.4.1, tH uN is a sequence of i.i.d. random vari-\nk k(cid:16)1\nables with the following distribution\n#\nu with probability \u03c0\u02c6\nH (cid:16)\nk\n\u2113 with probability 1(cid:1)\u03c0\u02c6\n5Each time unit is divided into 1{\u03b4 small time intervals.\n129 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nAsymptotics of parameters u, \u2113, and p\nThe goal of this section is to show the following approximation:\nu (cid:16) 1(cid:0)\u03b4r(cid:0)? \u03b4\u03c3\u03b1 (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3\u03b1(cid:0)op\u03b4q,\n(3.3.1)\n\u2113 (cid:16) 1(cid:0)\u03b4r(cid:1)? \u03b4\u03c3\u03b2 (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3\u03b2 (cid:0)op\u03b4q.\n?\nTo obtain this approximation, one should notice that from (2.4.7), we have x (cid:16) 1(cid:0)\u03bb \u03b4 (cid:0)\n? 0 2\nop \u03b4q. Thus, it follows from (2.4.6) that\n?\n1(cid:1)p ? ? 1 \u03bb \u03b4 ?\n(cid:16) x2 (cid:16) 1(cid:0)\u03bb \u03b4(cid:0)op \u03b4q and p (cid:16) (cid:1) (cid:0)op \u03b4q.\np 0 2 4\nThen,\n1(cid:1)p ? c 1(cid:1)p ? ? ?\n\u03b12 (cid:16) (cid:0)2\u03bb \u03b4 (cid:0)op \u03b4q (cid:16) x2 (cid:16) 1(cid:0)3\u03bb \u03b4(cid:0)op \u03b4q. (3.3.2)\np p 0\nOn the other hand, one can easily see that6\n?\ne\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3\u03b1 (cid:16) 1(cid:0)\u03b4pr(cid:1) \u03c32 q(cid:0)? \u03b4\u03c3\u03b1(cid:0) p\u03b4pr(cid:1) \u03c3 22 q(cid:0) \u03b4\u03c3\u03b1q2 (cid:0)op\u03b4q\n2 2\n\u03c32 ? \u03b4\u03c32\u03b12\n(cid:16) 1(cid:0)\u03b4pr(cid:1) q(cid:0) \u03b4\u03c3\u03b1(cid:0) (cid:0)op\u03b4q\n2 2\n? \u03b4p\u03c32(cid:1)1q\u03b12\n(cid:16) 1(cid:0)\u03b4r(cid:0) \u03b4\u03c3\u03b1(cid:0) (cid:0)op\u03b4q\n2\n?\n(cid:16) 1(cid:0)\u03b4r(cid:0) \u03b4\u03c3\u03b1(cid:0)op\u03b4q.\n?\nIn the above we used (3.3.2), i.e., \u03c32(cid:1)1 (cid:16) Op \u03b4q.\n? ?\nSimilarly, we have \u03b22 (cid:16) 1(cid:1)3\u03bb \u03b4(cid:0)op \u03b4q and\ne\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3\u03b2 (cid:16) 1(cid:0)\u03b4r(cid:1)? \u03b4\u03c3\u03b2 (cid:0)op\u03b4q.\nArithmetic return versus log return\nThis asymptotics yields to the relation between the arithmetic return and the log return\nin the binomial model. While the arithmetic return is given by\n# ?\n\u03b4r(cid:0) \u03b4\u03c3\u03b1\nRarth (cid:16) ?\nt\n\u03b4r(cid:1) \u03b4\u03c3\u03b2\n6ex (cid:16)1(cid:0)x(cid:0) x2 (cid:0)opx2q\n2\n130 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nthe log return is given by\n# ?\n\u03c32\n\u03b4pr(cid:1) q(cid:0) \u03b4\u03c3\u03b1(cid:0)op\u03b4q\nRlog (cid:16) 2 ? .\nt \u03c32\n\u03b4pr(cid:1) q(cid:1) \u03b4\u03c3\u03b2 (cid:0)op\u03b4q\n2\nThe probabilities of the values in both returns are given by p\u03c0\u02c6,1 (cid:1) \u03c0\u02c6q for risk-neutral\nprobability and pp,1(cid:1)pq for physical probability. In particular, if E\u02c6 and E are respectively\nexpectationswithrespecttorisk-neutralprobabilityandphysicalprobability, thenwehave\nE\u02c6 rRarths (cid:16) r\u03b4, and E\u02c6 rpRarthq2s (cid:16) \u03c32\u03b4(cid:0)op\u03b4q\nt t\nErRarths (cid:16) \u00b5\u03b4, and ErpRarthq2s (cid:16) \u03c32\u03b4(cid:0)op\u03b4q\nt t\n1 (3.3.3)\nE\u02c6 rRlog s (cid:16) pr(cid:1) \u03c32q\u03b4, and E\u02c6 rpRlog q2s (cid:16) \u03c32\u03b4(cid:0)op\u03b4q\nt 2 t\n1\nErRlog s (cid:16) p\u00b5(cid:1) \u03c32q\u03b4, and ErpRlog q2s (cid:16) \u03c32\u03b4(cid:0)op\u03b4q.\nt 2 t\nWeak convergence of the binomial model: the geometric Brownian motion\nFrom the asymptotics in (3.3.3), the log return of the calibrated binomial model is given\nby\n# ?\n\u03c32\n\u03b4pr(cid:1) q(cid:0) \u03b4\u03c3\u03b1 with probability \u03c0\u02c6\nRlog (cid:16) lnpH q (cid:16) 2 ?\nt k \u03c32\n\u03b4pr(cid:1) q(cid:1) \u03b4\u03c3\u03b2 with probability 1(cid:1)\u03c0\u02c6\n2\nIndeed,\nlnpS q (cid:16) lnpS q(cid:0)lnpH q,\npk(cid:0)1q\u03b4 k\u03b4 k(cid:0)1\nor\nN\n\u201a\nlnpS q (cid:16) lnpS q(cid:0) lnpH q.\nt 0 k\nk(cid:16)1\nLet tZ uN be a sequence of i.i.d. random variables with the following distribution\nk k(cid:16)1\n#\n\u03b1 with probability \u03c0\u02c6\nZ (cid:16)\nk\n(cid:1)\u03b2 with probability 1(cid:1)\u03c0\u02c6\nThen, we have\n\u03c32 ? 1 \u201aN\nlnpS q (cid:16) lnpS q(cid:0)pr(cid:1) qT (cid:0)\u03c3 T (cid:4) ? Z . (3.3.4)\nT 0 k\n2 N\nk(cid:16)1\nNext, we want to show that the normalized summation ?1 \u0159N k(cid:16)1Z converges weakly to\nk\nN\n131 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\na random variable (distribution) as the number of time intervals N approaches infinity7.\nTo show this, from Theorem B.9 from the appendix, we only need to find\nNli (cid:209)m 8\u03c7 kp\u03b8q.\n?1 \u0159N k(cid:16)1Z\nN\nNotice that here the characteristic function is under the risk-neutral probability, \u03c7 p\u03b8q (cid:16)\nX\nE\u02c6 rei\u03b8Xs.\nSince tZ uN is a sequence of i.i.d. random variables, we have\nt k(cid:16)1\nN (cid:2) (cid:10)\n\u017a \u03b8\n\u03c7 ?1 \u0159N k(cid:16)1Z kp\u03b8q (cid:16) k(cid:16)1\u03c7 Z1 ? N .\nN\nOn the other hand,\n\u03b82E\u02c6 rZ2s\n\u03c7 p\u03b8q (cid:16) E\u02c6 rei\u03b8Z1s (cid:16) 1(cid:0)i\u03b8E\u02c6 rZ s(cid:1) 1 (cid:0)op\u03b82q.\nZ1 1\n2\nNotice that by (2.4.4), we can write\nR(cid:1)L \u03b2\n\u03c0\u02c6 (cid:16) (cid:16) . (3.3.5)\nU (cid:1)L \u03b1(cid:0)\u03b2\nTherefore, straightforward calculations show that E\u02c6 rZ s (cid:16) 0, and E\u02c6 rZ2s (cid:16) 1. By using the\n1 1\nTaylor expansion of the characteristic function, we obtain\n(cid:2) \u03b8 (cid:10) \u03b82 1\n\u03c7 ? (cid:16) 1(cid:1) (cid:0)op q,\nZ1\nN 2N N\nand\n(cid:2) \u03b82 1 (cid:10)N\n\u03c7 ?1 \u0159N k(cid:16)1Z kp\u03b8q (cid:16) 1(cid:1) 2N (cid:0)op Nq .\nN\nBy sending n (cid:209) 8, we obtain\n8(cid:2) 2\u03b8 N2 N1 q(cid:10)N e(cid:1)\u03b8 22\nNli (cid:209)m 8\u03c7 ?1 \u0159N k(cid:16)1Z kp\u03b8q (cid:16) Nli (cid:209)m 1(cid:1) (cid:0)op (cid:16) .\nN\ne(cid:1)\u03b8 22\nSince is the characteristic function of a standard Gaussian random variable, we con-\nclude that ?1 \u0159N k(cid:16)1Z converges weakly to Np0,1q.\nk\nN\nExercise 3.3.1. In the above calculations, explain why we cannot apply the central limit\ntheorem (Theorem B.7) directly.\n7Or equivalently \u03b4(cid:209)0.\n132 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\n(3.3.4) suggests that we define a continuous-time model for price S of the asset at time\nt\nT as the weak limit of the binomial model by\n\u03c32\nlnpS q (cid:16) lnpS q(cid:0)pr(cid:1) qT (cid:0)\u03c3Np0,Tq\nT 0\n2\nor equivalently\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S exp pr(cid:1) qT (cid:0)\u03c3Np0,Tq .\nT 0\n2\nCalibrating binomial model: revised\nIn the above, we see that the choice of parameters u, \u2113, and R leads to a perfect choice\nof E\u02c6 rZ s (cid:16) 0 and E\u02c6 rZ2s (cid:16) 1. However, in (3.3.4), the only criteria for the convergence of\n1 1\nbinomial model to Black-Scholes model is that the random variables Z , k (cid:16) 1,...,N must\nk\nsatisfy E\u02c6 rZ s (cid:16) op\u03b4q and E\u02c6 rZ2s (cid:16) 1(cid:0)op1q;\n1 1\nIf E\u02c6 rZ s (cid:16) op\u03b4q, and E\u02c6 rZ2s (cid:16) 1(cid:0)op1q,\n1 1\n1 \u201aN (3.3.6)\nthen ? Z converges to Np0,1q weakly.\nk\nN\nk(cid:16)1\nTo avoid the calculation of \u03b1 and \u03b2, one can choose different parameters for the bino-\nmial model. Notice that the binomial model has three parameters u, \u2113 and R while the\nBlack-Scholesparametersareonlytwo. Thisdegreeoffreedomprovidesuswithsomemod-\nifications of the binomial model which still converges to the Black-Scholes formula. This\nalso simplifies the calibration process in Section 2.4 significantly. Here are some choices:\n1) Symmetric probabilities:\nu (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3, \u2113 (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3, and R (cid:16) r\u03b4,\nThen\n1\n\u03c0\u02c6 (cid:16) \u03c0\u02c6 (cid:16) .\nu \u2113\n2\nNotice that (3.3.4) should be modified by setting thetZ uN distribution of the i.i.d.\nk k(cid:16)1\nsequence\n#\n1 with probability 1\nZ (cid:16) 2\n1 (cid:1)1 with probability 1\n2\nand E\u02c6 rZ s (cid:16) 0 and E\u02c6 rZ2s (cid:16) 1.\n1 1\n133 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\n2) Subjective return:\n? ?\nu (cid:16) e\u03b4\u03bd(cid:0) \u03b4\u03c3, \u2113 (cid:16) e\u03b4\u03bd(cid:1) \u03b4\u03c3, and R (cid:16) r\u03b4,\nThen\n(cid:3) (cid:11) (cid:3) (cid:11)\n1 ? r(cid:1)\u03bd (cid:1) 1\u03c32 1 ? r(cid:1)\u03bd (cid:1) 1\u03c32\n\u03c0\u02c6 (cid:16) 1(cid:0) \u03b4 2 and \u03c0\u02c6 (cid:16) 1(cid:1) \u03b4 2 .\nu \u2113\n2 \u03c3 2 \u03c3\nIn this case, (3.3.4) should be modified by setting thetZ uN distribution of the i.i.d.\nk k(cid:16)1\nsequence\n$ &? \u03b4\u03bd(cid:1)r(cid:0)1 2\u03c32\n(cid:0)1 with probability \u03c0\u02c6\nZ 1 (cid:16) ? \u03bd(cid:1)r(cid:0)\u03c3 1\u03c32 u\n% \u03b4 2 (cid:1)1 with probability \u03c0\u02c6\n\u03c3 \u2113\n1(cid:0)(cid:1) 21\u03c32(cid:9)2\nand E\u02c6 rZ s (cid:16) 0 and E\u02c6 rZ2s (cid:16) \u03bd(cid:1)r(cid:0) \u03b4.\n1 1 \u03c3\nExercise 3.3.2. Show\nE\u02c6 rZ s (cid:16) op\u03b4q, and E\u02c6 rZ2s (cid:16) 1(cid:0)op1q\n1 1\nin the following cases:\na) symmetric probabilities\nb) subjective return\nExercise 3.3.3. Consider a risk-neutral trinomial model with N periods presented by\nS (cid:16) S H , for k (cid:16) 0,...,N (cid:1)1\npk(cid:0)1q\u03b4 k\u03b4 k(cid:0)1\nwhere \u03b4 :(cid:16) T and tH uN is a sequence of i.i.d. random variables with distribution\nN k k(cid:16)1\n$ \u2019 &e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? 3\u03b4\u03c3 with probability \u03c0\u02c6 (cid:16) 1\n\u2019 6\nH k (cid:16) e\u03b4pr(cid:1)\u03c3 22 q with probability 1(cid:1)2\u03c0\u02c6 (cid:16) 2\n3\n\u2019 \u2019 %e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? 3\u03b4\u03c3 with probability \u03c0\u02c6 (cid:16) 1\n6\nand \u03c0\u02c6 \u0103 1. Show that as \u03b4 (cid:209) 0, this trinomial model converges to the Black-Scholes model\n2\nin the weak sense.\n?\n\u03c32\nHint: Find Z such that lnpH q (cid:16) pr(cid:1) q\u03b4(cid:0)\u03c3 \u03b4Z . Then, show (3.3.6)\nk k 2 k\n134 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\n3.3.2 Pricing contingent claims in the Black-Scholes model\nRecall from the last section that the limit of the binomial model under risk-neutral proba-\nbility yields the geometric Brownian motion (GBM)\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S exp pr(cid:1) qt(cid:0)\u03c3B . (3.3.7)\nt 0 t\n2\nWe can use this random variable S to price an option in this continuous setting. We start\nt\nwith a call option with maturity T and strike price K.\nInspired by the geometric Brownian motion market model, the price of this call option is\nthe discounted expected value of pS (cid:1)Kq under risk-neutral probability. To calculate\nT (cid:0)\nthisprice, weonlyneedtoknowthedistributionofS underrisk-neutralprobability, which\nt\nisgivenby(3.3.7). SinceS isafunctionofastandardGaussianrandomvariable,weobtain\nt\n1 \u017c8 (cid:2) (cid:2) \u03c32 ? (cid:10) (cid:10) (cid:2) x2(cid:10)\nE\u02c6 rpS (cid:1)Kq s (cid:16) ? S exp pr(cid:1) qT (cid:0)\u03c3 Tx (cid:1)K exp (cid:1) dx.\nT (cid:0) 0\n2\u03c0 2 2\n(cid:1)8 (cid:0)\n(cid:1) (cid:9)\nNotice that when x \u010f x(cid:6) :(cid:16) \u03c3?1 lnpK{S 0q(cid:1)pr(cid:1) \u03c3 22 qT , the integrand is zero and\nT\notherwise pS (cid:1)Kq (cid:16) S (cid:1)K. Therefore,\nT (cid:0) t\n\u017c8 e\u03c3? ?Tx(cid:1)x 22 dx(cid:1)K\u017c8 ?(cid:1)x 22\nE\u02c6 rpS (cid:1)Kq (cid:0)s (cid:16) S 0epr(cid:1)\u03c3 22 qT e dx\nT\n2\u03c0 2\u03c0\nx(cid:6) x(cid:6)\n\u017c8 e(cid:1)p ?x(cid:1)\u03c3 2? Tq2 dx(cid:1)K\u017c8 ?(cid:1)x 22\ne\n(cid:16) S erT dx\n0\n2\u03c0 2\u03c0\nx(cid:6) x(cid:6)\n\u017c8 ?(cid:1)x 22 dx(cid:1)K\u017c8 ?(cid:1)x 22\ne e\n(cid:16) S erT dx\n0 ? 2\u03c0 2\u03c0\nx(cid:6)(cid:0)\u03c3 T x(cid:6)\nNotice that \u015f8 e ?(cid:1)x 22 dx is the probability that a standard Gaussian random variable is\nx(cid:6) 2\u03c0\ngreater than x(cid:6) and \u015f8 ? e ?(cid:1)x 22 dx is the probability that a standard Gaussian random\nx(cid:6)(cid:0)\u03c3 T ?2\u03c0\nvariable is greater than x(cid:6)(cid:0)\u03c3 T. Simple calculation shows that\n? 1 (cid:2) \u03c32 (cid:10)\nx(cid:6)(cid:0)\u03c3 T (cid:16) ? lnpK{S q(cid:1)pr(cid:0) qT .\n0\n\u03c3 T 2\nIn other words, the price of a European call option is given by\nCpT,K,S ,0q :(cid:16) e(cid:1)rTE\u02c6 rpS (cid:1)Kq(cid:0)s (cid:16) S \u03a6pd q(cid:1)e(cid:1)rTK\u03a6pd q, (3.3.8)\n0 t 0 1 2\n135 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nwhere\n1 (cid:1) (cid:0) \u03c32 (cid:8) (cid:9) 1 (cid:1) (cid:0) \u03c32 (cid:8) (cid:9)\nd (cid:16) ? lnpS {Kq(cid:0) r(cid:0) T and d (cid:16) ? lnpS {Kq(cid:0) r(cid:1) T . (3.3.9)\n1 0 2 0\n\u03c3 T 2 \u03c3 T 2\nHere \u03a6pxq (cid:16) \u015fx e ?(cid:1)y 22 dy is the standard Gaussian distribution function.8\n(cid:1)8 2\u03c0\nExercise 3.3.4. Use put-call parity to show that the Black-Scholes formula for the price\nof a put option with maturity T and strike K is given by\nPpT,K,S ,0q :(cid:16) e(cid:1)rTK\u03a6p(cid:1)d q(cid:1)S \u03a6p(cid:1)d q.\n0 2 0 1\nFor a general contingent claim, the price of a derivative with payoff gpS q in the Black-\nt\nScholes model is given by\n(cid:18) (cid:2) (cid:10)\u0237\nV 0pS 0q :(cid:16) e(cid:1)rTE\u02c6 rgpS Tqs (cid:16) e(cid:1)rTE\u02c6 g epr(cid:1)\u03c3 22 qT(cid:0)\u03c3? TNp0,1q\n?1 \u017c8 g(cid:2) epr(cid:1)\u03c3 22 qT(cid:0)\u03c3? Tx(cid:10) e(cid:1)x 22\n(cid:16) dx.\n2\u03c0\n(cid:1)8\nAs a consequence of Assumption 2.4.1, if we repeat the calculations in Section 3.3.1, we\nobtain\n(cid:2) \u03c32 (cid:10) (cid:2) \u03c32 (cid:10)\nS (cid:16) S exp pr(cid:1) qt(cid:0)\u03c3Np0,tq and S (cid:16) S exp pr(cid:1) qpT (cid:1)tq(cid:0)\u03c3Np0,T (cid:1)tq .\nt 0 T t\n2 2\nNow we would like to explain the relation between the two normal random variables\nNp0,T (cid:1) tq and Np0,tq in the above. In the Black-Scholes model, ST is independent\nSt\nof S . This, in particular, implies that the Black-Scholes model is Markovian9 and\nt\ngiven that the price of the underlying asset at time t is equal to S , the price of a call\nt\noption with strike K and maturity T is a function of S and t but not S for u \u0103 t. As a\nt u\nresult, the price of a call option at time t given S (cid:16) S is given by\nt\nCpT,K,S,tq :(cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rpS (cid:1)Kq | S (cid:16) Ss (cid:16) S\u03a6pd q(cid:1)e(cid:1)rpT(cid:1)tqK\u03a6pd q,\nT (cid:0) t 1 2\n1 (cid:2) \u03c32 (cid:10)\nd (cid:16) ? lnpS{Kq(cid:0)pr(cid:0) qpT (cid:1)tq and\n1\n\u03c3 T (cid:1)t 2\n1 (cid:2) \u03c32 (cid:10)\nd (cid:16) ? lnpS{Kq(cid:0)pr(cid:1) qpT (cid:1)tq .\n2\n\u03c3 T (cid:1)t 2\nIn general, the Markovian property implies that for a general contingent claim with payoff\n8In the above calculations, we use 1(cid:1)\u03a6pxq(cid:16)\u03a6p(cid:1)xq.\n9Given the current asset price, future movements of the price are independent of past movements.\n136 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\ngpS q, the Black-Scholes price at time t is Vpt,S q :(cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS q | S s. We will study\nt t T t\nsome more properties of this function V : r0,Ts(cid:2)R (cid:209) R later in the chapter. In the\n(cid:0)\nBlack-Scholes market, a contingent claim that has payoff gpS q, a function of the price of\nT\nthe underlying asset at time T, is called a Markovian claim, and the price of a Markovian\nclaim is given by\n(cid:18) (cid:2) (cid:10)\u0237\nVpt,Sq :(cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS Tq | S (cid:16) Ss (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 g epr(cid:1)\u03c3 22 qpT(cid:1)tq(cid:0)\u03c3? T(cid:1)tNp0,1q\nt\ne(cid:1) ?rpT(cid:1)tq \u017c8 g(cid:2) S(cid:0) epr(cid:1)\u03c3 22 qpT(cid:1)tq(cid:0)\u03c3? T(cid:1)tx(cid:8)(cid:10) e(cid:1)x 22\n(cid:16) dx.\n2\u03c0\n(cid:1)8\n(3.3.10)\nRemark 3.3.1. The price of a Markovian claim in the Black-Scholes model does not de-\npend on past movements of the price; it only depends on the current price S . This is not\nt\ntruefornon-Markovianclaims. Forexample, alook-backoptionwithpayoffpmax S (cid:1)Kq\n0\u010ft\u010fT t (cid:0)\n(cid:1) (cid:9)\nor an Asian option 1 \u015fT S (cid:1)K are non-Markovian options with a price that depends\nT 0 t\n(cid:0)\nto some extent on the history of price movements rather than only on the current price of\nthe underlying.\nAs seen in (3.3.10), the Black-Scholes price of a Markovian European option is always\na function of T (cid:1) t rather than t and T separately. Therefore, we can introduce a new\nvariable \u03c4 :(cid:16) T (cid:1) t, time-to-maturity. Then, one can write the value of the Markovian\nEuropean option as a function of \u03c4 and S by\nVp\u03c4,Sq :(cid:16) e(cid:1)r\u03c4E\u02c6 rgpS \u03c4q | S (cid:16) Ss (cid:16) ?e(cid:1)r\u03c4 \u017c8 g(cid:2) S(cid:0) epr(cid:1)\u03c3 22 q\u03c4(cid:0)\u03c3? \u03c4x(cid:8)(cid:10) e(cid:1)x 22 dx.\n0\n2\u03c0\n(cid:1)8\nFor call option the Black-Scholes formula in terms of \u03c4 is given by\nCp\u03c4,K,Sq (cid:16) S\u03a6pd q(cid:1)e(cid:1)r\u03c4K\u03a6pd q,\n1 2\n1 (cid:2) \u03c32 (cid:10) 1 (cid:2) \u03c32 (cid:10) (3.3.11)\nd (cid:16) ? lnpS{Kq(cid:0)pr(cid:0) q\u03c4 and d (cid:16) ? lnpS{Kq(cid:0)pr(cid:1) q\u03c4 .\n1 2\n\u03c3 \u03c4 2 \u03c3 \u03c4 2\n3.3.3 Delta hedging\nAs seen in the binomial model, to hedge the risk of issuing an option, one has to construct\na replicating portfolio. The replicating portfolio contains \u2206 pS q units of risky asset at\nt t\ntime t. If the price of the asset at time t is given by S (cid:16) S, the \u2206 pS q in the binomial\nt t t\nmodel is given by (2.3.4);\nVpt(cid:0)\u03b4,Suq(cid:1)Vpt(cid:0)\u03b4,S\u2113q\n\u2206 pSq :(cid:16) .\nt\nSpu(cid:1)\u2113q\n137 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nUsing the asymptotic formula for u and \u2113 from (3.3.1), we have\n? ?\nVpt(cid:0)\u03b4,S (cid:0)Sp\u03b4r(cid:0) \u03b4\u03c3\u03b1qq(cid:1)Vpt(cid:0)\u03b4,S (cid:0)Sp1(cid:0)\u03b4r(cid:1) \u03b4\u03c3\u03b2qq\n\u2206 pSq (cid:16) ?\nt\nS \u03b4\u03c3p\u03b1(cid:0)\u03b2q\n? ?\nBy expanding Vpt(cid:0)\u03b4,S (cid:0)Sp\u03b4r(cid:0) \u03b4\u03c3\u03b1qq and Vpt(cid:0)\u03b4,S (cid:0)Sp1(cid:0)\u03b4r(cid:1) \u03b4\u03c3\u03b2qq about the\npoint pt,Sq and sending \u03b4 (cid:209) 0, we obtain the Delta of the Black-Scholes model as\n\u2206BSpSq (cid:16) B Vpt,Sq, (3.3.12)\nt S\nwhereVpt,SqistheBlack-Scholespriceofageneralcontingentclaimwithanygivenpayoff.\nAs for a call option with maturity T and strike K, by taking derivative with respect to S\nfrom (3.3.11), we obtain\n\u2206BSpSq (cid:16) \u03a6pd q.\nt 1\nHere we used\nSB d \u03a61pd q(cid:1)e(cid:1)rpT(cid:1)tqKB d \u03a61pd q (cid:16) 0.\nS 1 1 S 2 2\nExercise 3.3.5. Let S (cid:16) $10, \u03c3 (cid:16) .03, and r (cid:16) 0.03. Find the Black-Scholes Delta of the\n0\nfollowing portfolio.\nposition units type strike maturity\nlong 3 call $10 60 days\nshort 3 put $10 90 days\nshort 1 call $10 120 days\nThe maturities are given in business days.\nExercise 3.3.6. Let S (cid:16) 10, \u03c3 (cid:16) .03, and r (cid:16) 0.03. Consider the portfolio below.\n0\nposition units type strike maturity\nlong 3 call $10 60 days\nlong 4 put $5 90 days\n? x underlying NA NA\nHow many units x of the underlying are required to eliminate any sensitivity of the portfolio\nwith respect to the changes in the price of the underlying?\nAnother derivation of the Delta in the Black-Scholes model\nAnother heuristic derivation of this result is as follows. In the binomial model, we can\nwrite\nE\u02c6 rgpS q | S (cid:16) Sus (cid:16) E\u02c6 rgpS uq | S (cid:16) Ss and\nT t(cid:0)\u03b4 T(cid:1)\u03b4 t\nE\u02c6 rgpS q | S (cid:16) S\u2113s (cid:16) E\u02c6 rgpS lq | S (cid:16) Ss.\nT t(cid:0)\u03b4 T(cid:1)\u03b4 t\n138 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nThis is because the binomial model is time homogeneous. Therefore,\nVpt(cid:0)\u03b4,Suq(cid:1)Vpt(cid:0)\u03b4,S\u2113q\n\u2206 pSq (cid:16)\nt\nSpu(cid:1)\u2113q\nE\u02c6 rgpS q | S (cid:16) Sus(cid:1)E\u02c6 rgpS q | S (cid:16) S\u2113s\n(cid:16) e(cid:1)rpT(cid:1)tq T t(cid:0)\u03b4 T t(cid:0)\u03b4 (cid:0)Op\u03b4q\nSpu(cid:1)\u2113q\nE\u02c6 rgpS uq | S (cid:16) Ss(cid:1)E\u02c6 rgpS lq | S (cid:16) Ss\n(cid:16) e(cid:1)rpT(cid:1)tq T(cid:1)\u03b4 t T(cid:1)\u03b4 t (cid:0)Op\u03b4q\nSpu(cid:1)\u2113q\nE\u02c6 rS g1pS q | S (cid:16) Sspu(cid:1)\u2113q\n(cid:16) e(cid:1)rpT(cid:1)tq T(cid:1)\u03b4 T(cid:1)\u03b4 t (cid:0)Op\u03b4q.\nSpu(cid:1)\u2113q\nIn the above, we used (3.3.1) to obtain pu(cid:1)\u2113q2 (cid:16) Op\u03b4q, and we used\ngpxq(cid:1)gpyq (cid:16) g1pxqpy(cid:1)xq(cid:0)Oppx(cid:1)yq2q\nto obtain the last equality. Hence,\ne(cid:1)rpT(cid:1)tq\n\u2206 pSq (cid:16) E\u02c6 rS g1pS q | S (cid:16) Ss(cid:0)Op\u03b4q\nt T(cid:1)\u03b4 T(cid:1)\u03b4 t\nS\nNow, by the weak convergence of the underlying asset price in the binomial model to the\nasset price in the Black-Scholes model, as \u03b4 (cid:209) 0, we obtain\ne(cid:1)rpT(cid:1)tq\n\u2206BSpSq (cid:16) E\u02c6 rS g1pS q | S (cid:16) Ss.\nt S T T t\nNotice that given S (cid:16) S, we have\nt\n(cid:2) \u03c32 (cid:10)\nS (cid:16) Sexp pr(cid:1) qpT (cid:1)tq(cid:0)\u03c3Np0,T (cid:1)tq .\nT\n2\nTherefore,\nd (cid:1) (cid:9) (cid:2) \u03c32 (cid:10) S\ngpS q (cid:16) exp pr(cid:1) qpT (cid:1)tq(cid:0)\u03c3Np0,T (cid:1)tq g1pS q (cid:16) T g1pS q.\nT T T\ndS 2 S\nThis implies that\n(cid:17)S (cid:25) (cid:17) d (cid:1) (cid:9) (cid:25)\n\u2206BSpSq (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 T g1pS q | S (cid:16) S (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 gpS q | S (cid:16) S\nt S T t dS T t\nd (cid:1) (cid:9)\n(cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS q | S (cid:16) Ss (cid:16) B Vpt,Sq.\nT t S\ndS\n139 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\n3.3.4 Completeness of the Black-Scholes model\nSimilartothebinomialmodel,theBlack-Scholesmarketiscomplete;everycontingentclaim\nis replicable. For the moment, it is not our concern to show this rigorously. Instead, we\naccept this fact and would rather emphasize how to replicate a contingent claim. In order\nto replicate a Markovian contingent claim with payoff gpS q in the Black-Scholes model,\nT\nwe start by recalling from Section 2.3.3 that the replicating portfolio in the binomial model\nis determined by \u2206bipS q given by (2.3.4) and the replicating portfolio is written as\nti ti\nt(cid:1)1 t(cid:1)1\n\u201a \u201a\nVbipt,S q (cid:16) Vbip0,S q(cid:0)R pVbipi,S q(cid:1)\u2206bipS qS q(cid:0) \u2206bipS qpS (cid:1)S q. (3.3.13)\nt 0 i i i i i i i(cid:0)1 i\ni(cid:16)0 i(cid:16)0\nNotice that R (cid:16) r\u03b4(cid:0)op\u03b4q. By taking the limit from (3.3.13), we obtain\n\u017cT \u017cT\nVpT,S q (cid:16) Vp0,S q(cid:0)r pVpt,S q(cid:1)\u2206 pS qS qdt(cid:0) \u2206 pS qdS . (3.3.14)\nT 0 t t t t t t t\n0 0\nIn the above Vpt,Sq is the Black-Scholes price of the contingent claim, and \u2206 pS q satisfies\nt t\n(3.3.12). The first integral in (3.3.14) is a simple Riemann integral. The second integral\nis a more complicated stochastic integral; the integrator dS is an It\u00f4 stochastic, which is\nt\npresented in Section C.4. But for the moment, you can interpret the It\u02c60 integral in (3.3.14)\n\u0159N(cid:1)1\u2206\nas the limit of the discrete stochastic integral pS qpS (cid:1)S q.\ni(cid:16)0 ti ti ti(cid:0)1 ti\nExercise 3.3.7. Repeat the above calculation to show that the discounted value of the\noption p1(cid:0)Rq(cid:1)tVbipt,S q converges to\nt\n\u017cT\ne(cid:1)rTVpT,S q (cid:16) Vp0,S q(cid:0) e(cid:1)rt\u2206 pS qdS .\nT 0 t t t\n0\n3.3.5 Error of discrete hedging in the Black-Scholes model and Greeks\nEquation (3.3.14) suggests adjusting the Delta continuously in time to replicate the contin-\ngent claim. On one hand, this is a useful formula, because in reality trading can happen\nwithenormousspeedwhichmakescontinuoustimeafineapproximation. However, inprac-\ntice, thetimeisstilldiscrete, andhedgingisonlyatimelapse. Therefore, itisimportantto\nhave some estimation of the error of discrete-time hedging in the Black-Scholes framework.\nLet us consider that the Black-Scholes model is running continuously in time, but we\nonly adjust our position on the approximately replicating portfolio at times t :(cid:16) \u03b4i where\ni\n\u03b4 (cid:16) T and i (cid:16) 0,1,...,N. By setting aside the accumulated error until time t , we can\nN i\nassume that our hedge has been perfect until time t , for some i, i.e.\ni\nVpt ,S q (cid:16) \u2206BSpS qS (cid:0)Y ,\ni ti ti ti ti ti\n140 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nwhere Vpt,Sq is the Black-Scholes value of the contingent claim and Y is the position in\nt\ncash. At time t (cid:16) t (cid:0)\u03b4, the value of the portfolio is\ni(cid:0)1 i\n\u2206BSpS qS (cid:0)er\u03b4Y .\nti ti ti(cid:0)\u03b4 ti\nSince by (3.3.12), \u2206BSpS q (cid:16) B Vpt ,S q, the error is given by\nti ti S i ti\n(cid:17) (cid:25)\nErr p\u03b4q :(cid:16)E\u02c6 Vpt (cid:0)\u03b4,S q(cid:1)B Vpt ,S qS (cid:1)er\u03b4Y | S\nti i ti(cid:0)\u03b4 S i ti ti(cid:0)\u03b4 ti ti\n(cid:17) (cid:25)\n(cid:16)E\u02c6 Vpt (cid:0)\u03b4,S q(cid:1)B Vpt ,S qS (cid:1)er\u03b4pVpt ,S q(cid:1)B Vpt ,S qS q | S\ni ti(cid:0)\u03b4 S i ti ti(cid:0)\u03b4 i ti S i ti ti ti\n(cid:17)\n(cid:16)E\u02c6 Vpt (cid:0)\u03b4,S q(cid:1)Vpt ,S q(cid:1)B Vpt ,S qpS (cid:1)S q\ni ti(cid:0)\u03b4 i ti S i ti ti(cid:0)\u03b4 ti\n(cid:25)\n(cid:0)per\u03b4 (cid:1)1qpVpt ,S q(cid:1)B Vpt ,S qS q | S\ni ti S i ti ti ti\n(cid:17)\n(cid:16)E\u02c6 Vpt (cid:0)\u03b4,S q(cid:1)Vpt ,S q(cid:1)B Vpt ,S qpS (cid:1)S q\ni ti(cid:0)\u03b4 i ti S i ti ti(cid:0)\u03b4 ti\n(cid:25)\n(cid:1)\u03b4rpVpt ,S q(cid:1)B Vpt ,S qS qq | S (cid:0)Op\u03b42q\ni ti S i ti ti ti\nBy the Taylor formula, the price of the option is\nVpt (cid:0)\u03b4,S q (cid:16) Vpt ,S q(cid:0)B Vpt ,S q\u03b4(cid:0)B Vpt ,S qpS (cid:1)S q\ni ti(cid:0)\u03b4 i ti t i ti S i ti ti(cid:0)\u03b4 ti\n1 1\n(cid:0) B Vpt ,S qpS (cid:1)S q2(cid:0) B Vpt ,S q\u03b42\nSS i ti ti(cid:0)\u03b4 ti tt i ti\n2 2\n(cid:0)B Vpt ,S qpS (cid:1)S q\u03b4(cid:0)op\u03b4q.\nSt i ti ti(cid:0)\u03b4 ti\nNotice that since\n?\nS (cid:1)S (cid:16) \u03c3S \u03b4Np0,1q(cid:0)Op\u03b4q, with Np0,1q independent of S , (3.3.15)\nti(cid:0)\u03b4 ti ti ti\nthe conditional expectation E\u02c6 rpS (cid:1) S tiq2 | S tis (cid:16) \u03c32S t2 i\u03b4 (cid:0) Op\u03b423 q. Therefore, by the\nti(cid:0)\u03b4\nproperties of the conditional expectation, we have\nE\u02c6 rB Vpt ,S qpS (cid:1)S q | S s (cid:16) B Vpt ,S qE\u02c6 rS (cid:1)S | S s (cid:16) 0\nS i ti ti(cid:0)\u03b4 ti ti S i ti ti(cid:0)\u03b4 ti ti\nE\u02c6 rB Vpt ,S qpS (cid:1)S q2 | S s (cid:16) B Vpt ,S qE\u02c6 rpS (cid:1)S q2 | S s\nSS i ti ti(cid:0)\u03b4 ti ti SS i ti ti(cid:0)\u03b4 ti ti\n(cid:16) \u03c32S t2 iB SSVpt i,S tiq\u03b4(cid:0)Op\u03b423 q,\n141 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nand we can write the error term10 by\n\u03c32S2\nErr tip\u03b4q :(cid:16) \u03b4pB tVpt i,S tiq(cid:0) 2tiB SSVpt i,S tiq(cid:0)rB SVpt i,S tiqS tiq(cid:1)rVpt i,S tiqq(cid:0)Op\u03b43 2q.\n(3.3.16)\n3\nwhere the term Op\u03b42q depends on the higher derivative B tSV, \u03c3, S ti, and r.\nBefore finishing the error estimation, let us briefly explain some of the important terms\nwhich show up in (3.3.16).\n1) The first derivative B V of the option price, Delta, is denoted by \u2206pt,Sq and de-\nS\ntermines the sensitivity of the value of the option with respect to the price of the\nunderlying.\n2) The second derivative B V of the option price, which is called Gamma and denoted\nSS\nby\u0393pt,Sqanddeterminestheconvexityoftheoptionvalueonthepriceofunderlying.\n3) The time derivative B V, which is called time decay factor or Theta and is denoted\nt\nby \u0398pt,Sq, determines how the price of option evolves over time.\nAs a function of time-to-maturity \u03c4 (cid:16) T(cid:1)t, by the abuse of notation, we define Vp\u03c4,Sq :(cid:16)\nVpt,Sq and therefore we have\n\u2206p\u03c4,Sq (cid:16) B Vp\u03c4,Sq\nS\n\u0393p\u03c4,Sq (cid:16) B Vp\u03c4,Sq\nSS\n\u0398p\u03c4,Sq (cid:16) (cid:1)B Vp\u03c4,Sq\n\u03c4\nFor example in the case of call option with strike K and maturity T, by taking derivatives\nB and B in (3.3.11), we have\nSS \u03c4\n1 S\u03c3\n\u2206p\u03c4,Sq (cid:16) \u03a6pd q, \u0393p\u03c4,Sq (cid:16) ? \u03a61pd q and \u0398p\u03c4,Sq (cid:16) (cid:1) ? \u03a61pd q(cid:1)rKe(cid:1)r\u03c4\u03a6pd q.\n1 1 1 2\nS\u03c3 \u03c4 2 \u03c4\n(3.3.17)\nThe \u2206, \u0393, and \u0398 of a call option in the Black-Scholes model is shown in Figure 3.3.1.\nTo continue with the error estimation, we need the following proposition.\nProposition 3.3.1. For a European Markovian contingent claim, the Black-Scholes price\nsatisfies\n\u03c32S2\n\u0398p\u03c4,Sq (cid:16) (cid:1) \u0393p\u03c4,Sq(cid:1)rS\u2206p\u03c4,Sq(cid:0)rVp\u03c4,Sq.\n2\nProof. Apple Proposition (C.1) to the martingale e(cid:1)rtVpt,S q.\nt\n10HereweheuristicallyassumedNp0,1q(cid:18)1. Amorerigoroustreatmentofthiserrorisinbycalculating\nthe L2 error by calculating E\u02c6rpErr tip\u03b4qq2s21.\n142 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\n1 Delta\nGamma\nTheta\n0.5\n0\n\u22120.5\n6 8 10 12 14\nS\nFigure 3.3.1: Greeks of a call option with \u03c4 (cid:16) 1, \u03c3 (cid:16) .1, r (cid:16) .05, and K (cid:16) 10. As you\nsee the significant sensitivity is near the ATM.\nAs a result of this proposition, the term of order \u03b4 in (3.3.16) vanishes, and thus one step\nerror is of order Op\u03b43 2q. Since \u03b4 (cid:16) T , we have\nN\n(cid:19) ff\nN \u201a(cid:1)1 ?\nErrp\u03b4q :(cid:16) E\u02c6 Err p\u03b4q (cid:16) Op \u03b4q,\nti\ni(cid:16)0\n?\nwhich converges to 0 as quickly as \u03b4 when \u03b4 (cid:209) 0.\nDiscrete hedging without a money market account\nOne reason to completely disregard the money market account is because the risk-free\ninterest rate r is not exactly constant. The money market is also under several risks which\nis a different topic. One way to tackle the interest rate risks is to completely exclude the\nrisk-freemoneymarketaccountfromthehedgingportfolio, andtrytomeasurethehedging\nerror in this case. To understand this better, let us first consider the issuer of an option\nthat is long in \u2206BSpt ,S q units of the underlying. Then the change in the portfolio from\ni ti\ntime t to time t (cid:0)\u03b4 is\ni i\nE\u02c6 rVpt (cid:0)\u03b4,S q(cid:1)Vpt ,S q(cid:1)\u2206BSpt ,S qpS (cid:1)S qs\ni ti(cid:0)\u03b4 i ti i ti ti(cid:0)\u03b4 ti\n\u03c32S2\n(cid:16) pB Vpt ,S q(cid:0) tiB Vpt ,S qq\u03b4(cid:0)op\u03b4q,\nt i ti SS i ti\n2\n143 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nwhere we use (3.3.15) on the right-hand side. This error is related to the loss/profit of not\nperfectly hedging and is called a slippage error; see Figure 3.3.2.\nV(t;S)\nV(t +(cid:14);S )\ni t +(cid:14)\ni\nV(t ;S )\ni t\ni\nS\nS S\nt t +(cid:14)\ni i\nFigure 3.3.2: The red curve is the value of the option at time t , the blue curve is the\ni\nvalue of the option at time t . The slippage error is shown in burgundy.\ni(cid:0)1\nThe loss/profit from slippage can be calculated by using the same technology as in the\nprevious section; the slippage error during the time interval rt ,t (cid:0)\u03b4s is given by\ni i\n\u03c32S2\np\u0398pt ,S q(cid:0) ti\u0393pt ,S qq\u03b4(cid:0)op\u03b4q\ni ti i ti\n2\nAs illustrated in Figure 3.3.4, when, for instance, the time decay factor is negative and\nGamma is positive, for small changes in the price of the asset, we lose, and for larger\nchanges we gain. As seen in (3.3.17), it is a typical situation to have negative \u0398 and\npositive \u0393 for call options (or put options or any European Markovian option with a\nconvex payoff function). See Figure 3.3.3.\nExercise 3.3.8. Show that if the payoff function gpS q is a convex function on S , then\nT T\nthe Markovian European contingent claim with payoff gpS q has nonnegative \u0393; Vp\u03c4,Sq is\nT\nconvex on S for all \u03c4.\nLet S\u02dc (cid:16) e(cid:1)rtS and V\u02dc pt,S\u02dc q (cid:16) e(cid:1)rtVpt,S q (cid:16) e(cid:1)rtVpt,ertS\u02dc q be respectively the dis-\nt t t t t\ncounted underlying price and discounted option price. Then, we can show that\n\u03c32S\u02dc2\nB V\u02dc pt,S\u02dc q (cid:16) (cid:1) B V\u02dc pt,S\u02dc q.\nt S\u02dcS\u02dc\n2\n144 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\n2.5\n2\n)S,t(V\n1.5\n1\n0.5\n0\nK\nS\nFigure 3.3.3: The time decay for the price of call option in the Black-Scholes model. As\n\u03c4 (cid:209) 0, the color becomes darker.\nExercise 3.3.9. Use Proposition 3.3.1 to show the above equality.\nThis suggests that if the interest rate is nearly zero, then the lack of a money market in\nthe replication does not impose any error. Otherwise, when the interest rate is large, the\nslippage error is significant and is equal to\n\u03c32S2\np\u0398pt ,S q(cid:0) ti\u0393pt ,S qq\u03b4(cid:0)op\u03b4q (cid:16) rpVpt ,S q(cid:1)S2\u2206pt ,S qq\u03b4(cid:0)op\u03b4q,\ni ti 2 i ti i ti ti i ti\nwhich can accumulate to a large number.\nOther Greeks\nTwo other Greeks are Rho, denoted by \u03c1, and Vega, denoted by V, which respectively\nmeasure the sensitivity with respect to interest rate r and volatility \u03c3, i.e.,\n(cid:1) (cid:9) (cid:1) (cid:9)\n\u03c1p\u03c4,Sq :(cid:16) B e(cid:1)r\u03c4E\u02c6 rgpS q | S (cid:16) ss and Vp\u03c4,Sq :(cid:16) B e(cid:1)r\u03c4E\u02c6 rgpS q | S (cid:16) ss .\nr \u03c4 0 \u03c3 \u03c4 0\n145 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nPro(cid:12)t/Loss\n\u2206S\nFigure 3.3.4: The loss/profit of the discrete hedging in the Black-Scholes model. The\nred graph shows the loss/profit without the time decay factor. The blue includes the time\ndecay factor, too.\nFor a call option, these derivatives are given by\n?\n\u03c1p\u03c4,Sq (cid:16) e(cid:1)r\u03c4K\u03c4\u03a6pd q and Vp\u03c4,Sq (cid:16) S \u03c4\u03a61pd q.\n2 1\nFigures (3.3.1) and 3.3.5 show the Greeks \u2206, \u0393, \u0398, \u03c1 and V for a call option as a function\nof S.\nExercise 3.3.10. The third derivative of the Black-Scholes price with respect to S is called\nspeed. Find a closed-form solution for speed.\nExample 3.3.1. The payoff in Figure 3.3.6 can be written as pS (cid:1)K q (cid:1)pS (cid:1)K q (cid:1)\nT 1 (cid:0) T 2 (cid:0)\npS (cid:1)K q (cid:0)pS (cid:1)K q . Therefore, the closed-form solution for the Black-Scholes price\nT 3 (cid:0) T 4 (cid:0)\nof the option is given by\nVp\u03c4,Sq (cid:16) Cp\u03c4,K ,Sq(cid:1)Cp\u03c4,K ,Sq(cid:1)Cp\u03c4,K ,Sq(cid:0)Cp\u03c4,K ,Sq.\n1 2 3 4\nAll the Greeks of the option are also a linear combination of the Greeks of these call\noptions. For instance,\n\u2206pt,Sq (cid:16) \u03a6pd p\u03c4,K ,Sqq(cid:1)\u03a6pd p\u03c4,K ,Sqq(cid:1)\u03a6pd p\u03c4,K ,Sqq(cid:0)\u03a6pd p\u03c4,K ,Sqq.\n1 1 1 2 1 3 1 4\n146 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\n10\nRho\nVega\n8\n6\n4\n2\n0\n6 8 10 12 14\nS\nFigure 3.3.5: \u03c1 and V of a call option with \u03c4 (cid:16) 1, \u03c3 (cid:16) .1, r (cid:16) .05, and K (cid:16) 10.\ng(S )\nT\nS\nK K K K T\n1 2 3 4\nFigure 3.3.6: Payoff of Example 3.3.1 gpS q (cid:16) pS (cid:1)K q (cid:1)pS (cid:1)K q (cid:1)pS (cid:1)K q (cid:0)\nT T 1 (cid:0) T 2 (cid:0) T 3 (cid:0)\npS (cid:1)K q .\nT 4 (cid:0)\nExercise 3.3.11. Write the payoffs in Figure 3.3.7 as a linear combination of call options\nand derive a closed-form formula for the Black-Scholes price, the Delta, the Gamma, and\nthe time decay of options with these payoffs.\nExercise 3.3.12 (Bull and bear call spreads). Write the payoffs in Figure 3.3.8 as linear\ncombination of call options with different strikes and possibly some cash and give the closed\nform formula for them.\n3.3.6 Time-varying Black-Scholes model\nRecall from Section 2.4 that the binomial model can be calibrated to time-dependent\nparameters. Let \u03b4 (cid:16) T and consider the discrete time instances t (cid:16) i\u03b4. The time-varying\nN i\n147 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\ng(ST) g(ST)\nK K1 K2\nST ST\nFigure 3.3.7: Left: payoff of straddle. Right: payoff of strangle.\ng(S )\nT\nS\nK K T\n1 2\nFigure 3.3.8: Red: Bull-spread call. Blue: Bear-spread call\nbinomial can be given by\nlnpS q (cid:16) lnpS q(cid:0)lnpH q,\nt k(cid:0)1 k\u03b4 k(cid:0)1\nwhere tH uN is a sequence of independent random variables with the following distribu-\nk k(cid:16)1\ntion under the risk-neutral probability\n# ?\n1(cid:0)\u03b4r (cid:0) \u03b4\u03c3 \u03b1 with probability \u03c0\u02c6\nH (cid:16) t k ? t k k k ,\nk\n1(cid:0)\u03b4r (cid:1) \u03b4\u03c3 \u03b2 with probability 1(cid:1)\u03c0\u02c6\nt k t k k k\n148 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nwhere \u03b1 , \u03b2 are given by (2.4.6) and (2.4.7) for time-dependent \u03bb . Therefore, equation\nk k t\n(3.3.4) takes the following time-dependent form:\nk \u201a(cid:1)1 \u03c32 ? \u201aN\nlnpS q (cid:16) lnpS q(cid:0) pr (cid:1) tiq\u03b4(cid:0) \u03b4 \u03c3 Z . (3.3.18)\nt k 0 ti 2 t k k\ni(cid:16)0 k(cid:16)1\nAnalogous to (3.3.5), we have \u03c0 (cid:16) \u03b2 k and\nk \u03b1 k(cid:0)\u03b2\nk\nE\u02c6 rZ s (cid:16) 0 and E\u02c6 rZ2s (cid:16) 1.\nk k\nTherefore,\n\u03b82\u03c32 \u03b4E\u02c6 rZ2s\n\u03c7? kp\u03b8q (cid:16) E\u02c6 rei\u03b8\u03c3tkZ ks (cid:16) 1(cid:0)i\u03b8\u03c3 k\u03b4E\u02c6 rZ 1s(cid:1) t k 1 (cid:0)op\u03b4q.\n\u03b4\u03c3tkZ t 2\nThis implies that\nN (cid:2) (cid:10) N\n\u03c7? \u03b4\u0159N kp\u03b8q (cid:16) \u017a 1(cid:1) 1 2\u03b4\u03b82\u03c3 t2 (cid:0)op\u03b42q (cid:16) \u017a e(cid:1)1 2\u03b82\u03c3 t2 k\u03b4 (cid:0)op\u03b4q (cid:16) e(cid:1)\u03b8 22 \u0159N i(cid:16)1\u03c3 t2 k\u03b4 (cid:0)op\u03b4q.\nk(cid:16)1\u03c3tkZ k\nk(cid:16)1 k(cid:16)1\nAs \u03b4 (cid:209) 0,\ne(cid:1)\u03b8 22 \u015f 0T\u03c3 t2dt,\n\u03c7? \u03b4\u0159N kp\u03b8q (cid:209)\nk(cid:16)1\u03c3tkZ\nNp0,\u015fT\nwhich is the characteristic function of \u03c32dtq. Thus in the limit, we have\n0 t\n(cid:2)\u017cT \u03c32 \u017cT (cid:10)\nS (cid:16) S exp pr (cid:1) t qdt(cid:0) \u03c32dtNp0,1q .\nT 0 t 2 t\n0 0\nAs a matter of fact, for any t we have\n(cid:2)\u017ct \u03c32 (cid:2) \u017ct (cid:10)(cid:10)\nS (cid:16) S exp pr (cid:1) uqdu(cid:0)N 0, \u03c32du\nt 0 u 2 u\n0 0\n(cid:2)\u017cT \u03c32 (cid:2) \u017cT (cid:10)(cid:10)\nS (cid:16) S exp pr (cid:1) uqdu(cid:0)N 0, \u03c32du .\nT t u 2 u\nt t\n(cid:1) (cid:9) (cid:1) (cid:9)\nand the random variables N 0,\u015fT \u03c32du and N 0,\u015ft \u03c32du are independent.\nt u 0 u\nUsually the interest rate r and the volatility \u03c3 are not given and we have to estimate\nt t\nthem from the data. In the next section, we discuss some estimation methods for these\ntwo parameters.\n149 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nUsing the variable r and \u03c3, we can rewrite the Black-Scholes formula for a call option by\ne(cid:1)\u015f tTruduE\u02c6 1q(cid:1)e(cid:1)\u015f tTruduK\u03a6pd\nCpT,K,S,tq :(cid:16) rpS (cid:1)Kq | S (cid:16) Ss (cid:16) S\u03a6pd 2q,\nT (cid:0) t\n(cid:2) \u017cT (cid:2) \u03c32(cid:10) (cid:10)\n1\nd 1 (cid:16) b lnpS{Kq(cid:0) r u(cid:0) u du and\n\u015fT 2\n\u03c32du t\nt u\n(cid:2) \u017cT (cid:2) \u03c32(cid:10) (cid:10)\n1\nd 2 (cid:16) b lnpS{Kq(cid:0) r u(cid:1) u du .\n\u015fT 2\n\u03c32du t\nt u\nFor a general European payoff gpS q we have the Black-Scholes price given by\nT\ne(cid:1)\u015f tTruduE\u02c6\nVpt,Sq :(cid:16) rgpS \u03c4q | S (cid:16) Ss\n0\ne(cid:1) ?\u015f tTrudu \u017c8 g(cid:2) S(cid:0) e(cid:1)\u015f tTpru(cid:1)\u03c3 2u2 qdu(cid:0)xb \u015f tT\u03c3 u2udu(cid:8)(cid:10) e(cid:1)x 22\n(cid:16) dx.\n2\u03c0\n(cid:1)8\n3.3.7 Black-Scholes with yield curve and forward interest rate\nRecall from Section 1.1.5 that the yield curve R pTq and forward curve F pTq of a zero\nt t\nbond are defined by\nB tpTq (cid:16) e(cid:1)pT(cid:1)tqRtpTq (cid:16) e(cid:1)\u015f tTFtpuqdu or or R tpTq :(cid:16) (cid:1) 1 lnB tpTq F tpTq :(cid:16) (cid:1)dlnB tpTq .\nT (cid:1)t dT\nSince setting a model for the forward rate is equivalent to setting a model for the short\nrate r , in the Black-Scholes formula with a time-varying interest rate, one can equivalently\nt\nusetheforwardrateortheyieldcurve. Assumethat\u03c3 isconstant. Then,theBlack-Scholes\npricing formula becomes\ne(cid:1)\u015f tTFtpuqduE\u02c6 1q(cid:1)e(cid:1)\u015f tTFtpuqduK\u03a6pd\nCpT,K,S,tq :(cid:16) rpS (cid:1)Kq | S (cid:16) Ss (cid:16) S\u03a6pd 2q,\nT (cid:0) t\n1 (cid:2) \u017cT \u03c32 (cid:10)\nd 1 (cid:16) a lnpS{Kq(cid:0) F tpuqdu(cid:0) pT (cid:1)tq and\n\u03c32pT (cid:1)tq 2\nt\n1 (cid:2) \u017cT \u03c32 (cid:10)\nd 2 (cid:16) a lnpS{Kq(cid:0) F tpuqdu(cid:1) pT (cid:1)tq .\n\u03c32pT (cid:1)tq 2\nt\n150 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nand\nCpT,K,S,tq :(cid:16) e(cid:1)RtpTqpT(cid:1)tqE\u02c6 rpS (cid:1)Kq | S (cid:16) Ss (cid:16) S\u03a6pd q(cid:1)e(cid:1)RtpTqpT(cid:1)tqK\u03a6pd q,\nT (cid:0) t 1 2\n1 (cid:2) \u03c32 (cid:10)\nd 1 (cid:16) a lnpS{Kq(cid:0)R tpTqpT (cid:1)tq(cid:0) pT (cid:1)tq and\n\u03c32pT (cid:1)tq 2\n1 (cid:2) \u03c32 (cid:10)\nd 2 (cid:16) a lnpS{Kq(cid:0)R tpTqpT (cid:1)tq(cid:1) pT (cid:1)tq .\n\u03c32pT (cid:1)tq 2\n(3.3.19)\n3.3.8 Black-Scholes model and Brownian motion\nInSectionB.5,weshowthatthesymmetricrandomwalkconvergestotheBrownianmotion\n\u0159N\nB . The same principle shows that the linear interpolation of the summation Z in\nt k(cid:16)1 k\nthe logarithm of the asset price in the binomial model in (3.3.4) also converges to the\nBrownian motion. Therefore, one can write the Black-Scholes model (3.3.7) by using the\nBrownian motion B ;\nt\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S exp pr(cid:1) qt(cid:0)\u03c3B . (3.3.20)\nt 0 t\n2\nHere B is a Gaussian random variable with mean zero and variance t. The above process\nt\nis called a geometric Brownian motion (GBM for short)11.\nMarkovian property of the Black-Scholes model\nSince for Brownian motion the increment B (cid:1)B is independent of B ,\ns(cid:0)t t t\n(cid:2) \u03c32 (cid:10) (cid:2) \u03c32 (cid:10)\nS (cid:16) S exp pr(cid:1) qt(cid:0)\u03c3B and S (cid:16) S exp pr(cid:1) qs(cid:0)\u03c3pB (cid:1)B q\nt 0 t t(cid:0)s t t(cid:0)s t\n2 2\nareindependent. Verbally, thismeansthatfuturepricemovementsareindependentofpast\nmovements. In other words, given the history of the movement of an asset\u2019s price until\ntime t, i.e., S for all u P r0,ts, the distribution of S only depends on S and that part\nu t(cid:0)s t\nof history during r0,tq is irrelevant. As a result, for any function g : R (cid:209) R, we have\n(cid:0)\n(cid:18) (cid:2) (cid:2) \u03c32 (cid:10)(cid:10)\u0237\nE\u02c6 rgpS q | S : @u P r0,tss (cid:16) E\u02c6 rgpS q | S s (cid:16) E\u02c6 g S exp pr(cid:1) qs(cid:0)\u03c3pB (cid:1)B q .\nt(cid:0)s u t(cid:0)s t t t(cid:0)s t\n2\nThe pricing formula (3.3.10) is precisely derived from the Markovian property of the Black-\nScholes model.\n11Paul Samuelson, in the 1950\u2019s, first came up with the idea of using GBM to model the risky asset\nprice. His primary motivation is that GBM never generates negative prices, which overcomes one of the\ndrawbacks of Bachelier model, negative prices for an asset.\n151 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nAs a result of the Markovian property of GBM, one can write\n(cid:2) (cid:2) \u03c32 (cid:10) (cid:10)\nS (cid:1)S (cid:16) S exp pr(cid:1) qdt(cid:0)\u03c3pB (cid:1)B q (cid:1)1\nt(cid:0)dt t t t(cid:0)dt t\n2\n(cid:1) \u03c32 1 (cid:9)\n(cid:16) S pr(cid:1) qdt(cid:0)\u03c3pB (cid:1)B q(cid:0) \u03c32pB (cid:1)B q2 (cid:0)opdtq.\nt t(cid:0)dt t t(cid:0)dt t\n2 2\nTherefore, the short-term return of an asset in the Black-Scholes model is given by\nS (cid:1)S \u03c32 1\nt(cid:0)dt t (cid:16) pr(cid:1) qdt(cid:0)\u03c3pB (cid:1)B q(cid:0) \u03c32pB (cid:1)B q2(cid:0)opdtq.\nt(cid:0)dt t t(cid:0)dt t\nS 2 2\nt\nThis is, in particular, consistent with Assumption 2.4.1 and the definition of mean return\nand volatility, i.e.\n(cid:18) S (cid:1)S \u0237 \u03c32 1\nE\u02c6 t(cid:0)dt t (cid:16) pr(cid:1) qdt(cid:0)\u03c3E\u02c6 rB (cid:1)B s(cid:0) \u03c32E\u02c6 rpB (cid:1)B q2s(cid:0)opdtq (cid:16) rdt(cid:0)opdtq.\nt(cid:0)dt t t(cid:0)dt t\nS 2 2\nt\n(cid:2) (cid:10)\nS (cid:1)S\nvar t(cid:0)dt t (cid:16) \u03c32dt(cid:0)opdtq.\nS\nt\nInspired from the above formal calculation, We formally write the Black-Scholes model for\nthe asset price as\ndS\nt\n(cid:16) rdt(cid:0)\u03c3dB . (3.3.21)\nt\nS\nt\nThe above equation, which describes (3.3.20) in the differential form, is called the Black-\nScholes stochastic differential equation.\nMartingale property of the Black-Scholes model\nSimilartothebinomialmodel,intheBlack-Scholesmodelthelackofarbitrageisequivalent\nto the martingale property of the discounted asset price. The discounted asset price in the\nBlack-Scholes model is given by\n(cid:2) \u03c32 (cid:10)\nS\u02dc (cid:16) e(cid:1)rtS (cid:16) S exp (cid:1) t(cid:0)\u03c3B .\nt t 0 t\n2\n152 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nThe conditional expectation of S\u02dc given S\u02dc is then given by\nt(cid:0)s t\n0E\u02c6(cid:18) exp(cid:2) (cid:1)\u03c32 t(cid:0)s(cid:10)(cid:7) t\u0237\nS pt(cid:0)sq(cid:0)\u03c3B (cid:7) (cid:7)S\u02dc\n2 (cid:7)\n0exp(cid:2) (cid:1)\u03c32 t(cid:10) E\u02c6(cid:18) exp(cid:2) (cid:1)\u03c32 tq(cid:10)(cid:7) t\u0237\n(cid:16) S t(cid:0)\u03c3B s(cid:0)\u03c3pB t(cid:0)s(cid:1)B (cid:7) (cid:7)S\u02dc\n2 2 (cid:7)\ntE\u02c6(cid:18) exp(cid:2) (cid:1)\u03c32 tq(cid:10)(cid:7) t\u0237\n(cid:16) S\u02dc s(cid:0)\u03c3pB t(cid:0)s(cid:1)B (cid:7) (cid:7)S\u02dc .\n2 (cid:7)\nBy the independence of the increments of Brownian motion, we have\nE\u02c6(cid:18) exp(cid:2) (cid:1)\u03c32 tq(cid:10)(cid:7) t\u0237 E\u02c6(cid:18) exp(cid:2) (cid:1)\u03c32 tq(cid:10)\u0237\ns(cid:0)\u03c3pB t(cid:0)s(cid:1)B (cid:7) (cid:7)S\u02dc (cid:16) s(cid:0)\u03c3pB t(cid:0)s(cid:1)B ,\n2 (cid:7) 2\nand therefore,\ntE\u02c6(cid:18) exp(cid:2) (cid:1)\u03c32 tq(cid:10)\u0237\nE\u02c6(cid:16) S\u02dc t(cid:0)s(cid:7) (cid:7)S\u02dc t(cid:24) (cid:16) S\u02dc s(cid:0)\u03c3pB t(cid:0)s(cid:1)B .\n2\nOn the other hand since B (cid:1)B (cid:18) Np0,sq, we have\nt(cid:0)s t\n(cid:2) \u03c32 (cid:10)\nE\u02c6 rexpp\u03c3pB (cid:1)B qqs (cid:16) exp s ,\nt(cid:0)s t\n2\nand therefore, E\u02c6(cid:16) S\u02dc t(cid:0)s(cid:7) (cid:7)S\u02dc t(cid:24) (cid:16) S\u02dc t.\nIn addition to the asset price, the discounted price of a newly introduced contingent claim\nmust be a martingale to preserve the no-arbitrage condition. Recall from formula (3.3.10)\nthat the price of a contingent claim with payoff gpS q is given by\nT\nVpt,S q (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS q | S s.\nt T t\nIf we define the discounted price by V\u02dc pt,S q (cid:16) e(cid:1)rtVpt,S q, then we can write the above\nt t\nas\nV\u02dc pt,S q (cid:16) e(cid:1)rTE\u02c6 rgpS q | S s.\nt T t\nBy the tower property of conditional expectation, we have\nE\u02c6(cid:16) V\u02dc pt(cid:0)s,S t(cid:0)sq(cid:7) (cid:7)S t(cid:24) (cid:16) E\u02c6(cid:17) e(cid:1)rTE\u02c6 rE\u02c6 rgpS Tq | S t(cid:0)ss(cid:7) (cid:7) (cid:7)S t(cid:25) (cid:16) e(cid:1)rTE\u02c6 rgpS Tq|S ts (cid:16) V\u02dc pt,S tq.\nTherefore, the price of the contingent claim is a martingale under risk-neutral probability.\n153 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\n3.3.9 Physical versus risk-neutral in the Black-Scholes model\nRecall from (2.4.1) that the binomial model under physical probability is given by\nS (cid:16) S H , for k (cid:16) 0,...,N (cid:1)1,\npk(cid:0)1q\u03b4 k\u03b4 k(cid:0)1\nwhere the sequence of i.i.d. random variables tH uN is given by\nk k(cid:16)1\n#\nu with probability p\nH (cid:16)\nk\n\u2113 with probability 1(cid:1)p\nThen, the dynamics of the asset price under physical probability is given by\nN\n\u201a\nlnpS q (cid:16) lnpS q(cid:0) lnpH q.\nT 0 k\nk(cid:16)1\nlnpH q is the log return Rlog. Recall from (3.3.3) that the first two moments of log return\nk k\u03b4\nare given by\n1\nErlnpH qs (cid:16) p\u00b5(cid:1) \u03c32q\u03b4(cid:0)Op\u03b42q and ErlnpH q2s (cid:16) \u03c32\u03b4(cid:0)op\u03b4q.\nk k\n2\nIf we define Z1 :(cid:16) lnpH kq(cid:1) ?p\u00b5(cid:1)\u03c32{2q, one can write\nk \u03c3 \u03b4\n(cid:2) 1 (cid:10) ? 1 \u201aN\nlnpS q (cid:16) lnpS q(cid:0) \u00b5(cid:1) \u03c32 T (cid:0)\u03c3 T (cid:4) ? Z1,\nT 0 2 N k\nk(cid:16)1\nwhere tZ1u is a sequence of i.i.d. random variables satisfying\nk\nErZ1s (cid:16) op\u03b4q, and ErpZ1q2s (cid:16) 1(cid:0)op1q.\nk k\nIf follows from (3.3.6) that ?1 \u0159N Z1 converges weakly to Np0,1q, and under physical\nN k(cid:16)1 k\nprobability, the Black-Scholes model is described by\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S exp p\u00b5(cid:1) qt(cid:0)\u03c3B .\nt 0 t\n2\nInotherwords,byswitchingfromrisk-neutralprobabilitytophysicalprobability,weadjust\nthe mean return of the asset from r to the risk-free interest rate \u00b5.\nRemark 3.3.2. For the purpose of derivative pricing, physical probability is irrelevant.\nThis is because by the fundamental theorem of asset pricing, Theorem 2.1.1, the price\nof any derivative is determined by the discounted expectation of payoff under risk-neutral\n154 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nprobability. However, for portfolio management, physical probability is important, because\nit carries the long-term growth rate of the asset, \u00b5. For example, an investor with x initial\nwealth wants to decide how to split his investment between a risk-free bond with interest\nrate r and a risky asset given by the Black-Scholes model\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S exp p\u00b5(cid:1) qt(cid:0)\u03c3B .\nt 0 t\n2\nHis objective is to maximize his expected wealth at time T subject to a constraint of the risk\nof portfolio measured by the variance of the wealth at time T, i.e.,\nmaxtErX\u03b8s(cid:1)\u03bbvarpX\u03b8qu. (3.3.22)\nT T\n\u03b8\nwhere X\u03b8 is the wealth of the investor at time T if he chooses to invest x (cid:1)\u03b8 in the risk-free\nT 0\nasset and \u03b8 in the risky asset. The wealth X\u03b8 satisfies\nT\nX T\u03b8 (cid:16) erTpx 0(cid:1)\u03b8q(cid:0)\u03b8ep\u00b5(cid:1)\u03c3 22 qT(cid:0)\u03c3BT.\nTherefore,\nErX\u03b8s (cid:16) erTpx (cid:1)\u03b8q(cid:0)\u03b8e\u00b5 and varpX\u03b8q (cid:16) \u03b82e2\u00b5Tpe\u03c32T (cid:1)1q.\nT 0 T\nTherefore, the portfolio maximization problem (3.3.22) is given by\n! )\nmax erTpx (cid:1)\u03b8q(cid:0)\u03b8e\u00b5T (cid:1)\u03bb\u03b82e2\u00b5Tpe\u03c32T (cid:1)1q\n0\n\u03b8\nand the solution is given by\ne\u00b5T (cid:1)erT\n\u03b8(cid:6) (cid:16) .\n2\u03bbe2\u00b5Tpe\u03c32T (cid:1)1q\nVolatility estimation\nNotice that the log return of the Black-Scholes model satisfies\n(cid:1)S (cid:9) \u03c32\nt(cid:0)\u03b4\nln (cid:16) p\u00b5(cid:1) q\u03b4(cid:0)\u03c3pB (cid:1)B q\nt(cid:0)\u03b4 t\nS 2\nt\nWe consider the time discretization t (cid:16) 0, t (cid:16) t (cid:0)\u03b4, and t (cid:16) t. Therefore, it follows\n0 i(cid:0)1 i N\nfrom (B.15) (the quadratic variation of Brownian motion) that\nN \u201a(cid:1)1 ln(cid:1)S ti(cid:0)1(cid:9)2 \u03c32N \u201a(cid:1)1\n(cid:16) pB (cid:1)B q2(cid:0)op\u03b4q (cid:209) \u03c32t (3.3.23)\nti(cid:0)1 ti\nS\nti\ni(cid:16)0 i(cid:16)0\n155 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nOne can use (3.3.23) to make an estimation of volatility. For any t (cid:16) i\u03b4, evaluate\ni\ni \u201a(cid:1)1 ln(cid:1)S tj(cid:0)1(cid:9)2\nY :(cid:16) .\nti\nS\ntj\nj(cid:16)0\nIf \u03b4 is small enough, then Y should approximately be equal to t \u03c32. This suggests that\nti i\nif we fit a line to the data tpt ,Y q : i (cid:16) 0,1,...u, the slope of line is \u03c32. The schematic\ni ti\npicture of this fitting is shown in figure 3.3.9.\ndata nruter\n(cid:12)tted line: Slope=(cid:27)2\ngol\nfo\nnoitairav\ncitardauQ\n0 0:5 1\nTime\nFigure 3.3.9: Quadratic variation estimation of volatility\nExercise 3.3.13 (Project). With the same set of data from Exercise 2.4.1, calculate the\nvolatility by using the quadratic variation formula (3.3.23). Take \u03b4 (cid:16) 1 year. Then, plot\n250\nthe estimated quadratic variation Y versus time t . Some examples of the generated plots\nti i\nare given in Figure 3.3.10. Then fit a line to the data by assuming Y (cid:16) \u03c32t(cid:0)noise. To fit\nt\na line to the data points, you can use the least square method. The slope of the line gives\nyou the volatility \u03c3.\n3.3.10 Black-Scholes partial differential equation\nRecall from Proposition 3.3.1 that the price Vp\u03c4,Sq of the Markovian European contingent\nclaim with payoff gpS q at time t (cid:16) T (cid:1)\u03c4 (\u03c4 is time-to-maturity) when the asset price is\nT\nS satisfies\n\u03c32S2\n(cid:1)B Vp\u03c4,Sq (cid:16) (cid:1) B Vp\u03c4,Sq(cid:1)rSB p\u03c4,Sq(cid:0)rVp\u03c4,Sq.\n\u03c4 SS S\n2\n156 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\n(cid:1)10(cid:0)2\n0:2 3\nnrutergolfonoitairavcitardauQ\n2\n0:1\n1\n0\n0 0:5 1 0 0:5 1\nTime Time\nFigure 3.3.10: Quadratic variation estimation of volatility: Left: Tesla. Right: S&P500\nTheaboveequationisapartialdifferentialequationcalledtheBlack-Scholes equation. One\nway to find the pricing formula for an option is to solve the Black-Scholes PDE. As with\nall PDEs, a boundary condition and an initial condition12 are required to solve the PDE\nanalytically or numerically. The initial condition for the Black-Scholes equation is the\npayoff of the derivative, i.e.\nVp0,Sq (cid:16) gpSq.\nNotice that here when \u03c4 (cid:16) 0, we have t (cid:16) T.\nNotice that the above PDE holds in region \u03c4 P r0,Ts and S \u0105 0. Therefore, we need a\nboundary condition at S (cid:16) 0. This boundary condition is a little tricky to devise, because\nin the Black-Scholes model, the price of the asset S never hits zero; if the price of an asset\nt\nis initially positive, then the price stays positive at all times. If the price of the asset is\ninitially 0, then S (cid:16) 0 and the price of the option with payoff gpS q is given by\nT T\nVp\u03c4,0q (cid:16) e(cid:1)r\u03c4E\u02c6 rgpS q | S (cid:16) 0s (cid:16) e(cid:1)r\u03c4gp0q.\nT T(cid:1)\u03c4\nTherefore, the boundary condition for S (cid:16) 0 is given by\nVp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q.\nTosummarize,theBlack-ScholesPDEforpricingaMarkovianEuropeancontingentclaim\nwith payoff gpS q is given by the following boundary value problem\nT\n$ \u03c32S2\nB Vp\u03c4,Sq (cid:16) B Vp\u03c4,Sq(cid:0)rSB Vp\u03c4,Sq(cid:1)rVp\u03c4,Sq\n\u2019 & \u03c4 2 SS S\nVp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q . (3.3.24)\n\u2019\n%Vp0,Sq (cid:16) gpSq\nExercise 3.3.14. Consider the option with payoff gpS Tq (cid:16) ?1 ST. Find the Black-Scholes\n12For time-dependent PDEs.\n157 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nprice of this payoff at time t (cid:16) 0 by solving PDE (3.3.24). Hint: Try to plug in Vp\u03c4,Sq (cid:16)\ne(cid:1)r\u03c4Sa into the Black-Scholes equation, for some constant a. Then, find the constant a.\nThe boundary condition Vp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q is unnecessary as gp0q (cid:16) 8.\nRemark 3.3.3. Somehow the boundary condition Vp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q is redundant in equa-\ntion (3.3.24), becauseintheBlack-Scholesmodel, thepriceoftheunderlyingassetneverhits\nzero. But this condition is important for solving the Black-Scholes equation numerically.\nHeat equation and Black-Scholes model\nRecall from Exercise 3.3.9 that the change of variable S\u02dc :(cid:16) e(cid:1)rpT(cid:1)\u03c4qS and V\u02dc p\u03c4,S\u02dc q :(cid:16)\ne(cid:1)rpT(cid:1)\u03c4qVp\u03c4,Sq (cid:16) e(cid:1)rpT(cid:1)\u03c4qVp\u03c4,erpT(cid:1)\u03c4qS\u02dc q modifies the Black-Scholes equation to\n\u03c32S\u02dc2\nB V\u02dc p\u03c4,S\u02dc q (cid:16) B V\u02dc p\u03c4,S\u02dc q.\n\u03c4 S\u02dcS\u02dc\n2\nIf we make a change of variables x :(cid:16) lnpS\u02dc q and Up\u03c4,xq :(cid:16) V\u02dc p\u03c4,exq, then we obtain the\nheat equation\n\u03c32\nB Up\u03c4,xq (cid:16) B Up\u03c4,xq.\n\u03c4 xx\n2\nUnlike (3.3.24), the heat equation holds on the whole space, i.e.\n#\n\u03c32\nB Up\u03c4,xq (cid:16) B Up\u03c4,xq\n\u03c4 2 xx . (3.3.25)\nUp0,xq (cid:16) e(cid:1)rTVperTexq\nNotice that at time t (cid:16) 0 (or \u03c4 (cid:16) T), the price of the Markovian European contingent\nclaim with payoff gpS q is equal to VpT,S q (cid:16) V\u02dc pT,S q (cid:16) UpT,lnpS qq.\nT 0 0 0\nTransforming the Black-Scholes equation into the heat equation helps us to apply nu-\nmerical techniques for the heat equation that are developed in Section 3.2.2 to obtain the\nBlack-Scholes price of an option.\n3.3.11 Numerical methods for the Black-Scholes price of a European\noption\nAlthough the Black-Scholes price of call options, put options, digital options, or a linear\ncombination of them has to a closed-form solution, there are many payoffs that does not.\nAs a result, one need to develop numerical methods to evaluate the price of such options.\nThissection,coversthefinite-differenceschemefortheBlack-Scholesequation,thebinomial\nmodel approximation of the Black-Scholes model, and the Monte Carlo approximation of\nthe price of a European option in the Black-Scholes model. All the methods in Section\n3.2.2 can also be applied after transferring the Black-Scholes into the heat equation, as\ndiscussed in Section 3.3.10.\n158 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nSolving the Black-Scholes equation via finite-difference scheme\nOnecandirectlydiscretizetheBlack-Scholesequation(3.3.24)toapplythefinite-difference\nmethod described in the previous section. See Figure 3.3.11. In this case, the computation\ndomain has to be r0,S s for some S \u0105 0. The boundary condition at 0 is already\nmax max\nassigned at (3.3.24) by\nVp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q,\nand the ABC at S is given by the growth of the payoff for large values of S. For a call\nmax\noption, for instance, the ABC is\nVpt,S q (cid:16) S for S sufficiently large.\nmax max max\nThe rest of the approximation follows as was presented in Section 3.3.10. However, one\nshould be cautious about applying explicit schemes, which need the CFL condition. Recall\nthattheright-handsideoftheCFLconditionisalways 1 timestheinverseofthecoefficient\n2\nof second derivative in the equation. Therefore, the CFL condition translates to\nh 1\n\u010f .\nk2 \u03c32S2\nIf S is chosen very large, for a fixed discretization k of variable S, one needs to set the\nmax\ndiscretization h of variable t very small. The downside of this method is that the time of\nthe algorithm increases significantly. In such cases, transferring the Black-Scholes equation\ninto the heat equation and implementing the explicit finite-difference scheme in Section\n3.3.10 is more efficient.\nS\nS\nmax\nk\nt\nT\nh\nFigure 3.3.11: Finite-difference grid for the Black-Scholes equation. In the explicit\nscheme the CFL condition should be satisfied, i.e., h \u010f 1 . This requires choosing a\nk2 \u03c3S\nvery small h. Artificial boundary conditions are necessary on both S and 0.\nmax\n159 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nBinomial model scheme for the Black-Scholes equation\nRecall from Section 3.3.1 that the Black-Scholes model is the limit of the binomial model\nunder risk-neutral probability. Therefore, if necessary, one can use the binomial model\nto approximate the Black-Scholes price of the contingent claim. For implementation, one\nneeds to choose a sufficiently large number of periods N or, equivalently, a small \u03b4 (cid:16) T .\nN\nSuggested by (3.3.1), for a given interest rate r and volatility \u03c3, we need to choose u and\n\u2113 and the one-period interest rate R as follows.\nu (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3\u03b1, l (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3\u03b2, and R (cid:16) r\u03b4,\nwhere \u03b1 and \u03b2 are given by (2.4.6). However, one can avoid the calculation of \u03b1 and \u03b2 by\nmaking some different choices. Notice that the binomial model has three parameters u, \u2113\nand R while the Black-Scholes parameters are only two. This degree of freedom provides\nus with some modifications of binomial model, which still converges to the Black-Scholes\nformula. This also simplifies the calibration process in Section 2.4 significantly. Here are\nsome choices:\n1) Symmetric probabilities:\nu (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:0)? \u03b4\u03c3, l (cid:16) e\u03b4pr(cid:1)\u03c3 22 q(cid:1)? \u03b4\u03c3, and R (cid:16) r\u03b4,\nThen\n1\n\u03c0\u02c6 (cid:16) \u03c0\u02c6 (cid:16) .\nu \u2113\n2\n2) Subjective return:\n? ?\nu (cid:16) e\u03b4\u03bd(cid:0) \u03b4\u03c3, l (cid:16) e\u03b4\u03bd(cid:1) \u03b4\u03c3, and R (cid:16) r\u03b4,\nThen\n(cid:3) (cid:11) (cid:3) (cid:11)\n1 ? r(cid:1)\u03bd (cid:1) 1\u03c32 1 ? r(cid:1)\u03bd (cid:1) 1\u03c32\n\u03c0\u02c6 (cid:16) 1(cid:0) \u03b4 2 and \u03c0\u02c6 (cid:16) 1(cid:1) \u03b4 2 .\nu \u2113\n2 \u03c3 2 \u03c3\nTo see why this choices work, recall (3.3.4) from Section 3.3.1. The only criteria for the\nconvergence of the binomial model to the Black-Scholes model is that when we write the\nlog of asset price in the binomial model as in (3.3.4),\n\u03c32 ? 1 \u201aN\nlnpS q (cid:16) lnpS q(cid:0)pr(cid:1) qT (cid:0)\u03c3 T (cid:4) ? Z ,\nT 0 k\n2 N\nk(cid:16)1\n160 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nthe random variables Z , k (cid:16) 1,...,N must satisfy\nk\nE\u02c6 rZ s (cid:16) op\u03b4q and E\u02c6 rZ2s (cid:16) 1(cid:0)op1q.\n1 1\nIn Section 3.3.1, we made a perfect choice of E\u02c6 rZ s (cid:16) 0 and E\u02c6 rZ2s (cid:16) 1.\n1 1\nMonte Carlo scheme for Black-Scholes\nRecall from Section 3.3.2 that the price of a Markovian European contingent claim can be\nwritten as an expectation and/or a single integral.\nVp\u03c4,Sq :(cid:16) e(cid:1)r\u03c4E\u02c6 rgpS \u03c4q | S (cid:16) Ss (cid:16) ?e(cid:1)r\u03c4 \u017c8 g(cid:2) S(cid:0) epr(cid:1)\u03c3 22 q\u03c4(cid:0)\u03c3? \u03c4x(cid:8)(cid:10) e(cid:1)x 22 dx.\n0\n2\u03c0\n(cid:1)8\nOne way to estimate VpT,S q is to generate a sample xp1q,...,xpMq of Np0,1q and approx-\n0\nimate the above expectation by\ne(cid:1)rT \u201aM g(cid:2) 0(cid:0) epr(cid:1)\u03c3 22 qT(cid:0)\u03c3? Txpjq(cid:8)(cid:10)\nS . (3.3.26)\nM\nj(cid:16)1\nAnotherclassofapproximationmethods, quadrature methods, directlytargetstheintegral\nby choosing a large number 0 \u0103 x and approximate the integral\nmax\n\u017cxmax g(cid:2) \u03c4x(cid:8)(cid:10)\nS(cid:0) epr(cid:1)\u03c3 22 q\u03c4(cid:0)\u03c3? e(cid:1)x 22\ndx\n(cid:1)xmax\nby a finite Riemann sum. For instance, if we choose \u2206x :(cid:16) xmax and x (cid:16) j\u2206x, the\nL pjq\napproximation goes as follows:\n?e(cid:1)r\u03c4 \u017cxmax g(cid:2) S(cid:0) epr(cid:1)\u03c3 22 q\u03c4(cid:0)\u03c3? \u03c4x(cid:8)(cid:10) e(cid:1)x 22\nVp\u03c4,Sq (cid:19) dx\n2\u03c0\n(cid:1)xmax\n(cid:19) e(cid:1)rT L \u201a(cid:1)1 g(cid:2) S 0(cid:0) epr(cid:1)\u03c3 22 qT(cid:0)\u03c3? Tx pjq(cid:8)(cid:10) e(cid:1)x2 p 2jq \u2206x.\nj(cid:16)(cid:1)L\nQuadrature methods, if implemented carefully, can be more efficient than the naive Monte\nCarlo scheme (3.3.26).\nExercise 3.3.15 (Project). Consider the payoff of a bull-spread call in Figure 3.3.8 with\nT (cid:16) 1, K (cid:16) 10, and K (cid:16) 20. Assume that the parameters of the underlying asset\n1 2\nare given by S (cid:16) 15 and \u03c3 (cid:16) .02, and that the interest rate is r (cid:16) .01. Compare the\n0\nfollowing approximation schemes for the price of the bull-spread call. Record the time of\nthe algorithms for each scheme to obtain four-digit accuracy.\n161 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\na) The closed-form solution for the value of this option from the Black-Scholes formula.\nb) Implicit finite-difference with parameter \u03b8 (cid:16) .5.\nc) Implicit finite-difference with parameter \u03b8 (cid:16) 1.\nd) Explicit finite-difference (equivalently implicit with \u03b8 (cid:16) 0).\ne) Symmetric binomial model.\nf) Monte Carlo scheme.\ng) Approximation by a Riemann sum.\n3.3.12 Stock price with dividend in the Black-Scholes model\nIN this section, we consider two types of dividend strategies. If the dividend is paid\ncontinuously, then there is a constant outflow of cash from the price of the asset. If the\nrate of dividend payment is D , the Black-Scholes model in (3.3.21) has to be modified to\nt\ndS (cid:16) rS dt(cid:0)\u03c3dB (cid:1)D dt.\nt t t t\nChoosing D :(cid:16) qS for q \u011b 0, we obtain\nt t\ndS (cid:16) pr(cid:1)qqS dt(cid:0)\u03c3S dB .\nt t t t\nRemark 3.3.4. For a continuous dividend rate q, the dividend yield in time period rt,Ts\nis given by e(cid:1)qpT(cid:1)tq(cid:2)100 percent.\nEspecially, this choice guarantees that the dividend is always less than the asset price and\nthat paying the dividend does not diminish the value of the asset. In exponential form, we\nhave\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S expppr(cid:1)qqt(cid:0)\u03c3B q (cid:16) e(cid:1)qtS exp pr(cid:1) qt(cid:0)\u03c3B .\nt 0 t 0 t\n2\nIn this case, the Black-Scholes price of a European contingent claim with payoff gpS q is\nT\ngiven by\n(cid:17) (cid:1) (cid:9) (cid:25)\nVpt,Sq (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS q | S (cid:16) Ss (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 g e(cid:1)qpT(cid:1)tqS\u02dc | S\u02dc (cid:16) S ,\nT t T t\nwhere S\u02dc satisfies the Black-Scholes equation without dividend, i.e.\nt\n(cid:2) \u03c32 (cid:10)\nS\u02dc (cid:16) S exp pr(cid:1) qt(cid:0)\u03c3B .\nt 0 t\n2\n162 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\nIf the dividend strategy is time-varying q , then one can write the above pricing formula as\nt\nVpt,Sq (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6(cid:17) g(cid:1) e(cid:1)\u015f tTqsdsS\u02dc T(cid:9) | S\u02dc (cid:16) S(cid:25) .\nt\nForcontinuous-ratedividend,therelationbetweentheGreeksoftheoptioninProposition\n3.3.1 is modified as in the following proposition.\nProposition 3.3.2. Let S follow the Black-Scholes price with a continuous dividend rate\nt\nq. For a European Markovian contingent claim, the Black-Scholes price satisfies\n\u03c32S2\n\u0398p\u03c4,Sq (cid:16) (cid:1) \u0393p\u03c4,Sq(cid:1)pr(cid:1)qqS\u2206p\u03c4,Sq(cid:0)rVp\u03c4,Sq.\n2\nThe second type of dividend strategy is discrete. The discrete dividend is paid in times\n0 \u010f t \u0103 t \u0103 ... \u0103 t \u010f T in amounts D ,...,D . Then, between the times of dividend\n0 1 N 0 N\npayment, the asset price follows the Black-Scholes model, i.e.\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S exp pr(cid:1) qpt(cid:1)t q(cid:0)\u03c3pB (cid:1)B q , t P rt ,t q.\nt tn(cid:1)1 n(cid:1)1 t tn(cid:1)1 n(cid:1)1 n\n2\nJust a moment before the payment of dividend at time t (cid:1)13 the price of the asset is\nn\n(cid:2) \u03c32 (cid:10)\nS :(cid:16) S exp pr(cid:1) qpt (cid:1)t q(cid:0)\u03c3pB (cid:1)B q .\ntn(cid:1) tn(cid:1)1 n n(cid:1)1 tn tn(cid:1)1\n2\nBut, after paying a dividend of D , this price drops to\nn\n(cid:2) \u03c32 (cid:10)\nS (cid:16) S (cid:1)D (cid:16) S exp pr(cid:1) qpt (cid:1)t q(cid:0)\u03c3pB (cid:1)B q (cid:1)D .\ntn tn(cid:1) n tn(cid:1)1 n n(cid:1)1 tn tn(cid:1)1 n\n2\nAs mentioned in Section 2.3.4, the dividend is usually given as a percentage of the current\nasset price, i.e.\nD (cid:16) d S , with d P r0,1q.\nn n tn(cid:1) n\nand we have\n(cid:2) \u03c32 (cid:10)\nS (cid:16) p1(cid:1)d qS (cid:16) p1(cid:1)d qS exp pr(cid:1) qpt (cid:1)t q(cid:0)\u03c3pB (cid:1)B q .\ntn n tn(cid:1) n tn(cid:1)1 n n(cid:1)1 tn tn(cid:1)1\n2\nRemark 3.3.5. For a discrete dividend, the dividend yield in time period rt ,t s is\nn(cid:1)1 n\nd (cid:2)100 percent.\nn\n13The moment before time t is denoted by t(cid:1).\n163 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\nTherefore,\n\u017aN (cid:2) \u03c32 (cid:10)\nS (cid:16) p1(cid:1)d qS exp pr(cid:1) qT (cid:0)\u03c3B .\nT n 0 T\n2\nn(cid:16)1\nRemark 3.3.6. If at time T there is a dividend payment, the payoff of a contingent claim\ngpS q takes into account the price S after the payment of the dividend. In short, the price\nT T\nof the asset at the maturity is always ex-dividend.\nProposition 3.3.3. Let S follow the Black-Scholes price with the discrete dividend policy\nt\ngiven by d ,...,d P r0,1q at times 0 \u010f t \u0103 t \u0103 ... \u0103 t \u010f T . For a European Markovian\n0 N 0 1 N\ncontingent claim, the Black-Scholes price satisfies\n\u03c32S2\n\u0398p\u03c4,Sq (cid:16) (cid:1) \u0393p\u03c4,Sq(cid:1)rS\u2206p\u03c4,Sq(cid:0)rVp\u03c4,Sq for \u03c4 P pT (cid:1)t ,T (cid:1)t q.\nn n(cid:1)1\n2\nThen, the Black-Scholes price of a contingent claim with payoff gpS q is given by\nT\n(cid:17) (cid:1) \u017a (cid:9) (cid:7) (cid:25)\nVpt,Sq (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 rgpS q | S (cid:16) Ss (cid:16) e(cid:1)rpT(cid:1)tqE\u02c6 g p1(cid:1)d qS\u02dc (cid:7)S\u02dc (cid:16) S ,\nT t n T (cid:7) t\nt\u0103tn\u010fT\nwhere S\u02dc satisfies the simple no-dividend Black-Scholes model.\nt\nExercise 3.3.16. Consider a portfolio of one straddle option with K (cid:16) 10 and one strangle\noption with K (cid:16) 8 and K (cid:16) 14, both maturing at T (cid:16) 1. See Figure 3.3.7. Assume that\n1 2\nthe underlying asset has parameters S (cid:16) 2 and \u03c3 (cid:16) .2, and that it pays a 4% quarterly\n0\ndividend. The interest rate is r (cid:16) .01 (1%). Find the price of this portfolio and its \u2206 and\n\u0393 at time t (cid:16) 0.\nRemark 3.3.7. Dividend strategies are sometimes not known upfront and therefore should\nbe modeled by random variables. If the dividend policy is a random policy that depends on\nthe path of the stock price, then, the pricing formula will be more complicated even in the\nBlack-Scholes model.\nExercise 3.3.17 (Butterfly spread). Consider the payoff gpS q shown in Figure 3.3.12.\nT\nConsider the Black-Scholes model for the price of a risky asset with T (cid:16) 1, r (cid:16) .04, and\n\u03c3 (cid:16) .02 with dividends paid quarterly with a dividend yield of 10%. Take S (cid:16) 10, K (cid:16) 9,\n0 1\nand K (cid:16) 11. Find the Black-Scholes price, \u2206, \u0393, \u03c1, and V of this option at time t (cid:16) 0.\n2\nFind \u0398 at time t (cid:16) 0 without taking derivatives with respect to S.\n164 3. CONTINUOUS MARKETS 3.3. BLACK-SCHOLES MODEL\ng(S )\nT\nK2(cid:0)K1\n2\nS\nK K T\n1 K1+K2 2\n2\nFigure 3.3.12: Butterfly spread payoff\nThe Black-Scholes equation with dividend\nIn the case of dividends, the Black-Scholes equation in (3.3.24) is given by\n$ \u03c32S2\nB Vp\u03c4,Sq (cid:16) B Vp\u03c4,Sq(cid:0)pr(cid:1)qqSB p\u03c4,SqVp\u03c4,Sq(cid:1)rVp\u03c4,Sq\n\u2019 & \u03c4 2 SS S\nVp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q .\n\u2019\n%Vp0,Sq (cid:16) gpSq\nThis also allows us to solve the derivative pricing problem with more complicated dividend\nstrategies. Let\u2019s assume that the dividend payment rate at time t is a function qpt,S q.\nt\nThen, the Black-Scholes model with dividend is given by the SDE\ndS (cid:16) S pr(cid:1)qpt,S qqdt(cid:0)\u03c3S dB .\nt t t t t\nand Black-Scholes equation in (3.3.24) is given by\n$ \u03c32S2\nB Vp\u03c4,Sq (cid:16) B Vp\u03c4,Sq(cid:0)pr(cid:1)qpt,SqqSB Vp\u03c4,Sq(cid:1)rVp\u03c4,Sq\n\u2019 & \u03c4 2 SS S\nVp\u03c4,0q (cid:16) e(cid:1)r\u03c4gp0q .\n\u2019\n%Vp0,Sq (cid:16) gpSq\nAfter the change of variables described in Section 3.3.10, we obtain\n#\nB Up\u03c4,xq (cid:16) \u03c32 B Up\u03c4,xq(cid:1)qpT (cid:1)\u03c4,erpT(cid:1)\u03c4qexqB Up\u03c4,xq,\n\u03c4 2 xx x .\nUp0,xq (cid:16) e(cid:1)rTVperTexq\nTheaboveequationisaheatequationwithadrifttermgivenbyqpT(cid:1)\u03c4,erpT(cid:1)\u03c4qexqB Up\u03c4,xq.\nx\nExercise 3.3.18 (Project). Consider a European call option with T (cid:16) 1 and K (cid:16) 2.\nAssume that the parameters of the underlying asset are given by S (cid:16) 2 and \u03c3 (cid:16) .2, and\n0\nthat the interest rate is r (cid:16) .01 (1%). In addition, assume that the underlying asset pays\n165 3.3. BLACK-SCHOLES MODEL 3. CONTINUOUS MARKETS\ndividends at continuous rate qpt,S q (cid:16) .05e(cid:1).01tS , i.e., 5% of the discounted asset price.\nt t\na) Write the Black-Scholes equation for this problem and convert it into a heat equation\nwith a drift term.\nb) Solve this problem numerically by using a finite-difference scheme.\nExample 3.3.2. Consider a European option with payoff\ngpS q (cid:16) e\u03b1ST.\nT\nAssume that the interest rate is r \u0105 0 and that the volatility of the underlying asset is \u03c3 \u0105 0,\nand at time 0 it has value S , and pays dividends at a continuous rate qpt,S q (cid:16) qS , where\n0 t t\nq \u0105 0. Then, the Black-Scholes equation is given by\n#\n\u03c32S2\nB Vp\u03c4,Sq (cid:16) B Vp\u03c4,Sq(cid:0)pr(cid:1)qSqSB Vp\u03c4,Sq(cid:1)rVp\u03c4,Sq\n\u03c4 2 SS S .\nVp0,Sq (cid:16) e\u03b1S.\nThe boundary condition for the Black-Scholes equation at S (cid:16) 0 is given by\nVp\u03c4,0q (cid:16) 1.\nFunction Vp\u03c4,Sq (cid:16) e(cid:1)r\u03c4e\u03b1S satisfies the Black-Scholes equation and the boundary condi-\ntions. Therefore, the price of the contingent claim with payoff e\u03b1ST at time-to-maturity \u03c4\n(at time T (cid:1)\u03c4) is given by Vp\u03c4,Sq (cid:16) e(cid:1)r\u03c4e\u03b1S if the asset price takes value S at that time.\nExercise 3.3.19. Consider a European option with payoff\ngpS q (cid:16) S(cid:1)5e10ST.\nT T\nAssume that the interest rate is r (cid:16) .1 and the underlying asset satisfies S (cid:16) 2 and \u03c3 (cid:16) .2,\n0\nand that pays dividends at a continuous rate of qpt,S q (cid:16) .2S .\nt t\na) Write the Black-Scholes equation for this problem.\nb) Solve this problem analytically by the method of separation of variables. Plug into the\nequation a solution candidate with the form e\u03b1\u03c4S(cid:1)5e10S and determine \u03b1.\n166 4. AMERICAN OPTIONS\n4\nAmerican options\nUnlikeEuropeanoptions,holderofanAmericanoptionshastherightbutnottheobligation\nto exercise any date before or at the maturity. When she chooses to exercise the option\nat time t P r0,Ts (or in discrete-time models t P t0,...,Tu), she receives the payoff of the\noption gpt,S q; i.e., the payoff is a function gpt,Sq of the time of exercise t and the price\nt\nof the underlying S at the time of exercise. For instance, the payoff of an American call\noption if exercises at time t is pS (cid:1)Kq .\nt (cid:0)\nTo price an American option, we assume that the holder chooses to exercise the American\noption at the optimal time of exercise; the time that the holder receives the largest value\npossible. We will discuss the details of the optimal exercise time in the future.\nWe use C pT,K,S,tq and P pT,K,S,tq to denote the price of American call and\nAm Am\nAmerican put at time t when the underlying asset price is S with maturity T and strike K,\nrespectively. The following remarks are very important in our future study of American\noption.\nRemark 4.0.1. Notice that since exercising is always an option, the value of the American\noption never falls below the payoff. In fact, is can sometimes be strictly larger than the\npayoff.\nRemark 4.0.2. Consider an American option with payoff gpt,Sq which can possibly take\nnegative values. Since the holder has no obligation to exercise the option, she will not do\nso as long as gpt,S q \u010f 0. In particular, if the American option has not been exercised\nt\nbefore the maturity T, it is not optimal for her to exercise at T if SpT,S q \u010f 0. Therefore,\nT\nthe actual payoff is g pt,Sq (cid:16) maxt0,gpt,Squ. On the other hand, if the payoff gpT,S q is\n(cid:0) T\npositive at maturity, it is always optimal to exercise it. Therefore, we always assume that\nthe payoff of an American option is nonnegative.\nRemark 4.0.3. The price p of an American option with payoff g pt,Sq(cid:0)g pt,Sq is not\n1 2\nthe same as the sum of the price p of an American option with payoff g pt,Sq and price p\n1 1 2\nof an American option with payoff g pt,Sq. In fact, the first value is always smaller than\n2\n167 4. AMERICAN OPTIONS\nor equal to the sum of the other two. To see this, let t\u02dcbe the optimal exercise time for the\nAmerican option with payoff g pt,Sq(cid:0)g pt,Sq, i.e., the present value of the option is\n1 2\np (cid:16) B pt\u02dcqpg pt\u02dc,S q(cid:0)g pt\u02dc,S qq.\n0 1 t\u02dc 2 t\u02dc\nNotice that time t\u02dcis not necessarily optimal for the other two American options with payoff\ng pt,Sq or g pt,Sq. Therefore,\n1 2\np \u011b B pt\u02dcqg pt\u02dc,S q, for i (cid:16) 1,2.\ni 0 i t\u02dc\nThis implies that p \u010f p (cid:0)p .\n1 2\n4.0.1 Pricing American option in the binomial model via examples\nThe key to the pricing of American options is to compare to values at each node of the\nmodel, i.e., continuation value and exercise value. We will properly define these values in\nthis section and use them to price American option. We first present the pricing method\nin the naive case of one-period binomial model.\nExample 4.0.1. Consider a one-period binomial model with S (cid:16) 1, u (cid:16) 2.1, \u2113 (cid:16) .6 and\n0\nR (cid:16) .1 (for simplicity). We consider an American put option with strike K; the payoff is\npK(cid:1)Sq . Similar to the European put, at the terminal time T (cid:16) 1, the value of the option\n(cid:0)\nis known. However, at time t (cid:16) 0 we are facing a different situation; we can choose to\nexercise and get the exercise value of E :(cid:16) pK (cid:1)1q , or we can continue. If we continue,\n(cid:0)\nwe will have a payoff of pK(cid:1)2.1q or pK(cid:1).6q depending of the future events. The value\n(cid:0) (cid:0)\nof continuation is obtain via taking risk-neutral expectation:\n(cid:2) (cid:10)\n1 1 1 2\nC :(cid:16) E\u02c6 rpK (cid:1)S q s (cid:16) pK (cid:1)2.1q (cid:0) pK (cid:1).6q .\nT (cid:0) (cid:0) (cid:0)\n1(cid:0)R 1.1 3 3\n(K(cid:0)2:1)\n+\nmaxfC;Eg\n(K(cid:0):6)\n+\nFigure 4.0.1: American put option in one-period binomial model\nNext, we should compare continuation value C and exercise value E. If C \u0105 E, we should\nnot exercise at time 0 and should wait until time 1. Otherwise when C \u010f E, it is optimal\n168 4. AMERICAN OPTIONS\nto exercise. For example when K (cid:16) 3, we have C (cid:16) 1.7273 \u0103 E (cid:16) 2 and thus we exercise.\nHowever, when K (cid:16) 1, we have C (cid:16) .2424 \u0105 E (cid:16) 0 and thus we do not exercise.\nK\n0:6 21 2:1\n13\nFigure 4.0.2: One-period binomial model: continuation value C (cid:16)\n(cid:0) (cid:8)\n1 1pK (cid:1)2.1q (cid:0) 2pK (cid:1).6q (gray) and exercise value E (cid:16) pK (cid:1) 1q (red) of\n1.1 3 (cid:0) 3 (cid:0) (cid:0)\nan American put option as a function of strike price K.\nAs seen in Figure 4.0.2, only American put options with strike K in p.6, 21q generate a\n13\nlarger continuation value and therefore should not be exercises at time 0.\nTo illustrate more, we consider a two period binomial model in the following example.\nExample 4.0.2. Consider a two-period binomial model with the same parameters as in\nExercise 4.0.1, i.e., u (cid:16) 2.1, \u2113 (cid:16) .6 and R (cid:16) .1. We consider an American put option\nwith strike K; the payoff is pK(cid:1)Sq . The terminal time T (cid:16) 2, the value of the option is\n(cid:0)\nknown. At time t (cid:16) 1, there are two nodes and at time t (cid:16) 0 there is one node, at each of\nwhich we have to find exercise value and continuation value. The exercise values are given\nby the payoff as seen in Figure 4.0.3\nHere C , C , and C are the continuation values at nodes t (cid:16) 0, t (cid:16) 1 price-down, and\n0 1,1 1,2\nt (cid:16) 1 price-up, respectively. Next, we should compare continuation value and exercise value\nat each node in a backward manner. At time t (cid:16) 1, the continuation value is\n(cid:2) (cid:10)\n1 1 1 2\nC (cid:16) E\u02c6 rpK (cid:1)S q | S (cid:16) 2.1s (cid:16) pK (cid:1)4.41q (cid:0) pK (cid:1)1.26q\n1,2 T (cid:0) 1 (cid:0) (cid:0)\n1(cid:0)R 1.1 3 3\n(cid:2) (cid:10)\n1 1 1 2\nC (cid:16) E\u02c6 rpK (cid:1)S q | S (cid:16) .6s (cid:16) pK (cid:1)1.26q (cid:0) pK (cid:1).36q\n1,1 T (cid:0) 1 (cid:0) (cid:0)\n1(cid:0)R 1.1 3 3\n169 4. AMERICAN OPTIONS\n(K(cid:0)4:41)+\nmaxfC1;2;(K(cid:0)2:1)+g\nmaxfC0;(K(cid:0)1)+g (K(cid:0)1:26)+\nmaxfC1;1;(K(cid:0):6)+g\n(K(cid:0):36)+\nFigure 4.0.3: American put option in two-period binomial model\nTherefore, the price of the option at these nodes are\n\" (cid:2) (cid:10) *\n1 1 2\nV (cid:16) max pK (cid:1)4.41q (cid:0) pK (cid:1)1.26q ,pK (cid:1)2.1q\n1,2 (cid:0) (cid:0) (cid:0)\n1.1 3 3\n\" (cid:2) (cid:10) *\n1 1 2\nV (cid:16) max pK (cid:1)1.26q (cid:0) pK (cid:1).36q ,pK (cid:1).6q\n1,1 (cid:0) (cid:0) (cid:0)\n1.1 3 3\nK K\n1:26 2:1 3:3 4:41 :36 :6 12:61:26\n13\nNode (1;2) Node (1;1)\nFigure 4.0.4: Two-period binomial model: at each nodes at time t (cid:16) 1, continuation\nvalue (gray) is compared to exercise value (red) as a function of strike price K.\nAs you see from Figure 4.0.4, if we choose the strike of the option K in p1.26,3.3q, then\nat node p1,2q the continuation value is larger, otherwise we exercise at this node. If we\nchooseK in p.36, 12.6q, at nodep1,1q thecontinuationvalue islarger.Inthis example, values\n13\nof K that imposes the continuation in node p1,1q is disjoint from those which imposed\ncontinuation at node p1,2q. Therefore, we exercise the American option on at least one of\n170 4. AMERICAN OPTIONS\nthese nodes.\nNow let fix our put option by choosing K (cid:16) 2. Then, we continue at node p1,2q and\nexercise at node p1,1q. Therefore, at time t (cid:16) 1, the option takes values\nV (cid:16) C (cid:19) 0.4485 and V (cid:16) 1.4.\n1,2 1,2 1,1\nAt time t (cid:16) 0, we need to see if it is optimal to exercise or if it is optimal to continue. The\nsituation at node p0,0q is explained in Figure 4.0.5. The exercise value is E (cid:16) 1 but the\ncontinuation value is positive, i.e., C (cid:16) .9844. Therefore, it is optimal to exercise.\n0:4485\nmaxfC;Eg = E = 1\n1:4000\nFigure4.0.5: Americanputoptionattimet (cid:16) 0intwo-periodbinomialmodelofExample\n4.0.2.\nRemark 4.0.4. As a general rule, when it is optimal to exercise, i.e., the continuation\nvalue is less than or equal to exercise value, there is no point in continuing the option. This\nis because the continuation value remains equal to exercise value since then after. This can\nbe observed from Example 4.0.2 by taking for example K (cid:16) 1. The schematic pattern of\nexercise and continuation nodes is presented in Figure 4.0.6.\n(4.41,0) (4.41,0)\n(2.1,0) (2.1,.9)\n(1,.2424) (1.26,0) (1,1) (1.26,.74)\n(.6,.4) (.6,1.4)\nK = 1 (.36,.46) K = 2 (.36,1.64)\nFigure 4.0.6: The pattern of continuation versus exercise in a two-period binomial model\nin Example 4.0.2. The red nodes are the exercise nodes and blue nodes are continuation\nnodes. In the pair pa,bq, a is the asset price and b is the continuation value.\nExercise 4.0.1. In Example 4.0.2, take the following values of K.\n171 4.1. PRICING AMERICAN OPTION IN THE BINOMIAL MODEL; PROBLEM\nFORMULATION 4. AMERICAN OPTIONS\n1) K (cid:16) 1.\n2) K (cid:16) 3.\n4.1 Pricing American option in the binomial model; problem\nformulation\nInthissection, weformulatetheproblemofpricinganAmericanoptionwith(nonnegative)\npayoff gpt,Sq in T-period binomial model. Notice that to price an American option, it is\nimportanttoknowthebestexercisetimefortheholderoftheoption. Sincethepriceofthe\nunderlying is randomly changing over time, the best execution time can also be a random\ntime. To formulate an exercise strategy as a random time, we need to define the notion of\nstopping time. Recalling from Definition B.19, we define an exercise strategy for the multi\nperiod binomial model.\nDefinition 4.1.1. An exercise strategy for an American option is a stopping time with\nrespect to price of underlying tS : t (cid:16) 0,...u, i.e., is a random variables \u03c4 : \u2126 (cid:209) t0,...,Tu\nt\nsuch that for any t (cid:16) 0,...,T, the even \u03c4 \u010f t is known given the values of S for u \u010f t.\nu\nIn other words, exercise strategy is a stopping time with respect to the information gen-\nerated by the price process. Given the holder of an American option chooses a specific\nstopping time \u03c4, the corresponding value of the option is obtained through\n(cid:17) 1 (cid:25)\nE\u02c6 gp\u03c4,S q .\np1(cid:0)Rq\u03c4 \u03c4\nTherefore, the (optimal) value of the option for the holder is given by the maximum value\nover all exercise strategies;\n(cid:17) 1 (cid:25)\nV :(cid:16) maxE\u02c6 gp\u03c4,S q ,\n0 \u03c4PT p1(cid:0)Rq\u03c4 \u03c4\n0\nwhere the maximum is taken over the set T all stopping times \u03c4 with values in t0,...,Tu.\n0\nSince the binomial model can be constructed on a finite sample space (the set of all price\nprocess paths is finite), then the set T is finite and therefore in the above e can show the\n0\nvalue of the American option with a maximum. More generally, given the option has not\nbeen exercised until time t, then the value of the option is given\n1\nV :(cid:16) maxE\u02c6 r gp\u03c4,S q | F s. (4.1.1)\nt \u03c4PT p1(cid:0)Rq\u03c4(cid:1)t \u03c4 t\nt\nHere the maximum is taken over the finite set T of all stopping times \u03c4 with values in\nt\ntt,...,Tu. Since T is finite, there exists an optimal exercise strategy (stopping time) \u03f1(cid:6)\n0\n172 4. AMERICAN OPTIONS 4.1. AMERICAN OPTION IN THE BINOMIAL MODEL\nwith values in t0,...,Tu such that\n(cid:17) 1 (cid:25)\nV (cid:16) E\u02c6 gp\u03f1(cid:6),S q\n0 p1(cid:0)Rq\u03f1(cid:6) \u03f1(cid:6)\nSimilarly at time t, there exists an optimal a stopping time \u03f1(cid:6) with values in tt,...,Tu such\nt\nthat\n(cid:17) 1 (cid:25)\nV (cid:16) E\u02c6 gp\u03f1(cid:6),S q | F\nt p1(cid:0)Rq\u03f1(cid:6) t(cid:1)t t \u03f1(cid:6) t t\nWe explain the methodology for pricing American option in the simple one-period case\nby choosing t (cid:16) T (cid:1)1, i.e.\n1\nV :(cid:16) max E\u02c6 r gp\u03c4,S q | F s,\nT(cid:1)1 \u03c4PT p1(cid:0)Rq\u03c4(cid:1)T(cid:0)1 \u03c4 T(cid:1)1\nT(cid:1)1\nwhere the maximum is taken over all stopping times \u03c4 with two values T (cid:1)1 and T; the\nformer corresponds to decision to exercise at time T (cid:1)1, while the latter is to continue\nuntill maturity T. Given F , for any stopping time \u03c4 with two values tT (cid:1)1,Tu, the\nT(cid:1)1\nevents t\u03c4 (cid:16) T (cid:1)1u (cid:16) t\u03c4 \u010f T (cid:1)1u and t\u03c4 (cid:16) Tu (cid:16) t\u03c4 \u010f T (cid:1)1uA are both known. Therefore,\neither \u03c4 (cid:16) T (cid:1) 1 a.s. or \u03c4 (cid:16) T a.s.. When \u03c4 (cid:16) T (cid:1) 1 we obtain the exercise value\ngpT (cid:1) 1,S q; otherwise \u03c4 (cid:16) T yields the continuation value 1 E\u02c6 rgpT,S q | F s.\nT(cid:1)1 1(cid:0)R T T(cid:1)1\nTherefore, the choice of exercise strategy boils down to choosing the maximum of the\nexercise value gpT (cid:1)1,S q and the continuation value 1 E\u02c6 rgpT,S q | F s, i.e.\nT(cid:1)1 1(cid:0)R T T(cid:1)1\n! 1 )\nV (cid:16) max E\u02c6 rgpT,S q | F s,gpT (cid:1)1,S q .\nT(cid:1)1 T T(cid:1)1 T(cid:1)1\n1(cid:0)R\nBy using the Markov property of the binomial model, we have E\u02c6 rgpT,S q | F s (cid:16)\nT T(cid:1)1\nE\u02c6 rgpT,S q | S s and thus the value of the American option is a function of time T (cid:1)1\nT T(cid:1)1\nand asset price S , i.e.\nT(cid:1)1\n! 1 )\nVpT (cid:1)1,S q (cid:16) max E\u02c6 rgpT,S q | S s,gpT (cid:1)1,S q .\nT(cid:1)1 T T(cid:1)1 T(cid:1)1\n1(cid:0)R\nIn this one period situation, it isnot hard to see that the optimal stopping time is obtained\nby the first time t (among T (cid:1)1, and T) that the exercise value gpt,S q is not smaller than\nt\ncontinuation value 1 E\u02c6 rgpT,S q | S s. Notice that from Remark 4.0.2 the value of the\n1(cid:0)R T T(cid:1)1\nAmerican option at maturity time T is always equal gpT,S q and\nT\n! 1 )\nVpT (cid:1)1,S q (cid:16) max E\u02c6 rV | S s,gpT (cid:1)1,S q .\nT(cid:1)1 T T(cid:1)1 T(cid:1)1\n1(cid:0)R\nIn the sequel, we would like to extend the above implication to all t. More precisely, we\nseek to show the following theorem.\n173 4.1. AMERICAN OPTION IN THE BINOMIAL MODEL 4. AMERICAN OPTIONS\nTheorem 4.1.1. The value of the American option with payoff function gpt,Sq is a func-\ntion Vpt,Sq of time t and the asset price S which satisfies\n! 1 )\nVpt,S q (cid:16) max E\u02c6 rVpt(cid:0)1,S q | S s,gpt,S q (4.1.2)\nt t(cid:0)1 t t\n1(cid:0)R\nHere the supremum is over all stopping times with values in tt,...,Tu. In addition, we show\nthat an optimal exercise strategy is given by the stopping time \u03c4(cid:6) defined by the first time\nt\nu \u011b t such that Vpu,S q (cid:16) gpu,S q, i.e.,\nu u\n\u03c4(cid:6) (cid:16) inftu : u (cid:16) t,...,T, such that Vpu,S q (cid:16) gpu,S qu. (4.1.3)\nt u u\nRecall that from Remark 4.0.1, we already know that V \u011b gpt,S q. Therefore (4.1.3)\nt t\nrepresentation for an optimal exercise implies that Vpt,S q \u0105 gpt,S q if and only if \u03c4(cid:6) \u0105 t.\nt t t\nTo prove Theorem 4.1.1, we define a new process V\u02dc by\n#\nV\u02dc :(cid:16) gpT,S q\nT T\n. (4.1.4)\nV\u02dc :(cid:16) max\u2423 1 E\u02c6 rV\u02dc | F s,gpt,S q( t (cid:16) 0,...,T (cid:1)1\nt 1(cid:0)R t(cid:0)1 t t\nThe following lemma presents some key properties for the study of an American option.\nLemma 4.1.1. The following properties hold for V and V\u02dc defined by 4.1.1 and 4.1.4,\nt t\nrespectively.\ni) Both Vt and V\u02dc t are supermartingales with respect to filtration generated by\np1(cid:0)Rqt p1(cid:0)Rqt\nthe asset price.\nii) V and V\u02dc are greater than or equal to gpt,S q.\nt t t\niii) V is the smallest process with property (i) and (ii).\nt\niv) ! V u^\u03c4 t(cid:6) : u (cid:16) t,...,T) is a martingale.\np1(cid:0)Rqu^\u03c4 t(cid:6)\nProperty (i) asserts that the discounted price of an American option is a supermartingale\nand property (ii) simply restates that the value of the American option is never smaller\nthan the payoff. Property (iii), which is a crucial property of the value of American option,\nindicatesthatthediscountedvaluesoftheAmericanoptionisthesmallestsupermartingale\nwhich is greater than or equal to the discounted payoff.\nProof of Lemma 4.1.1. Given F , for any stopping time \u03c4 with values in tt,...,Tu, the\nt\noccurrence of the event t\u03c4 \u010f tu (cid:16) t\u03c4 (cid:16) tu is known. Therefore,\n\u2022 If \u03c4 (cid:16) t has happened then strategy \u03c4 suggests to exercise and\n(cid:17) 1 (cid:25)\nE\u02c6 gp\u03c4,S q | F (cid:16) gpt,S q.\np1(cid:0)Rq\u03c4(cid:1)t \u03c4 t t\n174 4. AMERICAN OPTIONS 4.1. AMERICAN OPTION IN THE BINOMIAL MODEL\n\u2022 If \u03c4 (cid:16) t has not happened, then strategy \u03c4 suggests to continue.\nTherefore,\nV (cid:16) maxE\u02c6 r 1 gp\u03c4,S q | F s (cid:16) max\u2423 max E\u02c6 r 1 gp\u03c4,S q | F s,gpt,S q(\nt \u03c4PT p1(cid:0)Rq\u03c4(cid:1)t \u03c4 t \u03c4PT p1(cid:0)Rq\u03c4(cid:1)t \u03c4 t t\nt t(cid:0)1\n(4.1.5)\n1 1\n\u011b max E\u02c6 r gp\u03c4,S q | F s.\n1(cid:0)R \u03c4PT p1(cid:0)Rq\u03c4(cid:1)t(cid:1)1 \u03c4 t\nt(cid:0)1\nLet \u03f1(cid:6) be an optimal exercise for V , i.e.\nt(cid:0)1 t(cid:0)1\n(cid:17) 1 (cid:25)\nV (cid:16) E\u02c6 gp\u03f1(cid:6) ,S q .\nt(cid:0)1 p1(cid:0)Rq\u03f1(cid:6) t(cid:0)1(cid:1)t(cid:1)1 t(cid:0)1 \u03f1(cid:6) t(cid:0)1\nThen, in particular we have\n1 1\nV \u011b E\u02c6 r gp\u03f1(cid:6) ,S q | F s (cid:16) E\u02c6 rV | F s.\nt p1(cid:0)Rq\u03f1(cid:6) t(cid:0)1(cid:1)t t(cid:0)1 \u03f1(cid:6) t(cid:0)1 t 1(cid:0)R t(cid:0)1 t\nTherefore, Vt is a supermartingale. The supermartingale property for V\u02dc t is a direct\np1(cid:0)Rqt p1(cid:0)Rqt\nconsequence of its definition (4.1.4), i.e.\nV\u02dc (cid:16) max\u2423 1 E\u02c6 rV\u02dc | F s,gpt,S q( \u011b 1 E\u02c6 rV\u02dc | F s.\nt t(cid:0)1 t t t(cid:0)1 t\n1(cid:0)R 1(cid:0)R\nHence, (i) is proven. (ii) is a straightforward consequence of choosing \u03c4 (cid:17) t in (4.1.1) and\n(4.1.4).\nTo show (iii), let Y be another process which satisfies (i)-(ii). In particular, Y \u011b\nt T\ngpT,S q (cid:16) V . Inductively, assume that Y \u011b V for u \u0105 t. If V (cid:16) gpt,S q, then\nT T u u t t\nproperty (ii) for Y implies V (cid:16) gpt,S q \u010f Y . Otherwise, V \u0105 gpt,S q and we deduce from\nt t t t t t\n(4.1.5) that\n1\nV (cid:16) max E\u02c6 r gp\u03c4,S q | F s.\nt \u03c4PT p1(cid:0)Rq\u03c4(cid:1)t \u03c4 t\nt(cid:0)1\nSince Y satisfies (ii), we have\nt\n1\nV \u010f max E\u02c6 r Y | F s.\nt \u03c4PT p1(cid:0)Rq\u03c4(cid:1)t \u03c4 t\nt(cid:0)1\nBy optional sampling theorem, Theorem B.6, we obtain\n1\nE\u02c6 r Y | F s \u010f Y .\np1(cid:0)Rq\u03c4(cid:1)t \u03c4 t t\n175 4.1. AMERICAN OPTION IN THE BINOMIAL MODEL 4. AMERICAN OPTIONS\nHence, V \u010f Y .\nt t\nRemark 4.1.1 (Snell envelope). For any given payoff process g :(cid:16) tg u , for instance\nt t\u011b0\ng (cid:16) gpt,Sq , the smallest supermartingale which is greater than or equal to g is called Snell\nt p1(cid:0)Rqt\nenvelope of g. Therefore, the discounted value of the American option is the Snell envelope\nof the discounted payoff.\nFirst, we use the properties (i)-(iii) in Lemma 4.1.1 to show that V (cid:16) V\u02dc for all t.\nt t\nLemma 4.1.2. For any t (cid:16) 0,...,T, we have V (cid:16) V\u02dc.\nt t\nProof. Obviously, V (cid:16) gpT,S q (cid:16) V\u02dc . If V (cid:16) V\u02dc , then\nT T T t(cid:0)1 t(cid:0)1\n! 1 ) ! 1 )\nV\u02dc (cid:16) max E\u02c6 rV\u02dc | F s,gpt,S q (cid:16) max E\u02c6 rV | F s,gpt,S q .\nt t(cid:0)1 t t t(cid:0)1 t t\n1(cid:0)R 1(cid:0)R\nBy (i) (supermartingale property of discounted V) and (ii), we have\nV\u02dc \u010f max\u2423 V ,gpt,S q( (cid:16) V .\nt t t t\nOn the other hand, since V is the smallest process with properties (i) and (ii), we must\nt\nhave V \u010f V\u02dc, which verifies the equality.\nt t\nNext lemma is on the Markovian property of the price of American option.\nLemma 4.1.3. The value of the American option V is a function of time t and asset price\nt\nS, i.e., V (cid:16) Vpt,S q.\nt t\nProof. If V (cid:16) Vpt(cid:0)1,S q, then by Markovian property of binomial model, we obtain\nt(cid:0)1 t(cid:0)1\nE\u02c6 rVpt(cid:0)1,S q | F s (cid:16) E\u02c6 rVpt(cid:0)1,S q | S s and\nt(cid:0)1 t t(cid:0)1 t\n! 1 )\nV (cid:16) max E\u02c6 rVpt(cid:0)1,S q | S s,gpt,S q\nt t(cid:0)1 t t\n1(cid:0)R\nis a function Vpt,S q of time and the asset price. Hence, (4.1.2) follows.\nt\nFinally, we show that (4.1.3) provides an optimal exercise.\nLemma 4.1.4. The stopping time \u03c4(cid:6) given by 4.1.3 satisfies\nt\n(cid:17) 1 (cid:25)\nV (cid:16) E\u02c6 gp\u03c4(cid:6),S q | F\nt p1(cid:0)Rq\u03c4 t(cid:6)(cid:1)t t \u03c4 t(cid:6) t\nProof. Notice that by definition, V (cid:16) gp\u03c4(cid:6),S q. Hence, by the optional sampling theo-\n\u03c4(cid:6) t \u03c4(cid:6)\nt t\nrem, Theorem (B.6), and property (iv), we obtain that\n(cid:17) 1 (cid:25) (cid:17) 1 (cid:25)\nV (cid:16) V (cid:16) E\u02c6 Vp\u03c4(cid:6),S q | F (cid:16) E\u02c6 gp\u03c4(cid:6),S q | F ,\nt t^\u03c4 t(cid:6) p1(cid:0)Rq\u03c4 t(cid:6)(cid:1)t t \u03c4 t(cid:6) t p1(cid:0)Rq\u03c4 t(cid:6)(cid:1)t t \u03c4(cid:6) t\n176 4. AMERICAN OPTIONS 4.1. AMERICAN OPTION IN THE BINOMIAL MODEL\nwhich shows that \u03c4(cid:6) is optimal.\nt\nThe above discussion suggests the following algorithm in pricing American options.\nPricing American options in the binomial model\n1: At time T, the value of the option is gpT,S Tpjqq.\n2: for each t (cid:16) T (cid:1)1,...,0 do\n3: for each j (cid:16) 1,...,t(cid:0)1 do\n4: Exercise value = gpt,S tpjqq.\n5: Continuation value = 1(cid:0)1 RE\u02c6 rVpt(cid:0)1,S t(cid:0)1q | S t (cid:16) S tpiqs (cid:16) 1(cid:0)1 R (cid:0) V ti (cid:0)(cid:0) 11\u03c0\u02c6 u(cid:0)V ti (cid:0)1\u03c0\u02c6 \u2113(cid:8) .\n! )\n6: ThevalueoftheoptionVpt,S tpiqq (cid:16) max gpt,S tpiqq, 1(cid:0)1 RE\u02c6 rVpt(cid:0)1,S t(cid:0)1q | S t (cid:16) S tpiqs .\n7: If Vpt,S tpiqq (cid:16) gpt,S tpiqq, we exercise the option and stop.\n8: If Vpt,S tpiqq \u0105 gpt,S tpiqq, we continue and the replicating portfolio is given by\n\u2206 pS pjqq units of risky assets and Vpt,S piqq(cid:1)\u2206 pS pjqqS pjq is cash.\nt t t t t t\n9: end for\n10: end for\nRemark 4.1.2 (Path dependent American option). If the payoff of the American option\ndepends on the path, one can adjust the algorithm by considering the path dependent con-\ntinuation value and path dependent exercise value. Exercise 4.1.1 provides an example of\nsuch kind.\nExample 4.1.1 (American call option on a nondividend asset does not exist!). In this\ncase the payoff is given by gpt,Sq (cid:16) pS(cid:1)Kq . Then, the price of the American call option\n(cid:0)\nis the same as the price of European call option! In fact, this is true in any model where\nthe pricing of European claims is carried by the risk-neutral probability. See Proposition\n4.1.1.\nThis situation is not unique to American call option. The following proposition further\nelaborate on this matter.\nProposition 4.1.1. Consider an American option with a convex payoff gpSq such that\ngp0q (cid:16) 0 on an asset which pays no dividend. Assume that the price of a European contin-\ngent claim is given by\nVEupt,Sq (cid:16) B pTqE\u02c6 rgpS q | S (cid:16) Ss,\nt T t\nwhere E\u02c6 is expectation under risk-neutral probability, and the discounted asset price S\u02dc (cid:16)\nt\nSt is a martingale under risk-neutral probability. Then, the price of American option\np1(cid:0)Rqt\nVAmpt,Sq with payoff gpSq is the same as VEu, i.e.\nVEupt,Sq (cid:16) VAmpt,Sq.\n177 4.1. AMERICAN OPTION IN THE BINOMIAL MODEL 4. AMERICAN OPTIONS\nRemark 4.1.3. Proposition 4.1.1 is only true when the underlying asset does not pay\ndividend. See Exercise 4.1.2.\nExercise 4.1.1. Consider a two-period binomial model for a risky asset with each period\nequal to a year and take S (cid:16) $1, u (cid:16) 1.5 and \u2113 (cid:16) 0.6. The interest rate for both periods is\n0\nR (cid:16) .1.\na) Price an American put option with strike K (cid:16) .8.\nb) Price an American call option with strike K (cid:16) .8.\nc) Price an American option with a path dependent payoff which pays the running max-\nimum1 of the path.\nRemark 4.1.4. A naive example of an American option is the case where the payoff is $1.\nIn this case, if the interest rate is positive, it is optimal to exercise the option right away.\nHowever, if interest rate is 0, the time of exercise can be any time. This naive example has\nan important implication. If interest rate is zero, one can remove condition gp0q (cid:16) 0 from\nProposition 4.1.1, simply by replacing payoff g by g\u02dcpSq (cid:16) gpSq(cid:1)gp0q. Since cash value of\ngp0q does not change value over time, the value of the American option with payoff gpSq is\ngp0q plus the value of American option with payoff g\u02dcpSq.\nFor negative interest rate, the exercise date will be postponed compared to the positive\ninterest rate.\nFor example, if the interest rate is zero, the price of American put is equal to the price of\nEuropean put.\nHedging American option in the binomial model\nHedging American option in the binomial model follows the same way as European option.\nThe only difference is that the hedging may not continue until maturity because of the\nearly exercise. Given that we know the price Vpt(cid:0)1,S piqq of the American option at\nt(cid:0)1\ntime t(cid:0)1 at all states i (cid:16) 1,...,t(cid:0)2, to hedge at time t and state j, we need to keep\n\u2206 pS pjqq units of risky asset in the replicating portfolio and Vpt,S piqq(cid:1)\u2206 pS pjqqS pjq\nt t t t t t\nin cash, where \u2206 pSq is given by (2.3.4), i.e.\nt\nVpt(cid:0)1,Suq(cid:1)Vpt(cid:0)1,S\u2113q\n\u2206pt,Sq :(cid:16) for t \u0103 \u03c4(cid:6).\nSpu(cid:1)\u2113q\nNotice that hedging an American contingent claim is only matters before the time of the\nexercise. At the time of the exercise or thereafter, there is no need to hedge. However, if\nthe holder of the American claim decides not to exercise at time \u03c4(cid:6), the issuer can continue\nhedging with no hassle. For example, in Example 4.0.2 with K (cid:16) 2, it is optimal for the\n1The running maximum at time t is the maximum of the price until or at time t.\n178 4. AMER4I.C2A. NPORPITCIIONNGS AMERICAN OPTION IN THE BLACK-SCHOLES MODEL\nholder to exercise the option at the beginning, where the price of asset is $ 1. Therefore,\nthe issuer need $ 1 to replicate. However, if the holder continues, the replication problem\nin the next period leads to solving the following system of equation.\n#\n2.1a(cid:0)1.1b (cid:16) .4485\n.6a(cid:0)1.1b (cid:16) 1.4000\nwhich yields a (cid:16) (cid:1)1.903 and b (cid:16) 2.3107. Therefore, the issuer needs $ a(cid:0)b (cid:16) .4077 to\nreplicate the option which is less than $ 1 if the holder exercises the option.\nExercise 4.1.2. Consider a two-period binomial model for a risky asset with each period\nequal to a year and take S (cid:16) $1, u (cid:16) 1.2 and \u2113 (cid:16) 0.8. The interest rate for both periods is\n0\nR (cid:16) .05.\na) If the asset pays 10% divided yield in the first period and 5% in the second period,\nfind the price of an American and European call options with strike K (cid:16) .8.\nb) Construct the replicating portfolio for both American and European call option.\n4.2 Pricing American option in the Black-Scholes model\nIn continuous time, including Black-Scholes model, the definition of exercise policy (stop-\nping time) for American options is not easy to define. The definition needs to use filtration\nand \u03c3-algebra from measure theory2. Here we avoid technical discussion of stopping times\nand only present the solution for American option in the Black-Scholes model.\nFirst notice that Proposition 4.1.1 implies that the American call option is Black-Scholes\nmodel has the same price as European call if the underlying does not pay any dividend.\nTherefore, our focus here is on the derivatives such as American put or American call on\na dividend-paying asset.\nThe key to solve the American option problem in the Black-Scholes model is to set up a\nfree boundary problem. This type of problems are widely studied in physics. For example,\nin order to understand how an ice cube is melting over time, we need to solve a free\nboundary problem. Or if we push an elastic object to a certain shape, after releasing, the\nshape starts changing in a certain way which can be realized by solving a free boundary\nproblem. See Figure 4.2.1.\nAnother simple example occurs if we add obstacle underneath a hanging elastic rubber.\nAn elastic rubber fixed at two level points takes shape as a piece of parabola shown in left\nimageinFigure4.2.2. Theequationsatisfiedbythefreerubberisu2 (cid:16) cwheretheconstant\nc depends on the physical properties of the rubber. If we position an obstacle underneath\nthe rubber such that the elastic rubber is touched, then it changes the shape of the red\n2For more information see for example [23, 31] or for a more advanced text see [17, Chapter 1].\n179 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES 4. AMERICAN OPTIONS\nFigure 4.2.1: Exterior membrane of a tube (purple shape) is forcefully shaped into a\ndumbbell (red shape). Upon release of the forces, the surface of the shape starts moving;\neach point moves at a speed proportional to the curvature of the surface. Eventually, it\nreturns back to the original shape. The picture is adopted from [12].\n180 4. AMERICAN OPTIONS 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES\ncurve shown in right image in Figure 4.2.2. The position of the red curve satisfies the\nsame equation u2 (cid:16) c but only at the points where the rubber in not touching the obstacle.\nInside the touching region px ,x q, the rubber takes the shape of the obstacle. At the two\n0 1\nendpoints of touching region, the shape of the rubber is once continuously differentiable;\ni.e., if the upx q (cid:16) upx q (cid:16) y the height of the obstacle and u1px q (cid:16) u1px q (cid:16) 0.\n0 1 0 0 1\ny\n0\nx x x\n0 0 1\nFigure 4.2.2: The blue curve on the left shows the position of a free elastic hanging at\ntwo points. The red curve shows the same elastic rubber hanging at the same points but\nbounded below by an obstacle.\nAfter this short introduction, we come back to the problem of pricing and hedging Ameri-\ncan option. For the sake of simplicity, we only consider simple case where there is only one\nfree boundary. This for example occurs when we have an American put or an American\ncall on a dividend-paying asset. Below, we list the important facts that you need to know\nabout the free boundary.\na) The domain for the problem tpt,Sq : t P r0,Ts, and S P r0,8qu is divided into to\nparts separated by a curve C :(cid:16) tpt,S(cid:6)ptqq : t P r0,Tsu. The curve C is called free\nboundary.\nb) On one side of the boundary it is not optimal to exercise the option. This side is\ncalled continuation region, e.g. if the asset price S \u0105 S(cid:6)psq for all s \u010f t, it has never\ns\nbeen optimal to exercise the option before or at time t.\nc) The other side of the boundary is called exercise region, e.g. if the asset price S \u010f\nt\nS(cid:6)ptq, then it is optimal to exercise the option at time t. Therefore, the optimal\nstopping time is the first time that the pair pt,S q hits the exercise region. More\nt\nprecisely, the asset price S hits the free boundary at time t at point S(cid:6)ptq.\nt\n\u03c4(cid:6) :(cid:16) inftt \u010f T : S (cid:16) S(cid:6)ptqu.\nt\n181 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES 4. AMERICAN OPTIONS\nIt is important to notice that the exercise boundary is an unknown in pricing American\noptions in continuous time. The other unknown is the price of the American option. We\nnext explain that finding the price of the American option also gives us the free boundary.\nTherelation betweenthese twois liedin thefollowingrepresentationof thestopping policy.\nFor an American option with payoff gpt,S q, we have the optimal stopping \u03c4(cid:6) given by\nt\n\u03c4(cid:6) (cid:16) inftt \u010f T : Vpt,S q (cid:16) gpt,S qu.\nt t\nSee[24]formoredetails. Therefore,findingthepriceofAmericanoptionisthefirstpriority\nhere, which will be explained in the sequel.\nFinding the edges of exercise boundary\nSo far, we learned that the domain of the problem is split into continuation boundary and\nexerciseboundary; e.g. forAmericanputateachtimet, p0,S(cid:6)ptqqistheinteriorofexercise\nregion and pS(cid:6)ptq,8q is the interior of the continuation region. determining continuation\nregion is the matter of guess-and-check; we must look at the payoff of the American option\nto guess the topology of the continuation region. One general rule is that it is not\noptimal to exercise in the out of money region or where the payoff takes its\nminimum value. We consider the following examples to clarify this rule:\na) American put. An American put option with strike K is out-of-money if S \u0105\nt\nK, and since it is not optimal to exercise in the out-of-money region, the exercise\nboundary should be inside the in-the-money region, i.e., S(cid:6)ptq \u010f K. See Figure 4.2.3\non the left. At the maturity (t (cid:16) T), S(cid:6)pTq (cid:16) K.\nb) American call. An American call option with strike K on a dividend-paying asset\nis out-of-money if S \u0103 K, and since it is not optimal to exercise in the out-of-\nt\nmoney region, the exercise boundary should be inside the in-the-money region, i.e.,\nS(cid:6)ptq \u011b K. See Figure 4.2.3 on the left. At the maturity (t (cid:16) T), S(cid:6)pTq (cid:16) K.\nc) Straddle. Severalotheroptionsincludingstrangle,bullandbearspread,etccanalso\nbearguedinthesimilarfashion. However,weonlyexplainitforstraddle. Firstnotice\nthatonecanshiftthepayoffofastraddleoptionbycashamountof K sothatthenew\n2\npayoff is positive. The key to analyze the straddle is that it is the least desirable to\nexercise the option at and around the minimum point. Therefore, we can guess that\ntherearetwofreeboundaries, S(cid:6)ptqandS(cid:6)ptq, locatedsymmetricallyontwosidesof\n1 2\nthe minimum point of the payoff K. At the maturity (t (cid:16) T), S(cid:6)pTq (cid:16) S(cid:6)2pTq (cid:16) K;\n1\nthe free boundaries collapse to K.\nThe position of the free boundary with respect time in the three examples is sketched in\nFigure 4.2.5.\n182 4. AMERICAN OPTIONS 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES\nK K\nS S\nt t\n(cid:3) (cid:3)\nS (t) S (t)\nFigure 4.2.3: Left: Free boundary of American put at time t. Right: Free boundary of\nAmerican call (on dividend-paying asset) at time t. The continuation region in marked\nwith |\u2014|.\ng(St)\ng(St)\nK K\n2 2\nS1(cid:3)(t) S2(cid:3)(t)\nK St K St\nS1(cid:3)(t) S2(cid:3)(t)\nFigure 4.2.4: Two free boundaries of straddle.The continuation region in marked with\n|\u2014|. The free boundaries can occur both on the positive regions of the payoff and on\nthe negative region of the payoff. If the time-to-maturity is long, we guess that the free\nboundaries are wides apart and as time-to-maturity decreases, they get closer.\nRemark 4.2.1. The price of an American option with payoff equal to g pSq (cid:0) g pSq is\n1 2\nnot equal to, but only smaller than, the summation of prices of an American option with\npayoff g pSq and an American option with payoff g pSq Similar phenomenon is observed\n1 2\nin Exercise 1.3.3.\nSmooth fit\nThe main tool in finding the free boundary and to evaluate American options in the prin-\nciple of smooth fit.\nLet\u2019s denote the price of the American option at time t when the asset price is equal to\nS (cid:16) S by Vpt,Sq. We provide the methodology for American put option. For other cases,\nt\nthe method can be adopted after necessary modifications. Before presenting this principle,\nwe shall explain that in the continuation region, the price function Vpt,Sq of the American\n183 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES 4. AMERICAN OPTIONS\n2:8\n2 Continuationregion Exerciseregion\n2:5\n2:6\n1:8 Exerciseregion\n1:6 2:4 2 Continuationregion\n1:4\nExerciseregion 2:2\nContinuationregion 1:5\nExerciseregion\n1:2\n2\n1 1\n0 0:2 0:4 0:6 0:8 1 0 0:2 0:4 0:6 0:8 1 0 0:2 0:4 0:6 0:8 1\nFigure 4.2.5: Sketch of the position of American option exercise boundary in time (hor-\nizontal axis). Left: American put. Middle: American call (dividend). Right: American\nStraddle.\nput option satisfies Black-Scholes equation, i.e.\n$ B Vpt,Sq(cid:0) \u03c32S2 B Vpt,Sq(cid:0)rSB Vpt,Sq(cid:1)rVpt,Sq (cid:16) 0 for S \u0105 S(cid:6)ptq\n\u2019 & t 2 SS S\nVpt,Sq (cid:16) gpt,Sq for S \u010f S(cid:6)ptq . (4.2.1)\n\u2019\n%VpT,Sq (cid:16) gpT,Sq;\nTherefore, S(cid:6)ptq serves as a boundary for the above equation. However, S(cid:6)ptq itself is an\nunknown. With the Black-Scholes equation, we have two unknowns but only one equation.\nPrincipal of smooth fit provides a second equation.\nProposition 4.2.1 (Principal of smooth fit). Assume that the payoff gpt,Sq of the Ameri-\ncan option is twice continuously differentiable with respect to S and continuous in t. Then,\nat the free boundary S(cid:6)ptq, we have\nVpt,S(cid:6)ptqq (cid:16) gpt,S(cid:6)ptqq, and B Vpt,S(cid:6)ptqq (cid:16) B gpt,S(cid:6)ptqq,\nS S\nfor all t \u0103 T.\nForexampleforAmericanputwehavegpt,Sq (cid:16) pK(cid:1)Sq . Therefore, principleofsmooth\n(cid:0)\nfit implies that Vpt,S(cid:6)ptqq (cid:16) pK (cid:1)S(cid:6)ptqq and B Vpt,S(cid:6)ptqq (cid:16) (cid:1)1.\n(cid:0) S\nTo see how smooth fit can be used in pricing American options, we provide some exactly\nsolvable example in the following. These examples are called perpetual American options\nwith maturity T (cid:16) 8. As a result, the price of the American option does not depend\non time and the term B V in PDE (4.2.1) vanishes. Therefore, the pricing function VpSq\nt\nsatisfies the ODE\n\u03c32S2\nV2pSq(cid:0)rSV1pSq(cid:1)rVpSq (cid:16) 0,\n2\nin the continuation region.\n184 4. AMERICAN OPTIONS 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES\nExample 4.2.1 (Perpetual American put option). A perpetual American option is an\noption with maturity T (cid:16) 8. In practice, there is no perpetual option. However, if the\nmaturity is long (10 years), then one can approximate the price with the price of a perpetual\noption.\nThe key observation is that since the Black-Scholes model is time-homogeneous, the free\nboundary of the perpetual American put option does not depend on time, i.e., S(cid:6)ptq (cid:16) S(cid:6)\nfor some unknown constant S(cid:6) \u0103 K. On the other hand, since the time horizon is infinite,\nthe price Vpt,Sq of the American put does not depend on t, i.e., B Vpt,Sq (cid:16) 0. Thus, we\nt\nhave\n\u03c32S2\nV1pSq(cid:0)rSV1pSq(cid:1)rVpSq (cid:16) 0.\n2\nThe general solution of the above equation is given by\nVpSq (cid:16) c 1S (cid:0)c 2S(cid:1) \u03c32r 2.\nOne can argue that c must be equal to 0. Since as S (cid:209) 8, the option goes deep out-of-\n1\nmoney and becomes worthless. To find c , we use principle of smooth fit.\n2\nc 2pS(cid:6)q(cid:1) \u03c32r 2 (cid:16) K (cid:1)S(cid:6)\n\u03c32\nc (cid:16) pS(cid:6)q\u03c32r 2(cid:0)1.\n2\n2r\nThus, S(cid:6) (cid:16) rK and\nr(cid:0)\u03c32\n2\n$\n\u2019 &K (cid:1)S S \u011b r(cid:0)rK \u03c32\nVpSq (cid:16) \u2019 %\u03c3 2r2(cid:1) r(cid:0)rK \u03c32(cid:9) \u03c32r 2(cid:0)1 S(cid:1) \u03c32r 2 S \u0103 r(cid:0)rK \u03c32 .\n2\n2 2\nExample 4.2.2 (Perpetual American call option on continuous dividend-paying asset).\nConsider a continuous constant dividend rate q \u0105 0. The free boundary in this case is\ngiven by a constant S(cid:6) with S(cid:6) \u0105 K and the price of American option satisfies\n\u03c32S2\nV2pSq(cid:0)pr(cid:1)qqSVpSq(cid:1)rVpSq (cid:16) 0.\n2\nThe general solution of the above equation is given by\nVpSq (cid:16) c S\u03b31 (cid:0)c S\u03b32,\n1 2\n185 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES 4. AMERICAN OPTIONS\nwhere \u03b3 and \u03b3 are roots of\n1 2\n\u03c32 (cid:1) \u03c32(cid:9)\n\u03b32(cid:0) r(cid:1)q(cid:1) \u03b3 (cid:1)r (cid:16) 0.\n2 2\nNotice that \u03b3 and \u03b3 have opposite sign and the positive one is strictly larger than 1. With\n1 2\nout loss in generality, we assume that \u03b3 \u0103 0 \u0103 1 \u0103 \u03b3 .\n1 2\nOne can argue that c must be equal to 0. Since as S (cid:209) 0, the option goes deep out-of-\n1\nmoney and becomes worthless. To find c , we use principle of smooth fit.\n2\nc pS(cid:6)q\u03b32 (cid:16) S(cid:6)(cid:1)K\n2\n1\nc (cid:16) .\n2 \u03b3 2pS(cid:6)q\u03b32(cid:1)1\nThus, S(cid:6) (cid:16) \u03b32K and\n\u03b32(cid:1)1\n#\nS (cid:1)K S \u010f \u03b32K\nVpSq (cid:16) \u03b32(cid:1)1 .\n1 pS(cid:6)q1(cid:1)\u03b32S\u03b32 S \u0105 \u03b32K\n\u03b32 \u03b32(cid:1)1\nExercise 4.2.1. Formulate and solve the free boundary problem for the perpetual American\noptions with following payoffs.\na) pS (cid:1)Kq (cid:0)a where a \u0105 0.\n(cid:0)\nb) pK (cid:1)Sq (cid:0)a where a \u0105 0.\n(cid:0)\nc) Straddle\nd) Strangle\ne) Bull call spread\nf) Bear call spread\nAmerican option with finite maturity\nUnlikeperpetualAmericanoption,whenT \u0103 8,thereisnoclosed-formsolutionforthefree\nboundary problem (4.2.1). Therefore, numerical methods should be used to approximate\nthe solution.\nThe simplest among numerical methods is the binomial approximation. One needs to\nchoose large number of periods N and apply the algorithm of \u201cPricing American options\nin the binomial model\u201d. The parameters of the binomial model u, \u2113 , and R can be\nchosenaccordingtosymmetricprobabilities,subjectivereturn,oranyotherbinomialwhich\nconverges to the specific Black-Scholes model.\n186 4. AMERICAN OPTIONS 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES\nThe finite-difference scheme can be employed to solve free boundary problem numerically.\nSimilar to Section (3.3.10), one can apply the change of variables Up\u03c4,xq (cid:16) e(cid:1)r\u03c4VpT (cid:1)\n\u03c4,er\u03c4(cid:0)xq, to derive a heat equation with free boundary for U, i.e.\n$ B Up\u03c4,xq (cid:16) \u03c32 B Up\u03c4,xq(cid:0)rB Vp\u03c4,xq(cid:1)rUp\u03c4,xq for x \u0105 x(cid:6)p\u03c4q\n\u2019 & \u03c4 2 xx x\nUp\u03c4,xq (cid:16) gpT (cid:1)\u03c4,exq for x \u010f x(cid:6)p\u03c4q ,\n\u2019\n%Up0,xq (cid:16) gpT,exq\nwhere x(cid:6)p\u03c4q (cid:16) lnpS(cid:6)p\u03c4qq.\nFor the simplicity, we only consider American put option, where we have Up\u03c4,xq \u011b gpT (cid:1)\n\u03c4,exq. Whetherwewanttoapplyexplicitorimplicitschemetotheaboveproblem, because\nof the free boundary, we need to add an intermediate step between step i and step i(cid:0)1\nof the scheme. Suppose that the approximate solution U\u02c6 p\u03c4 ,x q at \u03c4 is known for all j.\ni j i\nTherefore, finite-difference scheme (3.2.19) or (3.2.20) provides an approximate solution,\ndenoted by U\u02c6 p\u03c4 ,x q for the heat equation without including the free boundary3. Then,\ni(cid:0)1 j\n2\nto find an approximate solution U\u02c6 p\u03c4 ,x q for the free boundary problem at \u03c4 , one only\ni(cid:0)1 j i(cid:0)1\nneeds to set\nU\u02c6 p\u03c4 ,x q :(cid:16) maxtU\u02c6 p\u03c4 ,x q,gpT (cid:1)\u03c4,exjqu.\ni(cid:0)1 j i(cid:0)1 j\n2\nTo summarize we have the following:\n# U\u02c6 p\u03c4 ,(cid:4)q :(cid:16) AU\u02c6 p\u03c4 ,(cid:4)q\ni(cid:0)1 i\n2 .\nU\u02c6 p\u03c4 i(cid:0)1,x jq :(cid:16) maxtU\u02c6 p\u03c4 i(cid:0)1,x jq,gpT (cid:1)\u03c4,exjqu @j\n2\nHere A can be implicit, explicit or mixed scheme.\nThe above method is in the category of splitting method, where there is one or more\nintermediate steps in the numerical schemes to go from step i to step i(cid:0)1.\nThesplittingmethoddescribedinthissectioncanalsobeapplieddirectlytoBlack-Scholes\nequation with free boundary\n$ B Vp\u03c4,Sq (cid:16) \u03c32S2 B Vp\u03c4,Sq(cid:0)rSB Vp\u03c4,Sq(cid:1)rVp\u03c4,Sq for S \u0105 S(cid:6)p\u03c4q\n\u2019 & \u03c4 2 SS S\nVp\u03c4,Sq (cid:16) gpT (cid:1)\u03c4,Sq for S \u010f S(cid:6)p\u03c4q .\n\u2019\n%Vp0,Sq (cid:16) gpT,Sq;\nThe CFL condition is not different in the case of free boundary problems.\nThe Monte Carlo methods for American options are more complicated than for the Eu-\nropean options and in beyond the scope of this lecture notes. For more information of the\nMonte Carlo methods for American options, see [19], [7], or the textbook [15].\n3The subscript in \u03c4 indicate that finite-difference evaluation in each step in an intermediate step.\ni(cid:0)1\n2\n187 4.2. AMERICAN OPTION IN THE BLACK-SCHOLES 4. AMERICAN OPTIONS\nAmerican call option on discrete dividend-paying asset\nUnlike continuous dividend problem, the discrete dividend cannot be solved as a single\nfree boundary problem. Consider an asset which pays dividend yield of d P p0,1q at times\nt \u0103 t \u0103 ... \u0103 t (cid:16) T. Proposition 4.1.1 suggests that at any time t P rt ,t q between\n1 2 n i i(cid:0)1\nthe times of dividend payments it is better to wait and not to exercise. However, at time t\ni\nof the dividend payment, the price of the asset decreases by the dividend and so does the\nprice of the call option. Therefore, if the continuation is not optimal, the option should be\nexercises at the moment just before the time of a dividend payment.\n188 Appendices\n189  A. CONVEX OPTIMIZATION\nA Convex optimization\nIn this section, we briefly review the important result that we need from linear and convex\noptimization for this course. We start with reminding the notion of convex set and convex\nfunction.\nA.1 Convex functions\nDefinition A.1. A set A \u010e Rd is called convex if for any \u03bb P p0,1q and x,y P A, we have\n\u03bbx(cid:0)p1(cid:1)\u03bbqy P A.\nIn other words, a convex set is a set which contains all the segments with endpoints inside\nthe set.\nExample A.1. The unit disk tx P Rd : |x| \u010f 1u and the unit cube r0,1sd are convex\nsets. The volume given by inequalities a (cid:4) x \u010f b for i (cid:16) 1,...,n, a P Rd and b P R\ni i i i\n(enclosed within n hyperplanes) is a convex set. Euclidean space Rd and the empty set are\nalso convex.\nDefinition A.2. Let A be a convex set. A real function f : A \u010e Rd (cid:209) R is called convex\nif for any \u03bb P p0,1q and x,y P Rd, we have\nfp\u03bbx(cid:0)p1(cid:1)\u03bbqyq \u010f \u03bbfpxq(cid:0)p1(cid:1)\u03bbqfpyq.\nA function f is called concave if (cid:1)f is convex. The convexity (concavity) is called strict if\nthe inequality above is strict when x(cid:24)y.\nProposition A.1. A set A \u010e Rd is called convex. Then, a function f : A \u010e Rd (cid:209) R is\nconvex if and only if\n(cid:3) (cid:11)\nn n\n\u201a \u201a\nf \u03bb x \u010f \u03bb fpx q,\ni i i i\ni(cid:16)1 i(cid:16)1\nfor all x ,...,x P A and \u03bb ,...,\u03bb P R with \u0159n \u03bb (cid:16) 1.\n1 n 1 n (cid:0) i(cid:16)1 i\nIfaconvexfunctionf istwicedifferentiable, thentheHessianmatrixofsecondderivatives\nof f, \u22072f, has all eigenvalues nonnegative. In one dimensional case, this is equivalent to\nf2 \u011b 0.\nHowever,notallconvexfunctionaretwicedifferentiableorevendifferentiable. Weactually\nknowthatall convexfunctionsare continuous. In addition, wecan showthat the one-sided\ndirectional derivatives of a continuous function exits.\nProposition A.2. Let A be a convex set and f : A \u010e Rd (cid:209) R be a convex function. Then,\nfor all x in the interior of A and all vectors v P Rd, the directional derivative of f at x is\n191 A. CONVEX OPTIMIZATION\nthe direction of v,\nfpx(cid:0)\u03b5vq(cid:1)fpxq\n\u2207 fpxq :(cid:16) lim\nv\n\u03b5(cid:209)0(cid:0) \u03b5\nexits and satisfies fpx(cid:0)tvq \u011b fpxq(cid:0)t\u2207 fpxq for all t \u011b 0. In particular, f is continuous\nv\nat all points of A.\nIn one dimensional case, for a convex functions f the above Proposition implies that the\nright and left derivatives, f1p(cid:4)(cid:0)q and f1p(cid:4)(cid:1)q, exist at all points, and in particular a convex\nfunction is always continuous.\nThe above proposition has an important implication about the tangent hyperplane to a\nconvex function.\nCorollary A.1. Consider a convex function f and x P Rd. Then, there exists some\n0\nu P Rd such that the hyperplane y (cid:16) fpx q(cid:0)px(cid:1)x q(cid:4)u always lies underneath the surface,\n0 0\ni.e.\nfpxq \u011b fpx q(cid:0)px(cid:1)x q(cid:4)u for all x P Rd.\n0 0\nWhen f is differentiable, the linear approximation of f is always under-approximating the\nfunction, i.e.\nfpxq \u011b fpx q(cid:0)px(cid:1)x q(cid:4)\u2207fpx q for all v P Rd.\n0 0 0\nIf a function f is twice differentiable, the Hessian \u22072f is the matrix which contains all\n(cid:17) (cid:25)\nB2f\nsecond derivatives of the function f, i.e. . For twice differentiable function one\nBxiBxj\nd(cid:2)d\ncan provide a criteria for convexity based on the eigenvalues of the Hessian matrix.\nCorollary A.2. If all eigenvalues of the Hessian matrix \u22072f are nonnegative (positive)\nat all points, then the function f is convex (resp. strictly convex).\nOne can also use the Hessian matrix to find the local minimum and maximums of a\nfunction by checking its local convexity and concavity which is given in the following result.\nRecall that a point x for a differentiable function is called critical if \u2207fpx q (cid:16) 0.\n0 0\nProposition A.3. A critical point x for a differentiable function f is a local minimum\n0\n(resp. maximum) if and only if f is convex (resp. concave) in a neighborhood of x .\n0\nAsaresultoftheabovepropositionwehavethesecondorderderivativetestinmultivariate\ncalculus.\nProposition A.4. A critical point x for a second order differentiable function f is\n0\ni) a local minimum if the Hessian \u22072fpx q is positive-definite.\n0\nii) a local maximum if the Hessian \u22072fpx q is negative-definite.\n0\niii) a saddle point if the Hessian \u22072fpx q has both negative and positive eigenvalues.\n0\nxe(cid:1)x2(cid:0) 2y2\nExercise A.1. Find and categorize all the critical point of the function fpx,yq (cid:16) .\nxye(cid:1)x2(cid:0) 2y2\nExerciseA.2. Findandcategorizeallthecriticalpointofthefunctionfpx,yq (cid:16) .\n192 A. CONVEX OPTIMIZATION\nA.2 Convex constrained optimization\nConsider a convex function f : D \u010e Rn (cid:209) R where the set D is given by\nK (cid:16) tx P Rn : g pxq \u010f 0 for i (cid:16) 1,...,mu.\ni\nWe assume that all functions g for i (cid:16) 1,...,m are convex and therefore the set K is closed\ni\nand convex. The primal problem is to minimize f in D, i.e.\nminfpxq subject to constraints g pxq \u010f 0 for i (cid:16) 1,...,M.\ni\nIf f is strictly concave, then the optimizer is unique if it exists. Notice that the existence\nof the optimizer is subject to nonemptiness of the set D.\nAn equality constraint can also be described in the above form if the function g is affine4\ni\nand both g pxq \u010f 0 and (cid:1)g pxq \u010f 0. For later analysis, we specify constraint equalities in\ni i\nthe problem separately and define the feasibility set by\nK (cid:16) tx P Rn : g pxq \u010f 0 for i (cid:16) 1,...,m and h pxq (cid:16) 0 for j (cid:16),...,ku.\ni j\nNotice that since g s are convex and h s are affine, K is convex, for any number \u03bb P p0,1q\ni j\nand any x,y P K, \u03bbx(cid:0)p1(cid:1)\u03bbqy P K. Given the convex functions g for i (cid:16) 1,...,m and\ni\naffine functions h for j (cid:16) 1,...,k, the convex constrained optimization problem is given by\nj\n#\ng pxq \u010f 0 for i (cid:16) 1,...,m\ni\nP :(cid:16) minfpxq subject to constraints . (A.1)\nh pxq (cid:16) 0 for j (cid:16) 1,...,k\nj\nFunction f is called the objective function and the inequalities g \u010f 0 and equations h (cid:16) 0\ni j\nare called constraints. If K (cid:24) H, the problem is called feasible. if fpxq is strictly convex,\nthentheminimizerisunique;foranytwodistinguishedminimizersx andx withminimum\n1 2\nf(cid:0)x1(cid:0)x2(cid:8)\nvalue P (cid:16) fpx q (cid:16) fpx q, we have \u0103 1pfpx q(cid:0)fpx qq (cid:16) P which contradicts\n1 2 2 2 1 2\nwith that x and x are minimizers.\n1 2\nDuality method is one of the useful approaches to solve the convex optimization problems.\nTo present the dual problem, we first introduce the Lagrangian\n! )\nLp\u00b5,\u03bbq (cid:16) min fpxq(cid:0)\u00b5(cid:4)gpxq(cid:0)\u03bb(cid:4)hpxq .\nxPRn\nHere \u00b5 P Rm and gpxq (cid:16) pg pxq,...,g pxqqq, \u03bb P Rk and hpxq (cid:16) ph pxq,...,h pxqqq and (cid:4) is\n1 m 1 m\nthe dot product in the proper Euclidean space. Then, the dual problem is given by\nD :(cid:16) max Lp\u00b5,\u03bbq.\n\u00b5PRm, \u03bbPRk\n(cid:0)\n4An affine function is a linear function plus a constant; hpxq(cid:16)a(cid:4)x(cid:0)b, where aPRm and bPR.\n193 A. CONVEX OPTIMIZATION\nNotice that for x P K, Lp\u00b5,\u03bbq \u010f fpxq(cid:0)\u00b5(cid:4)gpxq(cid:0)\u03bb(cid:4)hpxq \u010f fpxq. Therefore, Lp\u00b5,\u03bbq \u010f\nmin fpxq and thus, D \u010f P which is called the weak duality. We can show that under\nxPK\nthe following condition that the strong duality holds.\nAssumption A.1 (Slater condition). There exist a point x such that g px q \u0103 0 for all\n0 i 0\ni (cid:16) 1,...,m and h px q (cid:16) 0 for all j (cid:16) 1,...,k.\nj 0\nTheorem A.1 (Duality). Let f, g for i (cid:16) 1,...,n and h for j (cid:16) 1,...,m are convex\ni j\nand Slater condition A.1 holds. Then D (cid:16) P. In addition, the dual maximizer p\u00b5(cid:6),\u03bb(cid:6)q P\nRm(cid:2)Rk exists whenever D \u0105 (cid:1)8, i.e.\n(cid:0)\nmax Lp\u00b5,\u03bbq (cid:16) Lp\u00b5(cid:6),\u03bb(cid:6)q.\n\u00b5PRm, \u03bbPRk\n(cid:0)\nA proof of this theorem can be found in [8, Section 5.3.2]. The following example shows\nif Slater condition fail, the strong duality does not necessarily hold.\nExample A.2. Take d (cid:16) m (cid:16) 2, n (cid:16) 1 with fpx ,x q (cid:16) x2 (cid:0)x , g pxq (cid:16) x , h pxq (cid:16)\n1 2 1 2 1 2 1\nx (cid:0)x and h pxq (cid:16) x (cid:1)x . Since feasibility set is a singleton; K (cid:16) tp0,0qu, the Slater\n1 2 2 1 2\ncondition does not hold. Therefore, P (cid:16) fp0,0q (cid:16) 0. On the other hand, Lp\u00b5,\u03bbq (cid:16) (cid:1)8\nunless \u03bb (cid:16) 0. Specifically, Lp\u00b5,0q (cid:16) min fpx ,x q(cid:0)\u00b5x . Then, we also have\npx1,x2q 1 2 2\nLp\u00b5,0q (cid:16) minx2(cid:0)minx p1(cid:0)\u00b5q (cid:16) (cid:1)8,\n1 2\nx1 x2\nsince \u00b5 \u011b 0. Therefore, D (cid:16) (cid:1)8 \u0103 P (cid:16) fp0,0q (cid:16) 0.\nRemark A.1. Notice that the duality can sometimes hold when the Slater condition does\nnotholdorwhentheproblemisnotevenfeasible. Forinstance, ifK (cid:16) H, sincemin (cid:16) 8,\nH\nP (cid:16) 8. On the other hand, for and arbitrary point x , let I and J respectively be the set\n0\nof all indices i and j such that g px q \u0105 0 and h px q (cid:24) 0. Since K (cid:16) H, at least one of I\ni 0 j 0\nor J is nonempty. Then, choose \u00b5 and \u03bb such that \u00b5 (cid:16) 0 if and only if i R I and \u03bb (cid:16) 0\ni j\nif and only if j R J. Therefore,\nLp\u00b5,\u03bbq \u010f fpx q(cid:0)\u00b5(cid:4)gpx q(cid:0)\u03bb(cid:4)hpx q.\n0 0 0\nBy sending \u00b5 (cid:209) (cid:0)8 for i P I and \u03bb (cid:209) (cid:8)8 whether h px q is negative/positive, we obtain\ni j j 0\nthat max \u00b5PRm, \u03bbPRkLp\u00b5,\u03bbq (cid:16) (cid:0)8.\n(cid:0)\nOne of the practical methods of finding the optimal points for primal and dual problem is\nthrough the KKT5, which provided a necessary condition of optimality. Additionally with\nSlater condition, KKT is also sufficient.\n5Karush-Kuhn-Tucker\n194 A. CONVEX OPTIMIZATION\nTheorem A.2 (KKT optimality condition). Assume that f, g and h are differentiable\nand x(cid:6) P Rd and p\u00b5(cid:6),\u03bb(cid:6)q P Rm (cid:2)Rk are respectively the optimizer of the primal and dual\n(cid:0)\nproblems. Then,\nB fpx(cid:6)q(cid:0)\u00b5(cid:4)B gpx(cid:6)q(cid:0)\u03bb(cid:4)B hpx(cid:6)q (cid:16) 0 for \u2113 (cid:16) 1,...,n\nx x x\n\u2113 \u2113 \u2113\n\u00b5(cid:6)g px(cid:6)q (cid:16) 0 for i (cid:16) 1,...,m. (A.2)\ni i\nh px(cid:6)q (cid:16) 0 for j (cid:16) 1,...,k\nj\nCondition \u00b5(cid:6)g px(cid:6)q (cid:16) 0 is called the complementary slackness condition. In addition, if\ni i\nthe Slater condition A.1 holds and (A.2) is satisfied, then x(cid:6) P Rd and p\u00b5(cid:6),\u03bb(cid:6)q P Rm(cid:2)Rk\n(cid:0)\nare respectively the optimizer of the primal and dual problems.\nExample A.3. We want to find the maximum volume of an open lid box with a fixed\nsurface area s by solving the constrained maximization problem\nmaxxyz subject to constraints xy(cid:0)2xz(cid:0)2yz (cid:16) s.\n?\nNotice that since the Slater condition holds for x (cid:16) y (cid:16) s and Z (cid:16) 0, the dual problem\n0 0 0\nand primal problem have the same value. The KKT condition suggest to solve the following\nto find candidates for the primal and dual problem.\nxy(cid:0)2\u00b5px(cid:0)yq (cid:16) 0\nxz(cid:0)\u00b5px(cid:0)2zq (cid:16) 0\nyz(cid:0)\u00b5py(cid:0)2zq (cid:16) 0\nxy(cid:0)2xz(cid:0)2yz (cid:16) s\nSolving the above system of equation yields\n? ?\n3s 3s\nx(cid:6) (cid:16) y(cid:6) (cid:16) 2z(cid:6) (cid:16) and \u00b5(cid:6) (cid:16) (cid:1) ,\n3 12\n?\nand the maximum volume is s 3s.\n16\nExercise A.3. Find the volume of the largest box under the constraint that the sum of the\ndiagonals of the three sides sharing a corner equal is to s.\nThe duality method, while can be used as a computational tool, it can also provide us\nwith some qualitative results about the optimization problem that we are studying. For\ninstance, in Section 2.1.6, the dual problem for evaluation of model risk is the problem of\nsuperreplication. In the next sections, we formulate the dual problem for the linear and\nquadratic programming.\n195 A. CONVEX OPTIMIZATION\nLinear programming\nLinear optimization is when the objective function f and the constraints are all linear;\nfor some constants p P Rd, a P Rd, b P R for i (cid:16) 1,..,m, and c P Rd and d P R for\ni i j j\nj (cid:16) 1,...,k.\nfpxq (cid:16) p(cid:4)x, g pxq (cid:16) a (cid:4)x(cid:0)b , and h pxq (cid:16) c (cid:4)x(cid:0)d .\ni i i j j j\nTherefore,\n#\na (cid:4)x(cid:0)b \u010f 0 for i (cid:16) 1,...,m\ni i\nP :(cid:16) minp(cid:4)x subject to constraints . (A.3)\nc (cid:4)x(cid:0)d (cid:16) 0 for j (cid:16) 1,...,k\nj j\nLet matrices A and C consist of rows a ,...,a and c ,...,c , respectively and set d :(cid:16)\n1 m 1 k\npd ,...,d q and b :(cid:16) pb ,...,b q as column vectors. Then, the linear programming can be\n1 k 1 m\nwritten in the following compact form.\n#\nAx(cid:0)b \u010f 0\nminp(cid:4)x subject to constraints .\nCx(cid:0)d (cid:16) 0\nEach equation c (cid:4)x(cid:0)d (cid:16) 0 is a hyperplane and each inequality a (cid:4)x(cid:0)b \u010f 0 is a half-\nj j i i\nspaceinthed-dimensionalEuclideanspace. ThefeasibilitysetK caneasilybeempty,ifthe\nconstraints are made by parallel hyperplanes; for example a x(cid:0)b \u010f 0 and a x(cid:0)b \u010f 0\ni i i1 i1\nwith a (cid:16) (cid:1)a and b (cid:16) (cid:1)b (cid:1) 1. To avoid this situation, we assume that the vectors\ni i1 i i1\na ,...,a and c ,...,c are linearly independent in Rd. As a result, m(cid:0)k \u010f d the matrices\n1 m 1 k\nA and C are full rank, where A and C are matrices with rows a ,...,a and c ,...,c ,\n1 m 1 k\nrespectively. In addition, we need to assume that the column vector d (cid:16) pd ,...,d q is in\n1 k\nthe range of (cid:1)C and the orthant ty P Rm : y \u011b b for i (cid:16) 1,...,mu intersects with the\ni\nrange of (cid:1)A, Cx(cid:0)d (cid:16) 0 and Ax(cid:0)b \u010f 0 together have a solution for x. and are column\nvectors.\nThe Lagrangian for the linear programming is given by\nLp\u00b5,\u03bbq (cid:16) mintp(cid:4)x(cid:0)\u00b5(cid:4)pAx(cid:0)bq(cid:0)\u03bb(cid:4)pCx(cid:0)dqu.\nxPRd\nNotice that if p\u00b5,\u03bbq are such that pT(cid:0)p\u00b5(cid:6)qTA(cid:0)p\u03bb(cid:6)qTC (cid:24) 0 then,\n! )\nmin ppT(cid:0)\u00b5TA(cid:0)\u03bbTCq(cid:4)x (cid:0)\u00b5Tb(cid:0)\u03bbTd (cid:16) (cid:1)8.\nxPRd\nTherefore,\n#\n(cid:1)8 pT(cid:0)p\u00b5(cid:6)qTA(cid:0)p\u03bb(cid:6)qTC (cid:24) 0\nLp\u00b5,\u03bbq (cid:16) .\n\u00b5Tb(cid:0)\u03bbTd pT(cid:0)p\u00b5(cid:6)qTA(cid:0)p\u03bb(cid:6)qTC (cid:16) 0\n196 A. CONVEX OPTIMIZATION\nTherefore, the dual problem can be written as\nD :(cid:16) max \u00b5Tb(cid:0)\u03bbTd subject to constraints pT(cid:0)p\u00b5(cid:6)qTA(cid:0)p\u03bb(cid:6)qTC (cid:16) 0 (A.4)\n\u00b5\u011b0,\u03bb\nTheorem A.3 (Linear programming duality). Consider the following two linear program-\nming problems (A.3) and (A.4). If either of the problems has an optimal solution, so does\nthe other one and both problems have the same value, D (cid:16) P.\nExercise A.4. Write the dual problem and KKT condition for the standard linear pro-\ngramming equation:\n#\nx \u010f 0 for i (cid:16) 1,...,d\ni\nminp(cid:4)x subject to constraints .\nc (cid:4)x(cid:0)d (cid:16) 0 for j (cid:16) 1,...,k\nj j\nExercise A.5 (Project). Study the following algorithms for the linear programming prob-\nlem in Exercise 2.1.10. Find a package that has both methods and compare the running\ntime of each method on the same problem.\na) Simplex method\nb) Interior points\nQuadratic programming\nConsider a positive-definite symmetric6 d-by-d matrix M, a P Rd, b P R for i (cid:16) 1,..,m,\ni i\nand c P Rd and d P R for j (cid:16) 1,...,k.\nj j\n1\nfpxq (cid:16) x(cid:4)Mx, g pxq (cid:16) a (cid:4)x(cid:0)b , and h pxq (cid:16) c (cid:4)x(cid:0)d .\ni i i j j j\n2\nTherefore, the quadratic optimization problem is given by\n#\n1 a (cid:4)x(cid:0)b \u010f 0 for i (cid:16) 1,...,m\ni i\nmin x(cid:4)Mx subject to constraints . (A.5)\n2 c (cid:4)x(cid:0)d (cid:16) 0 for j (cid:16) 1,...,k\nj j\nThe Lagrangian for the linear programming is given by\n\" *\n1\nLp\u00b5,\u03bbq (cid:16) min x(cid:4)Mx(cid:0)\u00b5(cid:4)pAx(cid:0)bq(cid:0)\u03bb(cid:4)pCx(cid:0)dq .\nxPRd 2\n6A matrix A is symmetric if AT (cid:16)A and is positive-definite if all its eigenvalues are\n197 A. CONVEX OPTIMIZATION\nThe dual problem for (A.5) is also a quadratic problem; the minimizer for x in the La-\ngrangian function Lp\u00b5,\u03bbq is given by xp\u00b5,\u03bbq (cid:16) (cid:1)M(cid:1)1pAT\u00b5 (cid:0) CT\u03bbq and therefore La-\ngrangian Lp\u00b5,\u03bbq is a quadratic function of \u00b5 and \u03bb. Therefore,\n1 1\nLp\u00b5,\u03bbq (cid:16) (cid:1) \u00b5(cid:4)A\u02dc\u00b5(cid:0)\u00b5(cid:4)b(cid:1) \u03bb(cid:4)C\u02dc\u03bb(cid:0)\u03bb(cid:4)d,\n2 2\nwhere A\u02dc (cid:16) AM(cid:1)1AT and C\u02dc (cid:16) CM(cid:1)1CT are indeed nonnegative definite symmetric matri-\nces. The dual problem can now be decoupled into two problems;\n\" * \" *\n1 1\nmax (cid:1) \u00b5(cid:4)A\u02dc\u00b5(cid:0)\u00b5(cid:4)b and max (cid:1) \u03bb(cid:4)C\u02dc\u03bb(cid:0)\u03bb(cid:4)d\n\u00b5\u011b0 2 \u03bb 2\nThe maximization problem on \u03bb is an unconstrained problem which leads to \u03bb(cid:6) (cid:16) C\u02dc(cid:1)1d\nwhen C\u02dc is invertible. The maximization problem on \u00b5 is, however, a constrained problem.\nOne way to find the primal and the dual optimal variables X(cid:6), \u00b5(cid:6) and \u03bb(cid:6) is through KKT\ncondition in Theorem (A.2), which is written as\nMx(cid:6)(cid:0)AT\u00b5(cid:6)(cid:0)CT\u03bb(cid:6) (cid:16) 0\n\u00b5(cid:6)pa x(cid:6)(cid:0)b q (cid:16) 0 for i (cid:16) 1,...,m\ni i i\nc x(cid:6)(cid:0)d (cid:16) 0 for j (cid:16) 1,...,k\nj j\nWhen the dual maximizer \u00b5(cid:6) \u0105 0, then by KKT condition the ith constraint must hold\ni\nwith equality, a x(cid:6)(cid:0)b (cid:16) 0. In this case, we call the constraint an active constraint.\ni i\nExercise A.6 (Project). Study the following algorithms for the linear programming prob-\nlem in Section 1.2. Find a package that has both methods and compare the running time\nof each method on the same problem.\na) Active set\nb) Interior points\nComputational tools for convex optimization problems\nThe computational methods for convex optimization problems are vast and we do not\nintend to study them in this book. Instead, we briefly introduce some of the tools which\nyou can use to solve optimization problems in finance.\nA well-developed convex optimization tool is CVX under MatLab created by Michael Grant\nandStephenBoyd. Theacademic(noncommercial)versionofthetoolboxisfreeandunder\na GNU General Public License; it can be used or redistributed but not altered. However,\nit works under commercial software MatLab. The home of CVX is http://cvxr.com.\n198 B. A REVIEW OF PROBABILITY THEORY\nAnotherconvexoptimizationtoolisCVXOPTwhichisaPythonProgramcreatedbyMartin\nAndersen, Joachim Dahl, and Lieven Vandenberghe. The license is also a GNU General\nPublic License. The home of CVXOPT is https://cvxopt.org.\nAs a fun fact, Stephen Boyd from Stanford University and Lieven Vandenberghe from\nUCLA are the authors of the convex optimization book [8] which has more than 40,000\ncitations and is widely used as textbook for optimization courses.\nB A review of probability theory\nIn financial modeling, most uncertainties can effectively bemodeled by probability. Prob-\nability was not considered part of mathematics until approximately four hundred years\nago by a series of correspondence between Blaise Pascal (1623\u20131662) and Pierre de Fermat\n(1607\u20131665). Most of the problems were motivated by observation in gambling and games\nof chance.\nExample B.1 (Empirical observation). One wins a game of rolling one die if he achieves\nat least one six in four trials. In a different game, one wins in rolling two dice if he\nachieves at least one double six in twenty-four trials. Chevalier de M\u00e9r\u00e9 a.k.a. Antoine\nGombaud (1607\u20131684) wrote to Pascal that these two games must have the same probability\nof winning; in the latter, the chance of getting a favorable outcome is a round in six times\nless than the former, while the number of trials is six times more. Chevalier de M\u00e9r\u00e9,\nhowever, discovered that the two games are not empirically the same. More specifically,\nhe observed that the first game has a winning chance of slightly more than 50% while the\nsecond game\u2019s chance is slightly greater than that. Pascal and Fermat discussed the problem\nuntil Fermat eventually solved it. The solution is as follows.\n(cid:1) (cid:9)4\nThe chance of losing the first game is 5 . Therefore, the change of\n6\n(cid:1) (cid:9)4\nwinning is 1(cid:1) 5 (cid:19) 0.5177.The second problem has the change of\n6\n(cid:1) (cid:9)24\nwinning equal to 1(cid:1) 35 (cid:19) 0.4914.\n36\nIt is astonishing that Chevalier de M\u00e9r\u00e9 could empirically distinguish a difference of 0.0263\nbetween the two chances of winning.\nExample B.2 (Problem of points). Three players are playing over a stake. The condition\nof winning is that whoever wins a certain number of rounds takes the whole stake. Player\n1 needs one more round to win the stake, while players 2 and 3 need two rounds. However,\noutside circumstances dictates that they have to suddenly stop playing and agree to divide\nthe stake according to current situation of the game. Obviously, player 1 deserves a greater\nshare of the stake than the other two players, who should receive the same share. What is\nthe fair share of the stake for each player?\n199 B. PROBABILITY\nThe game is over after at most three rounds. Therefore, for each pos-\nsible outcome of the next three rounds a winner can be decided. For\nexample, if the outcome of the next three rounds is p2,3,1q (player 2\nwins, then player 3 wins, and finally player 1 wins), then player 1 is\nthe winner. There are twenty-seven possible outcomes in the next three\nrounds in seventeen of which player 1 wins. Players 2 and 3 each win in\nexactly five of the twenty-seven outcomes. Therefore, if all players have\nthe same chance of winning each round of the game, the stake should\nbe divided by 17, 5 and 5 between players 1, 2, and 3, respectively.\nFor about a hundred more years, probability theory continued to be used primarily to\naddressgambling-relatedproblems,untilJacobBernoulli(1655\u20131705),AbrahamdeMoivre\n(1667\u20131754), andThomasBayes(1702\u20131761)introducedthefirstlimittheorems. Bernoulli\nproved that if the probability of heads in tossing a coin is p, then the frequency of heads\nin a sequence of n trials converges to p as n (cid:209) 8. De Moivre showed that the empirical\ndistribution of the number of heads in n trials converges to a normal distribution.\nLaw of large numbers. If r is the number of heads in n trials of\ntossing a coin with heads probability p, then the probability of that\n|p(cid:1) r| \u011b \u03f5 converges to zero as n (cid:209) 8.\nn\nIn n trials of tossing a coin with heads probability p, the probability of r heads is given by\n(cid:0)n(cid:8)\nprp1(cid:1)pqn(cid:1)r for r (cid:16) 0,...,n. This probability is called the binomial distribution.\nr\nInthebinomialdistribution,(cid:0)n(cid:8)\nDeMoivre-Laplace. prp1(cid:1)pqn(cid:1)r (cid:18)\nr\n?1 e(cid:1)x 22 holds when as n (cid:209) 8 and ?r(cid:1)np (cid:209) x.\n2\u03c0 npp1(cid:1)pq\nThe above theorem is an early version of the central limit theorem, which will be presented\nlater in Theorem B.7 in Section B.4.\nBayes also contributed the concept of conditional probability, which deals with how the\noccurrenceofaspecificeventcanaffecttheprobabilitiesofotherevents. Thisgavebirthto\nthe concept of conditional probability. Consider the Venn diagram in Figure B.1. Assume\nthat events A, B, and C have their ex ante probabilities. If we discover that event A has\nhappened,theexpostprobabilityofAisnowequalto1. AnothereventB isnowrestricted\nto whatever remains of it inside A, i.e., AXB, and their ex post probabilities are obtained\nby rescaling the ex ante probability of AXB by the ex ante probability of A. For example,\nthe probability of event B given by\nex ante probability of AXB\nex post probability of A given B (cid:16) .\nex ante probability of A\nIn Figure B.1, the ex post probability of C is zero, since the ex ante probability of AXC\nis zero.\n200 B. PROBABILITY\nA B C\nA \\ B\nFigure B.1: Given A, the ex post probability of event B is the probability of event B\ninside A (AXB) divided by the probability of A.\nIn the above, we explained how to find the ex post probability in terms of the ex ante\nprobability. The Bayes formula explains how to obtain the ex ante probability in terms of\nthe ex post probability. Bayes formula, one of the most influential results in probability,\nconstructs the foundation of Bayesian statistics. To explain the formula, first we need to\nintroduce some notations. By PpAq we denote the ex ante probability of event A, and by\nPpA|Bq we denote the ex post probability of A given B.\nBayes formula 1.\nPpAq (cid:16) PpA|BqPpBq(cid:0)PpA|BAqPpBAq\nIf B ,B ,... are mutually exclusive and\n1 2\nPpB YB Y(cid:4)(cid:4)(cid:4)q (cid:16) 1,\n1 2\nthen\nPpAq (cid:16) PpA|B qPpB q(cid:0)PpA|B qPpB q(cid:0)(cid:4)(cid:4)(cid:4) .\n1 1 2 2\nWhen ex post probabilities of an event A conditional on a certain event B and the ex ante\nprobability of B are known, one can use Bayes formula to find the ex post probability of\nB conditional on A.\nBayes formula 2.\nPpA|BqPpBq PpA|BqPpBq\nPpB|Aq (cid:16) (cid:16)\nPpAq PpA|BqPpBq(cid:0)PpA|BAqPpBAq\nWeelaborateonthenotionofconditionalprobabilityandtheBayestheoremviaafamous\nexample in conditional probability, namely the three prisoners problem.\n201 B. PROBABILITY\nExample B.3 (Three prisoners problem). Three suspects (Bob, Kevin, and Stuart) are\nequally likely to be convicted. However, the judge has made up his mind and is going\nto pronounce one and only one of them guilty the following morning. None of the three\nprisoners knows who is going to be announced; however, the warden has been told the name\nof the guilty by the judge and has been given strict orders not to pass the information to\nthe prisoners. Stuart argues with the warden that at least one of the other two, Kevin or\nBob, is not guilty. If the warden names one of the other two, Stuart still cannot know\nif he himself is guilty or not. The warden counterargues that if he reveals the name of a\nnonguilty person, Stuart\u2019s chance of conviction increases from 1 to 1, because now there\n3 2\nare two prisoners one of whom is going to be guilty. Is the warden correct?\nTo answer the question, we formulate the problem using conditional probabilities. In\nthis case, if the warden names Bob as not guilty, then the ex ante probability of Stuart\u2019s\nconviction is given by\n\u015e\nex ante probability of conviction of Stuart Bob named not guilty by the warden\n.\nex ante probability of Bob named not guilty by the warden\nThe ex ante probability of Bob named not guilty by the warden can be calculated using the\nBayes formula. Let\u2019s denote this event by B\u02dc, and let S, K, and B be the events that either\nStuart, Kevin, or Bob, respectively, is announced guilty. By conditional probability, one\nneeds to calculate\nPpS XB\u02dc q\nPpS|B\u02dc q (cid:16) .\nPpB\u02dc\nq\nSince PpS YK YBq (cid:16) 1, it follows from the first Bayes formula that\nPpB\u02dc q (cid:16) PpB\u02dc |SqPpSq(cid:0)PpB\u02dc |KqPpKq(cid:0)PpB\u02dc |BqPpBq.\nNotice that PpKq (cid:16) PpBq (cid:16) PpSq (cid:16) 17, PpB\u02dc |Sq (cid:16) 1, PpB\u02dc |Kq (cid:16) 1, and PpB\u02dc |Bq (cid:16) 0.\n3 2\nTherefore,\n1 1 1\nPpB\u02dc q (cid:16) (cid:0) (cid:0)0 (cid:16) .\n6 3 2\nOn the other hand,\n1\nPpS XB\u02dc q (cid:16) PpB\u02dc |SqPpSq (cid:16) .\n6\nTherefore, PpS|B\u02dc q (cid:16) 61 (cid:16) 1.\n1 3\n2\nIn Example B.3, the revealed information does not change the ex ante probability. This\nis, however, a coincidence and not necessarily true. The following exercise addresses this\nissue.\n7Hereweassumethattheyareequallylikelytobepronouncedguilty. Onecanadjusttheseprobabilities\nand solve the problem accordingly.\n202 B. PROBABILITY\nExercise B.1. Repeat the solution to Example B.3 with PpKq (cid:16) PpSq (cid:16) 1 and PpBq (cid:16) 2.\n6 3\nBeware as here is some ambiguity about how to choose PpB\u02dc |Sq!\nExample B.4. In a burglary hearing, there is a probability p that the suspect is guilty.\nG\nIn actual fact, the suspect is left-handed. If it is brought before the court that the burglar\nis right-handed, the ex post probability that the suspect is guilty vanishes to zero. However,\nif the evidence shows that the burglar is left-handed, we need to use the Bayes formula to\nfind the ex post probability that the suspect is guilty. In this case, let G be the event that\nthe suspect is guilty and L be the event that the burglar is left-handed that, we assume, has\nthe same ex ante probability of any individual is left-handed8. Then,\nPpL|GqPpGq PpGq\nPpG|Lq (cid:16) (cid:16) .\nPpLq PpLq\nNotice that PpL|Gq (cid:16) 1, because the suspect is left-handed. On the other hand,\nPpLq (cid:16) PpL|GqPpGq(cid:0)PpL|GAqPpGAq (cid:16) PpGq(cid:0)PpL|GAqPpGAq\nNotice that PpGq (cid:16) p , PpGAq (cid:16) 1(cid:1)p , and PpL|GAq is roughly equal to the percentage of\nG G\nthe left-handed population, denoted by p . Therefore,\nL\np\nPpG|Lq (cid:16) G .\np (cid:0)p1(cid:1)p qp\nG G L\nNotice that when P \u0103 1, then PpG|Lq \u0105 PpGq (cid:16) p , because p (cid:0)p1(cid:1)p qp \u0103 1. For\nL G G G L\ninstance, when p (cid:16) .1 and p (cid:16) .15, then the ex post probability PpG|Lq is 15 . If p (cid:16) 0,\nL G 23.5 L\nthen no one in the population is left-handed except for the suspect, which makes him guilty.\nIf p (cid:16) 1, then everyone in the population is left-handed, PpG|Lq (cid:16) p , and the event L\nL G\ndoes not add to the information we already have.\nExercise B.2. Show that if the ex ante probability of event A is 1, then PpB|Aq (cid:16) PpBq.\nThe notion of conditional probability (the handling of new pieces of information in prob-\nability) is one of the most influential tools in applications of probability theory. Most\nimportant applications appear in Bayesian statistics, through which they contribute to all\nother areas of science.\nWe conclude the discussion of early advances in probability theory by mentioning that\nthese early developments are gathered in Essai philosophique sur les probabilit\u00e9s by Pierre-\nSimone Laplace (1749\u20131827) ([18]). However, the subject still lacked mathematical rigor\ncompared to other areas of mathematics until a breakthrough happened in the twentieth\ncentury. Andrey Nikolaevich Kolmogorov (1903\u20131987) initiated the foundation of probabil-\nity theory through measure theory, a topic in mathematical analysis. We provide a more\n8It is logical to assume that the probability that a burglar is left-handed is the same as any other\nindividual.\n203 B. PROBABILITY\nrigorous treatment of probability theory in Section B.2. In the next section, we present\nthe discrete theory of probability, which does not need measure theory.\nB.1 Basic concepts and definitions of discrete probability\nA (finite, countably infinite) sample space is a collection of all possible outcomes of a\nrandom experiment. Any subset A of the sample space \u2126 is called an event.\nExample B.5 (Flipping a coin). The sample space is thead,tailu.\nExample B.6 (Arrow-Debreu market model in Section 2.1). The sample space can be\nchosen to be t1,...,Mu, i.e., the collection of all the possible states of the system.\nExample B.7 (T-period binomial model). The sample space of the T-period binomial\nmodel in Section 2.3 can be chosen to be the collection of all T-sequences of the form\npa ,...,a q where each a is either u or \u2113. Each sample addresses the complete movements\n1 T i\nof the asset price over time.\nA probability over a finite (countably infinite) sample space \u2126 (cid:16) t\u03c9 ,...,\u03c9 u (\u2126 (cid:16)\n1 M\nt\u03c9 ,\u03c9 ,...u) is a vector \u03c0 (cid:16) p\u03c0 ,...,\u03c0 q (\u03c0 (cid:16) p\u03c0 ,\u03c0 ,...q) of nonnegative values such that\n1 2 1 M 1 2\n\u0159 \u03c0 (cid:16) 1. For simplicity, we write P\u03c0p\u03c9 q (cid:16) \u03c0 if no confusion occurs. The collection\n\u03c9P\u2126 i j j\nof all subsets of \u2126 determines the set of all events. The probability of an event A \u010e \u2126 is\nthen defined by\n\u201a\nPpAq :(cid:16) \u03c0 .\n\u03c9i\n\u03c9PA\nEvidently, P satisfies\n1) PpHq (cid:16) 0,\n2) PpAAq (cid:16) 1(cid:1)PpAq for all A \u010e \u2126, and,\n3) If tA u is a sequence of disjoint events, then\nn n\u011b1\n(cid:3) (cid:11)\n\u010f \u201a\nP A (cid:16) PpA q.\nn n\nn\u011b1 n\u011b1\nExample B.8 (Flipping a coin). In flipping a fair coin, the probability of either heads or\ntails is p (cid:16) 1. In flipping a unfair coin, the probability of heads is p (cid:24) 1, and therefore the\n2 2\nprobability of tails is 1(cid:1)p. In two consecutive flips of a fair coin, the probability of having\npH,Hq, pH,Tq, pT,Hq, orpT,Tqisequally1{4. Ifthecoinisnotfair, thenthesamplespace\nis not changed. But the probabilities of these outcomes change to \u03c0 (cid:16) p and \u03c0 (cid:16) 1(cid:1)p\nH T\nwhere p P r0,1s. In two consecutive flips, we have \u03c0 (cid:16) p2, \u03c0 (cid:16) \u03c0 (cid:16) pp1(cid:1)pq, and\nH,H H,T T,H\n\u03c0 (cid:16) p1(cid:1)pq2.\nT,T\n204 B. PROBABILITY\nExample B.9 (SingleassetT-periodbinomialmodel). In a binomial model with T-periods,\na risk-neutral probability assigns the probability \u03c0k\u03c0T(cid:1)k to an outcome pa ,...,a q in which\nu \u2113 1 T\nk of the entities are u and the T (cid:1)k remaining are \u2113.\nArandom variable X isafunctionfromsamplespacetoRd, X : \u03c9 P \u2126 (cid:222)(cid:209) Xp\u03c9q P Rd. The\nvalues that X takes with positive probability are called the values of the random variable,\nx P Rd such that Pp\u03c9 : Xp\u03c9q (cid:16) xq \u0105 0. To simplify the notation, we often write PpX (cid:16) xq\nfor Pp\u03c9 : Xp\u03c9q (cid:16) xq. When the sample space is finite or countably infinite, the random\nvariables can only take finitely of countably infinitely many values. Random variables with\nat most countably infinitely many values are called discrete random variables.\nRemark B.1. Notice that the values of a random variable are relative to the choice of\nprobability measure. For example, a random variable X : t0,1,2u (cid:209) R defined by Xpxq (cid:16) x\nhas values t0,1,2u relative to probability Pp0q (cid:16) Pp1q (cid:16) Pp2q (cid:16) 1{3. However, relative to a\nnew probability Qp0q (cid:16) Qp1q (cid:16) 1{2 and Qp2q (cid:16) 0, the set of values is given by t0,1u.\nExample B.10. Recall from Example B.6 that the sample space for the Arrow-Debreu\nmarket model is the set of states \u2126 (cid:16) t1,...,Mu. Therefore, a random variable is given by\na function X : t1,...,Mu (cid:209) R. In particular, the payoff of an asset (the price of an asset\nat time 1 for each state of the market) in the Arrow-Debreu market model is a random\nvariable. For instance, the payoff of asset i given in diagram 2.1.1 is a random variable\nP : \u2126 (cid:209) R such that\ni,(cid:4)\nP pjq (cid:16) P .\ni,(cid:4) i,j\nExample B.11 (Bernoulli random variable). Flipping a coin creates a Bernoulli random\nvariable by assigning values to the outcomes headsand tails. The Bernoulli randomvariable\nX takes the value 1 if the coin turns heads and 0 otherwise. If the coin has a probability\nof tails equal to p, then X (cid:16) 1 has probability p and X (cid:16) 0 has probability 1(cid:1)p.\nDefinition B.1. For an event A, the indicator of A is a random variable that takes value\n1 if A occurs and 0 otherwise. The indicator of A is denoted by 1 9. The indicator random\nA\nvariable 1 is a Bernoulli random variable that takes value 1 with probability PpAq and\nA\nvalue 0 with probability 1(cid:1)PpAq.\nExample B.12 (Binomial random variable). In flipping a coin n times, the binomial\nrandom variable X takes the value of the number of heads. The set of values of X is\nt0,...,nu. If the coin has a probability of heads equal to p, then for x in the set of values,\nthe probability X (cid:16) x is given by\n(cid:2) (cid:10)\nn\npxp1(cid:1)pqn(cid:1)x.\nx\n9the indicator is also denoted by \u03c7 in some literature.\nA\n205 B. PROBABILITY\nExample B.13 (Random walk). In a game of chance, in each round a player flips a coin.\nIf it turns tails, he gains $1; otherwise, he loses $1. Technically, each round has an outcome\ngiven by 2X(cid:1)1 where X is a brand new Bernoulli random variable with outcomes 1 and 0.\nThe player\u2019s accumulated reward after two rounds is a random variable W that take values\n2\n(cid:1)2, 0, and 2 with probabilities 1{4, 1{2, and 1{4, respectively. If the coin has a probability\nof heads equal p, then PpW (cid:16) 2q (cid:16) p2, PpW (cid:16) (cid:1)2q (cid:16) p1(cid:1)pq2, and PpW (cid:16) 0q (cid:16) 2p1(cid:1)pqp.\n2 2 2\nHere, 1 is not among the values of W , because PpW (cid:16) 1q (cid:16) 0.\n2 2\nIf the player continues this game, the sequence of his accumulated wealth at all times,\nW ,W ,W ,...., is called a random walk. At time t, W takes values t(cid:1)t,(cid:1)t(cid:0)2,...,tu for\n0 1 2 t\nt (cid:16) 1,...,T. The probability of W (cid:16) x is given by\nt\n(cid:2) (cid:10)\nt t(cid:0)x\npkp1(cid:1)pqt(cid:0)1(cid:1)k with k (cid:16) .\nk 2\nIn Example B.13, a proper sample space can be given by\n\u2126 :(cid:16) tpa ,a ,...q a (cid:16) H or T for i (cid:16) 1,2,...u, (B.1)\n1 2 i\nwhen the game is infinite.\nExercise B.3. In Example B.13, calculate PpW (cid:16) 2 | W (cid:16) 1q and PpW (cid:16) (cid:1)1 | W (cid:16) 1q.\n2 1 3 1\nExample B.14 (Negative binomial random variable). In flipping a coin, the negative\nbinomial random variable X counts the number of heads before r number of tails appear.\nThe set of values of X is tr,r(cid:0)1,...u. If the coin has a probability of heads equal to p, then\nfor x in the set of values, the probability X (cid:16) x is given by\n(cid:2) (cid:10)\nx(cid:0)r(cid:1)1\npxp1(cid:1)pqr.\nx\nExercise B.4. In Example B.14, find an appropriate sample space and an accurate prob-\nability on this sample space.\nExample B.15 (T-period binomial model). For the binomial model with T periods, con-\nsider the sample space described in Example B.7. Recall from Section 2.3 that in the\nbinomial model with T periods, the price S of the asset at time t is a random variable that\nt\ntakes values tS uk\u2113t(cid:1)k : k (cid:16) 0,...,tu. Thus, one can say that under risk-neutral probability,\n0\nwe have P\u02c6\u03c0pS (cid:16) S uk\u2113t(cid:1)kq (cid:16) (cid:0)t(cid:8) p\u03c0\u02c6 qkp\u03c0\u02c6 qt(cid:1)k. This is because exactly (cid:0)t(cid:8) of outcomes in\nt 0 k u \u2113 k\nthe sample space lead to S (cid:16) S uk\u2113t(cid:1)k, and each outcome in the sample space has proba-\nt 0\nbility p\u03c0\u02c6 qkp\u03c0\u02c6 qt(cid:1)k. Under physical probability, see 2.4.1; the probability of S (cid:16) S uk\u2113t(cid:1)k\nu \u2113 t 0\n(cid:0)t(cid:8)\nchanges to pkp1(cid:1)pqt(cid:1)k.\nk\nRemark B.2 (Random walk as a corner stone of financial models). A binomial model is\nrelated to the random walk in Example B.13 through taking logarithm. If V (cid:16) lnpS q then\nt t\n206 B. PROBABILITY\nV takes values lnpS q(cid:0)klnpuq(cid:0)pt(cid:1)kqlnp\u2113q for k (cid:16) 0,...,t. In other words, V is the\nt 0 t\nposition of a generalized random walk after t rounds, starting at lnpS q which moves to\n0\nlnpuq or lnp\u2113q in each round, respective to the outcomes of a coin. If S (cid:16) 1, u (cid:16) e and\n0\n\u2113 (cid:16) e(cid:1)1, then the random walk V is the standard random walk W described in Example\nt t\nB.13. Otherwise, V (cid:16) lnpS q(cid:0)\u00b5t(cid:0)\u03c3W where \u00b5 (cid:16) lnpuq(cid:0)lnp\u2113q and \u03c3 (cid:16) lnpuq(cid:1)lnp\u2113q. In other\nt 0 t 2 2\nwords,\nS (cid:16) S expp\u00b5t(cid:0)\u03c3W q.\nt 0 t\nExample B.16. Two random variables representing the payoff of two risky assets in the\nArrow-Debreu market model that also includes a zero bond with yield R (cid:16) 0, is shown in\nFigure B.2. From Exercise 2.1.4, we know that all risk-neutral probabilities are given by\n\u03c0\u02c6 (cid:16) pt{2,p1(cid:1)tq{2,p1(cid:1)tq{2,t{2qT with t P p0,1q. The conditional probability of X (cid:16) y\nX Y\nP = 1 P = 1\n1;1 2;1\nP = (cid:0)1 P = 1\n1;2 2;2\np = 0 p = 0\n1 2\nP = 1 P = (cid:0)1\n1;3 2;3\nP = (cid:0)1 P = (cid:0)1\n1;4 2;4\nFigure B.2: Example B.16\ngiven Y (cid:16) x, for x (cid:16) (cid:8)1 and y (cid:16) (cid:8)1, is found below.\nPpX (cid:16) 1&Y (cid:16) 1q \u03c0\u02c6\nPpX (cid:16) 1|Y (cid:16) 1q (cid:16) (cid:16) 1 (cid:16) t\nPpY (cid:16) 1q \u03c0\u02c6 (cid:0)\u03c0\u02c6\n1 2\nPpX (cid:16) (cid:1)1&Y (cid:16) 1q \u03c0\u02c6\nPpX (cid:16) (cid:1)1|Y (cid:16) 1q (cid:16) (cid:16) 2 (cid:16) 1(cid:1)t\nPpY (cid:16) 1q \u03c0\u02c6 (cid:0)\u03c0\u02c6\n1 2\n(B.2)\nPpX (cid:16) 1&Y (cid:16) (cid:1)1q \u03c0\u02c6\nPpX (cid:16) 1|Y (cid:16) (cid:1)1q (cid:16) (cid:16) 3 (cid:16) 1(cid:1)t\nPpY (cid:16) (cid:1)1q \u03c0\u02c6 (cid:0)\u03c0\u02c6\n3 4\nPpX (cid:16) (cid:1)1&Y (cid:16) (cid:1)1q \u03c0\u02c6\nPpX (cid:16) (cid:1)1|Y (cid:16) (cid:1)1q (cid:16) (cid:16) 4 (cid:16) t\nPpY (cid:16) (cid:1)1q \u03c0\u02c6 (cid:0)\u03c0\u02c6\n3 4\nIndependence\nRecallthattheconditionalprobabilityofeventB giventhateventAhasoccurredisdefined\nby\nPpAXBq\nPpB | Aq :(cid:16) .\nPpAq\n207 B. PROBABILITY\nThe conditional probability gives birth to the important notion of independence. Two\nevents A and B are called independent if\nPpB | Aq (cid:16) PpBq,\nor equivalently\nPpA | Bq (cid:16) PpAq.\nIt is easier to write independence as\nPpBXAq (cid:16) PpAqPpBq.\nTwo random variables X and Y are called independent if each event related to X is inde-\npendent of each event related to Y, i.e.\nFor all x in values of X and all y is values of Y, we have\nPpX (cid:16) x, Y (cid:16) yq (cid:16) PpX (cid:16) xqPpY (cid:16) yq.\nExercise B.5. Show that two events A and B are independent if and only if the indicator\nrandom variables 1 and 1 are independent.\nA B\nIn modeling random experiments, independence is a common-sense knowledge or an as-\nsumption inside a model. For example in a random walk, the outcomes of two different\nrounds are assumed independent, because of the belief that two flips of a coin are indepen-\ndent trials. As a result, two random variables W and W (cid:1)W are independent.\n5 8 5\nExercise B.6. Show that in a random walk, W and W (cid:1)W are independent provided\n5 8 5\nthat the outcome of each round is independent of other rounds.\nDefiningindependenceformorethantwoevents(equivalentlyrandomvariables)isalittle\ntricky. We call X independent of the sequence of random variables X ,X ,...,X if\n1 2 n\nPpX (cid:16) x, X (cid:16) x ,X (cid:16) x ,...,X (cid:16) x q (cid:16) PpX (cid:16) xqPpX (cid:16) x ,X (cid:16) x ,...,X (cid:16) x q.\n1 1 2 2 n n 1 1 2 2 n n\nThis indicates that any event related to the values of X is independent of any event related\nto the values of X ,X ,...,X , i.e.\n1 2 n\nPpX P A, pX ,X ,...,X q P Bq (cid:16) PpX P AqPppX ,X ,...,X q P Bq.\n1 2 n 1 2 n\nA finite sequence X ,X ,...,X is called independent sequence of random variables if for\n1 2 n\neach i, X and tX : j(cid:24)iu are independent.\ni j\nAs observed in the following exercise, to show the independence of a sequence of random\nvariables, it is not enough to check that each pair of random variables X and X are\ni j\nindependent.\n208 B. PROBABILITY\nExercise B.7. In two consecutive flips of a fair coin, let A be the event that the first flip\nturns heads, B be the event that the second flip turns heads and C be the event that only\none of the flips turns heads. Show that A, B, and C are not an independent sequence of\nrandom variables, but they are pairwise independent.\nAn equivalent definition of independence of a sequence of random variables is as follows.\nA finite sequence X ,X ,...,X is called independent if for all subsets A ,...,A of values\n1 2 n 1 n\nof X ,...,X , respectively, we have\n1 n\nPpX P A ,...,X P A q (cid:16) PpX P A q...PpX P A q. (B.3)\n1 1 n n 1 1 n n\nThiscanalsobeextendedtoaninfinitesequenceofrandomvariables. Aninfinitesequence\nX ,X ,... is called independent if each finite subset tX ,...,X u makes an independent\n1 2 i1 in\nsequence. Having defined the notion of independence for a sequence of random variables,\nwe can now properly define a random walk, as the previous definition in Example B.13 is\nmore heuristic than rigorous.\nDefinition B.2. Let \u03be ,\u03be ,... be a sequence of independent and identically distributed\n1 2\n(i.i.d.) random variables such that Pp\u03be (cid:16) 1q (cid:16) p and Pp\u03be (cid:16) (cid:1)1q (cid:16) 1 (cid:1) p for some\ni i\np P p0,1q. For x P Z, the sequence W (cid:16) x,W ,W ,... with\n0 1 2\nn\n\u201a\nW :(cid:16) x(cid:0) \u03be for n \u011b 1,\nn i\ni(cid:16)1\nis called a random walk. When p (cid:16) 1, we call it a symmetric random walk; otherwise, it\n2\nis called a biased random walk.\nLet X be a random variable on a discrete sample space \u2126 with probability vector \u03c0p\u03c9q\nfor each \u03c9 P \u2126. Then, the expectation or expected value of X is defined by\n\u201a\nErXs :(cid:16) Xp\u03c9q\u03c0p\u03c9q. (B.4)\n\u03c9P\u2126\nIf a random variable X takes values x ,x ,... with probabilities p ,p ,..., respectively, then\n1 2 1 2\nthe expectation of X can equivalently be given by\n8\n\u201a\nErXs :(cid:16) x p .\ni i\ni(cid:16)1\nIn particular, if values of X are finitely many x ,x ,...,x with probabilities p ,p ,...,p ,\n1 2 n 1 2 n\nrespectively, then the expectation of X is equivalently given by\nn\n\u201a\nErXs :(cid:16) x p . (B.5)\ni i\ni(cid:16)1\n209 B. PROBABILITY\nTheadvantageof (B.5)over(B.4)isthatasamplespacecanbeverylargewhiletherandom\nvariable only takes small number of values. For example, in Example B.9, a single-asset\nT-period binomial model generates a sample space of all paths of the asset price of size 2T,\nwhile the values of random variable S are only T (cid:0)1.\nt\nBy straightforward calculations, the expectation of a function fpxq of X is given by\n8\n\u201a\nErfpXqs (cid:16) fpx qp .\ni i\ni(cid:16)1\nThe variance of a random variable is defined by\nvarpXq :(cid:16) ErpX (cid:1)ErXsq2s (cid:16) ErX2s(cid:1)ErXs2.\nOne of the important result in the expectation of random variables is the Jensen inequality\nfor convex functions.\nCorollary B.1. Consider a probability space p\u2126,F,Pq that hosts a Rd-valued random\nvariable X and let f : Rd (cid:209) R be convex function f. Then, we have\nfpErXsq \u010f ErfpXqs,\nprovided that both of the expectations exist.\nProof. By Corollary A.1, there exists a vector u P Rd such that fpErXsq(cid:0)pX(cid:1)ErXsq(cid:4)u \u010f\nfpXq. By taking the expected value from both sides, we obtain the desired result.\nThe Jensen inequality is reduced to the definition of convexity (A.2) when X is a random\nvariablewithtwovaluesx andx . Moreprecisely,ifPpX (cid:16) x q (cid:16) \u03bbandPpX (cid:16) x q (cid:16) 1(cid:1)\u03bb,\n1 2 1 2\nwe have\nfpErXsq (cid:16) fp\u03bbx (cid:0)p1(cid:1)\u03bbx qq \u010f \u03bbfpx q(cid:0)p1(cid:1)\u03bbqfpx q (cid:16) ErfpXqs.\n1 2 1 2\nLet Y be another random variable with values y ,...,y . To write the expectation of a\n1 m\nfunction fpx,yq of two random variables X and Y, we need to know the joint (mutual)\nprobabilities of the pair pX,Yq, i.e.,\np :(cid:16) PpX (cid:16) x , Y (cid:16) y q for i (cid:16) 1,...,n, and j (cid:16) 1,...,m.\ni,j i j\nNotice that although PpX (cid:16) x q and PpY (cid:16) y q are positive, p can be zero, which means\ni j i,j\nthat if a value x is realized for the random variable X, then y cannot be realized for Y,\ni j\nand vice versa. Then, we define the expected value of fpX,Yq by\n8 8\n\u201a \u201a\nErfpX,Yqs :(cid:16) fpx ,y qp .\ni j i,j\ni(cid:16)1j(cid:16)1\n210 B. PROBABILITY\nWith the above definition, one show the Cauchy-Schwartz inequality.\nTheorem B.1. For two random variables X and Y we have\na a\nErXYs \u010f ErX2s ErY2s.\nThe equality holds if and only if X and Y are linearly dependent, i.e., if aX (cid:0)bY (cid:0)c (cid:16) 0\nfor some constants a,b,c P R such that at least one of them is nonzero.\nThe covariance between two random variables is defined by\ncovpX,Yq :(cid:16) ErpX (cid:1)ErXsqpY (cid:1)ErYsqs (cid:16) ErXYs(cid:1)ErXsErYs.\nBy applying the Cauchy-Schwartz inequality, we obtain\na a\ncovpX,Yq (cid:16) ErpX (cid:1)ErXsqpY (cid:1)ErYsqs \u010f ErpX (cid:1)ErXsq2s ErpY (cid:1)ErYsq2s.\nIn the above, the equality holds if and only if X and Y are linearly dependent. The\ncorrelation between two random variables is defined by\ncovpX,Yq\ncorpX,Yq :(cid:16) .\na\nvarpxqvarpYq\nThe Cauchy-Schwartz inequality shows that (cid:1)1 \u010f corpX,Yq \u010f 1, and either of the equali-\nties holds if and only if if aX (cid:0)bY (cid:0)c (cid:16) 0 for some constants a,b,c P R such that at least\none of them is nonzero. In the case of equality, when ab \u0103 0 (respectively ab \u0105 0), then\ncorpX,Yq (cid:16) 1 (respectively corpX,Yq (cid:16) (cid:1)1).\nWe can define conditional expectation similarly by replacing the probabilities p with\ni,j\nthe conditional probabilities\np\np :(cid:16) PpX (cid:16) x | Y (cid:16) y q (cid:16) i,j ,\ni|j i j pY\nj\nwith pY (cid:16) PpY (cid:16) y q. More precisely,\nj j\n\u201a8 1 \u201a8\nErfpX,Yq | Y (cid:16) y s :(cid:16) fpx ,y qp (cid:16) fpx ,y qp . (B.6)\nj i j i|j pY i j i,j\ni(cid:16)1 j i(cid:16)1\nNotice that if PpY (cid:16) yq (cid:16) 0, then ErfpX,Yq | Y (cid:16) ys in (B.6) is not defined. However, we\ncan define function h : y (cid:222)(cid:209) ErfpX,Yq | Y (cid:16) ys on the set of values of the random variable\nY. This in particular helps us to define the random variable\nErfpX,Yq | Ys :(cid:16) hpYq.\n211 B. PROBABILITY\nRemark B.3. Notice the difference between ErfpX,Yq | Y (cid:16) y s, ErfpX,Yq | Y (cid:16) ys,\nj\nand ErfpX,Yq | Ys. ErfpX,Yq | Y (cid:16) y s is a real number, ErfpX,Yq | Y (cid:16) ys is a real\nj\nfunction on variable y, and finally ErfpX,Yq | Ys is a random variable.\nExample B.17. With regard to the above remark, we find PpX (cid:16) 1|Yq, PpX (cid:16) (cid:1)1|Yq,\nand ErX|Ys in Example B.16. It follows from (B.2) that hpyq (cid:16) PpX (cid:16) 1|Y (cid:16) yq is given\nby\n#\nt when y (cid:16) 1\nhpyq (cid:16)\n1(cid:1)t when y (cid:16) (cid:1)1\nThus, PpX (cid:16) 1|Yq (cid:16) t\u03b4 pYq(cid:0)p1(cid:1)tq\u03b4 pYq. Here, \u03b4 pyq is 1 when y (cid:16) x and 0 otherwise.\n1 (cid:1)1 x\nSimilarly, PpX (cid:16) (cid:1)1|Yq (cid:16) p1(cid:1)tq\u03b4 pYq(cid:0)t\u03b4 pYq. Finally,\n1 (cid:1)1\nErX|Ys (cid:16) PpX (cid:16) 1|Yq(cid:1)PpX (cid:16) (cid:1)1|Yq (cid:16) t\u03b4 pYq(cid:0)p1(cid:1)tq\u03b4 pYq(cid:1)p1(cid:1)tq\u03b4 pYq(cid:1)t\u03b4 pYq\n1 (cid:1)1 1 (cid:1)1\n(cid:16) p2t(cid:1)1q\u03b4 pYq(cid:0)p1(cid:1)2tq\u03b4 pYq.\n1 (cid:1)1\nAs a particular case, when fpx,yq (cid:16) x, we have\nhpyq (cid:16) ErX | Y (cid:16) ys and ErX | Ys (cid:16) hpYq.\nCorollary B.2. If X and Y are random variables and f is a real function, then we have\nErfpYqX | Ys (cid:16) fpYqErX | Ys.\nThe following proposition, which is a direct result of (B.6), explains a very important\nproperty of independent random variables.\nProposition B.1. X and Y are independent if and only if, for any real function fpx,yq\nof X and Y, we have\nErfpX,Yq | Y (cid:16) ys (cid:16) ErfpX,yqs for all y in the set of values of Y.\nCorollary B.3. If X and Y are independent and f is a real function, then we have\nErfpXq | Ys (cid:16) ErfpXqs.\nOne of the important properties of conditional expectation is the tower property, which\nis presented in the next proposition.\nProposition B.2 (Towerpropertyofconditionalexpectation). Let X, Y and Z be random\nvariables. Then,\nErErX | Y,Zs | Ys (cid:16) ErX | Ys.\nIn particular,\nErErX | Yss (cid:16) ErXs.\n212 B. PROBABILITY\nThefollowingpropositionprovidesanequivalentrepresentationforindependencethrough\nthe conditional expectation.\nB.2 General probability spaces\nSome random experiments can generate uncountable number of outcomes, e.g., choosing\na point in the unit interval r0,1s or choosing a chord of a unit circle. In such cases, the\ndefinitions in Section B.1 don\u2019t make sense; e.g., the summation in (B.4) relies on the\ncountability of the sample space. The complexity of uncountable sample spaces is twofold.\nFirst, the basic definitions, such as the expected value in (B.4), use summation, which\nrelies on countability of values. In Section B.2, we will consider the continuous random\nvariables in which the summations can be replaced by an integral, such as Example B.18.\nSecondly, there is mathematical challenge in defining an event in an uncountable sample\nspace, which we will describe later in this section.\nExample B.18. In choosing a random number uniformly inside r0,1s, the probability of\nthe following events can be calculated by integration.\n\u015fb\ni) The probability that the random number is in pa,bq \u010e r0,1s equals fpxqdx (cid:16) b(cid:1)\na\na. Here fpxq (cid:16) 1 pxq is called the uniform probability density function. This\nr0,1s\nprobability is the area enclosed by fpxq and x axis above interval pa,bq\nii) The probability that the random number is .5 equals 0 as the area described in (i) is\nzero.\niii) The probability that the random number is a rational number is 0. Rational numbers\nare countable so the probability of this event is sum of the probability of each rational\nnumber, which is summation of countable number of zeros.\niv) The probability that the random number is an irrational number is 1. This probability\nis the complement of the probability of rationals, which is 0.\nThe random experiment in the above example is describing a continuous random vari-\nable. In such random variables, the probability of events and expected values of random\nvariables can be calculated by integration. However, in general, there can be random\nvariables that are neither continuous nor discrete. In that case, concepts such as expec-\ntation and conditional expectation should be defined differently; they requires advanced\ntechniques from measure theory. Measure theory was gradually developed as a theory for\nintegration by several mathematicians such as \u00c9mile Borel (1871\u20131956), Henri Lebesgue\n(1875\u20131941), Johann Radon (1887\u20131956), and Maurice Fr\u00e9chet (1878\u20131973). However, An-\ndrey Kolmogorov (1903\u20131987) was the first who noticed that this theory can be used as a\nfoundationforprobabilitytheory; aprobabilityisanonnegative finite measure (normalized\nto mass one) and the expectation is an integral with respect to that measure.\n213 B. PROBABILITY\n(cid:17)\n!7!ei2(cid:25)r 2(cid:25)r\n!\n(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)!\n2(cid:25)r\nFigure B.3: Description of the transformations in Example B.19\nAnother difficulty that arises in uncountable sample spaces is the meaning of an event. In\ndiscrete space, any subset of the sample space is an event and any function from sample\nspace to Rd is a random variable. However, in uncountable sample spaces, there are some\nsubsets of the sample space for which no value as a probability can be assigned. Therefore,\nan event and a random variable should be defined in a proper way by using the concept of\nmeasurability; onlymeasurable setsareevents, andmeasurablerealfunctionsmakerandom\nvariables. Formoreextensivestudyontheconceptofprobabilitymeasuresandmeasurable\nfunctions see [1] or [4]. Here, we address the issue briefly. First, we provide an example to\nshow how a nonmeasurable set looks like.\nExample B.19 (A nonmeasurable set exists). Consider \u2126 (cid:16) r0,1q, identified by a unit\n?\ncircle through the transformation \u03c9 (cid:222)(cid:209) ei2\u03c0\u03c9 shown in Figure B.3. Here, i (cid:16) (cid:1)1. Now,\nfor any rational number r in r0,1q, consider the rotational transformation on the circle\ngiven by ei2\u03c0r : x (cid:16) ei2\u03c0\u03c9 (cid:222)(cid:209) ei2\u03c0rx. If we consider the uniform probability on \u2126 (cid:16) r0,1q,\nthe induced probability on the circle is also uniform. The uniform probability on the circle\nis invariant under rotations;\nPpBq (cid:16) Ppei2\u03c0rBq for any subset B on the circle.\nFor x (cid:16) ei2\u03c0\u03c9, define the orbit of x by Opxq :(cid:16) txei2\u03c0r : r P Q X r0,1qu. Since Opxq\nis countable and the unit circle is uncountable, there are uncountably many disjoint orbits\nwith a union equal to the unit circle. Let A be a set that has exactly one point from each\ndistinct orbit. Then, one can see that the countable disjoint union\n\u010f\nei2\u03c0rpAq\nrPQXr0,1q\ncovers the unit circle. Here, ei2\u03c0rpAq means the image of A under the rotational transfor-\nmation ei2\u03c0r. This is because: (1) If x P ei2\u03c0rpAqXei2\u03c0r1 pAq for 0 \u010f r \u0103 r1 \u0103 1 rationals ,\nwe have then both ei2\u03c0p1(cid:1)rqx10 and ei2\u03c0p1(cid:1)r1qx belonging to A and being members of Opxq,\n10Ify(cid:16)ei2\u03c0rx,thenx(cid:16)ye(cid:1)i2\u03c0r. But,since(cid:1)risnotinr0,1qand1(cid:16)ei2\u03c0,wecanwritex(cid:16)yei2\u03c0p1(cid:1)rq.\n214 B. PROBABILITY\nwhichcontradictsthechoiceofA; and(2)Foreachx, thereisamembery P Opxq P A; there\nexists a rational r such that y (cid:16) ei2\u03c0rx. Thus, x (cid:16) ei2\u03c0p1(cid:1)rqy P ei2\u03c0p1(cid:1)rqpAq. Therefore, we\nhave\n(cid:4) (cid:12)\nP (cid:5) \u010f ei2\u03c0rpAq(cid:13)(cid:16) \u201a P(cid:0) ei2\u03c0rpAq(cid:8) .\nrPQXr0,1q rPQXr0,1q\nIt follows from the invariance of uniform probability under rotation that the probability of\nA is the same as the probability of ei2\u03c0rpAq for all r P QXr0,1q, if such a probability exists.\n(cid:4) (cid:12)\n\u010f \u201a\nP ei2\u03c0rpAq(cid:13)(cid:16) PpAq.\n(cid:5)\nrPQXr0,1q rPQXr0,1q\nNow if A has probability 0 under uniform measure, then so does the countable union\n\u0164 ei2\u03c0rpAq, which is a contradiction, because the union \u0164 ei2\u03c0rpAq makes\nrPQXr0,1q rPQXr0,1q\nup the whole circle, which has probability 1. Otherwise, if A has a nonzero probability, then\nthe sum on the left-hand side is infinite. Either way, it is impossible to assign a probability\nto A; A is nonmeasurable.\nUncountable sample spaces appear in probability even when the experiment is a discrete\none. For instance, consider the following version of the law of large numbers:\nTheoremB.2(LawofLargeNumbers). LettX u8 beasequenceofindependentrandom\nn n(cid:16)1\nvariables that take values 0 or 1 with equal likelihood. Then,\n1 \u201a8 1\nlim X (cid:16)\nn\nN(cid:209)8 N 2\nn(cid:16)1\nexcept on a set of outcomes with probability zero.\nIn this theorem, we consider a sample space \u2126that consists of all sequences \u03c9 (cid:16) p\u03c9 ,...q\n1\nsuch that \u03c9 (cid:16) H or T based on the outcome of the nth coin flip. The random variable\nn\nX is defined by 1 if \u03c9 (cid:16) H and 0 if \u03c9 (cid:16) T. This sample space is uncountable! To see\nn n n\nthis, we construct a map which takes it into the interval r0,1q:\n\u201a8 X\nn\n\u03c9 (cid:222)(cid:209) .\n2n\nn(cid:16)1\nThe right-hand-side above is the binary representation of a number in r0,1q. Therefore,\nthe sample space \u2126 is uncountable and not significantly different from r0,1q.\nRemark B.4. Notice that some numbers can have two different binary representations.\nFor example, .5 (cid:16) 1 (cid:16) \u01598 1 . However, the even in \u2126 that corresponds to all these\n2 n(cid:16)2 2n\nnumbers has probability zero.\n215 B. PROBABILITY\n\u03c3-field of events\nOne of the important notions in the probability theory is dealing with the definition of an\nevent, a random variable, and the information related to them, which is presented in the\nfollowing definition.\nDefinition B.3 (\u03c3-field). For a (possibly uncountable) sample space \u2126, the set of events\nshould use the notion of \u03c3-field from measure theory. A \u03c3-field F is a collection of subsets\nof \u2126 that satisfies\na) H and \u2126 P F.\nb) If A P F, then AA P F.\nc) For a sequence tA u8 \u010e F, \u01648 A P F.\nn n(cid:16)0 n(cid:16)0 n\nA sample space \u2126 along with a \u03c3-field is called a measurable space.\nUsually, a \u03c3-field can be specified by defining a set of elementary events and expanding\nthis set to a whole \u03c3-field, which contains all events. For instance, in a discrete sample\nspace \u2126 (cid:16) t\u03c9 ,\u03c9 ,...u, one can define the elementary events to be E (cid:16) t\u03c9 u. Then, any\n1 2 n n\nevent is a countable union of elementary events.\nIn uncountable sample spaces, the methodology of working with elementary events is\ninevitable. We consider a set of elementary events tE : n \u011b 1u and construct the\nn\nsmallest \u03c3-field that contains all these elementary events, namely the \u03c3-field generated by\nelementary sets tE : n \u011b 1u denoted by \u03c3pE : n \u011b 1q.\nn n\nExample B.20. Consider \u2126 (cid:16) R and the elementary events given by the singleton sets\nE :(cid:16) tx u for n (cid:16) 1,2,.... Then, by property (b) the complement of singleton elementary\nn n\nevents, EA (cid:16) Rztx u is in the \u03c3-field generated by E s. Also, any finite or countable\nn n n\nnumber of x s and the complement of it make events in this \u03c3-field. For instance, the\nn\n\u03c3-field generated by t1u is\n! )\nH,R,t1u,Rzt1u .\nThe \u03c3-field generated by t1u and t2u is\n! )\nH,R,t1u,t2u,t1,2u,Rzt1u,Rzt2u,Rzt1,2u .\nExample B.21. The \u03c3-field generated by a single event, A has four distinct events: H,\n\u2126, A, and AA. For example, the \u03c3-field generated by the set of all rational numbers in R\nconsist of H, R, the set of rational numbers, and the set of irrational numbers.\nIn the discrete example from the last paragraph, the \u03c3-field is the same as the set of all\nsubsets of \u2126. In Chapter 2, the sample space is \u2126 (cid:16) pRd(cid:0)1qT. We consider each elementary\n216 B. PROBABILITY\nevent given by an open set in pRd(cid:0)1qT. Then, we work with the Borel \u03c3-field Bp\u2126q, the\n\u03c3-field generated by all open subsets of \u2126. This method can be generalized to all samples\nspaces that are topological spaces. The Borel \u03c3-field in R, BpRq, is generated by the set of\nall open intervals pa,bq. It is not hard to see that all intervals, closed or semi-closed, are\nalso included in the Borel \u03c3-field. For instance,\n\u010d (cid:1) 1(cid:9)\npa,bs (cid:16) a,b(cid:0) .\nn\nn\u011b1\nAlso, all single points are in the Borel \u03c3-field; tbu (cid:16) \u0164 rb,b(cid:0) 1q. Also, BpRq can be\nn\u011b1 n\ngenerated by half-open intervals of the form pa,bs, because\n\u010f8 (cid:1) 1(cid:25)\npa,bq (cid:16) a,b(cid:1) .\nn\nn(cid:16)1\nExercise B.8. Show that BpRq can be generated by half-open intervals of the form ra,bq.\nExercise B.9. Check whether the following sets make a \u03c3-field. In case they are not a\n\u03c3-field, find the missing events that makes them a \u03c3-field.\n\u2423R,tau,tbu,ta,bu,Rztbu,Rztau(\ni) where a and b are two distinct real numbers.\n\u2423 (\nii) H,r0,1s,r0, 2q,p1,1s .\n3 3\n\u2423 H,R(\niii) .\nThe Borel \u03c3-field on r0,1s, Bpr0,1sq, is the \u03c3-field generated by the intervals of the form\npa,bq, r0,bq, or pa,1s, where 0 \u010f a \u0103 b \u010f 1. Equivalently, Bpr0,1sq is generated by the\nhalf-open intervals of the form ra,bq or pa,bs.\nExample B.22. The Borel \u03c3field Bpr0,1sq can be generated by either of the following\nelementary events:\ni) The set of intervals of the form pa,bq, r0,bq, or pa,1s, where 0 \u010f a \u0103 b \u010f 1,\nii) The set of intervals of the form ra,bq or pa,bs, where 0 \u010f a \u0103 b \u010f 1, and\niii) The set of intervals of the form ra,bs, where 0 \u010f a \u0103 b \u010f 1.\nTo show this, we need to demonstrate that each elementary event of one set can be generated\nby the elementary events from the other sets. In the set of elementary events in (i), the\ninterval pa,bq can be written as\n\u010f8 (cid:1) 1(cid:25)\npa,bq (cid:16) a,b(cid:1) .\nn\nn(cid:16)1\n217 B. PROBABILITY\nTherefore, pa,bq can be generated by the events that are described in (ii). r0,bq and pa,1s\nalready belong to the set that are described in (ii). Therefore, all elementary events in (i)\ncan be generated by elementary events in (ii).\nIn addition, we have\n\u010f8 (cid:17) 1(cid:25) \u010f8 (cid:17) 1 (cid:25)\nra,bq (cid:16) a,b(cid:1) and pa,bs (cid:16) a(cid:0) ,b ,\nn n\nn(cid:16)1 n(cid:16)1\nwhich implies that all elementary events in (ii) can be generated by elementary events in\n(iii).\nFinally, we have\n\u010d8 (cid:1) 1 1(cid:9) \u010d8 (cid:1) 1 (cid:25) \u010d8 (cid:17) 1(cid:9)\nra,bs (cid:16) a(cid:1) ,b(cid:0) , pa,1s (cid:16) a(cid:1) ,1 , and r0,bq (cid:16) 0,b(cid:0) .\nn n n n\nn(cid:16)1 n(cid:16)1 n(cid:16)1\nTherefore, all elementary events in (iii) can be generated by elementary events in (i).\nThe Borel \u03c3-field on the half-line r0,8q, Bpr0,8qq, is the \u03c3-field generated by the sets of\nthe form pa,bq or r0,bq, where 0 \u010f a \u0103 b.\nExercise B.10. Show that Bpr0,8qq can be generated by either of the following elementary\nevents:\ni) The set of intervals of the form pa,bq or r0,bq, where 0 \u010f a \u0103 b \u0103 8, and\nii) The set of intervals of the form ra,bq, where 0 \u010f a \u0103 b \u0103 8.\nHint: Show that each elementary event of one set can be generated by the elementary events\nfrom the other set.\nThefollowingexampleisausefuluseofelementaryeventsinanalyzinganeventofinterest\nand a method of finding the probability of such an event.\nExample B.23. In Example B.13, let the event of ruin A be the collection of all outcomes\nfor which the gambler\u2019s wealth eventually hits zero. For instance, if W (cid:16) 10, any outcome\n0\nwith ten loses in a row since the start of the game is in this set. Also, any outcome with the\nnumber of losses at some time larger than the number of wins plus ten is in the ruin event\nA. The ruin event is uncountable. We attempt to find the probability of this event later in\nExample B.25, namely the ruin probability. Before that, we need to write this event as a\nunion of disjoint simpler events for which the probability can easily be evaluated.\n8\n\u010f\nA (cid:16) (cid:4) A ,\nn\nn(cid:16)1\n218 B. PROBABILITY\nwhere A is the event that the ruin happens exactly at the nth round. Notice that A is\nn n\nmade of all outcomes such that (1) the nth round is a lost round, (2) in the first n(cid:1)1st\nrounds there are x(cid:1)1 lost rounds more than the number of wins. Therefore, if m is the\nnumber of won rounds in the n(cid:1)1st rounds, we must have 2m(cid:0)x(cid:1)1 (cid:16) n(cid:1)1, or m (cid:16) n(cid:1)x.\n2\nAs a result, A is a nonempty event if and only if n(cid:1)x is an even number. Therefore, one\nn\ncan write\n8\n\u010f\nA (cid:16) (cid:4) A .\nx(cid:0)2m\nm(cid:16)1\nExercise B.11. Recall the sample space given by (B.1) for a random walk. Show that in\nExample B.23 the event of ruin is uncountable.\nMany complicated sets can be found in the Borel \u03c3-field. For more discussion of Borel\nsets, see [3, Chapter 7]. However, in most cases, it is enough to work with the elementary\nevents that build the \u03c3-field.\nProbability via measure theory\nGiven a \u03c3-field of events, we can define a probability measure in the most general form.\nDefinition B.4. A measure space is a p\u2126,Fq such that \u2126 is a sample space and F is a\n\u03c3-field on \u2126. A measure on a measure space p\u2126,Fq is a function from P : F (cid:209) RYt8u\nsuch that for any sequence tA u8 \u010e F of disjoint events,\nn n(cid:16)0\n(cid:3) (cid:11)\n8 8\n\u010f \u201a\nP A (cid:16) PpA q.\nn n\nn(cid:16)0 n(cid:16)0\nA probability measure is a measure with the following properties.\na) For any A P F then PpAq \u011b 0.\nb) Pp\u2126q (cid:16) 1.\nNotice that the above definition leads to many important properties of the probability:\na) PpAAq(cid:0)PpAq (cid:16) PpAAYAq (cid:16) Pp\u2126q (cid:16) 1. Therefore, PpAAq (cid:16) 1(cid:1)PpAq.\nb) PpHq (cid:16) 1(cid:1)Pp\u2126q (cid:16) 0.\nc) Continuity of probability. For any shrinking sequence of events A \u011a A \u011a (cid:4)(cid:4)(cid:4),\n1 2\nwe have\n(cid:3) (cid:11)\n8\n\u010d\nlim PpA q (cid:16) A\nn n\nn(cid:209)8\nn(cid:16)0\nExercise B.12. Show (c) in the above.\n219 B. PROBABILITY\nTriple p\u2126,F,Pq is called a probability space. To define any other measure P on a mea-\nsurable space p\u2126,Fq, it is sufficient to define it on the elementary sets that generate the\n\u03c3-field F. For example, to define a uniform probability measure on r0,1s on the Borel\n\u03c3-field Bpr0,1sq, one only needs to define\nPppa,bqq (cid:16) b(cid:1)a, for pa,bq P r0,1s.\nSince probability of singleton is zero, we have\nPpr0,bqq (cid:16) Ppt0uq(cid:0)Ppp0,bqq (cid:16) 0(cid:0)b.\nSimilarly, Pppa,1sq (cid:16) 1(cid:1)a.\nHere is a more complicated example. The random variable in this example is not discrete\nor continuous.\nExample B.24. We choose a random number in r0,1s in the following way. We flip a fair\ncoin. If the coin lands heads, we choose a number uniformly in r0,1s. If the coin lands tails,\n?\nwe choose 2{2. We define the corresponding probability measure on Bpr0,1sq by defining\nit only on the elementary events:\n# ?\n1pb(cid:1)aq if 2{2 R pa,bq P r0,1s\nPppa,bqq (cid:16) 2 ? .\n1pb(cid:1)aq(cid:0) 1 if 2{2 P pa,bq P r0,1s\n2 2\nNotice that although the above probability is only defined on open intervals, one can find\n? ? ?\nprobability of other events. For instance, Ppt 2{2uq (cid:16) lim (cid:0) 2{2(cid:1) 1, 2{2(cid:0) 1(cid:8) (cid:16)\nn(cid:209)8 n n\n2 (cid:0) 1 (cid:16) 1.\nn 2 2\nExample B.25. In this example, we follow up on the probability of ruin in Example B.23.\nRecall that the event of ruin is represented as the union of disjoint events:\n8\n\u010f\nA (cid:16) (cid:4) A .\nx(cid:0)2m\nm(cid:16)0\nTherefore, by the definition of probability\n8\n\u201a\nPpAq (cid:16) PpA q.\nx(cid:0)2m\nm(cid:16)0\nIf the chance of winning any round is p, then\n(cid:2) (cid:10)\nx(cid:0)2m(cid:1)1\nPpA q (cid:16) pmp1(cid:1)pqx(cid:0)m.\nx(cid:0)2m\nm\n220 B. PROBABILITY\nTherefore,\n\u201a8 (cid:2) x(cid:0)2m(cid:1)1(cid:10)\nPpAq (cid:16) pmp1(cid:1)pqx(cid:0)m.\nm\nm(cid:16)0\nThe above probability is not easy to calculate in this series form, and it is easier to find it\nby using a conditioning technique.\nExample B.26. In an infinite sequence of coin flips, we consider \u2126 to be the set of all\nsequences p\u03c9 ,\u03c9 ,(cid:4)(cid:4)(cid:4)q such that \u03c9 (cid:16) H or T for n \u011b 1. A \u03c3-field can be defined by\n1 2 i\nspecifying some elementary events. For a finite sequence n ,...n of positive integers, an\n1 m\nelementary event E is defined to be the set of all p\u03c9 ,\u03c9 ,(cid:4)(cid:4)(cid:4)q such that \u03c9 (cid:16) H\nn1,...nm 1 2 nj\nfor j (cid:16) 1,...,m. Then, on the \u03c3-field generated by a fair coin, we have the corresponding\nprobability measure given by PpE q (cid:16) (cid:0) 1(cid:8)m . For an unfair coin with the probability\nn1,...nm 2\nof heads given by p, we have a different probability measure QpE q (cid:16) pm. Based on\nn1,...nm\nthe assignment of probability , we can determine the probability of all events in the \u03c3-field\ngenerated by the elementary events. For instance, let E be the event that the nth flip\nm,(cid:1)n\nis heads and the mth flip is tails. Then,\nE (cid:16) E YE .\nm m,n m,(cid:1)n\nNotice that E and E are disjoint events. Thus, PpE q (cid:16) 1 (cid:1) 1 (cid:16) 1. For an\nm,n m,(cid:1)n m,n1 2 4 4\nunfair coin, we have QpE q (cid:16) p(cid:1)p2 (cid:16) pp1(cid:1)pq. Recalling the notion of independence\nm,n1\nfrom (B.3), one can see that for n(cid:24)m, E and E are independent events, under both\nn m\nmeasures P and Q. More precisely, since E XE (cid:16) E , we have\nn m m,n\n1\nPpE q (cid:16) (cid:16) PpE qPpE q and QpE q (cid:16) p2 (cid:16) QpE qQpE q.\nm,n m n m,n m n\n4\nGenerally speaking, E X(cid:4)(cid:4)(cid:4)XE (cid:16) E , and therefore the \u03c3-field generated by the\nn1 nm n1,...,nm\nsequence tE : n \u011b 1u is the same as the \u03c3-field generated by the elementary sets of the\nn\nform E .\nn1,...,nm\nRecall that mapping\n\u201a8 a\nn\n\u03c9 (cid:16) p\u03c9 ,\u03c9 ,(cid:4)(cid:4)(cid:4)q (cid:222)(cid:209)\n1 2 2n\nn(cid:16)1\nwith a (cid:16) 1 when \u03c9 (cid:16) H and a (cid:16) 0 when \u03c9 (cid:16) T maps \u2126 to r0,1s. Under this mapping,\nn n n n\nthe elementary event E is mapped to\nn\n2 \u010fn(cid:1)1 (cid:17)2i(cid:0)1 2i(cid:0)2(cid:9)\n, .\n2n 2n\ni(cid:16)0\nAlthough tedious, one can find the exact intervals that make the image of E under\nn1,...nm\nthis mapping and then use it to verify that the \u03c3-field generated by these events is exactly\n221 B. PROBABILITY\nthe Borel \u03c3-field Bpr0,1sq. The following theorem is a helpful tool in that regard.\n(cid:17) (cid:9)\nExercise B.13. Show that any interval of the form k1, k2 with 0 \u010f k \u0103 k \u010f 2n can\n2n 2n 1 2\nbe written by a combination of a finite union, intersection and complement of the sets that\nare image of the elementary events of the form E under the mapping described in Example\nn\nB.26. Use this to show that the \u03c3-field generated by the elementary events of the form E\nn\ncorrespond to the Borel \u03c3-field Bpr0,1sq.\nGiven a probability measure P, the events that have a probability of 0 under P are called\nnull events. For instance, in choosing a point uniformly in r0,1q, the probability of any\nsingle point is 0; therefore, the singleton txu is a null event. In Example B.24, the only\n?\n\u2423 2(\nsingleton that is not a null event is . The set of all rational numbers is a null event in\n2\nboth cases. In Example B.26, one can show that an event of a particular pattern appearing\nperiodically along a sequence of coin flips is a null event. For instance, the event of the\npattern THH appearing periodically along a sequence of coin flips is a null event.\nExercise B.14. Show that the event of all outcomes that have the pattern THH (or any\nother particular pattern) appearing periodically along a sequence of coin flips is a null event.\nUse the same idea to extend the result: the event of all outcomes that have a periodic pattern\nis a null event. (Hint: the set of all patterns is a countable set.)\nRandom variables\nIn this section, we explain the definition of a random variable. Random variables represent\nrandom quantities that are related to a random experiment. For example, in Example\nB.13, the value W of a random walk at time n is a random variable.\nn\nDefinition B.5. A random variable on a measure space p\u2126,Fq is a function X : \u2126 (cid:209) Rd\nsuch that for any Borel set A P BpRdq, the inverse image of A under X, X(cid:1)1pAq, belongs\nto the set of events F.\nIn the sequel, we denote the inverse image of A under X, X(cid:1)1pAq, by tX P Au. Since\nBpRdq is generated by open sets in Rd, the condition \u201c@A P BpRdq, tX P Au P F\u201d in\nDefinition B.5 needs to hold only for all open sets instead of all Borel sets; A P BpRdq\nfor all open sets A \u010e Rd. If \u2126 (cid:16) Rd and F (cid:16) BpRdq, a random variable is called a\nBorel-measurable function.\nIn practice, important random quantities are described by random variables. See the\nexample below.\nExample B.27. In an infinite sequence of coin flips, Example B.26, we define the random\nvariable X as follows. For \u03c9 (cid:16) p\u03c9 ,\u03c9 ,(cid:4)(cid:4)(cid:4)q P \u2126\n1 2\n\u201a8 a\nn\nXp\u03c9q (cid:16)\n3n\nn(cid:16)1\n222 B. PROBABILITY\nsuch that a (cid:16) 0 if \u03c9 (cid:16) H, and a (cid:16) 2 if \u03c9 (cid:16) T. Here, \u01598 an (cid:16) 0.a a (cid:4)(cid:4)(cid:4) is the\nn n n n n(cid:16)1 3n 1 2\nternary representation of a number in r0,1s. X maps \u2126 to r0,1s. To check if X is a random\nvariable, we need to check that the inverse of an open interval is in the \u03c3-field generated by\nthe elementary sets A described in Example B.26. We leave this task to the following\nn1,...nm\nexercise.\nRemark B.5. The image of X in Example B.27 is called a Cantor set.\nExercise B.15. Show that the mapping X defined in Example B.27 is a random variable.\nHint: Assume a ternary representation for the endpoints of the interval pa,bq.\nLet X be a random variable. The \u03c3-field generated by X is the smallest \u03c3-field that\ncontains all events tX P Au for all Borel sets A, and is denoted by \u03c3pXq. In other words,\nit is the \u03c3pXq that contains all events related to X. \u03c3pXq can equivalently be expressed\nas the smallest \u03c3-field that contains all events tX P Au for all open sets A.\nIndependence\nIt is possible to define the notion of independence for two random variables X and Y by\nusing the inverse images tX P Au and tY P Bu.\nDefinitionB.6. AsequenceofrandomvariablestX : n \u011b 1uarecalledindependentiffor\nn\nany sequence of Borel sets tA : n \u011b 1u \u010e BpRq, the sequenceof events tX(cid:1)1pA q : n \u011b 1u\nn n n\nare independent.\nIn particular, two random variables X and Y are called independent if for any two Borel\nsets A and B, tX P Au and tY P Bu are independent,\nPpX P A & Y P Bq (cid:16) PpX P AqPpY P Bq.\nThe following proposition can be used as an alternative definition of independence of two\nrandom variables.\nProposition B.3. Two random variables X and Y are independent if and only if for any\ntwo bounded Borel-measurable functions h pxq and h pyq we have\n1 2\nErh pXqh pYqs (cid:16) Erh pXqsErh pYqs. (B.7)\n1 2 1 2\nAs a consequence of the above proposition, if X and Y are independent, then for any two\nbounded Borel-measurable functions h pxq and h pyq, h pXq and h pYq are also indepen-\n1 2 1 2\ndent.\nExample B.28. In Example B.13, consider random variables W and W (cid:1) W with\nn m n\n(cid:0)\u0159n\nm \u0105 n. These random variables are independent. This is because, W (cid:16) W \u03be and\nn 0 i(cid:16)1 i\n\u0159m\nW (cid:1)W (cid:16) \u03be , and the vectors p\u03be ,...,\u03be q and p\u03be ,...,\u03be q are independent. As\nm n i(cid:16)n(cid:0)1 i 1 n n(cid:0)1 m\n(cid:0)\u0159n \u0159m\na result h p\u03be ,...,\u03be q :(cid:16) W \u03be and h p\u03be ,...,\u03be q (cid:16) \u03be are independent.\n1 1 n 0 i(cid:16)1 i 2 n(cid:0)1 m i(cid:16)n(cid:0)1 i\n223 B. PROBABILITY\nOnecanasserttheindependenceofasequenceofrandomvariablesintermsofthesequence\nof \u03c3-fields generated by them.\nProposition B.4. A sequence of random variables tX : n \u011b 1u are independent if any\nn\nsequence of events tE : n \u011b 1u such that E P \u03c3pX q for all n \u0105 1 is an independent\nn n n\nsequence.\nIn particular, two random variables X and Y are independent if for any two events F P\n1\n\u03c3pXq and F P \u03c3pYq, F and F are independent,\n2 1 2\nPpF XF q (cid:16) PpF qPpF q.\n1 2 1 2\nThe above proposition gives rise to the notion of independent \u03c3-fields of events.\nDefinition B.7. A sequence of random variables \u03c3-fields tF : n \u011b 1u are called inde-\nn\npendent if any sequence of events tF : n \u011b 1u such that F P F is an independent\nn n n\nsequence.\nIn particular, two \u03c3-fields F and G are called independent if for any two events F P F\nand G P G, we have\nPpF XGq (cid:16) PpFqPpGq.\nExample B.29. In Example B.13, consider the \u03c3-field generated by the outcomes of the\neven rounds and the \u03c3-field generated by the outcomes of the odd rounds; denote them by\nF and G, respectively. Since, the outcomes of each round in independent others, F and G\nare independent \u03c3-fields.\nExpected value and integration\nBefore Andrey Kolmogorov used the concept of a measure to define probability, measures\nwere used to extend the notion of integration. Integration with respect to measures is also\nimportant in probability theory to define the expected value of random variables. Here,\nwe define the expected value of a random variable by the integral of that random variable\nwithrespecttoaprobabilitymeasureinthemostgeneralform,whichincludeduncountable\nsample spaces.\nIf a random variable X is defined on a probability space p\u2126,F,Pq, the expected value of\nX is defined as an integral of X with respect to measure P, denoted by\n\u017c\nErXs :(cid:16) XdP.\nThe definition of the integral is a little cumbersome. Thus, we only outline the steps.\nStep 1) For an indicator random variable X (cid:16) 1 where A is an event in F, we have\nA\n\u017c\nErXs :(cid:16) dP (cid:16) PpAq.\nA\n224 B. PROBABILITY\nStep 2) For step random variable X, a finite linear combination of indicator random\n\u0159N\nvariables X (cid:16) a 1 , we have\nj(cid:16)1 j Aj\nN\n\u201a\nErXs :(cid:16) a PpA q.\nj j\nj(cid:16)1\nStep 3) If the random variable X is nonnegative,X \u011b 0, then X can be approximated\nfrom below by an increasing sequence of step random variables; X (cid:210) X. Then,\nn\nErXs :(cid:16) supErX s.\nn\nn\nNotice that one can show that the value ErXs is independent of the choice of\nthe increasing sequence of step random variables and thus is well defined.\nStep 4) For a general random variable X, we decompose X into positive and negative\nparts; X (cid:16) X (cid:1)X with X (cid:16) max0,X and X (cid:16) max0,(cid:1)X. Then,\n(cid:0) (cid:1) (cid:0) (cid:1)\nErXs :(cid:16) ErX s(cid:1)ErX s.\n(cid:0) (cid:1)\nIn Step (4) in the above, the expected value ErXs is 8 when ErX s (cid:16) 8 and ErX s \u0103 8,\n(cid:0) (cid:1)\nand it is (cid:1)8 when ErX s \u0103 8 and ErX s (cid:16) 8. However, ErXs cannot be defined when\n(cid:0) (cid:1)\nwe have both ErX s (cid:16) 8 and ErX s (cid:16) 8. This motivates the following definition.\n(cid:0) (cid:1)\nDefinition B.8. A random variable is called integrable if Er|X|s (cid:16) ErX s(cid:0)ErX s \u0103 8.\n(cid:0) (cid:1)\nThe following example shows why we need to separate the positive part and the negative\npart of a random variable in Step 4 above.\nExample B.30. Consider the uniform probability measure on probability space given by\n\u2126 (cid:16) r(cid:1)1,1s2, the two dimensional square, and a random variable X given by Xpx,yq (cid:16)\nxy 11. The positive part of X is r0,1s2 Yr(cid:1)1,0s2. It is easy (by switching to polar\npx2(cid:0)y2q2\ncoordinates) to see that\n\u017c \u017c1\u017c1 \u017c0 \u017c0\nxy xy\nX dP (cid:16) dxdy(cid:0) dxdy (cid:16) 8,\n(cid:0) px2(cid:0)y2q2 px2(cid:0)y2q2\n0 0 (cid:1)1 (cid:1)1\nr0,1s2\nand therefore, X is not integrable. We conclude that ErXs does not exist. However, the\niterated integral below exists and is equal to zero, i.e.\n\u017c1 \u017c1\nXpx,yqdxdy (cid:16) 0.\n(cid:1)1 (cid:1)1\n11X is undefined at the single point p0,0q. But, the probability of a single point is 0. Therefore, we can\ndefine Xp0,0q by any value of choice; for example, Xp0,0q(cid:16)0.\n225 B. PROBABILITY\nTherefore, for random variable X, the iterated integral is not a well defined notion of\nexpectation.\nThere are three main convergence theorems for integrals with respect to a measure, which\nare very useful in the probability theory. We conclude this section by presenting them.\nTheorem B.3 (Monotone convergence theorem). Let tX u be a sequence of nonneg-\nn n\u011b1\native and increasing random variables. Then, X :(cid:16) lim X is a random variable and\nn(cid:209)8 n\nErXs (cid:16) lim ErX s.\nn(cid:209)8 n\nExample B.31. In Example B.27, we assume the coin is a fair coin. We shall find the\nexpected value of the introduced random variable by introducing the sequence of random\nvariables tX u8 defined by\nn n(cid:16)1\nn\n\u201a a j\nX p\u03c9q :(cid:16) ,\nn 3j\nj(cid:16)1\nsuch that a (cid:16) 0 if \u03c9 (cid:16) H, and a (cid:16) 2 if \u03c9 (cid:16) T. Notice that by the monotone convergence\nj j j j\ntheorem, lim ErX s (cid:16) ErXs. Observe that X (cid:16) X (cid:0)\u03be , where \u03be takes two values\nn(cid:209)8 n n n(cid:1)1 n n\n0 and 2 with equal probabilities 1. Therefore, ErX s (cid:16) ErX s(cid:0)Er\u03be s. Since Er\u03be s (cid:16) 1 ,\n3n 2 n n(cid:1)1 n n 3n\nwe have ErX s (cid:16) ErX s(cid:0) 1 . By solving ErX s (cid:16) ErX s(cid:0) 1 recursively, we obtain\nn n(cid:1)1 3n n n(cid:1)1 3n\nErX s (cid:16) \u0159n 1 . As n (cid:209) 8, if follows from the monotone convergence theorem that\nn j(cid:16)1 3j\nErXs (cid:16) \u01598 1 (cid:16) 1.\nj(cid:16)1 3j 2\nExercise B.16. Repeat the calculation in Example B.31 for an unfair coin with a proba-\nbility p of heads.\nTheorem B.4 (Fatou\u2019s lemma). Let tX u be a nonnegative sequence of random vari-\nn n\u011b1\nables. Then, X (cid:16) liminf X is a random variable, and ErXs \u010f liminf ErX s.\nn(cid:209)8 n n(cid:209)8 n\nExample B.32. On the sample space \u2126 (cid:16) r0,1q equipped with uniform probability measure,\ndefine the sequence of random variables tY u8 by\nn n(cid:16)1\n#\n1 when for j (cid:16) 1,...,n, a (cid:16) 0 or 2\nj\nY p\u03c9q (cid:16) ,\nn\n0 otherwise\n\u01598 aj\nwhere \u03c9 (cid:16) is the ternary expansion of \u03c9 P \u2126. Define\nj(cid:16)1 3n\nYp\u03c9q :(cid:16) lim Y p\u03c9q.\nn\nn(cid:209)8\nIt is straightforward to see that\n#\n1 when a (cid:16) 0 or 2 for all j \u011b 1\nj\nYp\u03c9q (cid:16) .\n0 otherwise\n226 B. PROBABILITY\nIn other words, Y is the indicator random variable of the event that contains all numbers\nin r0,1q whose ternary representation has only digits 0 or 2. This event is the same as the\nCantor set in Remark B.5 and is denoted by C. Therefore, Y (cid:16) 1 and ErYs (cid:16) PpCq. To\nC\nfind the PpCq, we use Fatou\u2019s lemma, Theorem B.4, and write\nErYs (cid:16) PpCq \u010f liminfErY s.\nn\nn(cid:209)8\nNext, we will show that liminf ErY s (cid:16) 0. To see this, first observe that Y is also\nn(cid:209)8 n n\nan indicator random variable. For example for n (cid:16) 1, Y (cid:16) 1 and Y (cid:16)\n1 r0,1{3qYr2{3,1q 2\n1 , and so on. Generally speaking,\nr0,1{9qYr2{9,1{3qYr2{3,7{9qYr8{9,1q\nY (cid:16) 1 ,\nn An\nwhere A is the union of 2n intervals each of size 1 . Therefore, under uniform probability,\nn 3n\n2n\nErY s (cid:16) PpA q (cid:16) (cid:209) 0, as n (cid:209) 8.\nn n 3n\nThis means that the Cantor set has a probability of 0 under uniform probability.\nTheorem B.5 (Lebesgue convergence theorem). Let tX u be a convergent sequence of\nn n\u011b1\nrandom variables and \u03be be an integrable random variable such that |X | \u010f |\u03be| for all n \u011b 1.\nn\nThen, X :(cid:16) lim X is a random variable, and ErXs (cid:16) lim ErX s.\nn(cid:209)8 n n(cid:209)8 n\nRemark B.6. In Example B.32, we could use Lebesgue convergence theorem, Therem\nB.5, to show that ErYs (cid:16) 0. This is because all random variables Y are indicators, and\nn\ntherefore, their absolute values are bounded by the constant random variable \u03be (cid:16) 1.\nEquality of random variables\nRecall the simple version of the law of large numbers in Theorem B.2. Here, we put the\nemphasis on the exception set, where the limit inside the theorem does not converge to 1.\n2\nOne possible outcome inside this set is given by X (cid:16) 0 for n (cid:17) 0 pmod 3q, and X (cid:16) 1\nn n\nfor n (cid:17) 1 or 2pmod 3q. Then, the limit on the left-hand side converges to 2, not 1. The\n3 2\nlaw of large numbers in Theorem B.2 asserts that the collection of all outcomes such that\nlim 1 \u0159N X exists and is equal to 1 is an event with a probability of 1. In other\nN(cid:209)8 N n(cid:16)1 n 2\nwords, the random variable lim 1 \u0159N X is defined to be the constant 1 except on\nN(cid:209)8 N n(cid:16)1 n 2\nan event with probability 0.\nDefinition B.9. Two random variables X and Y are considered equal if the event\nt\u03c9 P \u2126 : Xp\u03c9q(cid:24)Yp\u03c9qu\nhas a probability of zero. Then, we write X (cid:16) Y P almost surely; X (cid:16) Y P-a.s. for short;\nor just a.s. whenever the probability measure is assumed.\n227 B. PROBABILITY\nFor instance, Theorem B.2 indicates that the random variable on the left-hand side,\nlim 1 \u01598 X , is equal to the random variable on the right-hand side, 1, a.s. In\nN(cid:209)8 N n(cid:16)1 n 2\naddition, it also implies that the limit lim 1 \u01598 X exists a.s., which is not an\nN(cid:209)8 N n(cid:16)1 n\nobvious fact.\nAsaresultofthefollowingLemma, TheoremB.2showsthattherandomvariableXp\u03c9q (cid:16)\nlim \u0159N X (cid:1) 1 is zero a.s.: a very fancy representation for zero!\nN(cid:209)8 n(cid:16)1 n 2\nLemma B.1. For a nonnegative random variable X, ErXs (cid:16) 0 if and only if X (cid:16) 0 a.s.\nAs a consequence, we can define the convergence of a sequence of random variables.\nDefinition B.10. A sequence tX u8 of random variables is called convergent a.s. if the\nn n(cid:16)1\nevent\nt\u03c9 P \u2126 : lim X p\u03c9q does not existu\nn\nn(cid:209)8\nhas a probability of 0. Then, the limit random variable X :(cid:16) lim X exists a.s. and is\nn(cid:209)8 n\ncalled the limit of tX u8 .\nn n(cid:16)1\nLaw of a random variable\nIntheremainderofthissection,weshowhowtodefineexpectationforgeneralrandomvari-\nables by means of the distribution function, without appealing to the notion of integration\nwith respect to a measure.\nDefinition B.11. For a random variable X with real values, the cumulative distribution\nfunction (or cdf or simply \u201cdistribution function\u201d) F pxq is defined by\nX\nF pxq :(cid:16) PpX \u010f xq.\nX\nThe definition of a distribution function is related to the probability measure P by PpX P\npa,bsq (cid:16) F pbq(cid:1)F paq. In fact, the distribution function induces a probability measure\nX X\non R, denoted by P , which is defined on open intervals by\nX\nP ppa,bsq (cid:16) F pbq(cid:1)F paq.\nX X X\nrecall that to define a probability measure on BpRq, we only need to define it on the open\nintervals, or equivalently on the half-open intervals of the form pa,bs.\nExample B.33. Let X (cid:16) 1 . Then, F pxq (cid:16) 0 if x \u0103 1 and F pxq (cid:16) 1 if x \u011b 1; see\nA X X\nFigure B.4.\nExample B.34. In Example B.24, define a random variable that is equal to the value of\nthe picked random number. Then, the law of X is shown in Figure B.5.\n228 B. PROBABILITY\nF (x)\nX\n1\nP(A)\n1(cid:0)P(A)\nx\n1\nFigure B.4: The distribution function for an indicator.\nF (x)\nX\np\n1 + 2\n2 4\np\n2\n4\nx\np\n2 1\n2\nFigure B.5: The distribution function for the random number chosen in Example B.24.\nFor a discrete random, F is a step function. For nondiscrete random variables F pxq is\nX X\nnot a step function. The distribution function of random variable X in Example B.27 is\nillustrated in Figure B.612.\nIn general, the distribution function of a random variable X satisfies the following prop-\nerties.\n12Tobeprecise,thedistributionfunctionofrandomvariableX inExampleB.27isapproximatedbythe\ndistribution function of random variable X with a large n.\nn\n229 B. PROBABILITY\n1\n0.8\n0.6\n0.4\n0.2\n0\n0 0.2 0.4 0.6 0.8 1\nFigure B.6: Devil\u2019s Staircase: the distribution function of the random variable X in\nExample B.27.\na) F p(cid:1)8q (cid:16) 0 and F p8q (cid:16) 1.\nX X\nb) F is an increasing right-continuous function with a left-limit at all points.\nX\nExercise B.17. Show that PpX P ra,bsq (cid:16) F pbq (cid:1) F pa(cid:1)q, where F pa(cid:1)q is the left\nX X X\nlimit of F at a.\nX\nItisalsowellknownthatifafunctionF satisfiestheproperties(a)and(b)ofadistribution\nfunction, then there is always a random variable X in a proper sample space such that\nF (cid:16) F.\nX\nThe probability P is called the law of X. Notice that knowing F and knowing the law\nX X\nof X are equivalent, but they are not equivalent to knowing P. In fact, we shall see that in\nmany important calculations about random variables, we do not exactly need to know P;\nin most applications, the law of a random variable is all we need. Therefore, we will now\nintroduce expected value in terms of the law of the random variable.\nNotice that F is an increasing function, and therefore one can define the Riemann-\nX\nStieltjes integral with respect to F as an alternative to the more complicated notion of\nX\nintegration with respect to measure P. In this case, the integral with respect to measure\nP is also simplified to a Riemann-Stieltjes13 integral.\nX\nProposition B.5. For an integrable random variable X the expectation of X satisfies\n\u017c8\nErXs (cid:16) xdF pxq.\nX\n(cid:1)8\n13Read\u201cSteel-chess\u201d.\n230 B. PROBABILITY\nIn particular, for any function g,\n\u017c8\nErgpXqs (cid:16) gpxqF pdxq,\nX\n(cid:1)8\ngiven Er|gpXq|s \u0103 8.\nSimilarly, for a random vector X (cid:16) pX ,...,X q, the distribution function is defined by\n1 d\nF px ,...,x q :(cid:16) PpX \u010f x ,...,X \u010f x q.\nX 1 d 1 1 d d\nThe law of X is a probability measure P on Rd such that\nX\nP pp(cid:1)8,x s(cid:2)(cid:4)(cid:4)(cid:4)(cid:2)p(cid:1)8,x sq (cid:16) F px ,...,x q.\nX 1 d X 1 d\nThen, the expectation of gpX ,...,X q is given by\n1 d\n\u017c8 \u017c8\nErgpX ,...,X qs (cid:16) (cid:4)(cid:4)(cid:4) gpx ,...,x qF pdx ,...,dx q,\n1 d 1 d X 1 d\n(cid:1)8 (cid:1)8\ngiven Er|gpX ,...,X q|s \u0103 8.\n1 d\nExercise B.18. If tX u8 is a sequence of independent Bernoulli random variables with\ni i(cid:16)1\nequally likely values 0 and 1, show that U (cid:16) \u01598 Xi is uniformly distributed on r0,1s.\ni(cid:16)1 2i\nConditional expectation\nConditional expectation cannot simply be defined in terms of the distribution function;\nmore advanced methods are needed. Unlike discrete probability setting, (B.6) in Section B,\nwe need to define ErX | Ys in general form by using a powerful tool in analysis, namely the\nRadon-Nikodym theorem. To give you a glimpse of the definition, we recall from Remark\nB.3 in the discrete setting that ErX | Y (cid:16) ys is a function of the variable y, denoted\nby hpyq. Then, we use this function to define ErX | Ys by hpYq. Similarly, we try to\nfind ErX | Ys among the random variables of the form hpYq for some (Borel measurable)\nfunction h : R (cid:209) R.\nDefinition B.12 (Conditional expectation). Let X be an integrable random variable.\nErX | Ys is the unique random variable of the form hpYq, where h : R (cid:209) R is a Borel\nmeasurable function that satisfies\nErhpYqgpYqs (cid:16) ErXgpYqs, (B.8)\nfor all bounded real functions g with the domain containing the set of values of Y.\n231 B. PROBABILITY\nThe Radon-Nikodym theorem from measure theory guarantees the existence and the\nuniqueness of an integrable random variable ErX | Ys in the a.s. sense. Given Defini-\ntion B.12 for conditional expectation, all the results of Corollary B.2, Proposition B.1, and\nProposition B.3 hold for general random variables.\nCorollary B.4. Let X and Y be random variables and f be a real function, such that\nfpYqX is integrable. Then,\nErfpYqX | Ys (cid:16) fpYqErX | Ys a.s..\nWe only provide a proof for the above corollary and leave the rest of the result of this\nsection to the reader.\nProof. Byuniquenessofconditionalexpectation,itissufficienttoshowthatbothErfpYqX |\nYs and fpYqErX | Ys satisfy the Definition B.12. In other words, for any bounded real\nfunctions g with the domain containing the set of values of Y, we have\nErhpYqgpYqs (cid:16) ErXgpYqs,\nwith hpYq (cid:16) ErfpYqX | Ys or hpYq (cid:16) fpYqErX | Ys. Without lack of generality, we as-\nsume that f is a bounded function. Then, fpYqgpYq is also a bounded function. Therefore,\nErErX | YsfpYqgpYqs (cid:16) ErXfpYqgpYqs.\nOn the other hand,\nErErfpYqX | YsgpYqs (cid:16) ErXfpYqgpYqs.\nTherefore, the uniqueness of conditional expectation implies the desired result.\nProposition B.6. X and Y are independent if and only if for any real function fpx,yq\nof X and Y, we have\nErfpX,Yq | Y (cid:16) ys (cid:16) ErfpX,yqs for all y in the set of values of Y,\nprovided that both fpX,Yq and fpX,yq are integrable for all y in the set of values of Y.\nCorollary B.5. Two random variables X and Y are independent if and only if for any a\nreal function f such that fpXq is integrable, we have\nErfpXq | Ys (cid:16) ErfpXqs a.s..\nProposition B.7 (Tower property of conditional expectation). Let X, Y, and Z be inte-\ngrable random variables. Then,\nErErX | Y,Zs | Ys (cid:16) ErX | Ys a.s..\n232 B. PROBABILITY\nIn particular,\nErErX | Yss (cid:16) ErXs.\nRemark B.7. The two following comments often help in finding conditional expectation\nin general form.\n1) One can verify (B.12) over a smaller set of functions to guarantee ErX | Ys (cid:16) hpYq.\nFor instance, if for any bounded function g we have ErhpYqgpYqs (cid:16) ErXgpYqs, then\nErX | Ys (cid:16) hpYq holds true. Equivalently, if for any Borel set (or open set) A we\nhave ErhpYq1 s (cid:16) ErX1 s, then ErX | Ys (cid:16) hpYq.\nYPA YPA\n2) If for a constant a, A (cid:16) tY (cid:16) au is an event with positive probability, then ErX |\na\nY (cid:16) as (cid:16) hpaq and is also constant. Then, one can find constant hpaq by using\nErhpYq1 s (cid:16) ErX1 s in the following.\nYPAa YPAa\nErX1 s\nErhpYq1 s (cid:16) hpaqPpY (cid:16) aq (cid:16) ErX1 s \u00f8\u00e6 hpaq (cid:16) tYPAau .\ntYPAau tYPAau PpY (cid:16) aq\nThis means that the conditional expectation ErX | Ys on the event {Y=a} is constant\nand is equal to the average of X over the event tY (cid:16) au.\nExercise B.19. Use Remark B.7-(1) to show Corollary B.4, Proposition B.6 and Propo-\nsition B.5.\nRecall that X be a random variable. The \u03c3-field generated by X is the smallest \u03c3-field\nthat contains all events tX P Au for all Borel sets A, and is denoted by \u03c3pXq. In other\nwords, it is the \u03c3pXq that contains all events related to X. \u03c3pXq can equivalently be\nexpressed as the smallest \u03c3-field that contains all events tX P Au for all open sets A. We\nsay that a random variable Z is \u03c3pXq-measurable, or measurable with respect to \u03c3pXq, if\nforanyBorelsetA, theeventtZ P Auisin\u03c3pXq. ItisknownthatifZ is\u03c3pXq-measurable,\nthen there exists a Borel function h : R (cid:209) R such that Z (cid:16) hpXq. In particular, since\nErX | Ys is \u03c3pYq-measurable, ErX | Ys (cid:16) hpYq.\nMore generally, for a \u03c3-field G \u010e F, we say that a random variable Z is G-measurable,\nor measurable with respect to G, if for any Borel set A, the event tZ P Au is in G. One\ncan define ErX | Gs, the conditional expectation of X given the events in G, in a similar\nfashionasDefinitionB.12,forwhichexistenceanduniquenessareguaranteedbytheRadon-\nNykodim theorem.\nDefinition B.13 (Conditional expectation with respect to \u03c3-field). Let X be an integrable\nrandom variable and G be a sub \u03c3-field of F. ErX | Gs is the unique random variable Z\nthat satisfies\nErZYs (cid:16) ErXYs, (B.9)\nfor all G-measurable random variables Y such that XY is integrable.\n233 B. PROBABILITY\nRemark B.7 holds also for (B.13): one only needs to verify ErZ1 s (cid:16) ErX1 s, for all\nG G\nG P G, to show that Z (cid:16) ErX | Gs. If G is generated by a set of elementary events E, then\none only needs to verify that ErZ1 s (cid:16) ErX1 s for all E P E. In addition, let A is an event\nE E\nin G such that PpAq \u0105 0 and for any events B P G such that B \u010e A, we have PpBq (cid:16) PpAq\nor PpBq (cid:16) 0. Then, we have\nErX1 s\nErX | Gs (cid:16) tYPAu on A.\nPpAq\nExample B.35. Consider the probability space pp0,1q,Bpp0,1qqq,Pq where P is uniform\nprobability measure, and let G be the \u03c3-field generated by the intervals pi, i(cid:0)1q, for i (cid:16)\n4 4\n0,1,2,3. Define the random variable X : \u03c9 P p0,1q (cid:222)(cid:209) R to be Xp\u03c9q (cid:16) 1 (cid:1)1 (cid:1)\np1{3,2{3q p0,1{3q\n1 . We would like to find ErX|Gs. The key observation here is that the \u03c3-field G\np2{3,1q\ncan be generated by a random variable that takes a constant value in interval pi, i(cid:0)1q, for\n4 4\ni (cid:16) 0,1,2,3. For instance, one can choose (among all other valid choices)\n3\n\u201a\nY (cid:16) i1\npi,i(cid:0)1q\n4 4\ni(cid:16)0\nand ErX|Gs (cid:16) ErX|Ys. Therefore, since Y is constant in each interval pi, i(cid:0)1q, so is\n4 4\nErX|Gs, and we can write\n3\n\u201a\nErX|Gs (cid:16) a 1 .\ni pi,i(cid:0)1q\n4 4\ni(cid:16)0\nIn Definition B.13, one can take Y (cid:16) 1 to obtain\npi,i(cid:0)1q\n4 4\n$\n\u2019(cid:1)1 i (cid:16) 0\n\u2019 \u2019 4\n\u017c i(cid:0) 41 \u2019 & 11 i (cid:16) 1\na Er1 s (cid:16) ErX1 s (cid:16) Xp\u03c9qd\u03c9 (cid:16) 2\ni p 4i,i(cid:0) 41q p 4i,i(cid:0) 41q i \u2019 1 i (cid:16) 2\n4 \u2019 \u201912\n\u2019 %(cid:1)1 i (cid:16) 3\n4\nTherefore,\n$\n\u2019(cid:1)1 i (cid:16) 0\n\u2019\n\u2019\n\u2019 &1 i (cid:16) 1\na (cid:16) 3 ,\ni \u20191 i (cid:16) 2\n\u2019 \u20193\n\u2019\n%(cid:1)1 i (cid:16) 3\nand\n1 1\nErX|Gs (cid:16) (cid:1)1 (cid:0) 1 (cid:0) 1 (cid:1)1 .\np0, 41q 3 p1 4,1 2q 3 p1 2, 43q p3 4,1q\nTheconditionalexpectationErX | Gscanbeunderstoodbyusingtheconceptofregression.\n234 B. PROBABILITY\nX\nW\nE[XjG]\nFigure B.7: Geometricinterpretationofconditionalexpectationwithrespecttoa \u03c3-field.\nConsider the vector space of square integrable random variables; V (cid:16) t\u03be : Er\u03be2s \u0103 8u\nand a linear subspace W of V including all G-measurable random variables. Then, for a\nrandom variable X P V, the conditional expectation Z :(cid:16) ErX|Gs is the closest point in\nW to X; ErX|Gs minimizes\nEr|X (cid:1)Y|2s\nover all Y P W ( G-measurable square-integrable random variables). See Figure B.7.\nRemark B.8. Any \u03c3pYq-measurable random variable Y\u02c6 can be written as hpYq such that\nh : R (cid:209) R is a Borel function. Therefore, we have ErX | Ys by ErX | \u03c3pYqs.\nHaving the conditional expectation defined, one can expand the notion of independence\nto a general case. One can show, as in Proposition B.9, that two random variables X\nand Y are independent if and only if ErgpXq | \u03c3pYqs (cid:16) ErgpXqs for any Borel function g\n(or, equivalently, ErhpYq | \u03c3pXqs (cid:16) ErhpYqs for any Borel function h), provided that the\nexpectations exist.\nNow, one can define the independence between two \u03c3-fields: two \u03c3-fields G and H are\nindependent if for any G-measurable random variable Z, ErZ|Hs (cid:16) ErZs (or, equivalently,\nfor any H-measurable random variable Z, ErZ|Gs (cid:16) ErZs). Given Definition B.13 for\nconditional expectation, all the results of Corollary B.4, Proposition B.5 and Proposition\nB.7 hold for general random variables.\nCorollary B.6. Let X and Y be random variables. Then, provided that Y is G-measurable,\nwe have\nErYX | Gs (cid:16) YErX | Gs a.s.,\ngiven that X and XY are integrable.\nProposition B.8 (Tower property of conditional expectation). Let X be an integrable\nrandom variable and F and G be two \u03c3-fields such that G \u010e F. Then,\nErErX | Fs | Gs (cid:16) ErX | Gs a.s.\n235 B. PROBABILITY\nIn particular,\nErErX | Fss (cid:16) ErXs.\nProposition B.9. X is independent of all G-measurable random variables if and only if\nfor any bounded real function f such that fpXq is integrable, we have\nErfpXq | Gs (cid:16) ErfpXqs a.s.\nIn particular, X is independent of Y if and only if ErfpXq | \u03c3pYqs (cid:16) ErfpXqs.\nCorollary B.7. Consider a probability space p\u2126,F,Pq that hosts an integrable random\nvariable X, and let G be a \u03c3-field such that G \u010e F. Then, for any convex function f, we\nhave\nfpErX | Gsq \u010f ErfpXq | Gs,\nprovided that fpXq is integrable.\nThe proof of this corollary is exactly the same line of argument as in Corollary B.1.\nContinuous random variables\nIn this section, we review the basic concepts of continuous random variables without refer-\nring to measurability issues.\nDefinition B.14. A random variable X is called continuous if there exits a nonnegative\nmeasurable function f : Rd (cid:209) R such that\nX\n\u017cx1 \u017cx\nd\nF pxq :(cid:16) (cid:4)(cid:4)(cid:4) f pyqdy.\nX X\n(cid:1)8 (cid:1)8\nInthiscase, thefunctionf iscalledtheprobabilitydensityfunction(pdf)ofthecontinuous\nX\nrandom variable X.\nWorking with continuous random variables is often computationally convenient; one can\naccurately approximate the integrals to estimate relevant quantities such as probability of\ncertain events and expected value of certain random variables. For example, when X is a\nunivariate continuous random variable with pdf f , the expected value of X is given by\nX\n\u017c8\nErXs (cid:16) xf pxqdx.\nX\n(cid:1)8\nMore generally, for a function h : R (cid:209) R, we have\n\u017c8\nErhpXqs (cid:16) hpxqf pxqdx.\nX\n(cid:1)8\n236 B. PROBABILITY\nIf I \u010e R, then\n\u017c\nPpX P Iq (cid:16) f pxqdx.\nX\nI\nExample B.36 (Normal distribution). A continuous random variable X with density\nf Xpxq (cid:16) ?1 e(cid:1)x 22 for all x P R\n2\u03c0\nis called a standard Gaussian random variable. By using integration techniques, one can\nsee that ErXs (cid:16) 0 and varpXq :(cid:16) ErX2s (cid:16) 1.\nIf Y (cid:16) \u03c3X (cid:0)\u00b5 for \u03c3 \u0105 0 and \u00b5 P R, then Y is also a continuous random variable with\ndensity\nf Ypxq (cid:16) ?1 e(cid:1)px 2(cid:1) \u03c3\u00b5 2q2 for all x P R.\n2\u03c0\u03c3\nThen, Y is called a normal random variable with mean \u00b5 and variance \u03c32 and is denoted\nby Y (cid:18) Np\u00b5,\u03c32q.\nExercise B.20. Show that when X (cid:18) Np0,1q, we have ErXs (cid:16) 0 and varpXq :(cid:16) ErX2s (cid:16)\n1.\nWhenX (cid:16) pX ,...,X qisajointly continuousrandomvector, werefertoitspdff asthe\n1 d X\njoint probability density function of X ,...,X to emphasize its multi-dimensionality. For\n1 d\nsimplicity, let\u2019s focus on two random variables. Let the joint pdf of pX,Yq be f px,yq.\nX,Y\nThen, it is easy to see that\na) The pdf of X, f , satisfies\nX\n\u017c8\nf pxq (cid:16) f px,yqdy.\nX X,Y\n(cid:1)8\nA similar formula holds for the pdf of Y.\nb) For a function h : R2 (cid:209) R, we have\n\u017c8 \u017c8\nErhpXqs (cid:16) hpx,yqf px,yqdxdy\nX,Y\n(cid:1)8 (cid:1)8\nc) If K \u010e R2, then\n\u0133\nPppX,Yq P Kq (cid:16) f px,yqdA.\nX,Y\nK\n237 B. PROBABILITY\nExample B.37 (Bivariate normal distribution). Let C be a symmetric positive-definite\nmatrix and \u00b5 (cid:16) p\u00b5 ,...,\u00b5 q P Rd. A jointly continuous random vector X (cid:16) pX ,...,X q\n1 d 1 d\nwith density\np2\u03c0det1 pCqqd{2e(cid:1)px(cid:1)\u00b5qC(cid:1) 21px(cid:1)\u00b5qT\nf Xpxq (cid:16) for all x P Rd\nis called a multi-variate normal random vector. For each j (cid:16) 1,...,d, ErX s (cid:16) \u00b5 . The ma-\nj j\ntrix C is called the covariance matrix of X, because its entities correspond to the covariance\nof components of X, i.e.,\nC (cid:16) ErpX (cid:1)\u00b5 qpX (cid:1)\u00b5 qs.\ni,j i i j j\nIn particular, for d (cid:16) 2, for a positive-definite matrix14\n(cid:18) \u0237\n\u03c32 \u03c3\nC (cid:16) 1 12\n\u03c3 \u03c32\n12 2\nand \u00b5 (cid:16) 0, we have\n(cid:1)\u03c322x2(cid:1)2\u03c312xy(cid:0)\u03c312y2\n1\nf X,Ypx,yq (cid:16) a e 2p\u03c3 12\u03c3 22(cid:1)\u03c3 12 2q for all x P R.\n2\u03c0 \u03c32\u03c32(cid:1)\u03c32\n1 2 12\nHere by evaluating double integrals, we can see that \u03c32 and \u03c32 are variances of X and Y,\n1 2\nrespectively, and that \u03c3 is the covariance of X and Y.\n12\nExercise B.21. In Example B.37, show that covpX,Yq :(cid:16) ErpX (cid:1)\u00b5 qpX (cid:1)\u00b5 qs (cid:16) C .\ni i j j i,j\nExercise B.22. In Example B.37, show that \u03c32 and \u03c32 are variance of X and Y respec-\n1 2\ntively, and \u03c3 is the covariance of X and Y.\n12\nDefining and calculating conditional probability and conditional expectation is also done\nthrough integral definition for continuous random variables. Let pX,Yq be a jointly con-\ntinuous random variable with density f px,yq. Then, the conditional density of X given\nX,Y\nY (cid:16) y is defined by\nf px,yq\nX,Y\nf px | yq :(cid:16) ,\nX|Y f pyq\nY\nprovided that y is in the set of values of Y, ty : fpyq (cid:24) 0u. Using the above definition, the\nconditional probability of X P I given Y (cid:16) y is given by\n\u015f\nf px,yqdx\nPpX P I | Y (cid:16) yq :(cid:16) I X,Y (B.10)\nfpyq\nSimilarly, if h : R (cid:209) R is a function, then the conditional expectation of hpXq given Y (cid:16) y\n14InorderforC tobepositive-definite,isnecessaryandsufficienttohave\u03c3 1,\u03c3 (cid:24)0,and\u03c3 12\u03c3 22(cid:1)\u03c3 12 \u01050.\n2 2\n238 B. PROBABILITY\nis given by\n\u015f8\nhpxqf px,yqdx\nErhpXq | Y (cid:16) ys :(cid:16) (cid:1)8 X,Y . (B.11)\nfpyq\nIn particular, the conditional expectation of X given Y (cid:16) y is given by\n\u015f8\nxf px,yqdx\nErX | Y (cid:16) ys :(cid:16) (cid:1)8 X,Y . (B.12)\nf pyq\nY\nNoticethatconditionalexpectationandconditionalprobabilityin(B.10),(B.11),and(B.12)\nare functions of the variable y. The domain of all these is the set of values of Y, i.e., ty :\nf pyq (cid:24) 0u. This,inparticular,canbeusefulindefiningconditional distribution andcondi-\nY\ntional probability given Y. Let\u2019sfirstmakethedefinitionforconditional probability of X P I\n\u015f\ngiven Y. Consider a function Y that maps y onto Ypyq :(cid:16) PpX P I | Y (cid:16) yq (cid:16) IfX,Ypx,yqdx .\nfYpyq\nThen, one can define\n\u015f\nf px,Yqdx\nPpX P I | Yq :(cid:16) YpYq (cid:16) I X,Y .\nf pYq\nY\nNotice that, unlike PpX P I | Y (cid:16) yq which is a real function, PpX P I | Yq is a random\nvariable that is completely dependent on random variable Y. Similarly, we have\n\u015f8 \u015f8\nhpxqf px,Yqdx xf px,Yqdx\nErhpXq | Ys :(cid:16) (cid:1)8 X,Y and ErX | Ys :(cid:16) (cid:1)8 X,Y .\nf pYq f pYq\nY Y\nFor continuous random variables independence can be defined in terms of the joint pdf\nfpx,yq; let X and Y be jointly continuous. Then, X and Y are called independent if f is\na separable function, i.e.\nf px,yq (cid:16) gpxqhpyq.\nX,Y\nNotice that the choice of h and g is not unique and varies by multiplying or dividing\nconstants. In this case, one can write the separation in a standard form\nf px,yq (cid:16) f pxqf pyq, (B.13)\nX,Y X Y\nwhere f pxq and f pyq are, respectively, the pdf of x and the pdf of Y.\nX Y\nExample B.38. From Example B.37 and (B.13), one can see that bivariate normal ran-\ndom variables are independent if and only if they are uncorrelated, i.e., they have zero\ncorrelation or simply \u03c3 (cid:16) 0.\n12\nExercise B.23. Show that (B.7) and (B.13) are equivalent.\n239 B. PROBABILITY\nB.3 Martingales\nThe conditional expectation defined in the previous section is required in the definition of\na martingale. Consider a probability space p\u2126,F,Pq, i.e., a sample space \u2126, a \u03c3-field F,\nand a probability measure P and let X :(cid:16) tX uT (possibly T (cid:16) 8) be a discrete-time\nt t(cid:16)0\nstochastic process. Here, a stochastic process is simply a sequence of random variables\nindexed by time; for any t (cid:16) 0,1,..., X is a random variable.\nt\nDefinitionB.15. Adiscrete-timestochasticprocesstM uT onaprobabilityspacep\u2126,F,Pq\nt t(cid:16)0\nis called a martingale with respect to X if\na) M is integrable for all t (cid:16) 0,...,T, Er|M |s \u0103 8.\nt t\nb) The conditional expectation M given X ,X ,...,X is equal to M ,\nt s s(cid:1)1 0 s\nErM |X ,X ,...,X s (cid:16) M , for s \u0103 t.\nt s s(cid:1)1 0 s\nCondition (a) in the definition of martingale is technical and guarantees the existence of\nthe conditional expectation in condition (b). Condition (b) in the definition of martingale\nimplies that M is a \u03c3pX ,...,X q-measurable random variable, for all s \u011b 0. This is\ns 0 s\nbecause the conditional expectation ErM |X ,X ,...,X s is a \u03c3pX ,...,X q-measurable\nt s s(cid:1)1 0 0 s\nrandom variable.\nCondition (b) can also be given equivalently by\nb1) ErM |X ,...,X s (cid:16) M , for t \u011b 1.\nt t(cid:1)1 0 t(cid:1)1\nNotice that, as a result of the tower property for conditional expectation, if (b1) holds, we\ncan write\nErErM |X ,...,X s|X ,...,X s (cid:16) ErM |X ,...,X s.\nt t(cid:1)1 0 s 0 t(cid:1)1 s 0\nBy applying the tower property inductively, we obtain\nErM |X ,...,X s (cid:16) ErM |X ,...,X s (cid:16) (cid:4)(cid:4)(cid:4) (cid:16) ErM |X ,...,X s (cid:16) M .\nt s 0 t(cid:1)1 s 0 s(cid:0)1 s 0 s\nExample B.39. Let Y be an arbitrary integrable random variable. Then, M :(cid:16) ErY |\nt\nX ,...,X s is a martingale with respect to X.\nt 0\nExample B.40 (Symmetricrandomwalk). The symmetric random walk in Definition B.2\nis a martingale. Since W (cid:1)W (cid:16) \u03be , we have\ni i(cid:1)1 i\nErW |W ,...,W s (cid:16) ErW (cid:0)\u03be |\u03be ,...,\u03be ,W s\nt(cid:0)1 t 0 t t(cid:0)1 t 1 0\n(cid:16) ErW |\u03be ,...,\u03be ,W s(cid:0)Er\u03be |\u03be ,...,\u03be ,W s.\nt t 1 0 t(cid:0)1 t 1 0\nErW |\u03be ,...,\u03be ,W s is simply ErW |W ,...,W s (cid:16) W . On the other hand, since t\u03be u8 is\nt t 1 0 t t 0 t n n(cid:16)1\nan independent sequence of random variables, it follows from Corollary B.3 that\nEr\u03be |\u03be ,...,\u03be ,W s (cid:16) Er\u03be s (cid:16) 0,\nt(cid:0)1 t 1 0 t(cid:0)1\n240 B. PROBABILITY\nand therefore, ErW |W ,...,W s (cid:16) W .\nt(cid:0)1 t 0 t\nExample B.41 (Multiperiod binomial model). Under the risk-neutral probability, the dis-\ncounted price of the asset, S\u02c6 :(cid:16) St is a martingale. Recall from Section II.2.3 that\nt p1(cid:0)Rqt\nS (cid:16) S H ,\nt t(cid:1)1 t\nwhere H is a sequence of i.i.d. random variables under the risk-neutral probability that is\ni\ngiven by\n1(cid:0)R(cid:1)\u2113 u(cid:1)1(cid:1)R\nP\u03c0pH (cid:16) uq (cid:16) and P\u03c0pH (cid:16) lq (cid:16) .\ni i\nu(cid:1)\u2113 u(cid:1)\u2113\nThus, H is independent of S (cid:16) S H (cid:4)(cid:4)(cid:4)H and\nt t(cid:1)1 0 t(cid:1)1 1\nErS |S ,...,S s (cid:16) ErS H |H ,...,H ,S s\nt t(cid:1)1 0 t(cid:1)1 t t(cid:1)1 1 0\n(cid:16) S ErH |H ,...,H ,S s (cid:16) S ErH s (cid:16) p1(cid:0)RqS .\nt(cid:1)1 t t(cid:1)1 1 0 t(cid:1)1 t t(cid:1)1\nIn the second equality above, we used Corollary B.2 and the third equality is the result of\nCorollary B.3.\nRemark B.9. As a result of tower property of conditional expectation, the expectation of\na martingale remain constant with time, i.e., ErM s (cid:16) ErM s.\nt 0\nExample B.42. Let tW u8 be a symmetric random walk from Example B.2 and define\nt t(cid:16)0\nM :(cid:16) W2 (cid:1)t. Then, W is a martingale with respect to t\u03be u8 . To see this, we need to\nt t t t t(cid:16)1\nshow\nErW2 (cid:1)pt(cid:0)1q|\u03be ,...,\u03be s (cid:16) W2(cid:1)t.\nt(cid:0)1 t 1 t\nRecall that W (cid:16) W (cid:0)\u03be . Thus,\nt(cid:0)1 t t(cid:0)1\nErW2 |\u03be ,...,\u03be s (cid:16) ErpW (cid:0)\u03be q2|\u03be ,...,\u03be s\nt(cid:0)1 t 0 t t(cid:0)1 t 1\n(cid:16) ErW2|\u03be ,...,\u03be s(cid:0)Er\u03be2 |\u03be ,...,\u03be s(cid:0)2ErW \u03be |\u03be ,...,\u03be s.\nt t 1 t(cid:0)1 t 1 t t(cid:0)1 t 1\nIt follows from Corollary B.2 that\nErW2|\u03be ,...,\u03be s (cid:16) W2\nt t 1 t\nErW \u03be |\u03be ,...,\u03be s (cid:16) W Er\u03be |\u03be ,...,\u03be s.\nt t(cid:0)1 t 1 t t(cid:0)1 t 1\nOn the other hand, by Corollary B.3, we have\nEr\u03be2 |\u03be ,...,\u03be s (cid:16) Er\u03be2 s (cid:16) 1\nt(cid:0)1 t 1 t(cid:0)1\nEr\u03be |\u03be ,...,\u03be s (cid:16) Er\u03be s (cid:16) 0\nt(cid:0)1 t 1 t(cid:0)1\nThus, ErX2 |\u03be ,...,\u03be s (cid:16) W2(cid:0)1, and therefore,\nt(cid:0)1 t 0 t\nErM |\u03be ,...,\u03be s (cid:16) W2(cid:0)1(cid:1)pt(cid:0)1q (cid:16) M .\nt(cid:0)1 t 1 t t\n241 B. PROBABILITY\nIn the definition of a martingale, Definition B.15, process X models the dynamics of the\ninformation as time passes. At time t, the occurrence or absence of all events related to\nX ,...,X are known. The conditional expectation ErM |X ,X ,...,X s should be read\nt 0 t s s(cid:1)1 0\nasexpectationofM giventheinformationgatheredfromtherealizationofprocessX until\nt\ntime s. It follows from Remark B.8 that if we denote FX :(cid:16) \u03c3pX ,...,X q, then part (b)\ns s 0\nin Definition B.15 of martingale can be written as\nErM |FXs (cid:16) M .\nt s s\nThis motivates the definition of a filtration.\nDefinition B.16. A filtration is a sequence of \u03c3-fields F :(cid:16) tF u8 such that F \u010e F for\ns s(cid:16)0 s t\nt \u011b s.\nFor example, if we set FX :(cid:16) \u03c3pX ,...,X q, then\ns s 0\nFX (cid:16) \u03c3pX ,X ,...,X q \u010e FX (cid:16) \u03c3pX ,...,X ,X ,...,X q.\ns s s(cid:1)1 0 t t s s(cid:1)1 0\nIn this case, we call FX the filtration generated by X. FX represents the accumulated\ninformation that are revealed by the process X as time passes.\nWe a filtration tF u8 is given, a stochastic process tY u8 is called adapted with respect\nt t(cid:16)0 t t(cid:16)0\nto the filtration if for all t, Y is an F -measurable random variables. For instance, in\nt t\nExample B.13, the random walk tW u8 is adapted with respect to tF\u03be u8 . Here, W is\nt t(cid:16)0 t t(cid:16)0 0\na constant and F\u03be (cid:16) \u03c3p\u03be ,...,\u03be q.\nt 1 t\nGiven Definition B.13 of conditional expectation with respect to a \u03c3-field, one can now\ndefine a martingale with respect to a given filtration without appealing to a process X.\nA probability space p\u2126,F,Pq equipped with a filtration F :(cid:16) tF u8 is called a filtered\ns s(cid:16)0\nprobability space.\nDefinition B.17. Consider a filtered probability space, i.e., p\u2126,F,F :(cid:16) tF u8 ,Pq. A\ns s(cid:16)0\ndiscrete-time stochastic process tM uT is called a martingale with respect to filtration F if\nt t(cid:16)0\na) The expected value of |M | is finite for all t (cid:16) 0,...,T, i.e., Er|M |s \u0103 8.\nt t\nb) The conditional expectation M given F is equal to M , ErM | F s (cid:16) M for s \u010f t.\nt s s t s s\nWe can equivalently present (b) as\nErM | F s (cid:16) M .\nt t(cid:1)1 t(cid:1)1\nBy applying the tower property in Proposition B.8 inductively, we obtain\nErErM | F s | F s (cid:16) (cid:4)(cid:4)(cid:4) (cid:16) ErM | F s (cid:16) M and ErM s (cid:16) M .\nt t(cid:1)1 s s(cid:0)1 s s t 0\n242 B. PROBABILITY\nSuper/submartingales\nMotivated by American option pricing and many other applications, we define a super-\nmartingale and a submartingales\nDefinition B.18. A discrete-time stochastic process tM uT on a filtered probability space\nt t(cid:16)0\np\u2126,F,Pq is called a supermartingale (or, respectively, a submartingale) with respect to a\nfiltration F if\na) M is integrable for all t (cid:16) 0,...,T, i.e., Er|M |s \u0103 8.\nt t\nb) ErM | F s \u010f M , for s \u0103 t (or, respectively, ErM | F s \u011b M , for s \u0103 t).\nt s s t s s\nM is a supermartingale if and only if (cid:1)M is a submartingale. So, we can only focus\nt t\nour study of supermartingales. A martingale is simultaneously a submartingale and a\nsupermartingale. The supermartingale property can equivalently be given by\nErM | F s \u010f M .\nt t(cid:1)1 t(cid:1)1\nExample B.43 (asymmetric random walk). An asymmetric random walk with Pp\u03be (cid:16)\nn\n1q (cid:16) p \u0103 1 is a strict supermartingale.\n2\nErW | \u03be ,...,\u03be s (cid:16) ErW (cid:0)\u03be | \u03be ,...,\u03be s\nt(cid:0)1 t 1 t t(cid:0)1 t 1\n(cid:16) ErW | \u03be ,...,\u03be s(cid:0)Er\u03be | \u03be ,...,\u03be s.\nt t 1 t(cid:0)1 t 1\nErW | \u03be ,...,\u03be s is simply W . On the other hand, since t\u03be u is an independent sequence\nt t 1 t i i(cid:16)1\nof random variables, it follows from Corollary B.3 that\nEr\u03be | \u03be ,...,\u03be s (cid:16) Er\u03be s (cid:16) 2p(cid:1)1 \u0103 0.\nt(cid:0)1 t 1 t(cid:0)1\nThus, ErW | \u03be ,...,\u03be s \u0103 W .\nt(cid:0)1 t 1 t\nThe following corollary shows how submartingales naturally show up from convex trans-\nformation of martingales.\nLemma B.2. Let tM u be a martingale with respect to filtration F and f be a convex\nt t\u011b0\nfunction, and define Y :(cid:16) fpM q. Then, tY u is a submartingale with respect to filtration\nt t t t\u011b0\nF if Er|fpM q|s \u0103 8 for all t \u011b 0.\nt\nProof. By corollary B.7, we know that\nErfpM q | F s \u011b fpErM | F sq (cid:16) fpM q.\nt s t s s\nIn the above, the equality comes from the martingale property of tMu8 .\nt(cid:16)0\n243 B. PROBABILITY\nIf tMu8 is a submartingale, we can still have a slightly weaker version of the above\nt(cid:16)0\ncorollary.\nLemma B.3. Let tM u be a submartingale with respect to filtration F and f be a convex\nt t\u011b0\nnondecreasing function such that Er|fpM q|s \u0103 8 for all t \u011b 0. Define Y :(cid:16) fpM q. Then,\nt t t\ntY u is a submartingale with respect to filtration F.\nt t\u011b0\nProof. By corollary B.7, we know that\nErfpM q | F s \u011b fpErM | F sq \u011b fpM q.\nt s t s s\nIn the above, the second inequality comes from the submartingale property of tMu8 , i.e.,\nt(cid:16)0\nErM | F s \u011b M and nondecreasingness property of f.\nt s s\nThe following corollaries are the result of Lemmas B.2 and B.3\nCorollary B.8. If M (cid:16) tM u is a martingale, then M (cid:16) tmaxt0,M uu , |M| :(cid:16)\nt t\u011b0 (cid:0) t t\u011b0\nt|M |u , and |M|p :(cid:16) t|M |pu for p \u0105 1 are submartingales; for the last one we need\nt t\u011b0 t t\u011b0\nthe assumption that Er|M |ps \u0103 8 for all t \u011b 0.\nt\nStopping time and optional sampling theorem\nDefinition B.19. A stopping time with respect to filtration tF u8 is a random variables\nt t(cid:16)0\n\u03c4 : \u2126 (cid:209) t0,1,...u such that for any t, the even t\u03c4 \u010f tu belongs to F .\nt\nA stopping time is a random time that does not anticipate the release of information that\nis defined by a filtration. For instance, recall that the filtration generated by the process\nX is given by tFXu8 , where FX (cid:16) \u03c3pX ,...,X q increases as time t passes. Then, the\nt t(cid:16)0 t 0 t\nevent that \u03c4 happened before or at t should belong to \u03c3pX ,...,X q to make tau a stopping\n0 t\ntime. Some examples of a stopping time are presented below.\ni) A deterministic time \u03c4 (cid:17) t is a stopping time. Then, the event tt \u010f tu is either \u2126\n0 0\nor H, if t \u010f t or t \u0105 t, respectively.\n0 0\nii) Let \u03c4 be the first time that a stochastic process tXu8 such as the price of an asset\na t(cid:16)0\nis greater than or equal to a. Then, the event t\u03c4 \u010f tu can also be represented by al\nthe outcomes such that X \u011b a for some u \u010f t. Therefore, it belongs to \u03c3pX ,...,X q.\nu 0 t\niii) Assume that tY u q be a stochastic process which is measurable with respect to\nt t\u011b0\n\u03c3pX ,...,X q. Let \u03c4 be the first time that a stochastic process tY u q enters the\n0 t t t\u011b0\ninterval pa,bq. Then, \u03c4 is a stopping time.\niv) If tY u q is predictable, i.e., measurable with respect to \u03c3pX ,...,X q, then the\nt t\u011b0 0 t(cid:1)1\nstopping time in (iii) is called a predictable stopping time. In other words, we know\nthat the event t\u03c4 \u010f tu is going to happen one period ahead of time t.\n244 B. PROBABILITY\nv) If Y is not measurable with respect to \u03c3pX ,...,X q; but it is measurable with re-\nt 0 t\nspect to \u03c3pX ,...,X q, then \u03c4 is not a stopping time. Because we know about the\n0 t(cid:0)1\noccurrence of t\u03c4 \u010f tu not any time sooner than t(cid:0)1.\nLemma B.4. If \u03c4 and \u03f1 are two stopping times with respect to a filtration tF u8 , then\nt t(cid:16)0\n\u03c4 _ \u03f1 :(cid:16) maxt\u03c4,\u03f1u, and \u03c4 ^ \u03f1 :(cid:16) mint\u03c4,\u03f1u are stopping times with respect to filtration\ntF u8 . In particular, for a deterministic time t , \u03c4 ^t is a stopping time bounded by t\nt t(cid:16)0 0 0 0\nwith respect to filtration tF u8 .\nt t(cid:16)0\nProof. We only present the proof for \u03c4_\u03f1 as the rest of the proof follows through a similar\nline of arguments. The event t\u03c4 _\u03f1 \u010f tu is equal to t\u03c4 \u010f tuXt\u03f1 \u010f tu. Since, we have\nt\u03c4 \u010f tu P F and t\u03f1 \u010f tu P F , t\u03c4 _\u03f1 \u010f tu (cid:16) t\u03c4 \u010f tuXt\u03f1 \u010f tu P F , and therefore, \u03c4 _\u03f1 is\nt t t\na stopping time with respect to a filtration tF u8 .\nt t(cid:16)0\nFor the simplicity, a stopping time with respect to a known filtration is called a stopping\ntime, whenever there is no confusion.\nDefinition B.20 (Stopped process). For a process tX u8 that is adapted to a filtration\nt t(cid:16)0\nand a stopping time \u03c4 with respect to the same filtration, the random variable X is defined\n\u03c4\nto be equal X on the event \u03c4 (cid:16) t.\nt\nExample B.44. Consider a random walk W, and let the stopping time \u03c4 be the first time\na\nthe random walk is greater than or equal to a. Since the random walk moves one step at\na time, \u03c4 is the first time the random walk hits a. One can see this as the first time the\na\nwealth of a gambler who bets only one dollar at each round becomes equal to a. Therefore,\nW (cid:16) a.\n\u03c4a\nLet tMu8 is a martingale and \u03c4 be a stopping time with respect to filtration F such that\nt(cid:16)0\n\u03c4 \u011b t for some deterministic time t , it is natural to ask whether ErM | F s (cid:16) M . In\n0 0 \u03c4 t0 t0\nparticular when t (cid:16) 0, we want to see whether ErM s (cid:16) M . The answer in general case\n0 \u03c4 0\nis no according to the next example.\nExample B.45. Recall the Saint Petersburg paradox in Example 2.2.4. Let \u03c4 be the first\ntime that the gambler wins a round, i.e.,\n\u03c4 :(cid:16) inftt : \u03be (cid:16) 1u.\nt\nNotice that the doubling strategy always generates exactly one dollar more than the initial\nwealth, i.e., W (cid:16) W (cid:0)1. Let t (cid:16) 0. If the game is fair, i.e., Pp\u03be (cid:16) 1q (cid:16) Pp\u03be (cid:16) (cid:1)1q (cid:16) 1,\n\u03c4 0 0 2\nthe random walk, and therefore, the doubling strategy make the wealth process a martingale.\nHowever, ErW s (cid:16) W (cid:0)1 \u0105 W .\n\u03c4 0 0\nUnder some additional condition, we may hope for ErM | F s and ErM s (cid:16) M to hold\n\u03c4 t0 \u03c4 0\ntrue. The following Theorem is providing a set of sufficient conditions.\n245 B. PROBABILITY\nTheorem B.6 (Optional sampling). Let \u03c4 be stopping time bounded by a deterministic\ntime T, i.e., \u03c4 \u010f T and tMu8 be a supermartingale. Then for any t \u010f T,\nt(cid:16)0\nErM | F s \u010f M .\n\u03c4 t \u03c4^t\nIn particular, ErM s \u010f M .\n\u03c4 0\nIt is obvious that for a martingale, the inequalities in the assertion of Theorem B.6 turns\nto equalities, i.e., ErM | F s (cid:16) M and ErM s \u010f M .\n\u03c4 t \u03c4^t \u03c4 0\nTo show Theorem B.6, we need the following lemma.\nLemma B.5. Let tMu8 be a supermartingale. Then, the stopped process\nt(cid:16)0\n#\nM \u03c4 \u0105 t\nt\nM (cid:16)\n\u03c4^t\nM \u03c4 \u010f t\n\u03c4\nis also a supermartingale.\nProof of Theorem B.6. Notice that because \u03c4 \u010f T, \u03c4 ^T (cid:16) \u03c4 and by Lemma B.5, one can\nwrite\nErM | F s (cid:16) ErM | F s (cid:16) M .\n\u03c4 t \u03c4^T t \u03c4^t\nProof of Lemma B.5. It suffices to show Er|M |s \u0103 8 and\n\u03c4^t\nErM | F s (cid:16) M .\n\u03c4^t t(cid:1)1 \u03c4^pt(cid:1)1q\nNotice that M (cid:16) M 1 (cid:0)M 1 . Therefore,\n\u03c4^t \u03c4 t\u03c4\u0103tu t t\u03c4\u011btu\nErM | F s (cid:16) ErM | 1 | F s(cid:0)ErM 1 | F s\n\u03c4^t t(cid:1)1 \u03c4 t\u03c4\u0103tu t(cid:1)1 t t\u03c4\u011btu t(cid:1)1\nSince t\u03c4 \u0103 tu (cid:16) t\u03c4 \u010f t(cid:1)1u P F and t\u03c4 \u011b tu (cid:16) t\u03c4 \u0103 tuA P F , we have\nt(cid:1)1 t(cid:1)1\nErM | F s (cid:16) ErM 1 | F s(cid:0)1 ErM | F s.\n\u03c4^t t(cid:1)1 \u03c4 t\u03c4\u0103tu t(cid:1)1 t\u03c4\u011btu t t(cid:1)1\nBy supermartingale property of tMu8 , we have ErM | F s \u010f M and\nt(cid:16)0 t t(cid:1)1 t(cid:1)1\nErM | F s \u010f ErM 1 | F s(cid:0)M 1 .\n\u03c4^t t(cid:1)1 \u03c4 t\u03c4\u0103tu t(cid:1)1 t(cid:1)1 t\u03c4\u011btu\nOn the other hand,\nt(cid:1)1 t(cid:1)1\n\u201a \u201a\n1 ErM | F s (cid:16) ErM 1 | F s (cid:16) ErM 1 | F s.\nt\u03c4\u0103tu \u03c4 t(cid:1)1 \u03c4 t\u03c4(cid:16)iu t(cid:1)1 i t\u03c4(cid:16)iu t(cid:1)1\ni(cid:16)0 i(cid:16)0\n246 B. PROBABILITY\nSince 1 M isF -measurable for i \u010f t(cid:1)1, we have\nt\u03c4(cid:16)iu i t(cid:1)1\nErM 1 | F s (cid:16) 1 M ,\ni t\u03c4(cid:16)iu t(cid:1)1 t\u03c4(cid:16)iu i\nand\nt(cid:1)1\n\u201a\n1 ErM | F s (cid:16) M 1 (cid:16) M 1 .\nt\u03c4\u0103tu \u03c4 t(cid:1)1 i t\u03c4(cid:16)iu \u03c4 t\u03c4\u010ft(cid:1)1u\ni(cid:16)0\nTherefore,\nErM | F s \u010f M 1 (cid:0)M 1 (cid:16) M .\n\u03c4^t t(cid:1)1 \u03c4 t\u03c4\u010ft(cid:1)1u t(cid:1)1 t\u03c4\u011btu \u03c4^pt(cid:1)1q\nB.4 Characteristic functions and weak convergence\nThe characteristic function of a (univariate) random variable is a complex function defined\nby\n\u03c7 p\u03b8q :(cid:16) Erei\u03b8Xs.\nX\nW tinh ue on usX wi is tha pd di fsc fre ,t te hr ea nnd \u03c7om p\u03b8qva (cid:16)ria \u015fb 8le, et ih \u03b8xe fn px\u03c7 dp x\u03b8 .q I(cid:16) t\u0159 h8 lae ti t\u03b8 ex rip a, sa e,nd thw eh ce hn arX acti es ric so tn ic-\nqX i e(cid:16)1 c1\nn\nX (cid:1)8\nfunction is the Fourier transform of the pdf f.\nIfF isthedistributionfunctionofX, thecharacteristicfunctioncanbeequivalentlygiven\nby\n\u017c\n\u03c7 p\u03b8q (cid:16) ei\u03b8xdFpxq,\nX\nR\nwhere the above integral should be interpreted as Reimann-Stieltjes integral. Especially\nfor continuous random variables we have\n\u017c\n\u03c7 p\u03b8q (cid:16) ei\u03b8xfpxqdx.\nX\nR\nTherefore, for a continuous random variable, the characteristic function is the Fourier\ntransform of the pdf. Therefore, if we know the characteristic function of a distribution,\nthen one can find the distribution function by inverse Fourier transform.\nExample B.46. We want to find the characteristic function of Y (cid:18) Np\u00b5,\u03c3q. First tale\nthe standard case of X (cid:18) Np0,1q.\n\u017c ?(cid:1)\u03b8 22 \u017c\n?1 ei\u03b8xe(cid:1)x 22 e e(cid:1)px(cid:1) 2i\u03b8q2 e(cid:1)\u03b8 22\n\u03c7 Xp\u03b8q (cid:16) dx (cid:16) dx (cid:16) .\n2\u03c0 R 2\u03c0 R\n247 B. PROBABILITY\nNow, since Y (cid:16) \u00b5(cid:0)\u03c3X, we have\nei\u00b5\u03b8(cid:1)\u03c32 2\u03b82\n\u03c7 Yp\u03b8q (cid:16) Erei\u03b8p\u00b5(cid:0)\u03c3Xqs (cid:16) ei\u00b5\u03b8\u03c7 Xp\u03c3\u03b8q (cid:16) .\nFor the inversion theorem, see [10, Theorem 3.3.4], the characteristic function uniquely\ndetermines the distribution of the random variable. Therefore, all the information\nFor a random vector pX,Yq, the characteristic function is defined as\n\u03c7p\u03b8 ,\u03b8 q :(cid:16) Ereip\u03b81X(cid:0)\u03b82Yqs.\n1 2\nOne of the important implications of definition of independent random variable in Remark\nB.3 is that if X and Y are independent, then for any p\u03b8 ,\u03b8 q we have\n1 2\n\u03c7p\u03b8 ,\u03b8 q (cid:16) M p\u03b8 qM p\u03b8 q. (B.14)\n1 2 X 1 Y 2\nThe inverse is also true; see [10, Theorem 3.3.2]. This provides an easy way to formulate\nand verify the independence of random variable in theory.\nProposition B.10. X and Y are independent if and only if (B.14) holds true.\nWeak convergence\nThe most well-known place where the weak convergence comes to play is the central limit\ntheorem (CLT).\nTheorem B.7. Let X ,X ,... be a sequence of i.i.d. random variables with expectation\n1 2\n\u00b5 (cid:16) ErX 1s and standard deviation \u03c3 :(cid:16) a ErX 12s(cid:1)\u00b52 and define W :(cid:16) \u0159n i(cid:16) \u03c31p ?X ni(cid:1)\u00b5q. Then,\nn\n\u017cx\nPpW \u010f xq (cid:209) ?1 e(cid:1)y 22 dy,\nn\n2\u03c0\n(cid:1)8\nas n (cid:209) 8.\nTheappellation\u201cweak\u201disoriginatedfromthefactthatthisconvergenceisweakerthatthe\nconcept of pointwise or almost sure (shortly a.s.) convergence. The pointwise convergence\nindicates that the sequence of random variablestW p\u03c9qu converges for all \u03c9 P \u2126; while\nn n\nalmost sure convergence means the probability of the event\nA :(cid:16) t\u03c9 : W p\u03c9qu does not convergeu\nn n n\nconverges to zero as n (cid:209) 8. Almost sure convergence, for instance, appears in the law of\nlarge numbers (LLN).\n248 B. PROBABILITY\nTheorem B.8. Let X ,X ,... be a sequence of i.i.d. random variables with expectation\n1 2\na\n\u00b5 (cid:16) ErX s and standard deviation \u03c3 :(cid:16) ErX2s(cid:1)\u00b52. Then,\n1 1\n\u0159n\nX (cid:1)n\u00b5\ni(cid:16)1 i (cid:209) 0 almost surely,\nn\nas n (cid:209) 8. Here almost surely means that the probability that this convergence does not\nhappen is zero.\n\u0159n\ni(cid:16)1Xi\nIn other words, the statistical average converges to the expectation (mean), when\nn\nn (cid:209) 8, except for a set of outcomes with zero total probability. For example in the\ncontext of flipping a fair coin, the fraction of flips that the coin turns heads converges to 1\n2\nexclusively. However, one can simply construct infinite sequences of heads and tails such\nas H,T,T,H,T,T,... with statistical average converging to some value other than 1.\n2\nIn the weak sense of convergence in CLT, the sequence of random variablestW p\u03c9qu do\nn n\nnot actually converge to a normal random variable over a significantly large part of the\nsample space, as a result of law of iterated logarithms, i.e.\nW\nn\nlimsup a (cid:16) 1 almost surely.\nn(cid:209)8 2logplogpnqq\nInstead, the probability distribution function of W can be approximated by normal dis-\nn\n\u0159n\ni(cid:16)1?Xi(cid:1)n\u00b5\ntribution function for large n. In this case, we say that converges weakly or in\n\u03c3 n\ndistribution to standard Gaussian.\nDefinition B.21. We say the sequence tY u8 of random variables converges weakly (or\nn n(cid:16)1\nin distribution) to random variable Y if for the distribution functions we have\nF pyq (cid:209) F pyq for any y such that F is continuous at y.\nYn Y Y\nWe denote the weak convergence by Y \u00e6 Y.\nn\nThe following example reveals a different aspect of weak convergence in regard to com-\nparison with a.s. convergence.\nExample B.47. On a probability space p\u2126,Pq, let the random variable Y p\u03c9q (cid:16) y for all\nn n\n\u03c9 (a.s.), i.e., Y is a constant random variable equal to y . If y (cid:209) y, then Y (cid:209) Y (cid:17) y\nn n n n\npointwise (a.s., respectively).\nNow, consider a sequence of possibly different probability space p\u2126 (cid:16) t0,1u,P q such that\nn\nP pt0uq (cid:16) 1 if n is odd and P pt0uq (cid:16) 0 if n is even. For each n, let the random variable\nn n\nZ : \u2126 (cid:209) R be defined by\nn\n#\n1 p\u03c9 (cid:16) 0 and n is oddq or p\u03c9 (cid:16) 1 and n is evenq\nZ p\u03c9q (cid:16) n\nn\n1 otherwise.\n249 B. PROBABILITY\nIn particular, the distribution of Z is a Dirac distribution located at 1;\nn n\n#\n1 x \u011b 1\nF pxq :(cid:16) P pZ \u010f xq (cid:16) n\nn n n\n0 otherwise.\nZ does not converge pointwise, since Z p0q alternates between 1 and 1 as n increases\nn n n\nsuccessively. However, the distribution function F pxq of Z converges to the distribution\nn n\nfunction\n#\n1 x \u011b 0\nFpxq :(cid:16)\n0 otherwise.\nThe following proposition is one of the equivalent conditions of weak convergence.\nProposition B.11. Y \u00e6 Y if and only if for any bounded continuous function f :\nn\nR (cid:209) R we have\nlim ErfpY qs (cid:16) ErfpYqs\nn\nn(cid:209)8\nNotice that the expectation in ErY s and ErYs are to be interpreted in different sample\nn\nspaces with different probabilities.\nOne of the ways to establish weak convergence results is to use characteristic functions;\nsee [10, Theorem 3.3.6]\nTheorem B.9. Let tX u be a sequence of random variables such that for any \u03b8, \u03c7 p\u03b8q\nn Xn\nconverges to a function \u03c7p\u03b8q which is continuous at \u03b8 (cid:16) 0. Then, X converges weakly to\nn\na random variable X with characteristic function \u03c7.\nAs a consequence of the this Theorem, one can easily provide a formal derivation for\n\u0159n\n\u03c31?X ni(cid:1)n\u00b5\ncentral limit theorem. Let S :(cid:16) i(cid:16) . Thanks to the properties of characteristic\nn\nfunction and (B.14), the characteristic function of S is given by\nn\n\u017an ? (cid:0) ? (cid:8)n\n\u03c7 p\u03b8q (cid:16) \u03c7 p\u03b8{p\u03c3 nqq (cid:16) \u03c7 p\u03b8{p\u03c3 nqq .\nSn Xi(cid:1)\u00b5 X1(cid:1)\u00b5\ni(cid:16)1\nHere we used identical distribution of sequence tX u to write the last equality. Since\nn\neix (cid:16) 1(cid:0)ix(cid:1) x2 (cid:0)opx2q, we can write\n2\n\u03c32\u03b82\n\u03c7 p\u03b8q (cid:16) 1(cid:1) (cid:0)op\u03b82q.\nXi(cid:1)\u00b5\n2\nTherefore,\n(cid:0) pXi(cid:1)\u00b5qp\u03b8{p\u03c3? nqq(cid:8)n (cid:2) 2\u03b8 n2 (cid:0)opn(cid:1)1q(cid:10)n e(cid:1)\u03b8 22\n\u03c7 Snp\u03b8q (cid:16) \u03c7 (cid:16) 1(cid:1) (cid:209) ,\n250 B. PROBABILITY\ne(cid:1)\u03b8 22\nas n (cid:209) 8. This finished the argument since is the characteristic function of standard\nGaussian.\nRemarkB.10. IntheDefinitionB.21ofweakconvergence, onlythedistributionofrandom\nvariables matters, and not the sample space of each random variable. Therefore, in weak\nconvergence, the random variables in sequence tY u8 can live in different sample spaces.\nn n(cid:16)1\nHowever, one can make one universal sample space for all Y \u2019s and Y; more precisely, if\nn\nY and Y are defined on probability space p\u2126 ,F ,P q and p\u2126,F,Pq, then \u2126\u02dc (cid:16) \u2126(cid:2)\u015b \u2126\nn n n n n n\nis a universal sample space. The random variables Y and Y are redefined on \u2126\u02dc by\nn\nY\u02dc p\u03c9,\u03c9 ,\u03c9 ,...q (cid:16) Yp\u03c9q, and Y\u02dc p\u03c9,\u03c9 ,\u03c9 ,...q (cid:16) Y p\u03c9 q.\n1 2 n 1 2 n n\nThe distribution of random variables on \u2126\u02dc is determined by the probability P\u02dc :(cid:16) Pb\u015b P .\nn n\nTherefore, the weak convergence of random variables can be reduced to weak convergence\nof probabilities on a single sample space.\nWeak convergence of probabilities\nIf the sample space is a Polish space (complete metrizable topological space), then one can\ndefineweakconvergenceofprobabilities(orevenmeasures). Samplespaceswithatopology\ncontribute to the richness of the probabilistic structure; the concept of convergence of\nprobabilities can be defined.\nDefinition B.22. Consider a sequence of probabilities tP u on a Polish probability space\nn n\np\u2126,Fq. We say P converges weakly to a probability P on p\u2126,Fq, denoted by P \u00e6 P, if\nn n\nfor any bounded continuous function f : \u2126 (cid:209) R we have\nlim Enrfs (cid:16) Erfs\nn(cid:209)8\nNotice that in the above definition topology of \u2126 has been used in the continuity of\nfunction f.\nOne can always reduce the weak convergence of random variables to weak convergence of\nprobabilities in the Polish space Rd. Let tY u8 be a sequence of random variables and Y\nn n(cid:16)1\nbe a random variable all with values in Rd. Then, the distributions of Y \u2019s and Y defined\nn\nprobability measures in Rd as follows.\nP\u02dc pAq (cid:16) P pY P Aq and P\u02dc pAq (cid:16) PpY P Aq.\nn n\nNotice that, as emphasized in Remark B.10, Y and Y live in different probability spaces\nn\np\u2126 ,F ,P q and p\u2126,F,Pq, respectively. However, the probabilities P\u02dc and P\u02dc are defined\nn n n n\non the same sample space Rd.\nCorollary B.9. Y \u00e6 Y if and only if P\u02dc \u00e6 P\u02dc.\nn n\n251 B. PROBABILITY\nW W\nTime Time\nFigure B.8: Left: Sample path of a random walk. Right: Interpolated sample path of a\nrandom walk\nB.5 Donsker Invariance Principle and Brownian motion\nIn this section, we heuristically construct Brownian motion (or Wiener process) as the\nweak limit of symmetric discrete-time random walk in Definition B.2. First, we make\nthe sample paths of random walk continuous by linear interpolation. For t P r0,8q, we\ndefine the interpolated random walk by W :(cid:16) W (cid:0)pt(cid:1)rtsqW ; see Figure B.8. Then,\nt rts rts(cid:0)1\ntW : t \u011b 0u becomes a continuous-time stochastic process with continuous sample paths,\nt\ni.e., for each t \u011b 0, W is a random variable and for any realization \u03c9 of random walk,\nt\nW p\u03c9q is continuous in t.\nt\nMotivated by central limit theorem, we defined normalized random walk by\n1\nXpnq\n:(cid:16) ? W for all t P r0,8q.\nt n nt\nW\np1\nTime\nn\n1\nn\nA sample path of a normalized random walk X(n)\nXpnq\nThen, we define Brownian motion is the weak limit of as n (cid:209) 8. Indeed, a rigorous\nt\n252 B. PROBABILITY\ndefinition of the Brownian motion is way more technical and requires advanced techniques\nfrom analysis and measure theory. Here we only need the properties which characterize a\nBrownian motion.\nRemark B.11. In the above construction, one can take any sequence of i.i.d. random\nvariables t\u03be nu with finite variance \u03c32 and define X tpnq :(cid:16) \u03c3?1 nW nt. The rest of the\nn\u011b0\narguments in this section can be easily modified for this case.\nBecause t\u03be u8 are i.i.d., for any t (cid:16) k and s (cid:16) \u2113 with t \u0105 s, Xpnq (cid:1)Xpnq has mean zero\ni i(cid:16)1 n n t s\nand variance t(cid:1)s. If t \u0105 s are real numbers, then the mean is still zero but the variance is\n1prtns(cid:1)rsnsqwhichconvergestot(cid:1)s. Inaddition,Xpnq (cid:1)Xpnq isindependentofXpnq when\nn t s u\nu \u010f s. By central limit theorem, Xpnq (cid:1)Xpnq \u00e6 Np0,t(cid:1)sq, a normal distribution with\nt s\nmean zero and variance t(cid:1)s. This suggests that Brownian motion inherits the following\nXpnq:\nproperties in the limit from\nt\na) B has continuous sample paths,\nb) B (cid:16) 0,\n0\nc) when s \u0103 t, the increment B (cid:1)B is a normally distributed random variables with\nt s\nmean 0 and variance t(cid:1)s and is independent of B ; for all u \u010f s.\nu\nThe properties above fully characterize the Brownian motion.\nDefinition B.23. A stochastic process is a Brownian motion if it satisfies the properties\n(a)-(c) above.\nProperty (c) in the definition of Brownian motion also implies some new properties for\nthe Brownian motion which will be useful in modeling financial asset prices.\n- Time-homogeneity. Brownian motion is time homogeneous, i.e., B (cid:1)B has the\nt s\nsame distribution as B .\nt(cid:1)s\n- Markovian. The distribution of B given tB : u \u010f su has the same distribution as\nt u\nB given B , i.e., the most recent past is the only relevant information. Notice that\nt s\nB (cid:16) B (cid:0)B (cid:1)B . Sincebyproperty(c)B (cid:1)B isindependentofF :(cid:16) tB : u \u010f su,\nt s t s t s s u\nthe distribution of B (cid:16) B (cid:0)B (cid:1)B given F (cid:16) tB : u \u010f su is normal with mean\nt s t s s u\nB and variance t(cid:1)s, which only depends on the most recent past B . In other word,\ns s\nby Proposition B.6\nErfpB q | F s (cid:16) ErfpB (cid:1)B (cid:0)B q | F s (cid:16) ErfpB (cid:1)B (cid:0)B q | B s\nt s t s s s t s s s\n253 B. PROBABILITY\n- Martingale. Finally, the conditional expectation ErB | B : u \u010f ss can be shown\nt u\nto be equal to B .\ns\nErB | B : u \u010f ss (cid:16) ErB | B s (cid:16) ErB | B s(cid:0)ErB (cid:1)B | B s (cid:16) B .\nt u t s s s t s s s\nIn the above we used property (c) to conclude that ErB (cid:1)B | B s (cid:16) 0.\nt s s\nA typical sample paths of Brownian motion is shown in Figure B.9.\nFigure B.9: A sample paths of Brownian motion\nSample space for Brownian motion\nIn order to construct a Brownian motion, we need to specify the sample space. In the early\nwork of Kolmogorov, we choose the sample space to be pRdqr0,8q, i.e., space of all functions\nfrom r0,8q to Rd. This is motivated by the fact that for any \u03c9 P \u2126, the sample path of\nBrownian motion associated with sample \u03c9 is given by the function B p\u03c9q : r0,8q (cid:209) Rd.\nt\nSee Figure B.9. Kolmogorov made a theory which in particular resulted in the existence\nof Brownian motion. While it is not hard to show property (c), in his theory it is not easy\nto show property (a) of Brownian motion, i.e., the sample paths are continuous. By using\nthe weak convergence result of Yuri Prokhorov, Norbert Wiener take the construction of\nBrownian motion to a new level by taking the sample space \u2126 :(cid:16) Cpr0,8q;Rdq, the space\nof all continuous functions. This way property (a) becomes trivial, while, property (c) is\nmore challenging.\nAmong all the continuous functions in Cpr0,8q;Rdq only a small set can be a sample\npaths of a Brownian motion. In the following, we present some of the characteristics of the\n254 B. PROBABILITY\npaths of Brownian motion.\ni) Sample paths of Brownian motion are nowhere differentiable. In addition,\nB (cid:1)B B (cid:1)B\nt(cid:0)\u03b4 t t(cid:0)\u03b4 t\nlimsup (cid:16) 8, and liminf (cid:16) (cid:1)8.\n\u03b4(cid:209)0 \u03b4 \u03b4(cid:209)0 \u03b4\nii) Sample paths of Brownian motion are of bounded quadratic variation variations.\nMore precisely, the quadratic variation of the path of Brownian motion until time t,\nequals t, i.e.,\nN(cid:1)1\n\u201a\nlim pB (cid:1)B q2 (cid:16) t, a.s., (B.15)\nti(cid:0)1 ti\n}\u03a0}(cid:209)0\ni(cid:16)0\nwhereforthepartition\u03a0 :(cid:16) tt (cid:16) 0 \u0103 t \u0103 (cid:4)(cid:4)(cid:4) \u0103 t (cid:16) tu,}\u03a0} (cid:16) max pt (cid:1)\n0 1 N i(cid:16)0,...,N(cid:1)1 i(cid:0)1\nt q\ni\niii) Sample paths of Brownian motion are not of bounded variations almost surely, i.e.,\nfor\nN(cid:1)1\n\u201a\nsup |B (cid:1)B | (cid:16) 8, a.s.,\nti(cid:0)1 ti\n\u03a0\ni(cid:16)0\nwhere the supremum is over all partitions \u03a0 :(cid:16) tt (cid:16) 0 \u0103 t \u0103 (cid:4)(cid:4)(cid:4) \u0103 t (cid:16) tu.\n0 1 N\nIn the above, property (iii) is a result of (ii). More precisely, for a a continuous function\ng : ra,bs (cid:209) R, a nonzero quadratic variation implies infinite bounded variation. To show\nthis, let\u2019s assume that g is continuous and bounded variation B. Then, g is uniformly\ncontinuous on ra,bs, i.e., for any \u03b5 \u0105 0, there exists a \u03b4 \u0105 0 such that if }\u03a0} \u010f \u03b4, then\nmax t|gpt q(cid:1)gpt q|u \u010f \u03b5.\ni(cid:0)1 i\ni(cid:16)0,...,N(cid:1)1\nThus,\nN(cid:1)1 N(cid:1)1\n\u201a \u201a\npgpt q(cid:1)gpt qq2 \u010f max t|gpt q(cid:1)gpt q|u |gpt q(cid:1)gpt q| \u010f \u03b5B.\ni(cid:0)1 i i(cid:0)1 i i(cid:0)1 i\ni(cid:16)0,...,N(cid:1)1\ni(cid:16)0 i(cid:16)0\nBy sending \u03b5 (cid:209) 0, we obtain that the quadratic variation vanishes.\nThe following exercise shows the relation between the quadratic variation is martingale\nproperties of Brownian motion.\nExercise B.24. Show that B2(cid:1)t is a martingale, i.e.\nt\nErB2 (cid:1)pt(cid:0)sq | B s (cid:16) B2(cid:1)s.\nt(cid:0)s s s\n255 C. STOCHASTIC ANALYSIS\nC Stochastic analysis\nCalculus is the study of derivative (not financial) and integral. Stochastic calculus is\ntherefore the study of integrals and differentials of stochastic objects such as Brownian\nmotion. In this section, we provide a brief overview of the stochastic integral and It\u00f4\nformula (stochastic chain rule). The application to finance is provided in Part 3.\n\u015fb\nIn calculus, the Riemann integral fptqdt is defined by the limit of Riemann sums:\na\nN\n\u201a\nlim\u03b4 fpt(cid:6)q,\ni\n\u03b4(cid:209)0\ni(cid:16)1\nwhere \u03b4 (cid:16) b(cid:1)a, t (cid:16) a, t (cid:16) t (cid:0)i\u03b4, and t(cid:6) is an arbitrary point in interval rt ,t s. The\nN 0 i 0 i i(cid:1)1 i\nReiman integral can be defined for a limited class of integrands, i.e., the real functions f is\nRiemann integrable on ra,bs if and only if it is bounded and continuous almost everywhere.\nA natural extension of Riemann integral is Lebesgue integral, which can be defined on a\nlarge class of real functions, i.e., bounded measurable function on ra,bs.\nAmoregeneralformofRiemannintegral,Riemann-Stieltjesintegralisdefinedinasimilar\nfashion. Fortworealfunctionsf,g : ra,bs (cid:209) R, theintegraloftheintegrand f withrespect\nto integrator g is defined by\n\u017cb \u201aN\nfptqdgptqlim fpt(cid:6)qpgpt q(cid:1)gpt q.\ni i i(cid:1)1\na \u03b4(cid:209)0 i(cid:16)1\nFor Riemann-Stieltjes integral, and its extension, Lebegue-Stieltjes integral, to be well-\ndefined, we need some conditions on f and g.\nTheconditionontheintegrandf issimilartothethoseinRiemannandLebesgueintegrals.\nFor example if f is continuous almost everywhere and at the points of discontinuity of g,\nthen no further condition needs to be imposed on f in the Riemann-Stieltjes integral. For\ntheLebesgue-Stieltjesintegral,f onlyneedstobemeasurable. However,forg averycrucial\ncondition is needed to make the integral well-defined. g must be of bounded variation, i.e.\nN\n\u201a\nlim |gpt q(cid:1)gpt q| \u0103 8.\ni(cid:0)1 i\n\u03b4(cid:209)0\ni(cid:16)0\nNo matter how nice the function f is, if g is unbounded variation, Riemann-Stieltjes or\nLebesgue-Stieltjes integral cannot be defined. As seen in Section B.5, the sample paths of\nBrownian motion are of unbounded variation, which makes it impossible to use them as\n\u015fb\nthe integrator. Therefore, the integral fptqdB with respect to Brownian motion cannot\na t\nbe defined pathwise in the sense of the Riemann-Stitljes or Lebesgue-Stieltjes integrals.\n256 C. STOCHASTIC CALCULUS\nIn this section, we define a new notion of integral, It\u00f4 integral15, which makes sense of\n\u015fb\nfptqdB in a useful way for some applications, including finance.\na t\nOne of the major tools in stochastic analysis is the stochastic chain rule. Recall that the\nchain rule in the differential form is written as dhpgptqq (cid:16) g1ptqh1pgptqqdt, which can be\nused in the change of variable in integral. If vptq (cid:16) hpgptqq and h and g are differentiable\nfunctions, then\n\u017cb \u017cb\nfptqdvptq (cid:16) fptqg1ptqh1pgptqqdt.\na a\nThe right-hand side above is a Riemann (Lebesgue) integral. As a matter of fact, change\nof variable formula for Reimann (Lebesgue) integral is the integral format of the chain rule.\nFor bounded variation but not necessarily differentiable function g, the chain rule in the\nchange of variable for Riemann-Stieltjes (Lebesgue-Stieltjes) integral can be written in a\nslightly different way. More precisely, if vptq (cid:16) hpgptqq and h is a differentiable function\nand g is of bounded variation, then\n\u017cb \u017cb\nfptqdvptq (cid:16) fptqh1pgptqqdgptq.\na a\nIn the chain rule for It\u00f4 stochastic integral, an extra term appears. If vptq (cid:16) hpB q and h\nt\nis a twice differentiable function, then\n\u017cb \u017cb \u017cb\n1\nfptqdvptq (cid:16) fptqh1pB qdB (cid:0) fptqh2pB qdt.\nt t t\n2\na a a\n\u015fb\nAs expected the term fptqh1pB qdB shows up like in chain rule. However, the term\na t t\n1 \u015fb fptqh2pB qdt, which is a simple Riemann integral, is unprecedented. In the remaining\n2 a t\nof this section, we provide a heuristic argument why this term should be in the chain rule\nfor It\u00f4 stochastic integral.\nC.1 Stochastic integral with respect to Brownian motion and It\u00f4 formula\nWefirstintroduceaspecialcaseofIt\u00f4integral,calledWienerintegral16. InWienerintegral,\nwe assume that the integrand f is simply a real function and is not stochastic. The the\npartial sums\nN\n\u201a\nS :(cid:16) fpt qpB (cid:1)B q,\n\u03b4 i(cid:1)1 ti ti(cid:1)1\ni(cid:16)1\n15Named after Japanese mathematician Kiyosi It\u00f4, 1915-2008.\n16Named after American mathematician Norbert Wiener, 1894-1964.\n257 C. STOCHASTIC CALCULUS\nis a Gaussian random variable with mean zero and variance\nN\n\u201a\n\u03b4 f2pt q.\ni(cid:1)1\ni(cid:16)1\nExercise C.1. Show that S is a Gaussian random variable with mean zero and variance\n\u03b4\n\u03b4\u0159N f2pt q.\ni(cid:16)1 i(cid:1)1\nTherefore, it follows form\n\u201aN \u017cb\nlim\u03b4 f2pt q (cid:16) f2ptqdt,\ni(cid:1)1\n\u03b4(cid:209)0 i(cid:16)1 a\n\u015fb\nthat S \u00e6 X where X is a normal random variable with mean zero and variance f2ptqdt.\n\u03b4 a\nNotice that in the partial sum for S , we choose t , i.e., the left endpoint on the interval\n\u03b4 i(cid:1)1\nrt ,t s. This choice is not crucial to achieve the limit. If we would choose different points\ni(cid:1)1 i\non the interval, we still obtain the same limiting distributions. See Exercise C.2.\nExercise C.2. Calculate that the mean and the variance of partial sums below:\n\u0159N\na) fpt qpB (cid:1)B q.\ni(cid:16)1 i ti ti(cid:1)1\n(cid:1) (cid:9)\n\u0159N ti(cid:0)ti(cid:1)1\nb) f pB (cid:1)B q.\ni(cid:16)1 2 ti ti(cid:1)1\n\u0159N\nc) fpt qpB (cid:1)B q.\ni(cid:16)1 i(cid:1)1 ti ti(cid:1)1\nThen, show that in each case the limit of the calculated quantities as \u03b4 (cid:209) 0 is the same.\nIt\u00f4 integral extends Wiener integral to stochastic integrands. The integrand f is now a\nfunction of time t P ra,bs and \u03c9 in sample space \u2126. For our analysis in this notes, we only\nneed to define It\u00f4 integral on the integrands of the form fpt,B q where f : ra,bs(cid:2)R (cid:209) R\nt\nis a measurable function. Similar to the Winer integral we start with the partial sum\nN(cid:1)1\n\u201a\nfpt ,B qpB (cid:1)B q.\ni ti ti(cid:0)1 ti\ni(cid:16)0\nExercise C.3. Calculate that the mean and the variance of partial sums below:\n\u0159N\na) B pB (cid:1)B q.\ni(cid:16)1 ti ti ti(cid:1)1\n\u0159N\nb) B pB (cid:1)B q.\ni(cid:16)1 ti(cid:0)ti(cid:1)1 ti ti(cid:1)1\n2\n258 C. STOCHASTIC CALCULUS\n\u0159N\nc) B pB (cid:1)B q.\ni(cid:16)1 ti(cid:1)1 ti ti(cid:1)1\nThen, show that in all cases the limits of the calculated quantities as \u03b4 (cid:209) 0 are different.\n\u017cT N \u201a(cid:1)1\nfpu,B qdB :(cid:16) P(cid:1) lim fpt ,B qpB (cid:1)B q. (C.1)\nu u i ti ti(cid:0)1 ti\n0 \u03b4(cid:209)0 i(cid:16)0\nThe notation P(cid:1)lim means the limit is in probability, i.e., for any \u03b5 \u0105 0,\n(cid:3) (cid:11)\n(cid:7)N \u201a(cid:1)1 \u017cT (cid:7)\nP (cid:7) fpt ,B qpB (cid:1)B q(cid:1) fpu,B qdB (cid:7) \u0105 \u03b5 (cid:209) 0 as \u03b4 (cid:209) 0.\n(cid:7) i ti ti(cid:0)1 ti u u(cid:7)\ni(cid:16)0 0\nThechoiceofstartingpointt intheintervalrt ,t sinfpt ,B qiscrucial. Thisisbecause\ni i i(cid:0)1 i ti\nchoosing other point in the interval rt ,t s leads to different limits. Fo instance,\ni i(cid:0)1\nN \u201a(cid:1)1 f(cid:1)t i(cid:0)t B ti(cid:0)ti(cid:0)1(cid:9)\ni(cid:0)1\n, pB (cid:1)B q\nti(cid:0)1 ti\n2 2\ni(cid:16)0\nconverges to\n\u017cT \u017cT\nfpu,B qdB (cid:0) B fpu,B qdu.\nu u x u\n0 0\nMartingale property of stochastic integral\nConsider the discrete sum which converges to the stochastic integral, i.e.\nN(cid:1)1\n\u201a\nM :(cid:16) fpt ,B qpB (cid:1)B q\nT i ti ti(cid:0)1 ti\ni(cid:16)0\nAssume that the values of B ,...,B are given. We want to evaluate the conditional\n0 tj\nexpectation of the stochastic sum M , i.e.\nT\nErM | B ,...,B s.\nT 0 tj\nThen, we split the stochastic sum into to parts\nj(cid:1)1 N(cid:1)1\n\u201a \u201a\nM :(cid:16) fpt ,B qpB (cid:1)B q(cid:0) fpt ,B qpB (cid:1)B q.\nT i ti ti(cid:0)1 ti i ti ti(cid:0)1 ti\ni(cid:16)0 i(cid:16)j\n259 C. STOCHASTIC CALCULUS\nThe first summation of the right-hand side above is known given B ,...,B . Thus,\n0 tj\n(cid:19) ff\nj(cid:1)1 N(cid:1)1\n\u201a \u201a\nErM | B ,...,B s (cid:16) fpt ,B qpB (cid:1)B q(cid:0)E fpt ,B qpB (cid:1)B q | B ,...,B\nT 0 tj i ti ti(cid:0)1 ti i ti ti(cid:0)1 ti 0 tj\ni(cid:16)0 i(cid:16)j\nj(cid:1)1 N(cid:1)1\n\u201a \u201a E(cid:16) (cid:24)\n(cid:16) fpt ,B qpB (cid:1)B q(cid:0) fpt ,B qpB (cid:1)B q | B ,...,B\ni ti ti(cid:0)1 ti i ti ti(cid:0)1 ti 0 tj\ni(cid:16)0 i(cid:16)j\nEach term in the second summation of right-hand side above can be calculated by tower\nproperty of conditional expectation\nE(cid:16) fpt ,B qpB (cid:1)B q | B ,...,B (cid:24) (cid:16) E(cid:16) fpt ,B qErB (cid:1)B | B ,...,B s | B ,...,B (cid:24) .\ni ti ti(cid:0)1 ti 0 tj i ti ti(cid:0)1 ti 0 ti 0 tj\nSince B (cid:1)B is independent of B ,...,B ,\nti(cid:0)1 ti 0 ti\nErB (cid:1)B | B ,...,B s (cid:16) ErB (cid:1)B s (cid:16) 0.\nti(cid:0)1 ti 0 ti ti(cid:0)1 ti\nThis implies that the second summation vanishes and we have\nj(cid:1)1\n\u201a\nErM | B ,...,B s (cid:16) fpt ,B qpB (cid:1)B q (cid:16): M .\nT 0 tj i ti ti(cid:0)1 ti tj\ni(cid:16)0\nIn other words, given the Brownian motion up to time t , the expected values of M is\nj T\nequaltoM . Inprobabilityterms, wecallthisamartingale. Bysomemoretechnicaltools,\ntj\none can show that given the path of a Brownian motion until time t \u0103 T, the expected\n\u015fT \u015ft\nvalue of the stochastic integral fps,B qdB is equal to fps,B qdB , i.e.\n0 s s 0 s s\n(cid:18)\u017cT (cid:7) \u0237 \u017ct\n(cid:7)\nE fps,B sqdB s(cid:7)B for s P r0,ts (cid:16) fps,B sqdB s.\ns\n(cid:7)\n0 0\nOneoftheconsequenceofmartingalepropertyisthattheexpectationofstochasticintegral\nis zero, i.e.\n(cid:18)\u017cT \u0237 \u017c0\nE fps,B qdB (cid:16) fps,B qdB (cid:16) 0.\ns s s s\n0 0\nRemark C.1. The martingale property of the stochastic integral with respect to Brownian\nmotion is basically a result of martingale property of Brownian motion. Riemann integral\n\u015ft \u015ft\nfps,B qds is a martingale if and only if f (cid:17) 0. Intuitively, if we assume fps,B qds is\n0 s 0 s\na martingale, we have\n(cid:17)\u017ct(cid:0)\u03b4 (cid:7) (cid:25)\nE fps,B qds(cid:7)F (cid:16) 0.\ns (cid:7) t\nt\n260 C. STOCHASTIC CALCULUS\nBy dividing both sides by \u03b4 and then sending \u03b4 (cid:209) 0, we obtain\n(cid:17)1 \u017ct(cid:0)\u03b4 (cid:7) (cid:25)\nlimE fps,B qds(cid:7)F (cid:16) Erfpt,B q | F s (cid:16) fpt,B q.\n\u03b4(cid:209)0 \u03b4 t s (cid:7) t t t t\nC.2 It\u00f4 formula\nOne of the important implications of It\u00f4 integral is a very powerful tool called It\u00f4 formula.\nIt\u00f4 formula is the stochastic version of Taylor expansion. To understand this better let\u2019s\ntry to write Taylor expansion for Vpt(cid:0)\u03b4,B q about the point Vpt,B q.\nt(cid:0)\u03b4 t\n1\nVpt(cid:0)\u03b4,B q (cid:16) Vpt,B q(cid:0)\u03b4B Vpt,B q(cid:0)B Vpt,B qpB (cid:1)B q(cid:0) B Vpt,B qpB (cid:1)B q2(cid:0)op\u03b4q.\nt(cid:0)\u03b4 t t t x t t(cid:0)\u03b4 t xx t t(cid:0)\u03b4 t\n2\n(C.2)\n?\nThe remaining term in of order op\u03b4q since B (cid:1)B (cid:18) Op \u03b4q. Also, we know that\nt(cid:0)\u03b4 t\npB (cid:1)B q2(cid:1)\u03b4 (cid:18) op\u03b4q, pB (cid:1)B q\u03b4 (cid:18) op\u03b4q, and trivially \u03b42 (cid:18) op\u03b4q. (C.3)\nt(cid:0)\u03b4 t t(cid:0)\u03b4 t\nIf we take conditional expectation with respect to B , we obtain\nt\nErVpt(cid:0)\u03b4,B q | B s (cid:16)Vpt,B q(cid:0)\u03b4B Vpt,B q(cid:0)B Vpt,B qErpB (cid:1)B q | B s\nt(cid:0)\u03b4 t t t t x t t(cid:0)\u03b4 t t\n1\n(cid:0) B Vpt,B q\u03b4(cid:0)op\u03b4q.\nxx t\n2\n1\n(cid:16)Vpt,B q(cid:0)pB Vpt,B q(cid:0) B Vpt,B qq\u03b4(cid:0)op\u03b4q\nt t t xx t\n2\nNotice that here, by the martingale property of Brownian motion, we have ErpB (cid:1)B q |\nt(cid:0)\u03b4 t\nB s (cid:16) 0. Then, we obtain\nt\n(cid:19) ff\nN \u201a(cid:1)1\n1\nErVpT,B qs (cid:16) Vp0,B q(cid:0)E pB Vpt ,B q(cid:0) B Vpt ,B qq\u03b4 (cid:0)op1q,\nT 0 t i ti xx i ti\n2\ni(cid:16)0\nwhich in the limit converges to\n(cid:18)\u017cT \u0237\n1\nErVpT,B qs (cid:16) Vp0,B q(cid:0)E pB Vpt ,B q(cid:0) B Vpt,B qqdt .\nT 0 t i t xx t\n2\n0\nThe above formula is called Dynkin formula. If we don\u2019t take conditional expectation, we\ncan write\n1\nVpt(cid:0)\u03b4,B q (cid:16) Vpt,B q(cid:0)pB Vpt,B q(cid:0) B Vpt,B qq\u03b4(cid:0)B Vpt,B qpB (cid:1)B q(cid:0)op\u03b4q.\nt(cid:0)\u03b4 t t t xx t x t t(cid:0)\u03b4 t\n2\n261 C. STOCHASTIC CALCULUS\nThen, we obtain\nN \u201a(cid:1)1 N \u201a(cid:1)1\n1\nVpT,B q (cid:16) Vp0,B q(cid:0) pB Vpt ,B q(cid:0) B Vpt ,B qq\u03b4(cid:0) B Vpt ,B qpB (cid:1)B q(cid:0)op1q.\nT 0 t i ti xx i ti x i ti ti(cid:0)1 ti\n2\ni(cid:16)0 i(cid:16)0\nwhich in the limit converges to\n\u017cT \u017cT\n1\nVpT,B q (cid:16) Vp0,B q(cid:0) pB Vpt,B q(cid:0) B Vpt,B qqdt(cid:0) B Vpt,B qdB . (C.4)\nT 0 t t xx t x t t\n2\n0 0\nIn the above, (C.4) is referred to as It\u00f4 formula.\nIn a less formal way, Ut\u00f4 formula is given by\n1\ndVpt,B q (cid:16) pB Vpt,B q(cid:0) B Vpt,B qqdt(cid:0)B Vpt,B qdB .\nt t t xx t x t t\n2\nHowever, it has to be interpreted as (C.4).\nExercise C.4. Use It\u00f4 formula to calculate dVpt,B q in the following cases.\nt\na. Vpt,xq (cid:16) eax\nb. Vpt,xq (cid:16) e(cid:1)teax\nc. Vpt,xq (cid:16) e(cid:1)tcospxq\nd. Vpt,xq (cid:16) e(cid:1)txa\nwhere a is a given constant.\nC.3 Martingale property of stochastic integral and partial differential\nequations\nWhy martingale property of stochastic integral is important? Recall the It\u00f4 formula\n1\ndVpt,B q (cid:16) pB Vpt,B q(cid:0) B Vpt,B qqdt(cid:0)B Vpt,B qdB .\nt t t xx t x t t\n2\nAssume that Vpt,xq satisfies the PDE\n1\nB Vpt,xq(cid:0) B Vpt,xq (cid:16) 0. (C.5)\nt xx\n2\nThen,\ndVpt,B q (cid:16) B Vpt,B qdB .\nt x t t\n262 C. STOCHASTIC CALCULUS\nand thus Vpt,B q is a martingale, i.e.\nt\nVpt,B q (cid:16) ErVpT,B q | B for s P r0,tss.\nt T s\nConversely, if Vpt,B q is a martingale, then Vpt,xq must satisfy the PDE (C.5).\nt\nC.4 Stochastic integral and Stochastic differential equation\nRiemann integral allows us to write a differential equation dx (cid:16) fpt,xptqq, xp0q (cid:16) x as an\ndt 0\nintegral equation\n\u017ct\nxptq (cid:16) x (cid:0) fps,xpsqqds. (C.6)\n0\n0\nIntegral equations are more general because the solution does not necessarily need to be\ndifferentiable. For instance if\n#\n1 t \u011b 1\nfpt,xq (cid:16) .\n0 t \u0103 1\nThe solution to the integral equation is xptq (cid:16) x (cid:0)pt(cid:1)1q , which is not differentiable at\n0 (cid:0)\nt (cid:16) 1. While dx (cid:16) fpt,xptqqdt should be interpreted as (C.6).\nIt\u00f4 integral allows us to define stochastic differential equations (SDE for short) in integral\nform. For example, the Black-Scholes differential equation is given by\ndS\nt\n(cid:16) rdt(cid:0)\u03c3dB .\nt\nS\nt\nThe true meaning of this term is\n\u017ct \u017ct\nS (cid:16) S (cid:0)r S du(cid:0)\u03c3 S dB .\nt 0 u u u\n0 0\nThe solution is a stochastic process S which satisfies the SDE. In the above case, it is easy\nt\nto verify, by means of It\u00f4 formula, that the geometric Brownian motion\n(cid:2) (cid:10)\n1\nS (cid:16) S exp pr(cid:1) \u03c32qt(cid:0)\u03c3B .\nt 0 t\n2\n(cid:0) (cid:8)\nTake Vpt,xq (cid:16) S exp pr(cid:1) 1\u03c32qt(cid:0)\u03c3x . It follows from It\u00f4 formula that\n0 2\n\u017ct \u017ct\n1\nVpt,B q (cid:16) Vp0,B q(cid:0) pB Vps,B q(cid:0) B Vps,B qqdt(cid:0) B Vps,B qdB .\nt 0 t s xx s x s s\n2\n0 0\nSince Vp0,xq (cid:16) S , B Vps,xq (cid:16) pr(cid:1) 1\u03c32qVps,xq, B Vps,xq (cid:16) \u03c3Vps,xq, and B Vps,xq (cid:16)\n0 t 2 x xx\n263 C. STOCHASTIC CALCULUS\n\u03c32Vps,xq, we have\n\u017ct \u017ct\nVpt,B q (cid:16) S (cid:0)r Vps,B qds(cid:0)\u03c3 Vps,B qdB .\nt 0 s s s\n0 0\nIn general for a pair of given functions \u00b5pt,xq and \u03c3pt,xq, an equation of the form\ndS (cid:16) \u00b5pt,S qdt(cid:0)\u03c3pt,S qdB (C.7)\nt t t t\nis called a stochastic differential equation (SDE). A solution S is a process such that the\nt\nLebesgue integral\n\u017ct\n\u00b5ps,S qds \u0103 8 P-a.s.,\ns\n0\nthe It\u00f4 integral\n\u017ct\n\u03c3ps,S qdB\ns s\n0\nis well-defined, and the following is satisfied:\n\u017ct \u017ct\nS (cid:16) S (cid:0) \u00b5ps,S qds(cid:0) \u03c3ps,S qdB .\nt 0 s s s\n0 0\nFor CEV model in Section ??, SDE is written as\ndS\nt rdt(cid:0)\u03c3S\u03b2dB\n(cid:16)\nS t t\nt\nor in integral form\n\u017ct \u017ct\nS (cid:16) S (cid:0)r S du(cid:0)\u03c3 S1(cid:0)\u03b2dB .\nt 0 u u u\n0 0\nOneofthemostimportantapplicationsoftheIt\u00f4sformulaisthechainruleinthestochas-\ntic form. Consider SDE\ndS (cid:16) \u00b5pt,S qdt(cid:0)\u03c3pt,S qdB (C.8)\nt t t t\nand Vpt,S q where Vpt,xq is a function one time continuously differentiable in t and twice\nt\ncontinuously differentiable on x. Then we can write\n1\nVpt(cid:0)\u03b4,S q (cid:16) Vpt,S q(cid:0)B Vpt,S q\u03b4(cid:0)B Vpt,S qpS (cid:1)S q(cid:0) B Vpt,S qpS (cid:1)S q2(cid:0)op\u03b4q.\nt(cid:0)\u03b4 t t t x t t(cid:0)\u03b4 t xx t t(cid:0)\u03b4 t\n2\nNotice that by (C.8), we have\nS (cid:1)S (cid:19) \u00b5pt,S q\u03b4(cid:0)\u03c3pt,S qpB (cid:1)B q.\nt(cid:0)\u03b4 t t t t(cid:0)\u03b4 t\n264 C. STOCHASTIC CALCULUS\nTherefore, we have\npS (cid:1)S q2 (cid:16) \u03c32pt,S qpB (cid:1)B q2(cid:0)op\u03b4q.\nt(cid:0)\u03b4 t t t(cid:0)\u03b4 t\nand\nVpt(cid:0)\u03b4,S q (cid:16) Vpt,S q(cid:0)B Vpt,S q\u03b4(cid:0)B Vpt,S qp\u00b5pt,S q\u03b4(cid:0)\u03c3pt,S qpB (cid:1)B qq\nt(cid:0)\u03b4 t t t x t t t t(cid:0)\u03b4 t\n1\n(cid:0) B Vpt,S qp\u00b5pt,S q\u03b4(cid:0)\u03c3pt,S qpB (cid:1)B qq2(cid:0)op\u03b4q\nxx t t t t(cid:0)\u03b4 t\n2\n(cid:16) Vpt,S q(cid:0)B Vpt,S q\u03b4(cid:0)B Vpt,S qp\u00b5pt,S q\u03b4(cid:0)\u03c3pt,S qpB (cid:1)B qq\nt t t x t t t t(cid:0)\u03b4 t\n1\n(cid:0) B Vpt,S q\u03c32pt,S q\u03b4(cid:0)op\u03b4q\nxx t t\n2\n1\n(cid:16) Vpt,S q(cid:0)pB Vpt,S q(cid:0)B Vpt,S q\u00b5pt,S q(cid:0) B Vpt,S q\u03c32pt,S qq\u03b4\nt t t x t t xx t t\n2\n(cid:0)\u03c3pt,S qB Vpt,S qpB (cid:1)B qq(cid:0)op\u03b4q.\nt x t t(cid:0)\u03b4 t\nOr in the integral form we have\n\u017ct(cid:1) 1 (cid:9)\nVpt,S q (cid:16)Vp0,S q(cid:0) B Vpu,S q(cid:0)B Vpu,S q\u00b5pu,S q(cid:0) B Vpu,S q\u03c32pu,S q du\nt 0 t u x u u xx u u\n2\n0\n\u017cT\n(cid:0) \u03c3pu,S qB Vpu,S qdB .\nu x u u\n0\n(C.9)\nPropositionC.1. IfthefunctionVpt,SqistwicecontinuouslydifferentiableandtVpt,S quT\nt t(cid:16)0\nis a martingale, then\n1\nB Vpt,Sq(cid:0)B Vpt,Sq\u00b5pt,Sq(cid:0) B Vpt,Sq\u03c32pt,Sq (cid:16) 0\nt x xx\n2\nfor all t P r0,Ts and S.\nProof. By the It\u00f4 formula (C.9), we have\n\u017ct(cid:1) 1 (cid:9)\nB Vpu,S q(cid:0)B Vpu,S q\u00b5pu,S q(cid:0) B Vpu,S q\u03c32pu,S q du\nt u x u u xx u u\n2\n0\n\u017cT\n(cid:16) Vpt,S q(cid:1)Vp0,S q(cid:1) \u03c3pu,S qB Vpu,S qdB .\nt 0 u x u u\n0\nSince the right-hand side is a martingale, so is the left-hand side. However, a Riemann\nintegral on the left cannot be a martingale unless\n1\nB Vpt,S q(cid:0)B Vpt,S q\u00b5pt,S q(cid:0) B Vpt,S q\u03c32pt,S q (cid:16) 0.\nt t x t t xx t t\n2\n265 C. STOCHASTIC CALCULUS\nThis is because if the above term is not zero at some time t, e.g. positive, the Riemann\nintegral becomes increasing for a short interval rt,t(cid:0)\u03b4s, which contradicts the martingale\nproperty.\nC.5 It\u00f4 calculus\nThe calculations in the previous section can be obtained from a formal calculus. First, we\nformally write (C.2) as\n1\ndVpt,B q (cid:16) B Vpt,B qdt(cid:0)B Vpt,B qdB (cid:0) B Vpt,B qpdB q2.\nt t t x t t xx t t\n2\nThen, we present (C.3) in formal form of\npdB q2 (cid:16) dt, dB dt (cid:16) dtdB (cid:16) 0 , and pdtq2 (cid:16) 0. (C.10)\nt t t\nwhich implies the It\u00f4 formula for Brownian motion.\n1\ndVpt,B q (cid:16) pB Vpt,B q(cid:0) B Vpt,B qqdt(cid:0)B Vpt,B qdB .\nt t t xx t x t t\n2\nFor the It\u00f4 formula for process S in (C.8), we can formally write\nt\n1\ndVpt,S q (cid:16) B Vpt,S qdt(cid:0)B Vpt,S qdS (cid:0) B Vpt,S qpdS q2.\nt t t x t t xx t t\n2\nThen, we use (C.10) to obtain\npdS q2 (cid:16) \u00b52pdtq2(cid:0)2\u00b5\u03c3dtdB (cid:0)\u03c32pdB q2 (cid:16) \u03c32dt.\nt t t\nThus,\n\u03c32pt,S q\nt\ndVpt,S q (cid:16) pB Vpt,S q(cid:0) B Vpt,S qqdt(cid:0)B Vpt,S qdS .\nt t t xx t x t t\n2\nTheorem C.1 (It\u00f4 formula). Consider S given by (C.8) and assume that function V is\nt\nonce continuously differentiable in t and twice continuously differentiable in x. Then, we\nhave\n\u03c32pt,S q\nt\ndVpt,S q (cid:16) pB Vpt,S q(cid:0)\u00b5pt,S qB Vpt,S q(cid:0) B Vpt,S qqdt(cid:0)\u03c3pt,S qB Vpt,S qdB .\nt t t t x t xx t t x t t\n2\nSimilar to Section C.3, we can use martingale property of stochastic integral to obtain a\nPDE. More precisely, Vpt,S q is a martingale if and only if Vpt,xq satisfies\nt\n1\nB Vpt,xq(cid:0)\u00b5pt,xqB Vpt,xq(cid:0)\u03c32pt,xq B Vpt,xq (cid:16) 0.\nt x xx\n2\n266 C. STOCHASTIC CALCULUS\nExercise C.5. Let\ndS (cid:16) S dt(cid:0)2S dB .\nt t t t\nCalculate dVpt,S q in the following cases.\nt\na. Vpt,xq (cid:16) eax\nb. Vpt,xq (cid:16) e(cid:1)teax\nc. Vpt,xq (cid:16) e(cid:1)tcospxq\nd. Vpt,xq (cid:16) e(cid:1)txa\nwhere a is a constant.\nExercise C.6. In each of the following SDE, find the PDE for the function Vpt,xq such\nthat Vpt,S q is a martingale.\nt\na. dS (cid:16) \u03c3dB where \u03c3 is constants.\nt t\nb. dS (cid:16) \u03bapm(cid:1)S qdt(cid:0)\u03c3dB where \u03ba, m and \u03c3 are constants.\nt t t\n?\nc. dS (cid:16) \u03bapm(cid:1)S qdt(cid:0)\u03c3 S dB where \u03ba, m and \u03c3 are constants.\nt t t t\nd. dS (cid:16) rS dt(cid:0)\u03c3S2dB where r and \u03c3 are constants.\nt t t t\nExercise C.7. Consider the SDE\ndS (cid:16) rS dt(cid:0)\u03c3S dB where r and \u03c3 are constants.\nt t t t\na. Find the ODE for the function Vpxq such that e(cid:1)rtVpS q is a martingale.\nt\nb. Find all the solutions to the ODE in (a).\n267 C. STOCHASTIC CALCULUS\n268 BIBLIOGRAPHY BIBLIOGRAPHY\nBibliography\n[1] M. R. Adams and V. Guillemin, Measure theory and probability, Springer, 1996.\n[2] L. Bachelier, Th\u00e9orie de la sp\u00e9culation, Gauthier-Villars, 1900.\n[3] D.P.BertsekasandS.E.Shreve,Stochastic optimal control: the discrete time case,\nMathematics in Science and Engineering, Elsevier, Burlington, MA, 1978.\n[4] P. Billingsley, Probability and measure, John Wiley & Sons, 2008.\n[5] F. Black and M. Scholes, The pricing of options and corporate liabilities, The\njournal of political economy, (1973), pp. 637\u2013654.\n[6] B. Bouchard, M. Nutz, et al., Arbitrage and duality in nondominated\ndiscrete-time models, The Annals of Applied Probability, 25 (2015), pp. 823\u2013859.\n[7] B. Bouchard and X. Warin, Monte-carlo valuation of american options: facts\nand new algorithms to improve existing methods, in Numerical methods in finance,\nSpringer, 2012, pp. 215\u2013255.\n[8] S. P. Boyd and L. Vandenberghe, Convex optimization (pdf), Np: Cambridge\nUP, (2004).\n[9] F. Delbaen and W. Schachermayer, A general version of the fundamental\ntheorem of asset pricing, Mathematische Annalen, 300 (1994), pp. 463\u2013520.\n[10] R. Durrett, Probability. theory and examples. the wadsworth & brooks/cole\nstatistics/probability series, Wadsworth & Brooks/Cole Advanced Books & Software,\nPacific Grove, CA, (1991).\n[11] L. Eisenberg and T. H. Noe, Systemic risk in financial systems, Management\nScience, 47 (2001), pp. 236\u2013249.\n[12] A. Fahim, N. Touzi, and X. Warin, A probabilistic numerical method for fully\nnonlinear parabolic pdes, The Annals of Applied Probability, (2011), pp. 1322\u20131364.\n269 BIBLIOGRAPHY BIBLIOGRAPHY\n[13] H. F\u00f6llmer and A. Schied, Stochastic finance: an introduction in discrete time,\nWalter de Gruyter, 2011.\n[14] J. Franke, W. K. H\u00e4rdle, and C. M. Hafner, Statistics of financial markets,\nvol. 2, Springer, 2004.\n[15] P. Glasserman, Monte Carlo methods in financial engineering, vol. 53, Springer\nScience & Business Media, 2003.\n[16] J. Hull, Options, FuturesandOtherDerivatives, Options, FuturesandOtherDeriva-\ntives, Pearson/Prentice Hall, 2015.\n[17] I. Karatzas and S. Shreve, Brownian motion and stochastic calculus, vol. 113,\nSpringer Science & Business Media, 2012.\n[18] P.-S. Laplace, Essai philosophique sur les probabilit\u00e9s, H. Remy, 1829.\n[19] F. A. Longstaff and E. S. Schwartz, Valuing american options by simulation: a\nsimple least-squares approach, Review of Financial studies, 14 (2001), pp. 113\u2013147.\n[20] H. Markowitz, Portfolio selection, The journal of finance, 7 (1952), pp. 77\u201391.\n[21] R. C. Merton, An analytic derivation of the efficient portfolio frontier, Journal of\nfinancial and quantitative analysis, 7 (1972), pp. 1851\u20131872.\n[22] , Theory of rational option pricing, The Bell Journal of economics and manage-\nment science, (1973), pp. 141\u2013183.\n[23] B. Oksendal, Stochastic differential equations: an introduction with applications,\nSpringer Science & Business Media, 2013.\n[24] G. Peskir and A. Shiryaev, Optimal stopping and free-boundary problems,\nSpringer, 2006.\n[25] P. Protter, A partial introduction to financial asset pricing theory, Stochastic pro-\ncesses and their applications, 91 (2001), pp. 169\u2013203.\n[26] W. Schachermayer and J. Teichmann, How close are the option pricing formulas\nof bachelier and black\u2013merton\u2013scholes?, Mathematical Finance, 18 (2008), pp. 155\u2013\n170.\n[27] S.Shreve,StochasticcalculusforfinanceI:thebinomialassetpricingmodel,Springer\nScience & Business Media, 2012.\n[28] S. E. Shreve, Stochastic calculus for finance II: Continuous-time models, vol. 11,\nSpringer Science & Business Media, 2004.\n270 BIBLIOGRAPHY BIBLIOGRAPHY\n[29] M. S. Taqqu, Bachelier and his times: a conversation with bernard bru, Finance and\nStochastics, 5 (2001), pp. 3\u201332.\n[30] N. Touzi and P. Tankov, No-arbitrage theory for derivative pricing, Cours de\nl\u2019Ecole polytechnique, (2008).\n[31] D. Williams, Probability with martingales, Cambridge university press, 1991.\n271 INDEX INDEX\nIndex\na.s., see almost surely principle, 14\nABC, 120 sovereign, 16\nalmost surely, 103 yield, 15\narbitrage Brownian motion, 104\narbitrage bounds, 36\ncalibration, 93\nmodel-independent arbitrage, 36\nbinomial model\nno weak arbitrage condition, 41\nphysical probability, 94\nstrong arbitrage, 41\nrisk-neutral probability, 98\nweak arbitrage, 36, 41\ncanonoical mapping, 66\nArrow-Debreu model, 39\nCDO, seecollateralized debt obligation24\nartificial boundary conditions, see ABC\ncollateral portfolio, 24\nasset, 1\ntrenches, 24\nliquid, 1\nequity, 24\nreturn, 28\njunior, 24\nrealized, 45\nmezzanine, 24\nrisk-free, 1\nsenior, 24\nrisky, 1\ncentralcounterpartyclearinghouse(CCP),4\nunderlying, 2, 10\nclearing payment, 8\ncollateralized debt obligation, 24\nBachelier model, 104\ncommodity, 1\nbackwardation, 7\ncomputational domain, 120\nbinomial model, 75\ncontango, 7\nBlack-Scholes equation, 157\ncontingent claim, 56\nBlack-Scholes model, 135\nEuropean, see Markovion82\nbond, 14\nMarkovion, 82\nconvexity, 20\ncontinuouslycompoundedrate,seeshortrate\ncorporate, 16\ncredit risk, 2\ncoupon, 15\ncoupon-carrying, 15 debt, 1\nduration, 19 Delta, 85\nface value, 14 derivative, 1\nmaturity, 14 maturity, 2\npresent value, 14 payoff, 4\n272 INDEX INDEX\ndividend yield, 90 complete, 57\nincomplete, 57\nEisenberg-Noe model, 7\nmartingale, 72\nelementary securities, 48\nmaturity, 2\nequity, 1\nMonte Carlo method, 126\nfinancial risk, 2\nno weak arbitrage condition, 41\nfinancial security, 1\nno-dominance principle, 33\nfixed point, 8\nfixed-income, 1 option, 10\nmaturity, 1 American, 14, 167\nfixed-income security, 14 call, 14, 182\nforward contract, 2 continuation value, 173\nlong position, 2 exercise value, 173\nshort position, 2 put, 14, 182\nforward price, 3 straddle, 182\nforward rate, 16 asian, 137\ninstantaneous, 17 at-the-money, 10\nforward rate agreement, 17 basket option, 36\nfree boundary problem, 179 call, 10\nFTAP, 104 digital, 107\nfundamental theorem of asset pricing, see call, 107\nFTAP put, 107\nfutures contract, 2 European, 11\nfutures prices, 3 in-the-money, 10\nlong position, 11\nGBM, 135\nlook-back, 137\ngeometric Brownian motion, see GBM\noutof-the-money, 10\nGreeks, 140\nput, 10\nDelta, 142\nshort position, 11\nGamma, 142\nvanilla, 10\nTheta, 142\npayoff\nheat equation\nBear-spread call, 148\nbackward, 111\nBull-spread call, 148\nforward, 111\nEuropean, 11\nhedging\npath-dependent, 87\nDelta, 85, 137\nstraddle, 148\nstrangle, 148\ninstantaneous rate, see short rate\npayoff function, see payoff\nmarginal account, 4 polar collection, 71\nmarket polar sets, 71\n273 INDEX INDEX\ngenerated, 73 diffusion, 101\nportfolio, 28, 41 Markovian, 78\nof bonds, 15 strike price, 10\nadmissible, 74 subprime rating, 21\ncollateral portfolio, 24 superreplication, 58\nefficient portfolio, 28 superreplication price, 58\ninvestment portfolio, 28 survival rate, 21\nlong position, 41\nunderlying, see asset2\nof defaultable assets, 24\nreplicating, 52\nvolatility, 94\nself-financing, 66\nshort position, 41 weak convergence\npricing model, 58 binomial to GBM, 129\nprime rating, 21\nyield\nquadrature method, 126\nrisk-adjusted yield, 22\nrate of return, 94\nzero bond, see zero-coupon bond\nreplication\nmaturity, 14\nperfect, 58\nprinciple, 14\nreturn\nzero-coupon bond, 14\nArithmetic, 93\nlogarithmic, 93\nrisk\nmarket, 2\nmodel risk, 58\noperational, 2\nsystemic, 2, 25\nrisk premium, 96\nrisk-adjusted probability\nrisk-neutral probability, 42\nrisk-neutral probability, 42, 58\nsample path, 65\nsecurity, 1\nshort rate, 15\nshort selling, 34\nSnell envelope, 176\nspot price, 3\nspot rate, see short rate\nstate-price deflator, 47\nstochastic process, 64\n274"
}