{
    "text": "The Zakon Series on Mathematical Analysis\nBasic Concepts of Mathematics\nMathematical Analysis I\nMathematical Analysis II\n9 781931 705035  The Zakon Series on Mathematical Analysis\nMathematical\nAnalysis\nVolume II\nElias Zakon\nUniversity of Windsor\nThe Trillia Group West Lafayette, IN Copyright Notice\nMathematical Analysis II\nc 1977 Elias Zakon\n(cid:13)\nc 2009 Bradley J. Lucier and Tamara Zakon\n(cid:13)\nChapter6isdistributedunderaCreativeCommonsAttribution3.0Unported(CC BY 3.0)\nlicense made possible by funding from The Saylor Foundation in order to be incorporated\ninto Saylor.org\u2019s collection of open courses available at http://www.saylor.org. Informally,\nthis license allows you to:\nShare: copy and redistribute the material in any medium or format\nAdapt: remix, transform, and build upon the material\nfor any purpose, even commercially, under the following conditions:\nAttribution: You must give appropriate credit, provide a link to the license, and\nindicate if changes were made. You may do so in any reasonable manner, but not in\nany way that suggests the licensor endorses you or your use.\nNo additional restrictions: You may not apply legal terms or technological mea-\nsures that legally restrict others from doing anything the license permits.\nFull license terms are at: http://creativecommons.org/licenses/by/3.0/legalcode.\nChapters 7 to 9 are distributed under a Creative Commons Attribution-NonCommercial-\nNoDerivatives4.0International(CC BY-NC-ND 4.0)PublicLicense. Informally,thislicense\nallows you to:\nShare: copy and redistribute the material in any medium or format\nunder the following conditions:\nAttribution: You must give appropriate credit, provide a link to the license, and\nindicate if changes were made. You may do so in any reasonable manner, but not in\nany way that suggests the licensor endorses you or your use.\nNonCommercial: You may not use the material for commercial purposes.\nNoDerivatives: If you remix, transform, or build upon the material, you may not\ndistribute the modified material.\nNo additional restrictions: You may not apply legal terms or technological mea-\nsures that legally restrict others from doing anything the license permits.\nFulllicensetermsareat: http://creativecommons.org/licenses/by-nc-nd/4.0/legalcode.\nIf you would like more rights to this work (e.g., commercial publication rights or including\nparts of this work in another work, etc.), please contact the publisher.\nPublished by The Trillia Group, West Lafayette, Indiana, USA\nISBN 978-1-931705-03-8\nFirst published: December 18, 2009. This version released: May 11, 2017.\nTechnical Typist: Betty Gick. Copy Editor: John Spiegelman. Logo: Miriam Bogdanic.\nThe phrase \u201cThe Trillia Group\u201d and the Trillia Group logo are trademarks of The Trillia\nGroup and may not be used without permission.\nThis book was prepared by Bradley J. Lucier and Tamara Zakon from a manuscript\npreparedbyEliasZakon. Weintendtocorrectandupdatethisworkasneeded. Ifyounotice\nany mistakes in this work, please send e-mail to lucier@math.purdue.edu and they will be\ncorrected in a later version. Contents\u2217\nPreface ix\nAbout the Author xi\nn\nChapter 6. Differentiation on E and Other Normed Linear Spaces 1\n1. Directional and Partial Derivatives ................................... 1\nProblems on Directional and Partial Derivatives....................6\n2. Linear Maps and Functionals. Matrices...............................7\nProblems on Linear Maps and Matrices ........................... 14\n3. Differentiable Functions.............................................16\nProblems on Differentiable Functions..............................25\n4. The Chain Rule. The Cauchy Invariant Rule ........................ 28\nFurther Problems on Differentiable Functions......................33\n5. Repeated Differentiation. Taylor\u2019s Theorem ......................... 35\nProblems on Repeated Differentiation and Taylor Expansions......44\n6. Determinants. Jacobians. Bijective Linear Operators ................ 47\nProblems on Bijective Linear Maps and Jacobians.................55\n7. Inverse and Implicit Functions. Open and Closed Maps..............57\nProblems on Inverse and Implicit Functions,\nOpen and Closed Maps ........................................... 67\n8. Baire Categories. More on Linear Maps ............................. 70\nProblems on Baire Categories and Linear Maps....................76\n9. Local Extrema. Maxima and Minima................................79\nProblems on Maxima and Minima.................................84\n10. More on Implicit Differentiation. Conditional Extrema...............87\nFurther Problems on Maxima and Minima ........................ 94\nChapter 7. Volume and Measure 97\n1. More on Intervals in En. Semirings of Sets .......................... 97\nProblems on Intervals and Semirings.............................104\n2. -Sets. Countable Additivity. Permutable Series...................104\n\u03c3\nC\nProblems on -Sets, \u03c3-Additivity, and Permutable Series........112\n\u03c3\nC\n\u201cStarred\u201d sections may be omitted by beginners.\n\u2217 vi Contents\n3. More on Set Families...............................................115\nProblems on Set Families ........................................ 121\n4. Set Functions. Additivity. Continuity .............................. 124\nProblems on Set Functions.......................................133\n5. Nonnegative Set functions. Premeasures. Outer Measures...........136\nProblems on Premeasures and Related Topics....................141\n6. Measure Spaces. More on Outer Measures..........................147\nProblems on Measures and Outer Measures ...................... 155\n7. Topologies. Borel Sets. Borel Measures.............................160\nProblems on Topologies, Borel Sets, and Regular Measures.......165\n8. Lebesgue Measure..................................................168\nProblems on Lebesgue Measure.................................. 172\n9. Lebesgue\u2013Stieltjes Measures........................................176\nProblems on Lebesgue\u2013Stieltjes Measures ........................ 178\n10. Vitali Coverings....................................................180\nProblems on Vitali Coverings .................................... 190\n11. Generalized Measures. Absolute Continuity.........................194\nProblems on Generalized Measures...............................206\n12. Differentiation of Set Functions.....................................210\nProblems on Differentiation of Set Functions .....................215\nChapter 8. Measurable Functions. Integration 217\n1. Elementary and Measurable Functions..............................217\nProblems on Measurable and Elementary Functions in (S, )....222\nM\n2. Measurability of Extended-Real Functions..........................224\nFurther Problems on Measurable Functions in (S, ) ............ 229\nM\n3. Measurable Functions in (S, ,m).................................231\nM\nProblems on Measurable Functions in (S, ,m)..................238\nM\n4. Integration of Elementary Functions................................241\nProblems on Integration of Elementary Functions ................ 248\n5. Integration of Extended-Real Functions.............................251\nProblems on Integration of Extended-Real Functions.............265\n6. Integrable Functions. Convergence Theorems.......................267\nProblems on Integrability and Convergence Theorems ............277\n7. Integration of Complex and Vector-Valued Functions ............... 283\nProblems on Integration of Complex and Vector-Valued Functions291\n8. Product Measures. Iterated Integrals...............................293\nProblems on Product Measures and Fubini Theorems.............302 Contents vii\n9. Riemann Integration. Stieltjes Integrals ............................ 306\nProblems on Riemann and Stieltjes Integrals.....................319\n10. Integration in Generalized Measure Spaces..........................323\nProblems on Generalized Integration.............................333\n11. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition...........336\nProblems on Radon\u2013Nikodym Derivatives and\nLebesgue Decomposition.........................................344\n12. Integration and Differentiation ..................................... 345\nProblems on Differentiation and Related Topics ..................354\nChapter 9. Calculus Using Lebesgue Theory 357\n1. L-Integrals and Antiderivatives.....................................357\nProblems on L-Integrals and Antiderivatives......................367\n2. More on L-Integrals and Absolute Continuity.......................372\nProblems on L-Integrals and Absolute Continuity ................ 384\n3. Improper (Cauchy) Integrals ....................................... 387\nProblems on Cauchy Integrals....................................397\n4. Convergence of Parametrized Integrals and Functions...............402\nProblems on Uniform Convergence of Functions and C-Integrals..412\nIndex 417  Preface\nThis is a multipurpose text. When taken in full, including the \u201cstarred\u201d sec-\ntions, it is a graduate course covering differentiation on normed spaces and\nintegration with respect to complex and vector-valued measures. The starred\nsections may be omitted without loss of continuity, however, for a junior or\nsenior course. One also has the option of limiting all to En, or taking Riemann\nintegration before Lebesgue theory (we call it the \u201climited approach\u201d). The\nproofs and definitions are so chosen that they are as simple in the general case\nas in the more special cases. In a nutshell, the basic ideas of measure theory\nare given in Chapter 7, 1 and 2. Not much more is needed for the \u201climited\n\u00a7\u00a7\napproach.\u201d\nIn Chapter 6 (Differentiation), we have endeavored to present a modern\ntheory, without losing contact with the classical terminology and notation.\n(Otherwise, the student is unable to read classical texts after having been\ntaughtthe\u201celegant\u201dmoderntheory.) Thisiswhyweprefertodefinederivatives\nas in classical analysis, i.e., as numbers or vectors, not as linear mappings. The\nlatter are used to define a modern version of differentials.\nIn Chapter 9, we single out those calculus topics (e.g., improper integrals)\nthat are best treated in the context of Lebesgue theory.\nOur principle is to keep the exposition more general whenever the general\ncase can be handled as simply as the special ones (the degree of the desired\nspecialization is left to the instructor). Often this even simplifies matters\u2014\nfor example, by considering normed spaces instead of En only, one avoids\ncumbersome coordinate techniques. Doing so also makes the text more flexible.\nPublisher\u2019s Notes\nText passages in blue are hyperlinks to other parts of the text.\nSeveral annotations are used throughout this book:\n\u2217 This symbol marks material that can be omitted at first reading.\n\u21d2 This symbol marks exercises that are of particular importance.  About the Author\nElias Zakon was born in Russia under the czar in 1908, and he was swept\nalong in the turbulence of the great events of twentieth-century Europe.\nZakon studied mathematics and law in Germany and Poland, and later he\njoined his father\u2019s law practice in Poland. Fleeing the approach of the German\nArmy in 1941, he took his family to Barnaul, Siberia, where, with the rest of\nthe populace, they endured five years of hardship. The Leningrad Institute of\nTechnology was also evacuated to Barnaul upon the siege of Leningrad, and\nthere Zakon met the mathematician I. P. Natanson; with Natanson\u2019s encour-\nagement, Zakon again took up his studies and research in mathematics.\nZakon and his family spent the years from 1946 to 1949 in a refugee camp\nin Salzburg, Austria, where he taught himself Hebrew, one of the six or seven\nlanguages in which he became fluent. In 1949, he took his family to the newly\ncreated state of Israel and he taught at the Technion in Haifa until 1956. In\nIsrael he published his first research papers in logic and analysis.\nThroughout his life, Zakon maintained a love of music, art, politics, history,\nlaw, and especially chess; it was in Israel that he achieved the rank of chess\nmaster.\nIn 1956, Zakon moved to Canada. As a research fellow at the University of\nToronto, heworkedwith AbrahamRobinson. In1957, hejoinedthemathemat-\nics faculty at the University of Windsor, where the first degrees in the newly\nestablished Honours program in Mathematics were awarded in 1960. While\nat Windsor, he continued publishing his research results in logic and analysis.\nIn this post-McCarthy era, he often had as his house-guest the prolific and\neccentric mathematician Paul Erd\u02ddos, who was then banned from the United\nStates for his political views. Erd\u02ddos would speak at the University of Windsor,\nwhere mathematicians from the University of Michigan and other American\nuniversities would gather to hear him and to discuss mathematics.\nWhileatWindsor,Zakondevelopedthreevolumesonmathematicalanalysis,\nwhich were bound and distributed to students. His goal was to introduce\nrigorous material as early as possible; later courses could then rely on this\nmaterial. We are publishing here the latest complete version of the last of\nthese volumes, which was used in a two-semester class required of all Honours\nMathematics students at Windsor.  Chapter 6\nn\nDifferentiation on E and Other\nNormed Linear Spaces\n\u00a71. Directional and Partial Derivatives\nIn Chapter 5 we considered functions f: E1 E of one real variable.\n\u2192\nNow we take up functions f: E\u2032 E where both E\u2032 and E are normed\n\u2192\nspaces.1\nThe scalar field of both is always assumed the same: E1 or C (the complex\nfield). The case E = E\u2217 is excluded here; thus all is assumed finite.\nWe mostly use arrowed letters p~,~q,...,~x,~y,~z for vectors in the domain space\nE\u2032, and nonarrowed letters for those in E and for scalars.\nAs before, we adopt the convention that f is defined on all of E\u2032, with\nf(~x) = 0 if not defined otherwise.\nNote that, if p~ E\u2032, one can express any point ~x E\u2032 as\n\u2208 \u2208\n~x = p~ +t~u,\nwith t E1 and ~u a unit vector. For if ~x = p~, set\n\u2208 6\n1\nt = ~x p~ and ~u = (~x p~);\n| \u2212 | t \u2212\nand if ~x = p~, set t = 0, and any ~u will do. We often use the notation\n~t = \u2206~x = ~x p~ = t~u (t E1, ~t ,~u E\u2032).\n\u2212 \u2208 \u2208\nFirst of all, we generalize Definition 1 in Chapter 5, 1.\n\u00a7\nDefinition 1.\nGiven f: E\u2032 E and p~,~u E\u2032 (~u = ~0), we define the directional\n\u2192 \u2208 6\nderivative of f along ~u (or ~u-directed derivative of f) at p~ by\n1\n(1) D f(p~) = lim [f(p~ +t~u) f(p~)],\nu~\nt\u21920 t \u2212\n1We now presuppose 9\u201312 of Chapter 3, including the \u201cstarred\u201d parts.\n\u00a7\u00a7 2 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nif this limit exists in E (finite).\nWe also define the ~u-directed derived function,\nD f: E\u2032 E,\nu~\n\u2192\nas follows. For any p~ E\u2032,\n\u2208\n1\nlim [f(p~ +t~u) f(p~)] if this limit exists,\nD ~uf(p~) = t\u21920 t \u2212\n( 0 otherwise.\nThus D f is always defined, but the name derivative is used only if the\n~u\nlimit (1) exists (finite). If it exists for each p~ in a set B E\u2032, we call D f (in\nu~\n\u2286\nclassical notation \u2202f/\u2202~u) the ~u-directed derivative of f on B.\nNote that, as t 0, ~x tends to p~ over the line ~x = p~ +t~u. Thus D f(p~)\nu~\n\u2192\ncan be treated as a relative limit over that line. Observe that it depends on\nboth the direction and the length of ~u. Indeed, we have the following result.\nCorollary 1. Given f: E\u2032 E, ~u =~0, and a scalar s = 0, we have\n\u2192 6 6\nD f = sD f.\nsu~ u~\nMoreover, D f(p~) is a genuine derivative iff D f(p~) is.\ns~u u~\nProof. Set t = s\u03b8 in (1) to get\n1\nsD f(p~) = lim [f(p~ +\u03b8s~u) f(p~)] = D f(p~). (cid:3)\n~u su~\n\u03b8\u21920 \u03b8 \u2212\nIn particular, taking s = 1/ ~u , we have\n| |\n~u 1\ns~u = | | = 1 and D f = D f.\nu~ su~\n| | ~u s\n| |\nThus all reduces to the case D f, where ~v = s~u is a unit vector. This device,\n~v\ncalled normalization, is often used, but actually it does not simplify matters.\nIf E\u2032 = En (Cn), then f is a function of n scalar variables x (k = 1,...,n)\nk\nand E\u2032 has the n basic unit vectors ~e . This example leads us to the following\nk\ndefinition.\nDefinition 2.\nIf in formula (1), E\u2032 = En (Cn) and ~u = ~e for a fixed k n, we call\nk\n\u2264\nD f the partially derived function for f, with respect to x , denoted\n~u k\n\u2202f\nD f or ,\nk\n\u2202x\nk 1. Directional and Partial Derivatives 3\n\u00a7\nand the limit (1) is called the partial derivative of f at p~, with respect to\nx , denoted\nk\n\u2202 \u2202f\nD f(p~), or f(p~), or .\nk\n\u2202x k \u2202x k ~x=p~\n(cid:12)\n(cid:12)\nIf it exists for all p~ B, we call D kf the(cid:12)partial derivative (briefly,\n\u2208\npartial) of f on B, with respect to x .\nk\nIn any case, the derived functions D f (k = 1,...,n) are always de-\nk\nfined on all of En (Cn).\nIf E\u2032 = E3 (C3), we often write x,y,z for x ,x ,x , and\n1 2 3\n\u2202f \u2202f \u2202f\n, , for D f (k = 1,2,3).2\nk\n\u2202x \u2202y \u2202z\nNote 1. If E\u2032 = E1, scalars are also \u201cvectors,\u201d and D f coincides with f\u2032\n1\nas defined in Chapter 5, 1 (except where f\u2032 = ). Explain!\n\u00a7 \u00b1\u221e\nNote 2. As we have observed, the ~u-directed derivative (1) is obtained by\nkeeping ~x on the line ~x = p~ +t~u.\nIf ~u =~e , the line is parallel to the kth axis; so all coordinates of ~x, except\nk\nx , remain fixed (x = p , i = k), and f behaves like a function of one variable,\nk i i\n6\nx . Thus we can compute D f by the usual rules of differentiation, treating\nk k\nall x (i = k) as constants and x as the only variable.\ni k\n6\nFor example, let f(x,y) = x2y. Then\n\u2202f \u2202f\n= D f(x,y) = 2xy and = D f(x,y) = x2.\n1 2\n\u2202x \u2202y\nNote 3. More generally, given p~ and ~u =~0, set\n6\nh(t) = f(p~ +t~u), t E1.\n\u2208\nThen h(0) = f(p~); so\n1\nD f(p~) = lim [f(p~ +t~u) f(p~)]\nu~\nt\u21920 t \u2212\nh(t) h(0)\n= lim \u2212\nt\u21920 t 0\n\u2212\n= h\u2032(0)\nif the limit exists. Thus all reduces to a function h of one real variable.\nFor functions f: E1 E, the existence of a finite derivative (\u201cdifferentia-\n\u2192\nbility\u201d) at p implies continuity at p (Theorem 1 of Chapter 5, 1). But in the\n\u00a7\ngeneral case, f: E\u2032 E, this may fail even if D f(p~) exists for all ~u =~0.\nu~\n\u2192 6\n2Similarly in the case E =E2 (C2).\n\u2032 4 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nExamples.\n(a) Define f: E2 E1 by\n\u2192\nx2y\nf(x,y) = , f(0,0) = 0.\nx4 +y2\nFix a unit vector ~u = (u ,u ) in E2. Let p~ = (0,0). To find D f(p), use\n1 2 u~\nthe h of Note 3:\ntu2u\nh(t) = f(p~ +t~u) = f(t~u) = f(tu ,tu ) = 1 2 if u = 0,\n1 2 t2u4 +u2 2 6\n1 2\nand h = 0 if u = 0. Hence\n2\nu2\nD f(p~) = h\u2032(0) = 1 if u = 0,\nu~ 2\nu 6\n2\nand h\u2032(0) = 0 if u = 0. Thus D (~0) exists for all ~u. Yet f is discontin-\n2 u~\nuous at ~0 (see Problem 9 in Chapter 4, 3).\n\u00a7\n(b) Let\nx+y if xy = 0,\nf(x,y) =\n1 otherwise.\n(cid:26)\nThen f(x,y) = x on the x-axis; so D f(0,0) = 1.\n1\nSimilarly, D f(0,0) = 1. Thus both partials exist at ~0.\n2\nYet f is discontinuous at ~0 (even relatively so) over any line y = ax\n(a = 0). For on that line, f(x,y) = 1 if (x,y) = (0,0); so f(x,y) 1;\n6 6 \u2192\nbut f(0,0) = 0+0 = 0.\nThus continuity at ~0 fails. (But see Theorem 1 below!)\nHence, if differentiability is to imply continuity, it must be defined in a\nstronger manner. We do it in 3. For now, we prove only some theorems on\n\u00a7\npartial and directional derivatives, based on those of Chapter 5.\nTheorem 1. If f: E\u2032 E has a ~u-directed derivative at p~ E\u2032, then f is\n\u2192 \u2208\nrelatively continuous at p~ over the line\n~x = p~ +t~u (~0 = ~u E\u2032).\n6 \u2208\nProof. Set h(t) = f(p~ +t~u), t E1.\n\u2208\nBy Note 3, our assumption implies that h (a function on E1) is differentiable\nat 0.\nBy Theorem 1 in Chapter 5, 1, then, h is continuous at 0; so\n\u00a7\nlimh(t) = h(0) = f(p~),\nt\u21920 1. Directional and Partial Derivatives 5\n\u00a7\ni.e.,\nlimf(p~ +t~u) = f(p~).\nt\u21920\nBut this means that f(~x) f(p~) as ~x p~ over the line ~x = p~ +t~u, for, on\n\u2192 \u2192\nthat line, ~x = p~ +t~u.\nThus, indeed, f is relatively continuous at p~, as stated. (cid:3)\nNote that we actually used the substitution ~x = p~ + t~u. This is admissi-\nble since the dependence between x and t is one-to-tone (Corollary 2(iii) of\nChapter 4, 2). Why?\n\u00a7\nTheorem 2. Let E\u2032 ~u = ~q p~, ~u =~0.\n\u220b \u2212 6\nIf f: E\u2032 E is relatively continuous on the segment I = L[p~,~q] and has a\n\u2192\n~u-directed derivative on I Q (Q countable), then\n\u2212\n(2) f(~q) f(p~) sup D f(~x) , ~x I Q.\nu~\n| \u2212 | \u2264 | | \u2208 \u2212\nProof. Set again h(t) = f(p~ +t~u) and g(t) = p~ +t~u.\nThen h = f g, and g is continuous on E1. (Why?)\n\u25e6\nAs f is relatively continuous on I = L[p~,~q], so is h = f g on the interval\n\u25e6\nJ = [0,1] E1 (cf. Chapter 4, 8, Example (1)).\n\u2282 \u00a7\nNow fix t J. If ~x = p~ + t ~u I Q, our assumptions imply the\n0 0 0\n\u2208 \u2208 \u2212\nexistence of\n1\nD f(~x ) = lim [f(~x +t~u) f(~x )]\n~u 0 0 0\nt\u21920 t \u2212\n1\n= lim [f(p~ +t ~u +t~u) f(p~ +t ~u)]\n0 0\nt\u21920 t \u2212\n1\n= lim [h(t +t) h(t )]\n0 0\nt\u21920 t \u2212\n= h\u2032(t ). (Explain!)\n0\nThis can fail for at most a countable set Q\u2032 of points t J (those for which\n0\n\u2208\n~x Q).\n0\n\u2208\nThus h is differentiable on J Q\u2032; and so, by Corollary 1 in Chapter 5, 4,\n\u2212 \u00a7\nh(1) h(0) sup h\u2032(t) = sup D f(~x) .\nu~\n| \u2212 | \u2264 t\u2208J\u2212Q\u2032| | ~x\u2208I\u2212Q| |\nNow as h(1) = f(p~ +~u) = f(~q) and h(~0) = f(p~), formula (2) follows. (cid:3)\nTheorem 3. If in Theorem 2, E = E1 and if f has a ~u-directed derivative at\nleast on the open line segment L(p~,~q), then\n(3) f(~q) f(p~) = D f(~x )\nu~ 0\n\u2212\nfor some ~x L(p~,~q).\n0\n\u2208 6 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nThe proof is as in Theorem 2, based on Corollary 3 in Chapter 5, 2 (instead\n\u00a7\nof Corollary 1 in Chapter 5, 4).\n\u00a7\nTheorems 2 and 3 are often used in \u201cnormalized\u201d form, as follows.\nCorollary 2. If in Theorems 2 and 3, we set\n1\nr = ~u = ~q p~ = 0 and ~v = ~u,\n| | | \u2212 | 6 r\nthen formulas (2) and (3) can be written as\n(2\u2032) f(~q) f(p~) ~q p~ sup D f(~x) , ~x I Q,\n~v\n| \u2212 | \u2264 | \u2212 | | | \u2208 \u2212\nand\n(3\u2032) f(~q) f(p~) = ~q p~ D f(~x )\n~v 0\n\u2212 | \u2212 |\nfor some ~x L(p~,~q).\n0\n\u2208\nFor by Corollary 1,\nD f = rD f = ~q p~ D f;\nu~ ~v ~v\n| \u2212 |\nso (2\u2032) and (3\u2032) follow.\nProblems on Directional and Partial Derivatives\n1. Complete all missing details in the proof of Theorems 1 to 3 and Corol-\nlaries 1 and 2.\n2. Complete all details in Examples (a) and (b). Find D f(p~) and D f(p~)\n1 2\nalso for p~ = 0. Do Example (b) in two ways: (i) use Note 3; (ii) use\n6\nDefinition 2 only.\n3. In Examples (a) and (b) describe D f: E2 E1. Compute it for\nu~\n\u2192\n~u = (1,1) = p~.\nIn (b), show that f has no directional derivatives D f(p~) except if\nu~\n~u ~e or ~u ~e . Give two proofs: (i) use Theorem 1; (ii) use definitions\n1 2\nk k\nonly.\n4. Prove that if f: En(Cn) E has a zero partial derivative, D f = 0,\nk\n\u2192\non a convex set A, then f(~x) does not depend on x , for ~x A. (Use\nk\n\u2208\nTheorems 1 and 2.)\n5. Describe D f and D f on the various parts of E2, and discuss the\n1 2\nrelative continuity of f over lines through ~0, given that f(x,y) equals:\nxy\n(i) ; (ii) the integral part of x+y;\nx2 +y2\nxy 1 x2 y2\n(iii) +xsin ; (iv) xy \u2212 ;\nx y x2 +y2\n| |\n(v) sin(ycosx); (vi) xy. 1. Directional and Partial Derivatives 7\n\u00a7\n(Set f = 0 wherever the formula makes no sense.)\n\u21d26. Prove that if f: E\u2032 E1 has a local maximum or minimum at p~ E\u2032,\n\u2192 \u2208\nthen D f(p~) = 0 for every vector ~u =~0 in E\u2032.\n~u\n6\n[Hint: Use Note 3, then Corollary 1 in Chapter 5, 2.]\n\u00a7\n7. State and prove the Finite Increments Law (Theorem 1 of Chapter 5,\n4) for directional derivatives.\n\u00a7\n[Hint: Imitate Theorem 2 using two auxiliary functions, h and k.]\n8. State and prove Theorems 4 and 5 of Chapter 5, 1, for directional\n\u00a7\nderivatives.\n\u00a72. Linear Maps and Functionals. Matrices\nFor an adequate definition of differentiability, we need the notion of a linear\nmap. Below, E\u2032, E\u2032\u2032, and E denote normed spaces over the same scalar field,\nE1 or C.\nDefinition 1.\nA function f: E\u2032 E is a linear map if and only if for all ~x,~y E\u2032 and\n\u2192 \u2208\nscalars a,b\n(1) f(a~x +b~y) = af(~x)+bf(~y);\nequivalently, iff for all such ~x, ~y, and a\nf(~x +~y) = f(x)+f(y) and f(a~x) = af(~x). (Verify!)\nIf E = E\u2032, such a map is also called a linear operator.\nIf the range space E is the scalar field of E\u2032, (i.e., E1 or C,) the linear\nmap f is also called a (real or complex) linear functional on E\u2032.\nNote 1. Induction extends formula (1) to any \u201clinear combinations\u201d:\nm m\n(2) f a ~x = a f(~x )\ni i i i\n(cid:18)i=1 (cid:19) i=1\nX X\nfor all ~x E\u2032 and scalars a .\ni i\n\u2208\nBriefly: A linear map f preserves linear combinations.\nNote 2. Taking a = b = 0 in (1), we obtain f(~0) = 0 if f is linear.\nExamples.\n(a) Let E\u2032 = En(Cn). Fix a vector ~v = (v ,...,v ) in E\u2032 and set\n1 n\n( ~x E\u2032) f(~x) = ~x ~v\n\u2200 \u2208 \u00b7 8 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n(inner product; see Chapter 3, 1\u20133 and 9).\n\u00a7\u00a7 \u00a7\nThen\nf(a~x +b~y) = (a~x) ~v +(b~y) ~v\n\u00b7 \u00b7\n= a(~x ~v)+b(~y ~v)\n\u00b7 \u00b7\n= af(~x)+bf(~y);\nso f is linear. Note that if E\u2032 = En, then by definition,\nn n\nf(~x) = ~x ~v = x v = v x .\nk k k k\n\u00b7\nk=1 k=1\nX X\nIf, however, E\u2032 = Cn, then\nn n\nf(~x) = ~x ~v = x v\u00af = v\u00af x ,\nk k k k\n\u00b7\nk=1 k=1\nX X\nwhere v\u00af is the conjugate of the complex number v .\nk k\nBy Theorem 3 in Chapter 4, 3, f is continuous (a polynomial!).\n\u00a7\nMoreover, f(~x) = ~x ~v is a scalar (in E1 or C). Thus the range of f\n\u00b7\nlies in the scalar field of E\u2032; so f is a linear functional on E\u2032.\n(b) Let I = [0,1]. Let E\u2032 be the set of all functions u: I E that are of\n\u2192\nclass CD\u221e (Chapter 5, 6) on I, hence bounded there (Theorem 2 of\n\u00a7\nChapter 4, 8).\n\u00a7\nAs in Example (C) in Chapter 3, 10, E\u2032 is a normed linear space, with\n\u00a7\nnorm\nu = sup u(x) .\nk k | |\nx\u2208I\nHere each function u E\u2032 is treated as a single \u201cpoint\u201d in E\u2032. The\n\u2208\ndistance between two such points, u and v, equals u v , by definition.\nk \u2212 k\nNow define a map D on E\u2032 by setting D(u) = u\u2032 (derivative of u on\nI). As every u E\u2032 is of class CD\u221e, so is u\u2032.\n\u2208\nThus D(u) = u\u2032 E\u2032, and so D: E\u2032 E\u2032 is a linear operator. (Its\n\u2208 \u2192\nlinearity follows from Theorem 4 in Chapter 5, 1.)\n\u00a7\n(c) Let again I = [0,1]. Let E\u2032 be the set of all functions u: I E that are\n\u2192\nbounded and have antiderivatives (Chapter 5, 5) on I. With norm u\n\u00a7 k k\nas in Example (b), E\u2032 is a normed linear space.\nNow define \u03c6: E\u2032 E by\n\u2192\n1\n\u03c6(u) = u,\nZ0\n1\nwith u as in Chapter 5, 5. (Recall that u is an element of E if\n\u00a7 0\nu: I E.) By Corollary 1 in Chapter 5, 5, \u03c6 is a linear map of E\u2032 into\n\u2192R \u00a7 R 2. Linear Maps and Functionals. Matrices 9\n\u00a7\nE. (Why?)\n(d) The zero map f = 0 on E\u2032 is always linear. (Why?)\nTheorem 1. A linear map f: E\u2032 E is continuous (even uniformly so) on\n\u2192\nall of E\u2032 iff it is continuous at~0; equivalently, iff there is a real c > 0 such that\n( ~x E\u2032) f(~x) c ~x .\n\u2200 \u2208 | | \u2264 | |\n(We call this property linear boundedness.)\nProof. Assume that f is continuous at ~0. Then, given \u03b5 > 0, there is \u03b4 > 0\nsuch that\nf(~x) f(~0) = f(~x) \u03b5\n| \u2212 | | | \u2264\nwhenever ~x ~0 = ~x < \u03b4.\n| \u2212 | | |\nNow, for any ~x =~0, we surely have\n6\n\u03b4~x \u03b4\n= < \u03b4.\n2 ~x 2\n(cid:12) | |(cid:12)\n(cid:12) (cid:12)\nHence (cid:12) (cid:12)\n(cid:12) (cid:12)\n\u03b4~x\n( ~x =~0) f \u03b5,\n\u2200 6 2 ~x \u2264\n(cid:12) (cid:18) | |(cid:19)(cid:12)\n(cid:12) (cid:12)\nor, by linearity, (cid:12) (cid:12)\n(cid:12) (cid:12)\n\u03b4\nf(~x) \u03b5,\n2 ~x | | \u2264\n| |\ni.e.,\n2\u03b5\nf(~x) ~x .\n| | \u2264 \u03b4 | |\nBy Note 2, this also holds if ~x =~0.\nThus, taking c = 2\u03b5/\u03b4, we obtain\n(3) ( ~x E\u2032) f(~x) c ~x (linear boundedness).\n\u2200 \u2208 \u2264 | |\nNow assume (3). Then\n( ~x,~y E\u2032) f(~x ~y) c ~x ~y ;\n\u2200 \u2208 | \u2212 | \u2264 | \u2212 |\nor, by linearity,\n(4) ( ~x,~y E\u2032) f(~x) f(~y) c ~x ~y .1\n\u2200 \u2208 | \u2212 | \u2264 | \u2212 |\nHence f is uniformly continuous (given \u03b5 > 0, take \u03b4 = \u03b5/c). This, in turn,\nimplies continuity at ~0; so all conditions are equivalent, as claimed. (cid:3)\n1This is the so-called uniform Lipschitz condition. 10 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nA linear map need not be continuous.2 But, for En and Cn, we have the\nfollowing result.\nTheorem 2.\n(i) Any linear map on En or Cn is uniformly continuous.\n(ii) Every linear functional on En (Cn) has the form\nf(~x) = ~x ~v (dot product)\n\u00b7\nfor some unique vector ~v En (Cn), dependent on f only.\n\u2208\nProof. Suppose f: En E is linear; so f preserves linear combinations.\n\u2192\nBut every ~x En is such a combination,\n\u2208\nn\n~x = x ~e (Theorem 2 in Chapter 3, 1\u20133).\nk k\n\u00a7\u00a7\nk=1\nX\nThus, by Note 1,\nn n\nf(~x) = f x ~e = x f(~e ).\nk k k k\n(cid:18)k=1 (cid:19) k=1\nX X\nHere the function values f(~e ) are fixed vectors in the range space E, say,\nk\nf(~e ) = v E,\nk k\n\u2208\nso that\nn n\n(5) f(~x) = x f(~e ) = x v , v E.\nk k k k k\n\u2208\nk=1 k=1\nX X\nThus f is a polynomial in n real variables x , hence continuous (even uniformly\nk\nso, by Theorem 1).\nIn particular, if E = E1 (i.e., f is a linear functional) then all v in (5) are\nk\nreal numbers; so they form a vector\n~v = (v ,...,v ) in En,\n1 k\nand (5) can be written as\nf(~x) = ~x ~v.\n\u00b7\nThevector~v isunique. Forsupposetherearetwo vectors,~u and~v, suchthat\n( ~x En) f(~x) = ~x ~v = ~x ~u.\n\u2200 \u2208 \u00b7 \u00b7\nThen\n( ~x En) ~x (~v ~u) = 0.\n\u2200 \u2208 \u00b7 \u2212\n2See Problem 2(ii) below. 2. Linear Maps and Functionals. Matrices 11\n\u00a7\nBy Problem 10 of Chapter 3, 1\u20133, this yields ~v ~u = ~0, or ~v = ~u. This\n\u00a7\u00a7 \u2212\ncompletes the proof for E = En.\nIt is analogous for Cn; only in (ii) the v are complex and one has to replace\nk\nthem by their conjugates v\u00af when forming the vector ~v to obtain f(~x) = ~x ~v.\nk\n\u00b7\nThus all is proved. (cid:3)\nNote 3. Formula (5) shows that a linear map f: En(Cn) E is uniquely\n\u2192\ndetermined by the n function values v = f(~e ).\nk k\nIf further E = Em (Cm), the vectors v are m-tuples of scalars,\nk\nv = (v ,...,v ).\nk 1k mk\nWe often write such vectors vertically, as the n \u201ccolumns\u201d in an array of m\n\u201crows\u201d and n \u201ccolumns\u201d:\nv v ... v\n11 12 1n\nv v ... v\n21 22 2n\n(6) \uf8eb . . . . \uf8f6.\n. . . .\n. . . .\n\uf8ecv v ... v \uf8f7\n\uf8ec m1 m2 mn\uf8f7\n\uf8ed \uf8f8\nFormally, (6) is a double sequence of mn terms, called an m n matrix. We\n\u00d7\ndenote it by [f] = (v ), where for k = 1,2,...,n,\nik\nf(~e ) = v = (v ,...,v ).\nk k 1k mk\nThus linear maps f: En Em (or f: Cn Cm) correspond one-to-one to\n\u2192 \u2192\ntheir matrices [f].\nThe easy proof of Corollaries 1 to 3 below is left to the reader.\nCorollary 1. If f,g: E\u2032 E are linear, so is\n\u2192\nh = af +bg\nfor any scalars a,b.\nIf further E\u2032 = En (Cn) and E = Em (Cm), with [f] = (v ) and [g] = (w ),\nik ik\nthen\n[h] = (av +bw ).\nik ik\nCorollary 2. A map f: En(Cn) E is linear iff\n\u2192\nn\nf(~x) = v x ,\nk k\nk=1\nX\nwhere v = f(~e ).\nk k\nHint: For the \u201cif,\u201d use Corollary 1. For the \u201conly if,\u201d use formula (5) above. 12 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nCorollary 3. If f: E\u2032 E\u2032\u2032 and g: E\u2032\u2032 E are linear, so is the composite\n\u2192 \u2192\nh = g f.\n\u25e6\nOur next theorem deals with the matrix of the composite linear map g f.\n\u25e6\nTheorem 3. Let f: E\u2032 E\u2032\u2032 and g: E\u2032\u2032 E be linear, with\n\u2192 \u2192\nE\u2032 = En(Cn), E\u2032\u2032 = Em(Cm), and E = Er(Cr).\nIf [f] = (v ) and [g] = (w ), then\nik ji\n[h] = [g f] = (z ),\njk\n\u25e6\nwhere\nm\n(7) z = w v , j = 1,2,...,r, k = 1,2,...,n.\njk ji ik\ni=1\nX\nProof. Denote the basic unit vectors in E\u2032 by\ne\u2032,...,e\u2032 ,\n1 n\nthose in E\u2032\u2032 by\ne\u2032\u2032,...,e\u2032\u2032 ,\n1 m\nand those in E by\ne ,...,e .\n1 r\nThen for k = 1,2,...,n,\nm r\nf(e\u2032 ) = v = v e\u2032\u2032 and h(e\u2032 ) = z e ,\nk k ik i k jk j\ni=1 j=1\nX X\nand for i = 1,... m,\nr\ng(e\u2032\u2032) = w e .\ni ji j\nj=1\nX\nAlso,\nm m m r\nh(e\u2032 ) = g(f(e\u2032 )) = g v e\u2032\u2032 = v g(e\u2032\u2032) = v w e .\nk k ik i ik i ik ji j\n(cid:18)i=1 (cid:19) i=1 i=1 (cid:18)j=1 (cid:19)\nX X X X\nThus\nr r m\nh(e\u2032 ) = z e = w v e .\nk jk j ji ik j\nj=1 j=1(cid:18)i=1 (cid:19)\nX X X\nBut the representation in terms of the e is unique (Theorem 2 in Chapter 3,\nj\n1\u20133), so, equating coefficients, we get (7). (cid:3)\n\u00a7\u00a7 2. Linear Maps and Functionals. Matrices 13\n\u00a7\nNote 4. Observe that z is obtained, so to say, by \u201cdot-multiplying\u201d the\njk\njth row of [g] (an r m matrix) by the kth column of [f] (an m n matrix).\n\u00d7 \u00d7\nIt is natural to set\n[g][f] = [g f],\n\u25e6\nor\n(w )(v ) = (z ),\nji ik jk\nwith z as in (7).\njk\nCaution. Matrix multiplication, so defined, is not commutative.\nDefinition 2.\nThe set of all continuous linear maps f: E\u2032 E (for fixed E\u2032 and E) is\n\u2192\ndenoted L(E\u2032,E).\nIf E = E\u2032, we write L(E) instead.\nFor each f in L(E\u2032,E), we define its norm by\nf = sup f(~x) .3\nk k | |\n|~x|\u22641\nNote that f < + , by Theorem 1.\nk k \u221e\nTheorem 4. L(E\u2032,E) is a normed linear space under the norm defined above\nand under the usual operations on functions, as in Corollary 1.\nProof. Corollary 1 easily implies that L(E\u2032,E) is a vector space. We now\nshow that is a genuine norm.\nk \u00b7 k\nThe triangle law,\nf +g f + g ,\nk k \u2264 k k k k\nfollows exactly as in Example (C) of Chapter 3, 10. (Verify!)\n\u00a7\nAlso, by Problem 5 in Chapter 2, 8\u20139, sup af(~x) = a sup f(~x) . Hence\n\u00a7\u00a7 | | | | | |\naf = a f for any scalar a.\nk k | |k k\nAs noted above, 0 f < + .\n\u2264 k k \u221e\nIt remains to show that f = 0 iff f is the zero map. If\nk k\nf = sup f(~x) = 0,\nk k | |\n|~x|\u22641\nthen f(~x) = 0 when ~x 1. Hence, if ~x =~0,\n| | | | \u2264 6\n~x 1\nf = f(~x) = 0.\n~x ~x\n(cid:16)| |(cid:17) | |\nAs f(~0) = 0, we have f(~x) = 0 for all ~x E\u2032.\n\u2208\nThus f = 0impliesf = 0, andtheconverseisclear. Thusallisproved. (cid:3)\nk k\n3Equivalently, f =sup f(~x)/~x ; see Note 5 below.\n~x=~0|\nk k | | |\n6 14 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nNote 5. A similar proof, via f ~x and properties of lub, shows that\n|~x|\n(cid:0) (cid:1) f(~x)\nf = sup\nk k ~x\n~x6=0\n(cid:12) | | (cid:12)\n(cid:12) (cid:12)\nand\n(cid:12) (cid:12)\n( ~x E\u2032) f(~x) f ~x .\n\u2200 \u2208 | | \u2264 k k| |\nIt also follows that f is the least real c such that\nk k\n( ~x E\u2032) f(~x) c ~x .\n\u2200 \u2208 | | \u2264 | |\nVerify. (See Problem 3\u2032.)\nAs in any normed space, we define distances in L(E\u2032,E) by\n\u03c1(f,g) = f g ,\nk \u2212 k\nmaking it a metric space; so we may speak of convergence, limits, etc., in it.\nCorollary 4. If f L(E\u2032,E\u2032\u2032) and g L(E\u2032\u2032,E), then\n\u2208 \u2208\ng f g f .\nk \u25e6 k \u2264 k kk k\nProof. By Note 5,\n( ~x E\u2032) g(f(~x)) g f(~x) g f ~x .\n\u2200 \u2208 | | \u2264 k k| | \u2264 k kk k| |\nHence\n(g f)(~x)\n( ~x =~0) \u25e6 g f ,\n\u2200 6 ~x \u2264 k kk k\n(cid:12) | | (cid:12)\nand so (cid:12) (cid:12)\n(cid:12) (cid:12)\n(g f)(~x)\ng f sup | \u25e6 | = g f . (cid:3)\nk kk k \u2265 ~x k \u25e6 k\n~x6=~0\n| |\nProblems on Linear Maps and Matrices\n1. Verify Note 1 and the equivalence of the two statements in Definition 1.\n2. In Examples (b) and (c) show that\nf f (uniformly) on I iff f f 0,\nn n\n\u2192 k \u2212 k \u2192\ni.e., f f in E\u2032.\nn\n\u2192\n[Hint: Use Theorem 1 in Chapter 4, 2.]\n\u00a7\nHence deduce the following.\n(i) If E is complete, then the map \u03c6 in Example (c) is continuous.\n[Hint: Use Theorem 2 of Chapter 5, 9, and Theorem 1 in Chapter 4, 12.]\n\u00a7 \u00a7\n(ii) The map D of Example (b) is not continuous.\n[Hint: Use Problem 3 in Chapter 5, 9.]\n\u00a7 2. Linear Maps and Functionals. Matrices 15\n\u00a7\n3. Prove Corollaries 1 to 3.\n\u2032\n3 . Show that\nf(~x)\nf = sup f(~x) = sup f(~x) = sup | |.\nk k | | | | ~x\n|~x|\u22641 |~x|=1 ~x6=~0\n| |\n[Hint: From linearity of f deduce that f(~x) f(cx) if c < 1. Hence one may\n| | \u2265 | | | |\ndisregard vectors of length <1 when computing sup f(~x). Why?]\n| |\n4. Find the matrices [f], [g], [h], [k], and the defining formulas for the\nlinear maps f: E2 E1, g: E3 E4, h: E4 E2, k: E1 E3 if\n\u2192 \u2192 \u2192 \u2192\n(i) f(~e ) = 3, f(~e ) = 2;\n1 2\n\u2212\n(ii) g(~e ) = (1,0, 2,4), g(~e ) = (0,2, 1,1), g(~e ) = (0,1,0, 1);\n1 2 3\n\u2212 \u2212 \u2212\n(iii) h(~e ) = (2,2), h(~e ) = (0, 2), h(~e ) = (1,0), h(~e ) = ( 1,1);\n1 2 3 4\n\u2212 \u2212\n(iv) k(1) = (0,1, 1).\n\u2212\n5. In Problem 4, use Note 4 to find the product matrices [k][f], [g][k],\n[f][h], and [h][g]. Hence obtain the defining formulas for k f, g k,\n\u25e6 \u25e6\nf h, and h g.\n\u25e6 \u25e6\n6. For m n matrices (with m and n fixed) define addition and multipli-\n\u00d7\ncation by scalars as follows:\na[f]+b[g] = [af +bg] if f,g L(En,Em) (or L(Cn,Cm)).\n\u2208\nShow that these matrices form a vector space over E1 (or C).\n7. With matrix addition as in Problem 6, and multiplication as in Note 4,\nshow that all n n matrices form a noncommutative ring with unity,\n\u00d7\ni.e.,satisfythefieldaxioms(Chapter2, 1\u20134)exceptthecommutativity\n\u00a7\u00a7\nofmultiplicationandexistenceofmultiplicativeinverses(givecounterex-\namples!).\nWhich is the \u201cunity\u201d matrix?\n8. Let f: E\u2032 E be linear. Prove the following statements.\n\u2192\n(i) The derivative D f(p~) exists and equals f(~u) for every p~,~u E\u2032\nu~\n\u2208\n(~u =~0);\n6\n(ii) f is relatively continuous on any line in E\u2032 (use Theorem 1 in 1);\n\u00a7\n(iii) f carries any such line into a line in E.\n9. Let g: E\u2032\u2032 E be linear. Prove that if some f: E\u2032 E\u2032\u2032 has a ~u-\n\u2192 \u2192\ndirectedderivativeatp~ E\u2032, sohash = g f,andD h(p~) = g(D f(p~)).\nu~ u~\n\u2208 \u25e6\n[Hint: Use Problem 8.] 16 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n10. A set A in a vector space V (A V) is said to be linear (or a linear\n\u2286\nsubspace of V) iff a~x + b~y A for any ~x,~y A and any scalars a,b.\n\u2208 \u2208\nProve the following.\n(i) Any such A is itself a vector space.\n(ii) If f: E\u2032 E is a linear map and A is linear in E\u2032 (respectively,\n\u2192\nin E), so is f[A] in E (respectively, so is f\u22121[A] in E\u2032).\n11. AsetAinavectorspaceV iscalledthespan ofasetB A(A = sp(B))\n\u2286\niff A consists of all linear combinations of vectors from B. We then also\nsay that B spans A.\nProve the following:\n(i) A = sp(B) is the smallest linear subspace of V that contains B.\n(ii) If f: V E is linear and A = sp(B), then f[A] = sp(f[B]) in E.\n\u2192\n12. A set B = ~x ,~x ,...,~x in a vector space V is called a basis iff each\n1 2 n\n{ }\n~v V has a unique representation as\n\u2208\nn\n~v = a ~x\ni i\ni=1\nX\nfor some scalars a . If so, the number n of the vectors in B is called the\ni\ndimension of V, and V is said to be n-dimensional. Examples of such\nspaces are En and Cn (the ~e form a basis!).\nk\n(i) Show that B is a basis iff it spans V (see Problem 11) and its\nelements ~x are linearly independent, i.e.,\ni\nn\na ~x =~0 iff all a vanish.\ni i i\ni=1\nX\n(ii) If E\u2032 is finite-dimensional, all linear maps on E\u2032 are uniformly\ncontinuous. (See also Problems 3 and 4 of 6.)\n\u00a7\n13. Prove that if f: E1 E is continuous and ( x,y E1)\n\u2192 \u2200 \u2208\nf(x+y) = f(x)+f(y),\nthen f is linear; so, by Corollary 2, f(x) = vx where v = f(1).\n[Hint: Show that f(ax) = af(x); first for a = 1,2,... (note: nx = x+x+ +x,\n\u00b7\u00b7\u00b7\nn terms); then for rational a = m/n; then for a = 0 and a = 1. Any a E1 is a\n\u2212 \u2208\nlimit of rationals; so use continuity and Theorem 1 in Chapter 4, 2.]\n\u00a7\n\u00a73. Differentiable Functions\nAs we know, a function f: E1 E (on E1) is differentiable at p E1 iff, with\n\u2192 \u2208 3. Differentiable Functions 17\n\u00a7\n\u2206f = f(x) f(p) and \u2206x = x p,\n\u2212 \u2212\n\u2206f\nf\u2032(p) = lim exists (finite).\nx\u2192p \u2206x\nSetting \u2206x = x p = t, \u2206f = f(p+t) f(p), and f\u2032(p) = v, we may write\n\u2212 \u2212\nthis equation as\n\u2206f\nlim v = 0,\nt\u21920 t \u2212\n(cid:12) (cid:12)\nor\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n1\n(1) lim f(p+t) f(p) vt = 0.\nt\u21920 t | \u2212 \u2212 |\n| |\nNow define a map \u03c6: E1 E by \u03c6(t) = tv, v = f\u2032(p) E.\n\u2192 \u2208\nThen \u03c6 is linear and continuous, i.e., \u03c6 L(E1,E); so by Corollary 2 in 2,\n\u2208 \u00a7\nwe may express (1) as follows: there is a map \u03c6 L(E1,E) such that\n\u2208\n1\nlim \u2206f \u03c6(t) = 0.\nt\u21920 t | \u2212 |\n| |\nWe adopt this as a definition in the general case, f: E\u2032 E, as well.\n\u2192\nDefinition 1.\nA function f: E\u2032 E (where E\u2032 and E are normed spaces over the same\n\u2192\nscalar field) is said to be differentiable at a point p~ E\u2032 iff there is a map\n\u2208\n\u03c6 L(E\u2032,E)\n\u2208\nsuch that\n1\nlim \u2206f \u03c6(~t ) = 0;\n~t\u2192~0 ~t | \u2212 |\n| |\nthat is,\n1\n(2) lim [f(p~ +~t ) f(p~) \u03c6(~t )] = 0.\n~t\u2192~0 ~t \u2212 \u2212\n| |\nAs we show below, \u03c6 is unique (for a fixed p~), if it exists.\nWe call \u03c6 the differential of f at p~, briefly denoted df. As it depends\non p~, we also write df(p~;~t ) for df(~t) and df(p~; ) for df.\n\u00b7\nSome authors write f\u2032(p~) for df(p~; ) and call it the derivative at p~, but\n\u00b7\nwe shall not do this (see Preface). Following M. Spivak, however, we shall use\n\u201c[f\u2032(p~)]\u201d for its matrix, as follows.\nDefinition 2.\nIf E\u2032 = En(Cn) and E = Em(Cm), and f: E\u2032 E is differentiable at\n\u2192\np~, we set\n[f\u2032(p~)] = [df(p~; )]\n\u00b7 18 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nand call it the Jacobian matrix of f at p~.\nNote 1. In Chapter 5, 6, we did not define df as a mapping. However, if\n\u00a7\nE\u2032 = E1, the function value\ndf(p;t) = vt = f\u2032(p)\u2206x\nis as in Chapter 5, 6.\n\u00a7\nAlso, [f\u2032(p)] is a 1 1 matrix with single term f\u2032(p). (Why?) This motivated\n\u00d7\nDefinition 2.\nTheorem 1 (uniqueness of df). If f: E\u2032 E is differentiable at p~, then the\n\u2192\nmap \u03c6 described in Definition 1 is unique (dependent on f and p~ only).\nProof. Suppose there is another linear map g: E\u2032 E such that\n\u2192\n1 1\n(3) lim [f(p~ +~t ) f(p~) g(~t )] = lim [\u2206f g(~t )] = 0.\n~t\u2192~0 ~t \u2212 \u2212 ~t\u2192~0 ~t \u2212\n| | | |\nLet h = \u03c6 g. By Corollary 1 in 2, h is linear.\n\u2212 \u00a7\nAlso, by the triangle law,\nh(~t ) = \u03c6(~t ) g(~t ) \u2206f \u03c6(~t ) + \u2206f g(~t ) .\n| | | \u2212 | \u2264 | \u2212 | | \u2212 |\nHence, dividing by ~t ,\n| |\n~t 1 1 1\nh = h(~t ) \u2206f \u03c6(~t ) + \u2206f g(~t ) .\n~t ~t | | \u2264 ~t | \u2212 | ~t | \u2212 |\n(cid:12) (cid:18)| |(cid:19)(cid:12) | | | | | |\n(cid:12) (cid:12)\nBy (3)(cid:12) (cid:12)and (2),(cid:12) (cid:12)the right side expressions tend to 0 as ~t ~0. Thus\n\u2192\n~t\nlim h = 0.\n~t\n~t\u2192~0\n(cid:18)| |(cid:19)\nThis remains valid also if~t ~0 over any line through~0, so that~t /~t remains\n\u2192 | |\nconstant, say ~t /~t = ~u, where ~u is an arbitrary (but fixed) unit vector.\n| |\nThen\n~t\nh = h(~u)\n~t\n(cid:18)| |(cid:19)\nis constant; so it can tend to 0 only if it equals 0, so h(~u) = 0 for any unit\nvector ~u.\nSince any ~x E\u2032 can be written as ~x = ~x ~u, linearity yields\n\u2208 | |\nh(~x) = ~x h(~u) = 0.\n| |\nThus h = \u03c6 g = 0 on E\u2032, and so \u03c6 = g after all, proving the uniqueness\n\u2212\nof \u03c6. (cid:3) 3. Differentiable Functions 19\n\u00a7\nTheorem 2. If f is differentiable at p~, then\n(i) f is continuous at p~;\n(ii) for any ~u =~0, f has the ~u-directed derivative\n6\nD f(p~) = df(p~;~u).\nu~\nProof. By assumption, formula (2) holds for \u03c6 = df(p~; ).\n\u00b7\nThus, given \u03b5 > 0, there is \u03b4 > 0 such that, setting \u2206f = f(p~ +~t) f(p~),\n\u2212\nwe have\n1\n(4) \u2206f \u03c6(~t ) < \u03b5 whenever 0 < ~t < \u03b4;\n~t | \u2212 | | |\n| |\nor, by the triangle law,\n(5) \u2206f \u2206f \u03c6(~t ) + \u03c6(~t ) \u03b5~t + \u03c6(~t ) , 0 < ~t < \u03b4.\n| | \u2264 | \u2212 | | | \u2264 | | | | | |\nNow, by Definition 1, \u03c6 is linear and continuous; so\nlim \u03c6(~t ) = \u03c6(~0) = 0.\n~t\u2192~0| | | |\nThus, making ~t ~0 in (5), with \u03b5 fixed, we get\n\u2192\nlim \u2206f = 0.\n~t\u2192~0| |\nAs ~t is just another notation for \u2206~x = ~x p~, this proves assertion (i).\n\u2212\nNext, fix any ~u =~0 in E\u2032, and substitute t~u for ~t in (4).\n6\nIn other words, t is a real variable, 0 < t < \u03b4/ ~u , so that ~t = t~u satisfies\n| |\n0 < ~t < \u03b4.\n| |\nMultiplying by ~u , we use the linearity of \u03c6 to get\n| |\n\u2206f \u03c6(t~u) \u2206f f(p~ +t~u) f(p~)\n\u03b5 ~u > = \u03c6(~u) = \u2212 \u03c6(~u) .\n| | t \u2212 t t \u2212 t \u2212\n(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\nAs \u03b5 is arbitr(cid:12)ary, we have(cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\n1\n\u03c6(~u) = lim [f(p~ +t~u) f(p~)].\nt\u21920 t \u2212\nBut this is simply D f(p~), by Definition 1 in 1.\nu~\n\u00a7\nThus D f(p~) = \u03c6(~u) = df(p~;~u), proving (ii). (cid:3)\n~u\nNote 2. If E\u2032 = En(Cn), Theorem 2(ii) shows that if f is differentiable at\np~, it has the n partials\nD f(p~) = df(p~;~e ), k = 1,...,n.\nk k 20 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nBut the converse fails: the existence of the D f(p~) does not even imply con-\nk\ntinuity, let alone differentiability (see 1). Moreover, we have the following\n\u00a7\nresult.\nCorollary 1. If E\u2032 = En(Cn) and if f: E\u2032 E is differentiable at p~, then\n\u2192\nn n\n\u2202\n(6) df(p~;~t ) = t D f(p~) = t f(p~),\nk k k\n\u2202x\nk\nk=1 k=1\nX X\nwhere ~t = (t ,...,t ).\n1 n\nProof. By definition, \u03c6 = df(p~; ) is a linear map for a fixed p~.\n\u00b7\nIf E\u2032 = En or Cn, we may use formula (3) of 2, replacing f and ~x by \u03c6\n\u00a7\nand ~t , and get\nn n\n\u03c6(~t ) = df(p~;~t ) = t df(p~;~e ) = t D f(p~)\nk k k k\nk=1 k=1\nX X\nby Note 2. (cid:3)\nNote 3. In classical notation, one writes \u2206x or dx for t in (6). Thus,\nk k k\nomitting p~ and ~t , formula (6) is often written as\n\u2202f \u2202f \u2202f\n(6\u2032) df = dx + dx + + dx .\n1 2 n\n\u2202x \u2202x \u00b7\u00b7\u00b7 \u2202x\n1 2 n\nIn particular, if n = 3, we write x,y,z for x ,x ,x . This yields\n1 2 3\n\u2202f \u2202f \u2202f\n(6\u2032\u2032) df = dx+ dy + dz\n\u2202x \u2202y \u2202z\n(a familiar calculus formula).\nNote 4. If the range space E in Corollary 1 is E1(C), then the D f(p~)\nk\nform an n-tuple of scalars, i.e., a vector in En(Cn).\nIn case f: En E1, we denote it by\n\u2192\nn\nf(p~) = (D f(p~),...,D f(p~)) = ~e D f(p~).\n1 n k k\n\u2207\nk=1\nX\nIn case f: Cn C, we replace the D f(p~) by their conjugates D f(p~) and set\nk k\n\u2192\nn\nf(p~) = ~e D f(p~).\nk k\n\u2207\nk=1\nX\nThe vector f(p~) is called the gradient of f (\u201cgradf\u201d) at p~.\n\u2207 3. Differentiable Functions 21\n\u00a7\nFrom (6) we obtain\nn\n(7) df(p~;~t ) = t D f(p~) =~t f(p~)\nk k\n\u00b7\u2207\nk=1\nX\n(dot product of ~t by f(p~)), provided f: En E1 (or f: Cn C) is differ-\n\u2207 \u2192 \u2192\nentiable at p~.\nThis leads us to the following result.\nCorollary 2. A function f: En E1 (or f: Cn C) is differentiable at p~\n\u2192 \u2192\niff\n1\n(8) lim f(p~ +~t ) f(p~) ~t ~v = 0\n~t\u2192~0 ~t | \u2212 \u2212 \u00b7 |\n| |\nfor some ~v En (Cn).\n\u2208\nIn this case, necessarily ~v = f(p~) and ~t ~v = df(p~;~t ), ~t En(Cn).\n\u2207 \u00b7 \u2208\nProof. If f is differentiable at p~, we may set \u03c6 = df(p~; ) and ~v = f(p~).\n\u00b7 \u2207\nThen by (7),\n\u03c6(~t ) = df(p~;~t ) =~t ~v;\n\u00b7\nso by Definition 1, (8) results.\nConversely, if some ~v satisfies (8), set \u03c6(~t ) = ~t ~v. Then (8) implies (2),\n\u00b7\nand \u03c6 is linear and continuous.\nThus by definition, f is differentiable at p~; so (7) holds.\nAlso, \u03c6 is a linear functional on En (Cn). By Theorem 2(ii) in 2, the ~v in\n\u00a7\n\u03c6(~t ) =~t ~v is unique, as is \u03c6.\n\u00b7\nThus by (7), ~v = f(p~) necessarily. (cid:3)\n\u2207\nCorollary 3 (law of the mean). If f: En E1 (real) is relatively continuous\n\u2192\non a closed segment L[p~,~q], p~ = ~q, and differentiable on L(p~,~q), then\n6\n(9) f(~q) f(p~) = (~q p~) f(~x )\n0\n\u2212 \u2212 \u00b7\u2207\nfor some ~x L(p~,~q).\n0\n\u2208\nProof. Let\n1\nr = ~q p~ , ~v = (~q p~), and r~v = (~q p~).\n| \u2212 | r \u2212 \u2212\nBy (7) and Theorem 2(ii),\nD f(~x) = df(~x;~v) =~v f(~x)\n~v\n\u00b7\u2207\nfor ~x L(p~,~q). Thus by formula (3\u2032) of Corollary 2 in 1,\n\u2208 \u00a7\nf(~q) f(p~) = rD f(~x ) = r~v f(~x ) = (~q p~) f(~x )\n~v 0 0 0\n\u2212 \u00b7\u2207 \u2212 \u00b7\u2207\nfor some ~x L(p~,~q). (cid:3)\n0\n\u2208 22 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nAs we know, the mere existence of partials does not imply differentiability.\nBut the existence of continuous partials does. Indeed, we have the following\ntheorem.\nTheorem 3. Let E\u2032 = En(Cn).\nIf f: E\u2032 E has the partial derivatives D f (k = 1,...,n) on all of an\nk\n\u2192\nopen set A E\u2032, and if the D f are continuous at some p~ A, then f is\nk\n\u2286 \u2208\ndifferentiable at p~.\nProof. With p~ as above, let\nn n\n\u03c6(~t ) = t D f(p~) with ~t = t ~e E\u2032.\nk k k k\n\u2208\nk=1 k=1\nX X\nThen \u03c6 is continuous (a polynomial!) and linear (Corollary 2 in 2).\n\u00a7\nThus by Definition 1, it remains to show that\n1\nlim \u2206f \u03c6(~t ) = 0;\n~t\u2192~0 ~t | \u2212 |\n| |\nthat is,\nn\n1\n(10) lim f(p~ +~t) f(p~) t D f(p~) = 0.\n~t\u2208~0 |~t \u2212 \u2212 k k\n|(cid:12) k=1 (cid:12)\n(cid:12) X (cid:12)\n(cid:12) (cid:12)\nTo do this, fix \u03b5 > 0(cid:12). As A is open and the D kf are(cid:12)continuous at p~ A,\n\u2208\nthere is a \u03b4 > 0 such that G (\u03b4) A and simultaneously (explain this!)\np~\n\u2286\n\u03b5\n( ~x G (\u03b4)) D f(~x) D f(p~) < , k = 1,...,n.\np~ k k\n\u2200 \u2208 | \u2212 | n\nHence for any set I G (\u03b4)\np~\n\u2286\n\u03b5\n(11) sup D f(~x) D f(p~) . (Why?)\nk k\n| \u2212 | \u2264 n\n~x\u2208I\nNow fix any ~t E\u2032, 0 < ~t < \u03b4, and let p~ = p~,\n\u2208 | | 0\nk\np~ = p~ + t e , k = 1,...,n.\nk i i\ni=1\nX\nThen\nn\np~ = p~ + t ~e = p~ +~t,\nn i i\ni=1\nX\np~ p~ = t , and all p~ lie in G (\u03b4), for\n| k \u2212 k\u22121| | k | k p~\nk k n\np~ p~ = t e = t 2 t 2 = ~t < \u03b4,\n| k \u2212 | i i v | i | \u2264 v | i | | |\n(cid:12)i=1 (cid:12) ui=1 ui=1\n(cid:12)X (cid:12) uX uX\n(cid:12) (cid:12) t t\n(cid:12) (cid:12) 3. Differentiable Functions 23\n\u00a7\nas required.\nAs G (\u03b4) is convex (Chapter 4, 9), the segments I = L[p~ ,p~ ] all lie in\np \u00a7 k k\u22121 k\nG (\u03b4) A; and by assumption, f has all partials there.\np~\n\u2286\nHence by Theorem 1 in 1, f is relatively continuous on all I .\nk\n\u00a7\nAll this also applies to the functions g , defined by\nk\n(12) ( ~x E\u2032) g (~x) = f(~x) x D f(p~), k = 1,...,n.\nk k k\n\u2200 \u2208 \u2212\n(Why?) Here\nD g (~x) = D f(~x) D f(p~).\nk k k k\n\u2212\n(Why?)\nThus by Corollary 2 in 1, and (11) above,\n\u00a7\ng (p~ ) g (p~ ) p~ p~ sup D f(~x) D f(p~)\n| k k \u2212 k k\u22121 | \u2264 | k \u2212 k\u22121| | k \u2212 k |\nx\u2208Ik\n\u03b5 \u03b5\nt ~t ,\nk\n\u2264 n| | \u2264 n| |\nsince\np~ p~ = t ~e ~t ,\n| k \u2212 k\u22121| | k k | \u2264 | |\nby construction.\nCombine with (12), recalling that the kth coordinates x , for p~ and p~ ,\nk k k\u22121\ndiffer by t ; so we obtain\nk\ng (p~ ) g (p~ ) = f(p~ ) f(p~ ) t D f(p~)\n| k k \u2212 k k\u22121 | | k \u2212 k\u22121 \u2212 k k |\n(13) \u03b5\n~t .\n\u2264 n| |\nAlso,\nn\n[f(p~ ) f(p~ )] = f(p~ ) f(p~ )\nk \u2212 k\u22121 n \u2212 0\nk=1\nX\n= f(p~ +~t ) f(p~) = \u2206f (see above).\n\u2212\nThus\nn n\n\u2206f t D f(p~) = [f(p~ ) f(p~ ) t D f(p~)]\n\u2212 k k k \u2212 k\u22121 \u2212 k k\n(cid:12) k=1 (cid:12) (cid:12)k=1 (cid:12)\n(cid:12) X (cid:12) (cid:12)X (cid:12)\n\u03b5\n(cid:12) (cid:12) (cid:12) (cid:12) n(cid:12) (cid:12) ~t = \u03b5~t . (cid:12) (cid:12)\n\u2264 \u00b7 n| | | |\nAs \u03b5 is arbitrary, (10) follows, and all is proved. (cid:3)\nTheorem 4. If f: En Em (or f: Cn Cm) is differentiable at p~, with\n\u2192 \u2192\nf = (f ,...,f ), then [f\u2032(p~)] is an m n matrix,\n1 m\n\u00d7\n(14) [f\u2032(p~)] = [D f (p~)], i = 1,...,m, k = 1,...,n.\nk i 24 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nProof. By definition, [f\u2032(p~)] is the matrix of the linear map \u03c6 = df(p~; ),\n\u00b7\n\u03c6 = (\u03c6 ,...,\u03c6 ). Here\n1 m\nn\n\u03c6(~t ) = t D f(p~)\nk k\nk=1\nX\nby Corollary 1.\nAs f = (f ,...,f ), we can compute D f(p~) componentwise by Theorem 5\n1 m k\nof Chapter 5, 1, and Note 2 in 1 to get\n\u00a7 \u00a7\nD f(p~) = (D f (p~),...,D f (p~))\nk k 1 k m\nm\n= e\u2032D f (p~), k = 1,2,...,n,\ni k i\ni=1\nX\nwhere the e\u2032 are the basic vectors in Em(Cm). (Recall that the ~e are the\ni k\nbasic vectors in En(Cn).)\nThus\nm\n\u03c6(~t ) = e\u2032\u03c6 (~t ).\ni i\ni=1\nX\nAlso,\nn m m n\n\u03c6(~t ) = t e\u2032D f (p~) = e\u2032 t D f (p~).\nk i k i i k k i\nk=1 i=1 i=1 k=1\nX X X X\nThe uniqueness of the decomposition (Theorem 2 in Chapter 3, 1\u20133) now\n\u00a7\u00a7\nyields\nn\n\u03c6 (~t ) = t D f (p~), i = 1,...,m, ~t En(Cn).\ni k k i\n\u2208\nk=1\nX\nIf here ~t =~e , then t = 1, while t = 0 for j = k. Thus we obtain\nk k j\n6\n\u03c6 (~e ) = D f (p~), i = 1,...,m, k = 1,...,n.\ni k k i\nHence\n\u03c6(~e ) = (v ,v ,...,v ),\nk 1k 2k mk\nwhere\nv = \u03c6 (~e ) = D f (p~).\nik i k k i\nBut by Note 3 of 2, v ,...,v (written vertically) is the kth column of\n1k mk\n\u00a7\nthe m n matrix [\u03c6] = [f\u2032(p~)]. Thus formula (14) results indeed. (cid:3)\n\u00d7\nIn conclusion, let us stress again that while D f(p~) is a constant, for a fixed\nu~\np~, df(p~; ) is a mapping\n\u00b7\n\u03c6 L(E\u2032,E),\n\u2208\nespecially \u201ctailored\u201d for p~. 3. Differentiable Functions 25\n\u00a7\nThe reader should carefully study at least the \u201carrowed\u201d problems below.\nProblems on Differentiable Functions\n1. Complete the missing details in the proofs of this section.\n2. Verify Note 1. Describe [f\u2032(p~)] for f: E1 Em, too. Give examples.\n\u2192\n\u21d23. A map f: E\u2032 E is said to satisfy a Lipschitz condition (L) of order\n\u2192\n\u03b1 > 0 at p~ iff\n( \u03b4 > 0) ( K E1) ( ~x G (\u03b4)) f(~x) f(p~) K ~x p~ \u03b1.\n\u00acp~\n\u2203 \u2203 \u2208 \u2200 \u2208 | \u2212 | \u2264 | \u2212 |\nProve the following.\n(i) This implies continuity at p~ (but not conversely; see Problem 7 in\nChapter 5, 1).\n\u00a7\n(ii) L of order > 1 implies differentiability at p~, with df(p~; ) = 0\n\u00b7\non E\u2032.\n(iii) Differentiability at p~ implies L of order 1 (apply Theorem 1 in 2\n\u00a7\nto \u03c6 = df).\n(iv) If f and g are differentiable at p~, then\n1\nlim \u2206f \u2206g = 0.\n~x\u2192p~ \u2206~x | || |\n| |\n4. For the functions of Problem 5 in 1, find those p~ at which f is differ-\n\u00a7\nentiable. Find\nf(p~), df(p~; ), and [f\u2032(p~)].\n\u2207 \u00b7\n[Hint: Use Theorem 3 and Corollary 1.]\n\u21d25. Prove the following statements.\n(i) If f: E\u2032 E is constant on an open globe G E\u2032, it is differen-\n\u2192 \u2282\ntiable at each p~ G, and df(p~, ) = 0 on E\u2032.\n\u2208 \u00b7\n(ii) If the latter holds for each p~ G Q (Q countable), then f is\n\u2208 \u2212\nconstant on G (even on G) provided f is relatively continuous\nthere.\n[Hint: Given p~,~q G, use Theorem 2 in 1 to get f(p~)=f(q~).]\n\u2208 \u00a7\n6. Do Problem 5 in case G is any open polygon-connected set in E\u2032. (See\nChapter 4, 9.)\n\u00a7\n\u21d27. Prove the following.\n(i) If f,g: E\u2032 E are differentiable at p~, so is\n\u2192\nh = af +bg, 26 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nfor any scalars a,b (if f and g are scalar valued, a and b may be\nvectors); moreover,\nd(af +bg) = adf +bdg,\ni.e.,\ndh(p~;~t ) = adf(p~;~t )+bdg(p~;~t ), ~t E\u2032.\n\u2208\n(ii) In case f,g: Em E1 or Cm C, deduce also that\n\u2192 \u2192\nh(p~) = a f(p~)+b g(p~).\n\u2207 \u2207 \u2207\n\u21d28. Prove that if f,g: E\u2032 E1(C) are differentiable at p~, then so are\n\u2192\ng\nh = gf and k = .\nf\n(the latter, if f(p~) = 0). Moreover, with a = f(p~) and b = g(p~), show\n6\nthat\n(i) dh = adg +bdf and\n(ii) dk = (adg bdf)/a2.\n\u2212\nIf further E\u2032 = En(Cn), verify that\n(iii) h(p~) = a g(p~)+b f(p~) and\n\u2207 \u2207 \u2207\n(iv) k(p~) = (a g(p~) b f(p~))/a2.\n\u2207 \u2207 \u2212 \u2207\nProve (i) and (ii) for vector-valued g, too.\n[Hints: (i) Set \u03c6=adg+bdf, with a and b as above. Verify that\n\u2206h \u03c6(~t)=g(p~)(\u2206f df(~t))+f(p~)(\u2206g dg(~t))+(\u2206f)(\u2206g).\n\u2212 \u2212 \u2212\nUse Problem 3(iv) and Definition 1.\n(ii) Let F(~t)=1/f(~t). Show that dF = df/a2. Then apply (i) to gF.]\n\u2212\n\u21d29. Let f: E\u2032 Em(Cm), f = (f ,...,f ). Prove that\n1 m\n\u2192\n(i) f is linear iff all its m components f are;\nk\n(ii) f is differentiable at p~ iff all f are, and then df = (df ,...,df ).\nk 1 m\nHence if f is complex, df = df +i df .\nre im\n\u00b7\n10. Prove the following statements.\n(i) If f L(E\u2032,E) then f is differentiable on E\u2032, and df(p~; ) = f,\n\u2208 \u00b7\np~ E\u2032.\n\u2208\n(ii) Such is any first-degree monomial, hence any sum of such mono-\nmials.\n11. Any rational function is differentiable in its domain.\n[Hint: Use Problems 10(ii), 7, and 8. Proceed as in Theorem 3 in Chapter 4, 3.]\n\u00a7 3. Differentiable Functions 27\n\u00a7\n12. Do Problem 8(i) in case g is only continuous at p~, and f(p~) = 0. Find\ndh.\n13. Do Problem 8(i) for dot products h = f g of functions f,g: E\u2032\n\u00b7 \u2192\nEm(Cm).\n14. Prove the following.\n(i) If \u03c6 L(En,E1) or \u03c6 L(Cn,C), then \u03c6 = ~v , with ~v as in 2,\n\u2208 \u2208 k k | | \u00a7\nTheorem 2(ii).\n(ii) If f: En E1 (f: Cn C1) is differentiable at p~, then\n\u2192 \u2192\ndf(p~; ) = f(p~) .\nk \u00b7 k |\u2207 |\nMoreover, in case f: En E1,\n\u2192\nf(p~) D f(p~) if ~u = 1\nu~\n|\u2207 | \u2265 | |\nand\nf(p~)\nf(p~) = D f(p~) when ~u = \u2207 ;\nu~\n|\u2207 | f(p~)\n|\u2207 |\nthus\nf(p~) = maxD f(p~).\nu~\n|\u2207 | |u~|=1\n[Hints: Use the equality case in Theorem 4(c\u2019) of Chapter 3, 1\u20133. Use formula (7),\n\u00a7\u00a7\nCorollary 2, and Theorem 2(ii).]\n15. Show that Theorem 3 holds even if\n(i) D f is discontinuous at p~, and\n1\n(ii) f has partials on A Q only (Q countable, p~ Q), provided f is\n\u2212 6\u2208\ncontinuous on A in each of the last n 1 variables.\n\u2212\n[Hint: For k = 1, formula (13) still results by definition of D f, if a suitable \u03b4 has\n1\nbeen chosen.]\n\u2217 16. Show that Theorem 3 and Problem 15 apply also to any f: E\u2032 E\n\u2192\nwhere E\u2032 is n-dimensional with basis ~u ,...,~u (see Problem 12 in\n1 n\n{ }\n2) if we write D f for D f.\nk u~k\n\u00a7\n[Hints: Assume ~u = 1, 1 k n (if not, replace ~u by ~u /~u ; show that this\nk k k k\n| | \u2264 \u2264 | |\nyields another basis). Modify the proof so that the p~ are still in G (\u03b4). Caution:\nk p~\nThe standard norm of En does not apply here.]\n17. Let f : E1 E1 be differentiable at p (k = 1,...,n). For ~x =\nk k\n\u2192\n(x ,...,x ) En, set\n1 n\n\u2208\nn n\nF(~x) = f (x ) and G(~x) = f (x ).\nk k k k\nk=1 k=1\nX Y\nShow that F and G are differentiable at p~ = (p ,...,p ). Express\n1 n\nF(p~) and G(p~) in terms of the f\u2032(p ).\n\u2207 \u2207 k k 28 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n[Hint: In order to use Problems 7 and 8, replace the f by suitable functions defined\nk\non En. For G(p~), \u201cimitate\u201d Problem 6 in Chapter 5, 1.]\n\u2207 \u00a7\n\u00a74. The Chain Rule. The Cauchy Invariant Rule\nTogeneralizethechainrule(Chapter5, 1), weconsiderthecompositeh = g f\n\u00a7 \u25e6\nof two functions, f: E\u2032 E\u2032\u2032 and g: E\u2032\u2032 E, with E\u2032, E\u2032\u2032, and E as before.\n\u2192 \u2192\nTheorem 1 (chain rule). If\nf: E\u2032 E\u2032\u2032 and g: E\u2032\u2032 E\n\u2192 \u2192\nare differentiable at p~ and ~q = f(p~), respectively, then\nh = g f\n\u25e6\nis differentiable at p~, and\n(1) dh(p~; ) = dg(~q; ) df(p~; ).\n\u00b7 \u00b7 \u25e6 \u00b7\nBriefly: \u201cThe differential of the composite is the composite of differentials.\u201d\nProof. Let U = df(p~; ), V = dg(~q; ), and \u03c6 = V U.\n\u00b7 \u00b7 \u25e6\nAs U and V are linear continuous maps, so is \u03c6. We must show that \u03c6 =\ndh(p~; ).\n\u00b7\nHere it is more convenient to write \u2206~x or ~x p~ for the \u201c~t\u201d of Definition 1\n\u2212\nin 3. For brevity, we set (with ~q = f(p~))\n\u00a7\n(2) w(~x) = \u2206h \u03c6(\u2206~x) = h(~x) h(p~) \u03c6(~x p~), ~x E\u2032,\n\u2212 \u2212 \u2212 \u2212 \u2208\n(3) u(~x) = \u2206f U(\u2206~x) = f(~x) f(p~) U(~x p~), ~x E\u2032,\n\u2212 \u2212 \u2212 \u2212 \u2208\n(4) v(~y) = \u2206g V(\u2206~y) = g(~y) g(~q) V(~y ~q), ~y E\u2032\u2032.\n\u2212 \u2212 \u2212 \u2212 \u2208\nThen what we have to prove (see Definition 1 in 3) reduces to\n\u00a7\nw(~x)\n(5) lim = 0,\n~x\u2192p~ ~x p~\n| \u2212 |\nwhile the assumed existence of df(p~; ) = U and dg(~q; ) = V can be ex-\n\u00b7 \u00b7\npressed as\nu(~x)\n(5\u2032) lim = 0,\n~x\u2192p~ ~x p~\n| \u2212 |\nand\nv(~y)\n(5\u2032\u2032) lim = 0, ~q = f(p~).\n~y\u2192q~ ~y ~q\n| \u2212 | 4. The Chain Rule. The Cauchy Invariant Rule 29\n\u00a7\nFrom (2) and (3), recalling that h = g f and \u03c6 = V U, we obtain\n\u25e6 \u25e6\nw(~x) = g(f(~x)) g(~q) V(U(~x p~))\n(6) \u2212 \u2212 \u2212\n= g(f(~x)) g(~q) V(f(~x) f(p~) u(~x)).\n\u2212 \u2212 \u2212 \u2212\nUsing (4), with ~y = f(~x), and the linearity of V, we rewrite (6) as\nw(~x) = g(f(~x)) g(~q) V(f(~x) f(p~)) V(u(~x))\n\u2212 \u2212 \u2212 \u2212\n= v(f(~x))+V(u(~x)).\n(Verify!) Thus the desired formula (5) will be proved if we show that\nV(u(~x))\n(6\u2032) lim = 0\n~x\u2192p~ ~x p~\n| \u2212 |\nand\nv(f(~x))\n(6\u2032\u2032) lim = 0.\n~x\u2192p~ ~x p~\n| \u2212 |\nNow, as V is linear and continuous, formula (5\u2032) yields (6\u2032). Indeed,\nV(u(~x)) u(~x)\nlim = lim V = V(0) = 0\n~x\u2192p~ ~x p~ ~x\u2192p~ ~x p~\n| \u2212 | (cid:18)| \u2212 |(cid:19)\nby Corollary 2 in Chapter 4, 2. (Why?)\n\u00a7\nSimilarly, (5\u2032\u2032) implies (6\u2032\u2032) by substituting ~y = f(~x), since\nf(~x) f(p~) K ~x p~\n| \u2212 | \u2264 | \u2212 |\nby Problem 3(iii) in 3. (Explain!) Thus all is proved. (cid:3)\n\u00a7\nNote 1 (Cauchy invariant rule). Under the same assumptions, we also have\n(7) dh(p~;~t ) = dg(~q;~s)\nif ~s = df(p~;~t ), ~t E\u2032.\n\u2208\nFor with U and V as above,\ndh(p~; ) = \u03c6 = V U.\n\u00b7 \u25e6\nThus if\n~s = df(p~;~t ) = U(~t ),\nwe have\ndh(p~;~t ) = \u03c6(~t ) = V(U(~t )) = V(~s) = dg(~q;~s),\nproving (7). 30 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nNote 2. If\nE\u2032 = En(Cn), E\u2032\u2032 = Em(Cm), and E = Er(Cr)\nthen by Theorem 3 of 2 and Definition 2 in 3, we can write (1) in matrix\n\u00a7 \u00a7\nform,\n[h\u2032(p~)] = [g\u2032(~q)][f\u2032(p~)],\nresembling Theorem 3 in Chapter 5, 1 (with f and g interchanged). Moreover,\n\u00a7\nwe have the following theorem.\nTheorem 2. With all as in Theorem 1, let\nE\u2032 = En(Cn), E\u2032\u2032 = Em(Cm),\nand\nf = (f ,...,f ).\n1 m\nThen\nm\nD h(p~) = D g(~q)D f (p~);\nk i k i\ni=1\nX\nor, in classical notation,\nm\n\u2202 \u2202 \u2202\n(8) h(p~) = g(~q) f (p~), k = 1,2,...,n.\ni\n\u2202x \u2202y \u00b7 \u2202x\nk i k\ni=1\nX\nProof. Fix any basic vector ~e in E\u2032 and set\nk\n~s = df(p~;~e ), ~s = (s ,...,s ) E\u2032\u2032.\nk 1 m\n\u2208\nAs f is differentiable at p~, so are its components f (Problem 9 in 3), and\ni\n\u00a7\ns = df (p~;~e ) = D f (p~)\ni i k k i\nby Theorem 2(ii) in 3. Using also Corollary 1 in 3, we get\n\u00a7 \u00a7\nm m\ndg(~q;~s) = s D g(~q) = D f (p~)D g(~q).\ni i k i i\ni=1 i=1\nX X\nBut as ~s = df(p~;~e ), formula (7) yields\nk\ndg(~q;~s) = dh(p~;~e ) = D h(p~)\nk k\nby Theorem 2(ii) in 3. Thus the result follows. (cid:3)\n\u00a7\nNote 3. Theorem 2 is often called the chain rule for functions of several\nvariables. It yields Theorem 3 in Chapter 5, 1, if m = n = 1.\n\u00a7 4. The Chain Rule. The Cauchy Invariant Rule 31\n\u00a7\nIn classical calculus one often speaks of derivatives and differentials of vari-\nables y = f(x ,...,x ) rather than those of mappings. Thus Theorem 2 is\n1 n\nstated as follows.\nLet u = g(y ,... ,y ) be differentiable. If, in turn, each\n1 m\ny = f (x ,...,x )\ni i 1 n\nis differentiable for i = 1,...,m, then u is also differentiable as a com-\nposite function of the n variables x , and (\u201csimplifying\u201d formula (8)) we\nk\nhave\nm\n\u2202u \u2202u \u2202y\n(8\u2032) = i , k = 1,2,...,n.\n\u2202x \u2202y \u2202x\nk i k\ni=1\nX\nIt is understood that the partials\n\u2202u \u2202y\nand i are taken at some p~ E\u2032,\n\u2202x \u2202x \u2208\nk k\nwhile the \u2202u/\u2202y are at ~q = f(p~), where f = (f ,...,f ). This \u201cvariable\u201d\ni 1 m\nnotation is convenient in computations, but may cause ambiguities (see the\nnext example).\nExample.\nLet u = g(x,y,z), where z depends on x and y:\nz = f (x,y).\n3\nSet f (x,y) = x, f (x,y) = y, f = (f ,f ,f ), and h = g f; so\n1 2 1 2 3\n\u25e6\nh(x,y) = g(x,y,z).\nBy (8\u2032),\n\u2202u \u2202u \u2202x \u2202u \u2202y \u2202u \u2202z\n= + + .\n\u2202x \u2202x \u2202x \u2202y \u2202x \u2202z \u2202x\nHere\n\u2202x \u2202f \u2202y\n1\n= = 1 and = 0,\n\u2202x \u2202x \u2202x\nfor f does not depend on x. Thus we obtain\n2\n\u2202u \u2202u \u2202u \u2202z\n(9) = + .\n\u2202x \u2202x \u2202z \u2202x\n(Question: Is \u2202u/\u2202z \u2202z/\u2202x = 0?)\nThe trouble with (9) is that the variable u \u201cposes\u201d as both g and h.\n(cid:0) (cid:1)(cid:0) (cid:1)\nOn the left, it is h; on the right, it is g. 32 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nTo avoid this, our method is to differentiate well-defined mappings, not\n\u201cvariables.\u201d Thus in (9), we have the maps\ng: E3 E and f: E2 E3,\n\u2192 \u2192\nwith f ,f ,f as indicated. Then if h = g f, Theorem 2 states (9)\n1 2 3\n\u25e6\nunambiguously as\nD h(p~) = D g(~q)+D g(~q) D f(p~),\n1 1 3 1\n\u00b7\nwhere p~ E2 and\n\u2208\n~q = f(p~) = (p ,p ,f (p~)).\n1 2 3\n(Why?) In classical notation,\n\u2202h \u2202g \u2202g \u2202f\n3\n= +\n\u2202x \u2202x \u2202z \u2202x\n(avoiding the \u201cparadox\u201d of (9)).\nNonetheless, with due caution, one may use the \u201cvariable\u201d notation where\nconvenient. The reader should practice both (see the Problems).\nNote 4. The Cauchy rule (7), in \u201cvariable\u201d notation, turns into\nm n\n\u2202u \u2202u\n(10) du = dy = dx ,\ni k\n\u2202y \u2202x\ni k\ni=1 k=1\nX X\nwhere dx = t and dy = df (p~;~t ).\nk k i i\nIndeed, by Corollary 1 in 3,\n\u00a7\nn m\ndh(p~;~t ) = D h(p~) t and dg(~q;~s) = D g(~q) s .\nk k i i\n\u00b7 \u00b7\nk=1 i=1\nX X\nNow, in (7),\n~s = (s ,...,s ) = df(p~;~t );\n1 m\nso by Problem 9 in 3,\n\u00a7\ndf (p~;~t ) = s , i = 1,...,m.\ni i\nRewriting all in the \u201cvariable\u201d notation, we obtain (10).\nThe \u201cadvantage\u201d of (10) is that du has the same form, independently of\nwhether u is treated as a function of the x or of the y (hence the name\nk i\n\u201cinvariant\u201d rule). However, one must remember the meaning of dx and dy ,\nk i\nwhich are quite different.\nThe \u201cinvariance\u201d also fails completely for differentials of higher order ( 5).\n\u00a7\nTheadvantagesofthe\u201cvariable\u201dnotationvanishunlessoneisableto\u201ctrans-\nlate\u201d it into precise formulas. 4. The Chain Rule. The Cauchy Invariant Rule 33\n\u00a7\nFurther Problems on Differentiable Functions\n1. For E = Er(Cr) prove Theorem 2 directly.\n[Hint: Find\nD khj(p~), j =1,...,r,\nfrom Theorem 4 of 3, and Theorem 3 of 2. Verify that\n\u00a7 \u00a7\nr r\nD kh(p~)= ejD khj(p~) and Dig(~q)= ejDigj(q~),\nj=1 j=1\nX X\nwhere the ej are the basic unit vectors in Er. Proceed.]\n2. Let g(x,y,z) = u, x = f (r,\u03b8), y = f (r,\u03b8), z = f (r,\u03b8), and\n1 2 3\nf = (f ,f ,f ): E2 E3.\n1 2 3\n\u2192\nAssuming differentiability, verify (using \u201cvariables\u201d) that\n\u2202u \u2202u \u2202u \u2202u \u2202u\ndu = dx+ dy + dz = dr+ d\u03b8\n\u2202x \u2202y \u2202z \u2202r \u2202\u03b8\nbycomputingderivativesfrom(8\u2032). Thendoallinthemappingnotation\nfor H = g f, dH(p~;~t ).\n\u25e6\n3. For the specific functions f, g, h, and k of Problems 4 and 5 of 2, set\n\u00a7\nup and solve problems analogous to Problem 2, using\n(a) k f; (b) g k; (c) f h; (d) h g.\n\u25e6 \u25e6 \u25e6 \u25e6\n4. For the functions of Problem 5 in 1, find the formulas for df(p~;~t ). At\n\u00a7\nwhichp~ doesdf(p~; )existineachgivencase? Describeitforachosenp~.\n\u00b7\n5. From Theorem 2, with E = E1(C), find\nn\nh(p~) = D g(~q) f (p~).\nk k\n\u2207 \u2207\nk=1\nX\n6. Use Theorem 1 for a new solution of Problem 7 in 3 with E = E1(C).\n\u00a7\n[Hint: Define F on E and G on E2(C2) by\n\u2032\nF(~x)=(f(~x),g(~x)) and G(~y)=ay +by .\n1 2\nThen h = af +bg = G F. (Why?) Use Problems 9 and 10(ii) of 3. Do all in\n\u25e6 \u00a7\n\u201cvariable\u201d notation, too.]\n7. Use Theorem 1 for a new proof of the \u201conly if\u201d in Problem 9 in 3.\n\u00a7\n[Hint: Set fi = g f, where g(~x) = xi (the ith \u201cprojection map\u201d) is a monomial.\n\u25e6\nVerify!]\n8. Do Problem 8(i) in 3 for the case E\u2032 = E2(C2), with\n\u00a7\nf(~x) = x and g(~x) = x .\n1 2 34 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n(Simplify!) Then do the general case as in Problem 6 above, with\nG(~y) = y y .\n1 2\n9. Use Theorem 2 for a new proof of Theorem 4 in Chapter 5, 1. (Proceed\n\u00a7\nas in Problems 6 and 8, with E\u2032 = E1, so that D h = h\u2032.) Do it in the\n1\n\u201cvariable\u201d notation, too.\n10. Under proper differentiability assumptions, use formula (8\u2032) to express\nthe partials of u if\n(i) u = g(x,y), x = f(r)h(\u03b8), y = r +h(\u03b8)+\u03b8f(r);\n(ii) u = g(r,\u03b8), r = f(x+f(y)), \u03b8 = f(xf(y));\n(iii) u = g(xy,yz,zx+y).\nThen redo all in the \u201cmapping\u201d terminology, too.\n11. Let the map g: E1 E1 be differentiable on E1. Find h(p~) if\n\u2192 |\u2207 |\nh = g f and\n\u25e6\nn\n(i) f(~x) = x , ~x En;\nk\n\u2208\nk=1\nX\n(ii) f(~x) = ~x 2, ~x En.\n| | \u2208\n12. (Euler\u2019s theorem.) A map f: En E1 (or Cn C) is called homoge-\n\u2192 \u2192\nneous of degree m on G iff\n( t E1(C)) f(t~x) = tmf(~x)\n\u2200 \u2208\nwhen ~x, t~x G. Prove the following statements.\n\u2208\n(i) If so, and f is differentiable at p~ G (an open globe), then\n\u2208\np~ f(p~) = mf(p~).\n\u00b7\u2207\n\u2217(ii) Conversely, if the latter holds for all p~ G and if~0 G, then f is\n\u2208 6\u2208\nhomogeneous of degree m on G.\n(iii) What if ~0 G?\n\u2208\n[Hints: (i) Let g(t) = f(tp~). Find g (1). (iii) Take f(x,y) = x2y2 if x 0, f = 0 if\n\u2032\n\u2264\nx>0, G=G (1).]\n0\n13. Try Problem 12 for f: E\u2032 E, replacing p~ f(p~) by df(p~;p~).\n\u2192 \u00b7\u2207\n14. With all as in Theorem 1, prove the following.\n(i) If E\u2032 = E1 and ~s = f\u2032(p) =~0, then h\u2032(p) = D g(~q).\n~s\n6\n(ii) If ~u and~v are nonzero in E\u2032 and a~u+b~v =~0 for some scalars a,b,\n6\nthen\nD f(p~) = aD f(p~)+bD f(p~).\na~u+b~v u~ ~v 4. The Chain Rule. The Cauchy Invariant Rule 35\n\u00a7\n(iii) If f is differentiable on a globe G , and ~u =~0 in E\u2032, then\np~\n6\nD f(p~) = lim D (p~).\nu~ ~x\n~x\u2192u~\n[Hints: Use Theorem 2(ii) from 3 and Note 1.]\n\u00a7\n15. Use Theorem 2 to find the partially derived functions of f, if\nx\n(i) f(x,y,z) = sin(xy/z) ;\n(ii) f(x,y) = log(cid:0) tan(y/x(cid:1)) .\nx\n(Set f = 0 wherever(cid:12) undefine(cid:12)d.)\n(cid:12) (cid:12)\n\u00a75. Repeated Differentiation. Taylor\u2019s Theorem\nIn 1 we defined ~u-directed derived functions, D f for any f: E\u2032 E and any\nu~\n\u00a7 \u2192\n~u =~0 in E\u2032.\n6\nThus given a sequence ~u E\u2032 ~0 , we can first form D f, then\ni u~1\n{ } \u2286 \u2212 { }\nD (D f) (the ~u -directed derived function of D f), then the ~u -directed\n~u2 ~u1 2 u~1 3\nderived function of D (D f), and so on. We call all functions so formed the\nu~2 u~1\nhigher-order directional derived functions of f.\nIf at each step the limit postulated in Definition 1 of 1 exists for all p~ in a\n\u00a7\nset B E\u2032, we call them the higher-order directional derivatives of f (on B).\n\u2286\nIf all ~u are basic unit vectors in En(Cn), we say \u201cpartial\u201d instead of \u201cdi-\ni\nrectional.\u201d\nWe also define D1f = D f and\n~u u~\n(1) Dk f = D (Dk\u22121 f), k = 2,3,...,\n~u1~u2...~uk u~k u~1u~2...~uk\u22121\nand call Dk f a directional derived function of order k. (Some authors\n~u1~u2...~uk\ndenote it by Dk f.)\n~uk~uk\u22121...~u1\nIf all ~u equal ~u, we write Dkf instead.\ni u~\nFor partially derived functions, we simplify this notation, writing 12 ... for\n~e ~e ... and omitting the \u201ck\u201d in Dk (except in classical notation):\n1 2\n\u22022f \u22022f\nD f = D2 f = , D f = D2 f = , etc.\n12 ~e1~e2 \u2202x \u2202x 11 ~e1~e1 \u2202x2\n1 2 1\nWe also set D0f = f for any vector ~u.\n~u\nExample.\n(A) Define f: E2 E1 by\n\u2192\nxy(x2 y2)\nf(0,0) = 0, f(x,y) = \u2212 .\nx2 +y2 36 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nThen\n\u2202f y(x4 +4x2y2 y4)\n= D f(x,y) = \u2212 ,\n\u2202x 1 (x2 +y2)2\nwhence D f(0,y) = y if y = 0; and also\n1\n\u2212 6\nf(x,0) f(0,0)\nD f(0,0) = lim \u2212 = 0. (Verify!)\n1\nx\u21920 x\nThus D f(0,y) = y always, and so D f(0,y) = 1; D f(0,0) = 1.\n1 12 12\n\u2212 \u2212 \u2212\nSimilarly,\nx(x4 4x2y2 y4)\nD f(x,y) = \u2212 \u2212\n2\n(x2 +y2)2\nif x = 0 and D f(0,0) = 0. Thus ( x) D f(x,0) = x and so\n2 2\n6 \u2200\nD f(x,0) = 1 and D f(0,0) = 1 = D f(0,0) = 1.\n21 21 12\n6 \u2212\nThe previous example shows that we may well have D f = D f, or more\n12 21\n6\ngenerally, D2 f = D2 f. However, we obtain the following theorem.\n~u~v 6 ~vu~\nTheorem 1. Given nonzero vectors ~u and ~v in E\u2032, suppose f: E\u2032 E has\n\u2192\nthe derivatives\nD f, D f, and D2 f\nu~ ~v u~~v\non an open set A E\u2032.\n\u2286\nIf D2 f is continuous at some p~ A, then the derivative D2 f(p~) also\n~u~v \u2208 ~vu~\nexists and equals D2 f(p~).\n~u~v\nProof. By Corollary 1 in 1, all reduces to the case ~u = 1 = ~v . (Why?)\n\u00a7 | | | |\nGiven \u03b5 > 0, fix \u03b4 > 0 so small that G = G (\u03b4) A and simultaneously\np~\n\u2286\n(2) sup D2 f(~x) D2 f(p~) \u03b5\n| u~~v \u2212 u~~v | \u2264\n~x\u2208G\n(by the continuity of D2 f at p~).\nu~~v\nNow ( s,t E1) define H : E1 E by\nt\n\u2200 \u2208 \u2192\nH (s) = D f(p~ +t~u +s~v).\nt u~\nLet\n\u03b4 \u03b4\nI = , .\n\u22122 2\n(cid:16) (cid:17)\nIf s,t I, the point ~x = p~ +t~u +s~v is in G (\u03b4) A, since\np~\n\u2208 \u2286\n\u03b4 \u03b4\n~x p~ = t~u +s~v < + = \u03b4.\n| \u2212 | | | 2 2 5. Repeated Differentiation. Taylor\u2019s Theorem 37\n\u00a7\nThus by assumption, the derivative D2 f(p~) exists. Also,\nu~~v\n1\nH\u2032(s) = lim [H (s+\u2206s) H (s)]\nt \u2206s\u21920 \u2206s t \u2212 t\n1\n= lim [D f(~x +\u2206s ~v) D f(~x)].\nu~ u~\n\u2206s\u21920 \u2206s \u00b7 \u2212\nBut the last limit is D2 f(~x), by definition. Thus, setting\nu~~v\nh (s) = H (s) sD2 f(p~),\nt t \u2212 u~~v\nwe get\nh\u2032(s) = H\u2032(s) D2 f(p~)\nt t \u2212 u~~v\n= D2 f(~x) D2 f(p~).\nu~~v \u2212 u~~v\nWe see that h is differentiable on I, and by (2),\nt\nsup h\u2032(s) sup D2 f(~x) D2 f(p~) \u03b5\n| t | \u2264 | u~~v \u2212 u~~v | \u2264\ns\u2208I ~x\u2208G\nfor all t I. Hence by Corollary 1 of Chapter 5, 4,\n\u2208 \u00a7\nh (s) h (0) s sup h\u2032(\u03c3) s \u03b5.\n| t \u2212 t \u2264 | | | t | \u2264 | |\n\u03c3\u2208I\nBut by definition,\nh (s) = D f(p~ +t~u +s~v) sD2 f(p~)\nt u~ \u2212 u~~v\nand\nh (0) = D f(p~ +t~u).\nt u~\nThus\n(3) D f(p~ +t~u +s~v) D f(p~ +t~u) sD2 f(p~) s \u03b5\n| ~u \u2212 u~ \u2212 u~~v | \u2264 | |\nfor all s,t I.\n\u2208\nNext, set\nG (t) = f(p~ +t~u +s~v) f(p~ +t~u)\ns\n\u2212\nand\ng (t) = G (t) st D2 f(p~).\ns s \u2212 \u00b7 u~~v\nAs before, one finds that ( s I) g is differentiable on I and that\ns\n\u2200 \u2208\ng\u2032(t) = D f(p~ +t~u +s~v) D f(p~ +t~u) sD2 f(p~)\ns u~ \u2212 u~ \u2212 u~~v\nfor s,t I. (Verify!)\n\u2208\nHence by (3),\nsup g\u2032(t) s \u03b5.\n| s | \u2264 | |\nt\u2208I 38 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nAgain, by Corollary 1 of Chapter 5, 4,\n\u00a7\ng (t) g (0) st \u03b5,\ns s\n| \u2212 | \u2264 | |\nor by the definition of g (assuming s,t I 0 and dividing by st),\ns\n\u2208 \u2212{ }\n1 1\n[f(p~ +t~u +s~v) f(p~ +t~u)] D2 f(p~) [f(p~ +s~v) f(p~)] \u03b5.\nst \u2212 \u2212 u~~v \u2212 st \u2212 \u2264\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(Ve(cid:12)rify!) Making s 0 (with t fixed), we get, by the definition of D ~v(cid:12)f,\n\u2192\n1 1\nD f(p~ +t~u) D f(p~) D2 f(p~) \u03b5\nt ~v \u2212 t ~v \u2212 u~~v \u2264\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nwhenever 0 < t <(cid:12) \u03b4/2. (cid:12)\n| |\nAs \u03b5 is arbitrary, we have\n1\nD2 f(p~) = lim [D f(p~ +t~u) D f(p~)].\n~u~v t\u21920 t v \u2212 ~v\nBut by definition, this limit is the derivative D2 f(p~). Thus all is proved. (cid:3)\n~vu~\nNote 1. By induction, the theorem extends to derivatives of order > 2.\nThus the derivative Dk f is independent of the order in which the ~u\nu~1u~2...u~k i\nfollow each other if it exists and is continuous on an open set A E\u2032, along\n\u2286\nwith appropriate derivatives of order < k.\nIf E\u2032 = En(Cn), this applies to partials as a special case.\nFor En and Cn only, we also formulate the following definition.\nDefinition 1.\nLet E\u2032 = En(Cn). We say that f: E\u2032 E is m times differentiable at\n\u2192\np~ E\u2032 iff f and all its partials of order < m are differentiable at p~.\n\u2208\nIf this holds for all p~ in a set B E\u2032, we say that f is m times\n\u2286\ndifferentiable on B.\nIf, in addition, all partials of order m are continuous at p~ (on B), we\nsay that f is of class CDm, or continuously differentiable m times there,\nand write f CDm at p~ (on B).\n\u2208\nFinally, if this holds for all natural m, we write f CD\u221e at p~ (on B,\n\u2208\nrespectively).\nDefinition 2.\nGiven the space E\u2032 = En(Cn), the function f: E\u2032 E, and a point\n\u2192\np~ E\u2032, we define the mappings\n\u2208\ndmf(p~; ), m = 1,2,...,\n\u00b7 5. Repeated Differentiation. Taylor\u2019s Theorem 39\n\u00a7\nfrom E\u2032 to E by setting for every ~t = (t ,...,t )\n1 n\nn\nd1f(p~;~t ) = D f(p~) t ,\ni i\n\u00b7\ni=1\nX\nn n\n(4) d2f(p~;~t ) = D ijf(p~) t it j,\n\u00b7\nj=1 i=1\nXX\nn n n\nd3f(p~;~t ) = D f(p~) t t t , and so on.\nijk i j k\n\u00b7\nk=1j=1 i=1\nXXX\nWe call dmf(p~; ) the mth differential (or differential of order m) of f at p~.\n\u00b7\nBy our conventions, it is always defined on En(Cn) as are the partially derived\nfunctions involved.\nIf f is differentiable at p~ (but not otherwise), then d1f(p~;~t ) = df(p~;~t )\nby Corollary 1 in 3; d1f(p~; ) is linear and continuous (why?) but need not\n\u00a7 \u00b7\nsatisfy Definition 1 in 3.\n\u00a7\nIn classical notation, we write dx for t ; e.g.,\ni i\nn n \u22022f\nd2f = dx dx .\ni j\n\u2202x \u2202x\ni j\nj=1 i=1\nXX\nNote 2. Classical analysis tends to define differentials as above in terms of\npartials. Formula (4) for dmf is often written symbolically:\n\u2202 \u2202 \u2202 m\n(5) dmf = dx + dx + + dx f, m = 1,2,...\n1 2 n\n\u2202x \u2202x \u00b7\u00b7\u00b7 \u2202x\n1 2 n\n(cid:16) (cid:17)\nIndeed, raising the bracketed expression to the mth \u201cpower\u201d as in algebra\n(removing brackets, withoutcollecting\u201csimilar\u201dterms)andthen\u201cmultiplying\u201d\nby f, we obtain sums that agree with (4). (Of course, this is not genuine\nmultiplication but only a convenient memorizing device.)\nExample.\n(B) Define f: E2 E1 by\n\u2192\nf(x,y) = xsiny.\nTake any p~ = (x,y) E2. Then\n\u2208\nD f(x,y) = siny and D f(x,y) = xcosy;\n1 2\nD f(x,y) = D f(x,y) = cosy,\n12 21\nD f(x,y) = 0, and D f(x,y) = xsiny;\n11 22\n\u2212\nD f(x,y) = D f(x,y) = D f(x,y) = D f(x,y) = 0,\n111 112 121 211\nD f(x,y) = D f(x,y) = D f(x,y) = siny, and\n221 212 122\n\u2212 40 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nD f(x,y) = xcosy; etc.\n222\n\u2212\nAs is easily seen, f has continuous partials of all orders; so f CD\u221e on\n\u2208\nall of E2. Also,\ndf(p~;~t ) = t D f(p~)+t D f(p~)\n1 1 2 2\n= t siny +t xcosy.\n1 2\nIn classical notation,\n\u2202f \u2202f\ndf = d1f = dx+ dy\n\u2202x \u2202y\n= sinydx+xcosydy;\n\u22022f \u22022f \u22022f\nd2f = dx2 +2 dxdy + dy2\n\u2202x2 \u2202x\u2202y \u2202y2\n= 2 cosydxdy xsinydy2;\n\u2212\nd3f = 3sinydxdy2 xcosydy3;\n\u2212 \u2212\nand so on. (Verify!)\nWe can now extend Taylor\u2019s theorem (Theorem 1 in Chapter 5, 6) to the\n\u00a7\ncase E\u2032 = En(Cn).\nTheorem 2 (Taylor). Let ~u = ~x p~ =~0 in E\u2032 = En(Cn).\n\u2212 6\nIf f: E\u2032 E is m+1 times differentiable on the line segment\n\u2192\nI = L[p~,~x] E\u2032\n\u2282\nthen\nm\n1\nf(~x) f(p~) = dif(p~;~u)+R ,\nm\n\u2212 i!\ni=1\nX\nwith\nK\n(6) R m , K E1,\nm m\n| | \u2264 (m+1)! \u2208\nand\n(6\u2032) 0 K sup dm+1f(~s;~u) .\nm\n\u2264 \u2264 | |\n~s\u2208I\nProof. Define g: E1 E\u2032 and h: E1 E by g(t) = p~ +t~u and h = f g.\n\u2192 \u2192 \u25e6\nAs E\u2032 = En(Cn), we may consider the components of g,\ng (t) = p +tu , k n.\nk k k\n\u2264\nClearly, g is differentiable, g\u2032(t) = u .\nk k k 5. Repeated Differentiation. Taylor\u2019s Theorem 41\n\u00a7\nBy assumption, so is f on I = L[p~,~x]. Thus, by the chain rule, h = f g is\n\u25e6\ndifferentiable on the interval J = [0,1] E1; for, by definition,\n\u2282\np~ +t~u L[p~,~x] iff t [0,1].\n\u2208 \u2208\nBy Theorem 2 in 4,\n\u00a7\nn\n(7) h\u2032(t) = D f(p~ +t~u) u = df(p~ +t~u;~u), t J.\nk k\n\u00b7 \u2208\nk=1\nX\n(Explain!)\nBy assumption (and Definition 1), the D f are differentiable on I. Hence,\nk\nby (7), h\u2032 is differentiable on J. Reapplying Theorem 2 in 4, we obtain\n\u00a7\nn n\nh\u2032\u2032(t) = D f(p~ +t~u) u u\nkj k j\n\u00b7\nj=1k=1\nXX\n= d2f(p~ +t~u;~u), t J.\n\u2208\nBy induction, h is m+1 times differentiable on J, and\n(8) h(i)(t) = dif(p~ +t~u;~u), t J, i = 1,2,...,m+1.\n\u2208\nThe differentiability of h(i) (i m) implies its continuity on J = [0,1].\n\u2264\nThus h satisfies Theorem 1 of Chapter 5, 6 (with x = 1, p = 0, and Q = );\n\u00a7 \u2205\nhence\nm h(i)(0)\nh(1) h(0) = +R ,\nm\n\u2212 i!\ni=1\nX\n(9) R K m , K E1,\nm m\n| | \u2264 (m+1)! \u2208\nK sup h(m+1)(t) .\nm\n\u2264 | |\nt\u2208J\nBy construction,\nh(t) = f(g(t)) = f(p~ +t~u);\nso\nh(1) = f(p~ +~u) = f(~x) and h(0) = f(p~).\nThus using (8) also, we see that (9) implies (6), indeed. (cid:3)\nNote 3. Formula (3\u2032) of Chapter 5, 6, combined with (8), also yields\n\u00a7\n1 1\nR = h(m+1)(t) (1 t)mdt\nm\nm! \u00b7 \u2212\nZ0\n1 1\n= dm+1f(p~ +t~u;~u) (1 t)mdt.\nm! \u00b7 \u2212\nZ0 42 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nCorollary 1 (the Lagrange form of R ). If E = E1 in Theorem 2, then\nm\n1\n(10) R = dm+1f(~s;~u)\nm\n(m+1)!\nfor some ~s L(p~,~x).\n\u2208\nProof. Here the function h defined in the proof of Theorem 2 is real; so The-\norem 1\u2032 and formula (3\u2032) of Chapter 5, 6 apply. This yields (10). Explain! (cid:3)\n\u00a7\nCorollary 2. If f: En(Cn) E is m times differentiable at p~ and if ~u =~0\n\u2192 6\n(p~,~u En(Cn)), then the derivative Dmf(p~) exists and equals dmf(p~;~u).\n\u2208 u~\nThis follows as in the proof of Theorem 2 (with t = 0). For by definition,\n1\nD f(p~) = lim [f(p~ +s~u) f(p~)]\nu~\ns\u21920 s \u2212\n1\n= lim [h(s) h(0)]\ns \u2212\n= h\u2032(0) = df(p~;~u)\nby (7). Induction yields\nDmf(p~) = h(m)(0) = dm(p~;~u)\nu~\nby (8). (See Problem 3.)\nExample.\n(C) Continuing Example (B), fix\np~ = (1,0);\nthusreplace(x,y)by(1,0)there. Instead, write(x,y)for~x inTheorem2.\nThen\n~u = ~x p~ = (x 1,y);\n\u2212 \u2212\nso\nu = x 1 = dx and u = y = dy,\n1 2\n\u2212\nand we obtain\ndf(p~;~u) = D f(1,0) (x 1)+D f(1,0) y\n1 2\n\u00b7 \u2212 \u00b7\n= (sin0) (x 1)+(1 cos0) y\n\u00b7 \u2212 \u00b7 \u00b7\n= y;\nd2f(p~;~u) = D f(1,0) (x 1)2 +2D f(1,0) (x 1)y\n11 12\n\u00b7 \u2212 \u00b7 \u2212\n+D f(1,0) y2\n22\n\u00b7\n= (0) (x 1)2 +2(cos0) (x 1)y (1 sin0) y2\n\u00b7 \u2212 \u00b7 \u2212 \u2212 \u00b7 \u00b7\n= 2(x 1)y;\n\u2212 5. Repeated Differentiation. Taylor\u2019s Theorem 43\n\u00a7\nand for all ~s = (s ,s ) I,\n1 2\n\u2208\nd3f(~s;~u) = D f(s ,s ) (x 1)3 +3D f(s ,s ) (x 1)2y\n111 1 2 112 1 2\n\u00b7 \u2212 \u00b7 \u2212\n(10\u2032) +3D f(s ,s ) (x 1)y2 +D f(s ,s ) y3\n122 1 2 222 1 2\n\u00b7 \u2212 \u00b7\n= 3sins (x 1)y2 s coss y3.\n2 1 2\n\u2212 \u00b7 \u2212 \u2212 \u00b7\nHence by (6) and Corollary 1 (with m = 2), noting that f(p~) = f(1,0) =\n0, we get\nf(x,y) = x siny\n(11) \u00b7\n= y +(x 1)y +R ,\n2\n\u2212\nwhere for some ~s I,\n\u2208\n1 1\nR = d3f(~s;~u) = 3sins (x 1)y2 s coss y3 .\n2 2 1 2\n3! 6 \u2212 \u00b7 \u2212 \u2212 \u00b7\n(cid:2) (cid:3)\nAs ~s L(p~,~x), where p~ = (1,0) and ~x = (x,y), s is between 1 and x;\n1\n\u2208\nso\ns max( x ,1) x +1.\n1\n| | \u2264 | | \u2264 | |\nFinally, since sins 1 and coss 1, we obtain\n2 2\n| | \u2264 | | \u2264\n1\nR 3 x 1 +( x +1) y y2.\n2\n| | \u2264 6 | \u2212 | | | | |\n(cid:2) (cid:3)\nThisboundsthemaximumerrorthatarisesifweuse(11)toexpressxsiny\nas a second-degree polynomial in (x 1) and y. (See also Problem 4 and\n\u2212\nNote 4 below.)\nNote 4. Formula (6), briefly\nm dif\n\u2206f = +R ,\n2\ni!\ni=1\nX\ngeneralizes formula (2) in Chapter 5, 6.\n\u00a7\nAs in Chapter 5, 6, we set\n\u00a7\nm\n1\nP (~x) = f(p~)+ dif(p~;~x p~)\nm\ni! \u2212\ni=1\nX\nand call P the mth Taylor polynomial for f about p~, treating it as a function\nm\nof n variables x , with ~x = (x ,...,x ).\nk 1 n\nWhen expanded as in Example (C), formula (6) expresses f(~x) in powers of\nu = x p , k = 1,...,n,\nk k k\n\u2212\nplus the remainder term R .\nm 44 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nIf f CD\u221e on some G and if R 0 as m , we can express f(~x) as\np~ m\n\u2208 \u2192 \u2192 \u221e\na convergent power series\n\u221e\n1\nf(~x) = lim P (~x) = f(p~)+ dif(p~;~x p~).\nm\nm\u2192\u221e i! \u2212\ni=1\nX\nWe then say that f admits a Taylor series about p~, on G .\np~\nProblems on Repeated Differentiation and Taylor Expansions\n1. Complete all details in the proof of Theorem 1. What is the motivation\nfor introducing the auxiliary functions h and g in this particular way?\nt s\n2. Is symbolic \u201cmultiplication\u201d in Note 2 always commutative? (See Ex-\nample (A).) Why was it possible to collect \u201csimilar\u201d terms\n\u22022f \u22022f\ndxdy and dydx\n\u2202x\u2202y \u2202y\u2202x\nin Example (B)? Using (5), find the general formula for d3f. Expand it!\n3. Carry out the induction in Theorem 2 and Corollary 2. (Use a suitable\nnotation for subscripts: k k ... instead of jk....)\n1 2\n4. Do Example (C) with m = 3 (instead of m = 2) and with p~ = (0,0).\nShow that R 0, i.e., f admits a Taylor series about p~.\nm\n\u2192\nDo it in the following two ways.\n(i) Use Theorem 2.\n(ii) Expand siny as in Problem 6(a) in Chapter 5, 6, and then mul-\n\u00a7\ntiply termwise by x.\nGive an estimate for R .\n3\n5. Use Theorem 2 to expand the following functions in powers of x 3 and\n\u2212\ny +2 exactly (choosing m so that R = 0).\nm\n(i) f(x,y) = 2xy2 3y3 +yx2 x3;\n\u2212 \u2212\n(ii) f(x,y) = x4 x3y2 +2xy 1;\n\u2212 \u2212\n(iii) f(x,y) = x5y axy5 x3.\n\u2212 \u2212\n6. For the functions of Problem 15 in 4, give their Taylor expansions up\n\u00a7\nto R , with\n2\n\u03c0\np~ = 1, ,1\n4\n(cid:16) (cid:17)\nin case (i) and\n\u03c0\np~ = e, e\n4\n(cid:16) (cid:17)\nin (ii). Bound R .\n2 5. Repeated Differentiation. Taylor\u2019s Theorem 45\n\u00a7\n7. (Generalized Taylor theorem.) Let ~u = ~x p~ = ~0 in E\u2032 (E\u2032 need not\n\u2212 6\nbe En or Cn); let I = L[p~,~x]. Prove the following statement:\nIf f: E\u2032 E and the derived functions Di f (i m) are relatively\n\u2192 u~ \u2264\ncontinuous on I and have ~u-directed derivatives on I Q (Q countable),\n\u2212\nthen formula (6) and Note 3 hold, with dif(p~;~u) replaced by Di f(p~).\nu~\n[Hint: Proceed as in Theorem 2 without using the chain rule or any partials or\ncomponents. Instead of (8), prove that h(i)(t) = Di f(p~ +t~u) on J Q , Q =\nu~ \u2212 \u2032 \u2032\ng 1[Q].]\n\u2212\n8. (i) Modify Problem 7 by setting\n~x p~\n~u = \u2212 .\n~x p~\n| \u2212 |\nThus expand f(~x) in powers of ~x p~ .\n| \u2212 |\n(ii) Deduce Theorem 2 from Problem 7, using Corollary 2.\n9. Given f: E2(C2) E, f CDm on an open set A, and ~s A, prove\n\u2192 \u2208 \u2208\nthat ( ~u E2(C2))\n\u2200 \u2208\ni\ni\ndif(~s;~u) = uj ui\u2212j D f(~s), 1 i m,\nj 1 2 k1...ki \u2264 \u2264\nj=0(cid:18) (cid:19)\nX\nwhere the i are binomial coefficients, and in the jth term,\nj\n(cid:0) (cid:1) k = k = = k = 2\n1 2 j\n\u00b7\u00b7\u00b7\nand\nk = = k = 1.\nj+1 i\n\u00b7\u00b7\u00b7\nThen restate formula (6) for n = 2.\n[Hint: Use induction, as in the binomial theorem.]\n\u21d210. Given p~ E\u2032 = En(Cn) and f: E\u2032 E, prove that f CD1 at p~ iff\n\u2208 \u2192 \u2208\nf is differentiable at p~ and\n( \u03b5 > 0) ( \u03b4 > 0) ( ~x G (\u03b4)) d1f(p~; ) d1f(~x; ) < \u03b5,\np~\n\u2200 \u2203 \u2200 \u2208 k \u00b7 \u2212 \u00b7 k\nwith norm as in Definition 2 in 2. (Does it apply?)\nk k \u00a7\n[Hint: If f CD1, use Theorem 2 in 3. For the converse, verify that\n\u2208 \u00a7\nn\n\u03b5 d1f(p~;~t) d1f(~x;~t) = [D f(p~) D f(~x)]t\nk k k\n\u2265| \u2212 | \u2212\n(cid:12)k=1 (cid:12)\n(cid:12)X (cid:12)\n(cid:12) (cid:12)\nif ~x G (\u03b4) and ~t 1. Take~t =~e , to p(cid:12)rove continuity of D f at(cid:12)p~.]\np~ k k\n\u2208 | |\u2264\n11. Prove the following.\n(i) If \u03c6: En Em is linear and [\u03c6] = (v ), then\nik\n\u2192\n\u03c6 2 v 2.\nik\nk k \u2264 | |\ni,k\nX 46 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n(ii) If f: En Em is differentiable at p~, then\n\u2192\ndf(p~; ) 2 D f (p~) 2.\nk i\nk \u00b7 k \u2264 | |\ni,k\nX\n(iii) Hence find a new converse proof in Problem 10 for f: En Em.\n\u2192\nConsider f: Cn Cm, too.\n\u2192\n[Hints: (i) By the Cauchy\u2013Schwarz inequality, \u03c6(~x)2 ~x 2 v 2. (Why?)\n| | \u2264 | | i,k| ik |\n(ii) Use part (i) and Theorem 4 in 3.]\n\u00a7 P\n12. (i) Find d2u for the functions of Problem 10 in 4, in the \u201cvariable\u201d\n\u00a7\nand \u201cmapping\u201d notations.\n(ii) Do it also for\nu = f(x,y,z) = (x2 +y2 +z2)\u2212 21\nand show that D f +D f +D f = 0.\n11 22 33\ny\n(iii) Does the latter hold for u = arctan ?\nx\n13. Let u = g(x,y), x = rcos\u03b8, y = rsin\u03b8 (passage to polars).\nUsing \u201cvariables\u201d and then the \u201cmappings\u201d notation, prove that if g\nis differentiable, then\n\u2202u \u2202u \u2202u\n(i) = cos\u03b8 +sin\u03b8 and\n\u2202r \u2202x \u2202y\n\u2202u 2 1 \u2202u 2\n(ii) g(x,y) 2 = + .\n|\u2207 | \u2202r r \u2202\u03b8\n(cid:16) (cid:17) (cid:16) (cid:17)\n\u22022u \u22022u \u22022u\n(iii) Assuming g CD2, express , , and as in (i).\n\u2208 \u2202r\u2202\u03b8 \u2202r2 \u2202\u03b82\n14. Letf,g: E1 E1 beofclassCD2 onE1. Verify(in\u201cvariable\u201dnotation,\n\u2192\ntoo) the following statements.\n(i) D h = a2D h if a E1 (fixed) and\n11 22\n\u2208\nh(x,y) = f(ax+y)+g(y ax).\n\u2212\n(ii) x2D h(x,y)+2xyD h(x,y)+y2D h(x,y) = 0 if\n11 12 22\ny y\nh(x,y) = xf +g .\nx x\n(cid:16) (cid:17) (cid:16) (cid:17)\n(iii) D h D h = D h D h if\n1 21 2 11\n\u00b7 \u00b7\nh(x,y) = g(f(x)+y).\nFind D h, too.\n12 5. Repeated Differentiation. Taylor\u2019s Theorem 47\n\u00a7\n15. Assume E\u2032 = En(Cn) and E\u2032\u2032 = Em(Cm). Let f: E\u2032 E\u2032\u2032 and\n\u2192\ng: E\u2032\u2032 E be twice differentiable at p~ E\u2032 and ~q = f(p~) E\u2032\u2032,\n\u2192 \u2208 \u2208\nrespectively, and set h = g f.\n\u25e6\nShow that h is twice differentiable at p~, and\nd2h(p~;~t ) = d2g(~q;~s)+dg(~q;~v),\nwhere ~t E\u2032, ~s = df(p~;~t ), and ~v = (v ,...,v ) E\u2032\u2032 satisfies\n1 m\n\u2208 \u2208\nv = d2f (p~;~t ), i = 1,...,m.\ni i\nThus the second differential is not invariant in the sense of Note 4 in 4.\n\u00a7\n[Hint: Show that\nm m m\nD klh(p~)= Dijg(~q)D kfi(p~)D lfj(p~)+ Dig(q~)D klfi(p~).\nj=1i=1 i=1\nXX X\nProceed.]\n16. Continuing Problem 15, prove the invariant rule:\ndrh(p~;~t ) = drg(~q;~s),\nif f is a first-degree polynomial and g is r times differentiable at ~q.\n[Hint: Here all higher-order partials of f vanish. Use induction.]\n\u00a76. Determinants. Jacobians. Bijective Linear Operators\nWe assume the reader to be familiar with elements of linear algebra. Thus we\nonly briefly recall some definitions and well-known rules.\nDefinition 1.\nGiven a linear operator \u03c6: En En (or \u03c6: Cn Cn), with matrix\n\u2192 \u2192\n[\u03c6] = (v ), i,k = 1,...,n,\nik\nwe define the determinant of [\u03c6] by\nv v ... v\n11 12 1n\nv v ... v\n21 22 2n\ndet[\u03c6] = det(v ik) = (cid:12) . . . . (cid:12)\n(1) (cid:12) . . . . . . . . (cid:12)\n(cid:12) (cid:12)\n(cid:12)v v ... v (cid:12)\n(cid:12) n1 n2 nn(cid:12)\n(cid:12) (cid:12)\n= (cid:12) ( 1)\u03bbv v ...v(cid:12) ,\n(cid:12) \u2212 1k1 2k2 (cid:12)nkn\nX 48 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nwhere the sum is over all ordered n-tuples (k ,...,k ) of distinct integers\n1 n\nk (1 k n), and\nj j\n\u2264 \u2264\n0 if (k k ) > 0 and\n\u03bb = j<m m \u2212 j\n( 1 if Qj<m(k m \u2212k j) < 0.\nQ\nRecall (Problem 12 in 2) that a set B = ~v ,~v ,...,~v in a vector space\n1 2 n\n\u00a7 { }\nE is a basis iff\n(i) B spans E, i.e., each ~v E has the form\n\u2208\nn\n~v = a ~v\ni i\ni=1\nX\nfor some scalars a , and\ni\n(ii) this representation is unique.\nThe latter is true iff the ~v are independent, i.e.,\ni\nn\na ~v =~0 a = 0, i = 1,...,n.\ni i i\n\u21d0\u21d2\ni=1\nX\nIf E has a basis of n vectors, we call E n-dimensional (e.g., En and Cn).\nDeterminants and bases satisfy the following rules.\n(a) Multiplication rule. If \u03c6,g: En En (or Cn Cn) are linear, then\n\u2192 \u2192\ndet[g] det[\u03c6] = det([g][\u03c6]) = det[g \u03c6]\n\u00b7 \u25e6\n(see 2, Theorem 3 and Note 4).\n\u00a7\n(b) If \u03c6(~x) = ~x (identity map), then [\u03c6] = (v ), where\nik\n0 if i = k and\nv = 6\nik\n1 if i = k;\n(cid:26)\nhence det[\u03c6] = 1. (Why?) See also the Problems.\n(c) An n-dimensional space E is spanned by a set of n vectors iff they are\nindependent. If so, each basis consists of exactly n vectors.\nDefinition 2.\nFor any function f: En En (or f: Cn Cn), we define the f-induced\n\u2192 \u2192\nJacobian map J : En E1 (J : Cn C) by setting\nf f\n\u2192 \u2192\nJ (~x) = det(v ),\nf ik\nwhere v = D f (~x), ~x En(Cn), and f = (f ,...,f ).\nik k i 1 n\n\u2208\nThe determinant\nJ (p~) = det(D f (p~))\nf k i 6. Determinants. Jacobians. Bijective Linear Operators 49\n\u00a7\nis called the Jacobian of f at p~.\nBy our conventions, it is always defined, as are the functions D f .\nk i\nExplicitly, J (p~) is the determinant of the right-side matrix in formula (14)\nf\nin 3. Briefly,\n\u00a7\nJ = det(D f ).\nf k i\nBy Definition 2 and Note 2 in 5,\n\u00a7\nJ (p~) = det[d1f(p~; )].\nf\n\u00b7\nIf f is differentiable at p~,\nJ (p~) = det[f\u2032(p~)].\nf\nNote 1. More generally, given any functions v : E\u2032 E1(C), we can\nik\n\u2192\ndefine a map f: E\u2032 E1(C) by\n\u2192\nf(~x) = det(v (~x));\nik\nbriefly f = det(v ), i,k = 1,...,n.\nik\nWe then call f a functional determinant.\nIfE\u2032 = En(Cn)thenf isafunctionofnvariables,since~x = (x ,x ,...,x ).\n1 2 n\nIf all v are continuous or differentiable at some p~ E\u2032, so is f; for by (1), f\nik\n\u2208\nis a finite sum of functions of the form\n( 1)\u03bbv v ...v ,\nik1 ik2 ikn\n\u2212\nand each of these is continuous or differentiable if the v are (see Problems 7\niki\nand 8 in 3).\n\u00a7\nNote 2. Hence the Jacobian map J is continuous or differentiable at p~ if\nf\nall the partially derived functions D f (i,k n) are.\nk i\n\u2264\nIf, in addition, J (p~) = 0, then J = 0 on some globe about p~. (Apply\nf f\n6 6\nProblem 7 in Chapter 4, 2, to J .)\nf\n\u00a7 | |\nIn classical notation, one writes\n\u2202(f ,...,f ) \u2202(y ,...,y )\n1 n 1 n\nor\n\u2202(x ,...,x ) \u2202(x ,...,x )\n1 n 1 n\nfor J (~x). Here (y ,...,y ) = f(x ,...,x ).\nf 1 n 1 n\nThe remarks made in 4 apply to this \u201cvariable\u201d notation too. The chain\n\u00a7\nrule easily yields the following corollary.\nCorollary 1. If f: En En and g: En En (or f,g: Cn Cn) are\n\u2192 \u2192 \u2192\ndifferentiable at p~ and ~q = f(p~), respectively, and if\nh = g f,\n\u25e6 50 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nthen\n(i) J (p~) = J (~q) J (p~) = det(z ),\nh g f ik\n\u00b7\nwhere\nz = D h (p~), i,k = 1,...,n;\nik k i\nor, setting\n(u ,...,u ) = g(y ,...,y ) and\n1 n 1 n\n(y ,...,y ) = f(x ,...,x ) (\u201cvariables\u201d),\n1 n 1 n\nwe have\n\u2202(u ,...,u ) \u2202(u ,...,u ) \u2202(y ,...,y )\n1 n 1 n 1 n\n(ii) = = det(z ),\nik\n\u2202(x ,...,x ) \u2202(y ,...,y ) \u00b7 \u2202(x ,...,x )\n1 n 1 n 1 n\nwhere\n\u2202u\ni\nz = , i,k = 1,...,n.\nik\n\u2202x\nk\nProof. By Note 2 in 4,\n\u00a7\n[h\u2032(p~)] = [g\u2032(~q)] [f\u2032(p~)].\n\u00b7\nThus by rule (a) above,\ndet[h\u2032(p~)] = det[g\u2032(~q)] det[f\u2032(p~)],\n\u00b7\ni.e.,\nJ (p~) = J (~q) J (p~).\nh g f\n\u00b7\nAlso, if [h\u2032(p~)] = (z ), Definition 2 yields z = D h (p~).\nik ik k i\nThis proves (i), hence (ii) also. (cid:3)\nIn practice, Jacobians mostly occur when a change of variables is made.\nFor instance, in E2, we may pass from Cartesian coordinates (x,y) to another\nsystem (u,v) such that\nx = f (u,v) and y = f (u,v).\n1 2\nWe then set f = (f ,f ) and obtain f: E2 E2,\n1 2\n\u2192\nJ = det(D f ), k,i = 1,2.\nf k i\nExample (passage to polar coordinates).\nLet x = f (r,\u03b8) = rcos\u03b8 and y = f (r,\u03b8) = rsin\u03b8.\n1 2 6. Determinants. Jacobians. Bijective Linear Operators 51\n\u00a7\nThen using the \u201cvariable\u201d notation, we obtain J (r,\u03b8) as\nf\n\u2202x \u2202x\n\u2202(x,y) \u2202r \u2202\u03b8 cos\u03b8 rsin\u03b8\n= = \u2212\n(cid:12) (cid:12)\n\u2202(r,\u03b8) (cid:12) \u2202y \u2202y (cid:12) sin\u03b8 rcos\u03b8\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(cid:12) \u2202r \u2202\u03b8 (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12) = (cid:12)rcos2\u03b8 +rsin2\u03b8(cid:12) = r.\n(cid:12) (cid:12)\nThus here J (r,\u03b8) = r for all r,\u03b8 E1; J is independent of \u03b8.\nf f\n\u2208\nWe now concentrate on one-to-one (invertible) functions.\nTheorem 1. For a linear map \u03c6: En En (or \u03c6: Cn Cn), the following\n\u2192 \u2192\nare equivalent:\n(i) \u03c6 is one-to-one;\n(ii) the column vectors ~v ,...,~v of the matrix [\u03c6] are independent;\n1 n\n(iii) \u03c6 is onto En(Cn);\n(iv) det[\u03c6] = 0.\n6\nProof. Assume (i) and let\nn\nc ~v =~0.\nk k\nk=1\nX\nTo deduce (ii), we must show that all c vanish.\nk\nNow, by Note 3 in 2, ~v = \u03c6(~e ); so by linearity,\nk k\n\u00a7\nn\nc ~v =~0\nk k\nk=1\nX\nimplies\nn\n\u03c6 c ~e =~0.\nk k\n(cid:18)k=1 (cid:19)\nX\nAs \u03c6 is one-to-one, it can vanish at ~0 only. Thus\nn\nc ~e =~0.\nk k\nk=1\nX\nHence by Theorem 2 in Chapter 3, 1\u20133, c = 0, k = 1,...,n, and (ii) follows.\nk\n\u00a7\u00a7\nNext, assume (ii); so, by rule (c) above, ~v ,...,~v is a basis.\n1 n\n{ }\nThus each ~y En(Cn) has the form\n\u2208\nn n n\n~y = a ~v = a \u03c6(~e ) = \u03c6 a ~e = \u03c6(~x),\nk k k k k k\nk=1 k=1 (cid:18)k=1 (cid:19)\nX X X 52 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nwhere\nn\n~x = a ~e (uniquely).\nk k\nk=1\nX\nHence (ii) implies both (iii) and (i). (Why?)\nNow assume (iii). Then each ~y En(Cn) has the form ~y = \u03c6(~x), where\n\u2208\nn\n~x = x ~e ,\nk k\nk=1\nX\nby Theorem 2 in Chapter 3, 1\u20133. Hence again\n\u00a7\u00a7\nn n\n~y = x \u03c6(~e ) = x ~v ;\nk k k k\nk=1 k=1\nX X\nso the ~v span all of En(Cn). By rule (c) above, this implies (ii), hence (i),\nk\ntoo. Thus (i), (ii), and (iii) are equivalent.\nAlso, by rules (a) and (b), we have\ndet[\u03c6] det[\u03c6\u22121] = det[\u03c6 \u03c6\u22121] = 1\n\u00b7 \u25e6\nif \u03c6 is one-to-one (for \u03c6 \u03c6\u22121 is the identity map). Hence det[\u03c6] = 0 if (i) holds.\n\u25e6 6\nFor the converse, suppose \u03c6 is not one-to-one. Then by (ii), the ~v are not\nk\nindependent. Thus one of them is a linear combination of the others, say,\nn\n~v = a ~v .\n1 k k\nk=2\nX\nBut by linear algebra (Problem 13(iii)), det[\u03c6] does not change if ~v is re-\n1\nplaced by\nn\n~v a ~v =~0.\n1 k k\n\u2212\nk=2\nX\nThus det[\u03c6] = 0 (one column turning to ~0). This completes the proof. (cid:3)\nNote 3. Maps that are both onto and one-to-one are called bijective. Such\nis \u03c6 in Theorem 1. This means that the equation\n\u03c6(~x) = ~y\nhas a unique solution\n~x = \u03c6\u22121(~y)\nfor each ~y. Componentwise, by Theorem 1, the equations\nn\nx v = y , i = 1,...,n,\nk ik i\nk=1\nX 6. Determinants. Jacobians. Bijective Linear Operators 53\n\u00a7\nhave a unique solution for the x iff det(v ) = 0.\nk ik\n6\nCorollary 2. If \u03c6 L(E\u2032,E) is bijective, with E\u2032 and E complete, then\n\u2208\n\u03c6\u22121 L(E,E\u2032).\n\u2208\nProof for E = En(Cn).1 The notation \u03c6 L(E\u2032,E) means that \u03c6: E\u2032 E\n\u2208 \u2192\nis linear and continuous.\nAs \u03c6 is bijective, \u03c6\u22121: E E\u2032 is linear (Problem 12).\n\u2192\nIf E = En(Cn), it is continuous, too (Theorem 2 in 2).\n\u00a7\nThus \u03c6\u22121 L(E,E\u2032). (cid:3)\n\u2208\nNote. The case E = En(Cn) suffices for an undergraduate course. (The\nbeginner is advised to omit the \u201cstarred\u201d 8.) Corollary 2 and Theorem 2\n\u00a7\nbelow, however, are valid in the general case. So is Theorem 1 in 7.\n\u00a7\nTheorem 2. Let E, E\u2032 and \u03c6 be as in Corollary 2. Set\n1\n\u03c6\u22121 = .\nk k \u03b5\nThen any map \u03b8 L(E\u2032,E) with \u03b8 \u03c6 < \u03b5 is one-to-one, and \u03b8\u22121 is\n\u2208 k \u2212 k\nuniformly continuous.\nProof. By Corollary 2, \u03c6\u22121 L(E,E\u2032), so \u03c6\u22121 is defined and > 0 (for \u03c6\u22121\n\u2208 k k\nis not the zero map, being one-to-one).\nThus we may set\n1 1\n\u03b5 = , \u03c6\u22121 = .\n\u03c6\u22121 k k \u03b5\nk k\nClearly ~x = \u03c6\u22121(~y) if ~y = \u03c6(~x). Also,\n1\n\u03c6\u22121(~y) ~y\n| | \u2264 \u03b5| |\nby Note 5 in 2. Hence\n\u00a7\n~y \u03b5 \u03c6\u22121(~y) ,\n| | \u2265 | |\ni.e.,\n(2) \u03c6(~x) \u03b5 ~x\n| | \u2265 | |\nfor all ~x E\u2032 and ~y E.\n\u2208 \u2208\nNow suppose \u03c6 L(E\u2032,E) and \u03b8 \u03c6 = \u03c3 < \u03b5.\n\u2208 k \u2212 k\nObviously, \u03b8 = \u03c6 (\u03c6 \u03b8), and by Note 5 in 2,\n\u2212 \u2212 \u00a7\n(\u03c6 \u03b8)(~x) \u03c6 \u03b8 ~x = \u03c3 ~x .\n| \u2212 | \u2264 k \u2212 k| | | |\n1See 8 for the general case.\n\u2217\n\u00a7 54 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nThus for every ~x E\u2032,\n\u2208\n\u03b8(~x) \u03c6(~x) (\u03c6 \u03b8)(~x)\n| | \u2265 | |\u2212| \u2212 |\n(3) \u03c6(~x) \u03c3 ~x\n\u2265 | |\u2212 | |\n(\u03b5 \u03c3) ~x\n\u2265 \u2212 | |\nby (2). Therefore, given p~ =~r in E\u2032 and setting ~x = p~ ~r =~0, we obtain\n6 \u2212 6\n(4) \u03b8(p~) \u03b8(~r) = \u03b8(p~ ~r) = \u03b8(~x) (\u03b5 \u03c3) ~x > 0\n| \u2212 | | \u2212 | | | \u2265 \u2212 | |\n(since \u03c3 < \u03b5).\nWe see that p~ =~r implies \u03b8(p~) = \u03b8(~r); so \u03b8 is one-to-one, indeed.\n6 6\nAlso, setting \u03b8(~x) = ~z and ~x = \u03b8\u22121(~z) in (3), we get\n~z (\u03b5 \u03c3) \u03b8\u22121(~z) ;\n| | \u2265 \u2212 | |\nthat is,\n(5) \u03b8\u22121(~z) (\u03b5 \u03c3)\u22121 ~z\n| | \u2264 \u2212 | |\nfor all ~z in the range of \u03b8 (domain of \u03b8\u22121).\nThus \u03b8\u22121 is linearly bounded (by Theorem 1 in 2), hence uniformly con-\n\u00a7\ntinuous, as claimed. (cid:3)\nCorollary 3. If E\u2032 = E = En(Cn) in Theorem 2 above, then for given \u03c6 and\n\u03b4 > 0, there always is \u03b4\u2032 > 0 such that\n\u03b8 \u03c6 < \u03b4\u2032 implies \u03b8\u22121 \u03c6\u22121 < \u03b4.\nk \u2212 k k \u2212 k\nIn other words, the transformation \u03c6 \u03c6\u22121 is continuous on L(E), E =\n\u2192\nEn(Cn).\nProof. First, since E\u2032 = E = En(Cn), \u03b8 is bijective by Theorem 1(iii), so\n\u03b8\u22121 L(E).\n\u2208\nAs before, set \u03b8 \u03c6 = \u03c3 < \u03b5.\nk \u2212 k\nBy Note 5 in 2, formula (5) above implies that\n\u00a7\n1\n\u03b8\u22121 .\nk k \u2264 \u03b5 \u03c3\n\u2212\nAlso,\n\u03c6\u22121 (\u03b8 \u03c6) \u03b8\u22121 = \u03c6\u22121 \u03b8\u22121\n\u25e6 \u2212 \u25e6 \u2212\n(see Problem 11).\nHence by Corollary 4 in 2, recalling that \u03c6\u22121 = 1/\u03b5, we get\n\u00a7 k k\n\u03c3\n\u03b8\u22121 \u03c6\u22121 \u03c6\u22121 \u03b8 \u03c6 \u03b8\u22121 0 as \u03c3 0. (cid:3)\nk \u2212 k \u2264 k k\u00b7k \u2212 k\u00b7k k \u2264 \u03b5(\u03b5 \u03c3) \u2192 \u2192\n\u2212 6. Determinants. Jacobians. Bijective Linear Operators 55\n\u00a7\nProblems on Bijective Linear Maps and Jacobians\n1. (i) Can a functional determinant f = det(v ) (see Note 1) be contin-\nik\nuous or differentiable even if the functions v are not?\nik\n(ii) Must a Jacobian map J be continuous or differentiable if f is?\nf\nGive proofs or counterexamples.\n\u21d22. Prove rule (b) on determinants. More generally, show that if f(~x) = ~x\non an open set A En(Cn), then J = 1 on A.\nf\n\u2286\n3. Let f: En En (or Cn Cn), f = (f ,...,f ).\n1 n\n\u2192 \u2192\nSuppose each f depends on x only, i.e.,\nk k\nf (~x) = f (~y) if x = y ,\nk k k k\nn\nregardless of the other coordinates x ,y . Prove that J = D f .\ni i f k=1 k k\n[Hint: Show that D kfi =0 if i=k.]\n6 Q\n4. In Corollary 1, show that\nn\nJ (p~) = D f (p~) J (~q)\nh k k g\n\u00b7\nk=1\nY\nif f also has the property specified in Problem 3. Then do all in \u201cvari-\nables,\u201d with y = y (x ) instead of f .\nk k k k\n5. Let E\u2032 = E1 in Note 1. Prove that if all the v are differentiable at p,\nik\nthen f\u2032(p) is the sum of n determinants, each arising from det(v ), by\nik\nreplacing the terms of one column by their derivatives.\n[Hint: Use Problem 6 in Chapter 5, 1.]\n\u00a7\n6. Do Problem 5 for partials of f, with E\u2032 = En(Cn), and for directionals\nD f, in any normed space E\u2032. (First, prove formulas analogous to\n~u\nProblem 6 in Chapter 5, 1; use Note 3 in 1.) Finally, do it for the\n\u00a7 \u00a7\ndifferential, df(p~; ).\n\u00b7\n7. In Note 1 of 4, express the matrices in terms of partials (see Theorem 4\n\u00a7\nin 3). Invent a \u201cvariable\u201d notation for such matrices, imitating Jaco-\n\u00a7\nbians (Corollary 3).\n8. (i) Show that\nZ P\n\u2202(x,y,z)\n= r2sin\u03b1\n\u2202(r,\u03b8,\u03b1) \u2212\nif\nO\nx = rcos\u03b8, Y\ny = rsin\u03b8 sin\u03b1, and A\nz = rcos\u03b1 X\nFigure 27 56 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n(This transformation is passage to polars in E3; see Figure 27,\nwhere r = OP, \u2222XOA = \u03b8, and \u2222AOP = \u03b1.)\n(ii) What if x = rcos\u03b8, y = rsin\u03b8, and z = z remains unchanged\n(passage to cylindric coordinates)?\n(iii) Same for x = ercos\u03b8, y = ersin\u03b8, and z = z.\n9. Is f = (f ,f ): E2 E2 one-to-one or bijective, and is J = 0, if\n1 2 f\n\u2192 6\n(i) f (x,y) = excosy and f (x,y) = exsiny;\n1 2\n(ii) f (x,y) = x2 y2 and f (x,y) = 2xy?\n1 2\n\u2212\n10. Define f: E3 E3 (or C3 C3) by\n\u2192 \u2192\n~x\nf(~x) =\n3\n1+ x\nk=1 k\non\nP\n3\nA = ~x x = 1\nk\n6 \u2212\n(cid:26) (cid:12) k=1 (cid:27)\n(cid:12) X\n(cid:12)\nand f =~0 on A. Prove the foll(cid:12)owing.\n\u2212\n(i) f is one-to-one on A (find f\u22121!).\n1\n(ii) J (~x) = .\nf 3 4\n1+ x\nk=1 k\n(iii) Describe A geometrically.\n(cid:0) P (cid:1)\n\u2212\n11. Given any sets A,B and maps f,g: A E\u2032, h: E\u2032 E, and k: B A,\n\u2192 \u2192 \u2192\nprove that\n(i) (f g) k = f k g k, and\n\u00b1 \u25e6 \u25e6 \u00b1 \u25e6\n(ii) h (f g) = h f h g if h is linear.\n\u25e6 \u00b1 \u25e6 \u00b1 \u25e6\nUse these distributive laws to verify that\n\u03c6\u22121 (\u03b8 \u03c6) \u03b8\u22121 = \u03c6\u22121 \u03b8\u22121\n\u25e6 \u2212 \u25e6 \u2212\nin Corollary 3.\n[Hint: First verify the associativity of mapping composition.]\n12. Prove that if \u03c6: E\u2032 E is linear and one-to-one, so is \u03c6\u22121: E\u2032\u2032 E\u2032,\n\u2192 \u2192\nwhere E\u2032\u2032 = \u03c6[E\u2032].\n13. Let ~v ,...,~v be the column vectors in det[\u03c6]. Prove that det[\u03c6] turns\n1 n\ninto\n(i) c det[\u03c6] if one of the ~v is multiplied by a scalar c;\nk\n\u00b7\n(ii) det[\u03c6], if any two of the ~v are interchanged (consider \u03bb in for-\nk\n\u2212\nmula (1)). 6. Determinants. Jacobians. Bijective Linear Operators 57\n\u00a7\nFurthermore, show that\n(iii) det[\u03c6] does not change if some ~v is replaced by ~v +c~v (i = k);\nk k i\n6\n(iv) det[\u03c6] = 0 if some ~v is ~0, or if two of the ~v are the same.\nk k\n\u00a77. Inverse and Implicit Functions. Open and Closed Maps\nI. \u201cIf f CD1 at p~, then f resembles a linear map (namely df) at p~.\u201d\n\u2208\nPursuing this basic idea, we first make precise our notion of \u201cf CD1 at p~.\u201d\n\u2208\nDefinition 1.\nA map f: E\u2032 E is continuously differentiable, or of class CD1 (written\n\u2192\nf CD1), at p~ iff the following statement is true:\n\u2208\nGiven any \u03b5 > 0, there is \u03b4 > 0 such that f is differentiable on the\nglobe G = G (\u03b4), with\np~\ndf(~x; ) df(p~; ) < \u03b5 for all ~x G.1\nk \u00b7 \u2212 \u00b7 k \u2208\nBy Problem 10 in 5, this definition agrees with Definition 1 of 5, but is no\n\u00a7 \u00a7\nlonger limited to the case E\u2032 = En(Cn). See also Problems 1 and 2 below.\nWe now obtain the following result.\nTheorem 1. Let E\u2032 and E be complete. If f: E\u2032 E is of class CD1 at p~\n\u2192\nand if df(p~; ) is bijective ( 6), then f is one-to-one on some globe G = G (\u03b4).\np~\n\u00b7 \u00a7\nThus f \u201clocally\u201d resembles df(p~; ) in this respect.\n\u00b7\nProof. Set \u03c6 = df(p~; ) and\n\u00b7\n1\n\u03c6\u22121 =\nk k \u03b5\n(cf. Theorem 2 of 6).\n\u00a7\nBy Definition 1, fix \u03b4 > 0 so that for ~x G = G (\u03b4).\np~\n\u2208\n1\ndf(~x; ) \u03c6 < \u03b5.\nk \u00b7 \u2212 k 2\nThen by Note 5 in 2,\n\u00a7\n1\n(1) ( ~x G) ( ~u E\u2032) df(~x;~u) \u03c6(~u) \u03b5 ~u .\n\u2200 \u2208 \u2200 \u2208 | \u2212 | \u2264 2 | |\nNow fix any ~r,~s G, ~r = ~s, and set ~u = ~r ~s = ~0. Again, by Note 5 in\n\u2208 6 \u2212 6\n2,\n\u00a7 1\n~u = \u03c6\u22121(\u03c6(~u)) \u03c6\u22121 \u03c6(~u) = \u03c6(~u) ;\n| | | | \u2264 k k| | \u03b5| |\n1We can always make G closed by reducing \u03b4. 58 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nso\n(2) 0 < \u03b5 ~u \u03c6(~u) .\n| | \u2264 | |\nBy convexity, G I = L[~s,~r], so (1) holds for ~x I, ~x =~s+t~u, 0 t 1.\n\u2287 \u2208 \u2264 \u2264\nNoting this, set\nh(t) = f(~s +t~u) t\u03c6(~u), t E1.\n\u2212 \u2208\nThen for 0 t 1,\n\u2264 \u2264\nh\u2032(t) = D f(~s +t~u) \u03c6(~u)\nu~\n\u2212\n= df(~s +t~u;~u) \u03c6(~u).\n\u2212\n(Verify!) Thus by (1) and (2),\nsup h\u2032(t) = sup df(~s +t~u;~u) \u03c6(~u)\n| | | \u2212 |\n0\u2264t\u22641 0\u2264t\u22641\n\u03b5 1\n~u \u03c6(~u) .\n\u2264 2 | | \u2264 2 | |\n(Explain!) Now, by Corollary 1 in Chapter 5, 4,\n\u00a7\n1\nh(1) h(0) (1 0) sup h\u2032(t) \u03c6(~u) .\n| \u2212 | \u2264 \u2212 \u00b7 | | \u2264 2| |\n0\u2264t\u22641\nAs h(0) = f(~s) and\nh(1) = f(~s +~u) \u03c6(~u) = f(~r) \u03c6(~u),\n\u2212 \u2212\nwe obtain (even if ~r =~s)\n1\n(3) f(~r) f(~s) \u03c6(~u) \u03c6(~u) (~r,~s G, ~u =~r ~s).\n| \u2212 \u2212 | \u2264 2| | \u2208 \u2212\nBut by the triangle law,\n\u03c6(~u) f(~r) f(~s) f(~r) f(~s) \u03c6(~u) .\n| |\u2212| \u2212 | \u2264 | \u2212 \u2212 |\nThus\n1 1 1\n(4) f(~r) f(~s) \u03c6(~u) \u03b5 ~u = \u03b5~r ~s\n| \u2212 | \u2265 2| | \u2265 2 | | 2 | \u2212 |\nby (2).\nHence f(~r) = f(~s) whenever ~r = ~s in G; so f is one-to-one on G, as\n6 6\nclaimed. (cid:3)\nCorollary 1. Under the assumptions of Theorem 1, the maps f and f\u22121 (the\ninverse of f restricted to G) are uniformly continuous on G and f[G], respec-\ntively. 7. Inverse and Implicit Functions. Open and Closed Maps 59\n\u00a7\nProof. By (3),\n1\nf(~r) f(~s) \u03c6(~u) + \u03c6(~u)\n| \u2212 | \u2264 | | 2| |\n2\u03c6(~u)\n\u2264 | |\n2 \u03c6 ~u\n\u2264 k k| |\n= 2 \u03c6 ~r ~s (~r,~s G).\nk k| \u2212 | \u2208\nThis implies uniform continuity for f. (Why?)\nNext, let g = f\u22121 on H = f[G].\nIf ~x,~y H, let ~r = g(~x) and ~s = g(~y); so ~r,~s G, with ~x = f(~r) and\n\u2208 \u2208\n~y = f(~s). Hence by (4),\n1\n~x ~y \u03b5 g(~x) g(~y) ,\n| \u2212 | \u2265 2 | \u2212 |\nproving all for g, too. (cid:3)\nAgain, f resembles \u03c6 which is uniformly continuous, along with \u03c6\u22121.\nII. We introduce the following definition.\nDefinition 2.\nA map f: (S,\u03c1) (T,\u03c1\u2032) is closed (open) on D S iff, for any X D\n\u2192 \u2286 \u2286\nthe set f[X] is closed (open) in T whenever X is so in S.\nNote that continuous maps have such a property for inverse images (Prob-\nlem 15 in Chapter 4, 2).\n\u00a7\nCorollary 2. Under the assumptions of Theorem 1, f is closed on G, and so\nthe set f[G] is closed in E.\nSimilarly for the map f\u22121 on f[G].\nProof for E\u2032 = E = En(Cn) (for the general case, see Problem 6). Given\nany closed X G, we must show that f[X] is closed in E.\n\u2286\nNow, asGisclosedandbounded,itiscompact (Theorem4ofChapter4, 6).\n\u00a7\nSo also is X (Theorem 1 in Chapter 4, 6), and so is f[X] (Theorem 1 of\n\u00a7\nChapter 4, 8).\n\u00a7\nBy Theorem 2 in Chapter 4, 6, f[X] is closed, as required. (cid:3)\n\u00a7\nFor the rest of this section, we shall set E\u2032 = E = En(Cn).\nTheorem 2. If E\u2032 = E = En(Cn) in Theorem 1, with other assumptions\nunchanged, then f is open on the globe G = G (\u03b4), with \u03b4 sufficiently small.2\np~\nWe first prove the following lemma.\n2Thus formula (1) still holds for \u03b5=1/ \u03c6 1 , \u03c6=df(p~; ).\n\u2212\nk k \u00b7 60 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nLemma. f[G] contains a globe G (\u03b1) where ~q = f(p~).\nq~\nProof. Indeed, let\n1\n\u03b1 = \u03b5\u03b4,\n4\nwhere \u03b4 and \u03b5 are as in the proof of Theorem 1. (We continue the notation\nand formulas of that proof.)\nFix any ~c G (\u03b1); so\n~q\n\u2208\n1\n~c ~q < \u03b1 = \u03b5\u03b4.\n| \u2212 | 4\nSet h = f ~c on E\u2032. As f is uniformly continuous on G, so is h.\n| \u2212 |\nNow, G is compact in En(Cn); so Theorem 2(ii) in Chapter 4, 8, yields a\n\u00a7\npoint ~r G such that\n\u2208\n(6) h(~r) = minh[G].\nWe claim that ~r is in G (the interior of G).\nOtherwise, ~r p~ = \u03b4; for by (4),\n| \u2212 |\n1 1\n2\u03b1 = \u03b5\u03b4 = \u03b5~r p~ f(~r) f(p~)\n2 2 | \u2212 | \u2264 | \u2212 |\n(7)\nf(~r) ~c + ~c f(p~)\n\u2264 | \u2212 | | \u2212 |\n= h(~r)+h(p~).\nBut\nh(p~) = ~c f(p~) = ~c ~q < \u03b1;\n| \u2212 | | \u2212 |\nand so (7) yields\nh(p~) < \u03b1 < h(~r),\ncontrary to the minimality of h(~r) (see (6)). Thus ~r p~ cannot equal \u03b4.\n| \u2212 |\nWe obtain ~r p~ < \u03b4, so ~r G (\u03b4) = G and f(~r) f[G]. We shall now\np~\n| \u2212 | \u2208 \u2208\nshow that ~c = f(~r).\nTo this end, we set ~v =~c f(~r) and prove that ~v =~0. Let\n\u2212\n~u = \u03c6\u22121(~v),\nwhere\n\u03c6 = df(p~; ),\n\u00b7\nas before. Then\n~v = \u03c6(~u) = df(p~;~u).\nWith ~r as above, fix some\n~s =~r +t~u (0 < t < 1) 7. Inverse and Implicit Functions. Open and Closed Maps 61\n\u00a7\nwith t so small that ~s G also. Then by formula (3),\n\u2208\n1\nf(~s) f(~r) \u03c6(t~u) t~v ;\n| \u2212 \u2212 | \u2264 2| |\nalso,\nf(~r) ~c +\u03c6(t~u) = (1 t)~v = (1 t)h(~r)\n| \u2212 | \u2212 | | \u2212\nby our choice of ~v,~u and h. Hence by the triangle law,\n1\nh(~s) = f(~s) ~c 1 t h(~r).\n| \u2212 | \u2264 \u2212 2\n(cid:16) (cid:17)\n(Verify!)\nAs 0 < t < 1, this implies h(~r) = 0 (otherwise, h(~s) < h(~r), violating (6)).\nThus, indeed,\n~v = f(~r) ~c = 0,\n| | | \u2212 |\ni.e.,\n~c = f(~r) f[G] for ~r G.\n\u2208 \u2208\nBut ~c was an arbitrary point of G (\u03b1). Hence\nq~\nG (\u03b1) f[G],\nq~\n\u2286\nproving the lemma. (cid:3)\nProof of Theorem 2. The lemma shows that f(p~) is in the interior of f[G]\nif p~, f, df(p~; ), and \u03b4 are as in Theorem 1.\n\u00b7\nBut Definition 1 implies that here f CD1 on all of G (see Problem 1).\n\u2208\nAlso, df(~x; ) is bijective for any ~x G by our choice of G and Theorems 1\n\u00b7 \u2208\nand 2 in 6.\n\u00a7\nThus f maps all ~x G onto interior points of f[G]; i.e., f maps any open\n\u2208\nset X G onto an open f[X], as required. (cid:3)\n\u2286\nNote 1. A map\nf: (S,\u03c1) (T,\u03c1\u2032)\n\u2190on\u2192to\nis both openand closed(\u201cclopen\u201d)iff f\u22121 is continuous\u2014seeProblem 15(iv)(v)\nin Chapter 4, 2, interchanging f and f\u22121.\n\u00a7\nThus \u03c6 = df(p~; ) in Theorem 1 is \u201cclopen\u201d on all of E\u2032.\n\u00b7\nAgain, f locally resembles df(p~; ).\n\u00b7\nIII. The Inverse Function Theorem. We now further pursue these ideas.\nTheorem 3 (inverse functions). Under the assumptions of Theorem 2, let g\nbe the inverse of f (f restricted to G = G (\u03b4)).\nG p~\nThen g CD1 on f[G] and dg(~y; ) is the inverse of df(~x; ) whenever\n\u2208 \u00b7 \u00b7\n~x = g(~y), ~x G.\n\u2208 62 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nBriefly: \u201cThe differential of the inverse is the inverse of the differential.\u201d\nProof. Fix any ~y f[G] and ~x = g(~y); so ~y = f(~x) and ~x G. Let\n\u2208 \u2208\nU = df(~x; ).\n\u00b7\nAs noted above, U is bijective for every ~x G by Theorems 1 and 2 in 6;\n\u2208 \u00a7\nso we may set V = U\u22121. We must show that V = dg(~y; ).\n\u00b7\nTo do this, give~y anarbitrary (variable) increment\u2206~y, sosmall that~y+\u2206~y\nstays in f[G] (an open set by Theorem 2).\nAs g and f are one-to-one, \u2206~y uniquely determines\nG\n\u2206~x = g(~y +\u2206~y) g(~y) =~t ,\n\u2212\nand vice versa:\n\u2206~y = f(~x +~t) f(~x).\n\u2212\nHere \u2206~y and ~t are the mutually corresponding increments of ~y = f(~x) and\n~x = g(~y). By continuity, ~y ~0 iff ~t ~0.3\n\u2192 \u2192\nAs U = df(~x; ),\n\u00b7\n1\nlim f(~x +~t ) f(~t ) U(~t ) = 0,\n~t\u2192~0 ~t | \u2212 \u2212 |\n| |\nor\n1\n(8) lim F(~t ) = 0,\n~t\u2192~0 ~t | |\n| |\nwhere\n(9) F(~t ) = f(~x +~t ) f(~t ) U(~t ).\n\u2212 \u2212\nAs V = U\u22121, we have\nV(U(~t )) =~t = g(~y +\u2206~y) g(~y).\n\u2212\nSo from (9),\nV(F(~t )) = V(\u2206~y) ~t\n\u2212\n= V(\u2206~y) [g(~y +\u2206~y) g(~y)];\n\u2212 \u2212\nthat is,\n1 V(F(~t ))\n(10) g(~y +\u2206~y) g(~y) V(\u2206~y) = | |, \u2206~y =~0.\n\u2206~y | \u2212 \u2212 | \u2206~y 6\n| | | |\nNow, formula (4), with ~r = ~x, ~s = ~x +~t , and ~u =~t, shows that\n1\nf(~x +~t) f(~x) \u03b5~t ;\n| \u2212 | \u2265 2 | |\n3This change of variables is admissible as the map~t \u2206~y is one-to-one (Corollary 2\n\u2190\u2192\nin Chapter 4, 2).\n\u00a7 7. Inverse and Implicit Functions. Open and Closed Maps 63\n\u00a7\ni.e., \u2206~y 1\u03b5~t . Hence by (8),\n| | \u2265 2 | |\nV(F(~t )) V(F(~t ) 2 1 2 1\n| | | | = V F(~t ) V F(~t ) 0 as ~t ~0.\n\u2206~y \u2264 1\u03b5~t \u03b5 ~t \u2264 \u03b5 k k ~t | | \u2192 \u2192\n| | 2 | | (cid:12) (cid:18)| | (cid:19)(cid:12) | |\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nSince ~t ~0 as \u2206~y ~0 ((cid:12)change of varia(cid:12)bles!), the expression (10) tends to\n\u2192 \u2192\n0 as \u2206~y ~0.\n\u2192\nBy definition, then, g is differentiable at ~y, with dg(~y; ) = V = U\u22121.\n\u00b7\nMoreover, Corollary 3 in 6, applies here. Thus\n\u00a7\n( \u03b4\u2032 > 0) ( \u03b4\u2032\u2032 > 0) U W < \u03b4\u2032\u2032 U\u22121 W\u22121 < \u03b4\u2032.\n\u2200 \u2203 k \u2212 k \u21d2 k \u2212 k\nTaking here U\u22121 = dg(~y) and W\u22121 = dg(~y +\u2206~y), we see that g CD1 near\n\u2208\n~y. This completes the proof. (cid:3)\nNote 2. If E\u2032 = E = En(Cn), the bijectivity of \u03c6 = df(p~; ) is equiva-\n\u00b7\nlent to\ndet[\u03c6] = det[f\u2032(p~)] = 0\n6\n(Theorem 1 of 6).\n\u00a7\nInthiscase,thefactthatf isone-to-oneonG = G (\u03b4)means,componentwise\np~\n(see Note 3 in 6), that the system of n equations\n\u00a7\nf (~x) = f(x ,...,x ) = y , i = 1,...,n,\ni 1 n i\nhas a unique solution for the n unknowns x as long as\nk\n(y ,...,y ) = ~y f[G].\n1 n\n\u2208\nTheorem 3 shows that this solution has the form\nx = g (~y), k = 1,...,n,\nk k\nwhere the g are of class CD1 on f[G] provided the f are of class CD1 near p~\nk i\nand det [f\u2032(p~)] = 0. Here\n6\ndet[f\u2032(p~)] = J (p~),\nf\nas in 6.\n\u00a7\nThus again f \u201clocally\u201d resembles a linear map, \u03c6 = df(p~; ).\n\u00b7\nIV. The Implicit Function Theorem. Generalizing, we now ask, what\nabout solving n equations in n+m unknowns x ,...,x ,y ,...,y ? Say, we\n1 n 1 m\nwant to solve\n(11) f (x ,...,x ,y ,...,y ) = 0, k = 1,2,...,n,\nk 1 n 1 m\nfor the first n unknowns (or variables) x , thus expressing them as\nk\nx = H (y ,...,y ), k = 1,...,n,\nk k 1 m 64 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nwith H : Em E1 or H : Cm C.\nk k\n\u2192 \u2192\nLet us set ~x = (x ,...,x ), ~y = (y ,...,y ), and\n1 n 1 m\n(~x,~y) = (x ,...,x ,y ,...,y )\n1 n 1 m\nso that (~x,~y) En+m(Cn+m).\n\u2208\nThus the system of equations (11) simplifies to\nf (~x,~y) = 0, k = 1,...,n,\nk\nor\nf(~x,~y) =~0,\nwhere f = (f ,...,f ) is a map of En+m(Cn+m) into En(Cn); f is a function\n1 n\nof n+m variables, but it has n components f ; i.e.,\nk\nf(~x,~y) = f(x ,... ,x ,y ,... ,y )\n1 n 1 m\nis a vector in En(Cn).\nTheorem 4 (implicit functions). Let E\u2032 = En+m(Cn+m), E = En(Cn), and\nlet f: E\u2032 E be of class CD1 near\n\u2192\n(p~,~q) = (p ,...,p ,q ,...,q ), p~ En(Cn), ~q Em(Cm).\n1 n 1 m\n\u2208 \u2208\nLet [\u03c6] be the n n matrix\n\u00d7\n(D f (p~,~q)), j,k = 1,...,n.\nj k\nIf det[\u03c6] = 0 and if f(p~,~q) =~0, then there are open sets\n6\nP En(Cn) and Q Em(Cm),\n\u2286 \u2286\nwith p~ P and ~q Q, for which there is a unique map\n\u2208 \u2208\nH: Q P\n\u2192\nwith\nf(H(~y),~y) =~0\nfor all ~y Q; furthermore, H CD1 on Q.\n\u2208 \u2208\nThus ~x = H(~y) is a solution of (11) in vector form.\nProof. With the above notation, set\nF(~x,~y) = (f(~x,~y),~y), F: E\u2032 E\u2032.\n\u2192\nThen\nF(p~,~q) = (f(p~,~q),~q) = (~0,~q),\nsince f(p~,~q) =~0.\nAs f CD1 near (p~,~q), so is F (verify componentwise via Problem 9(ii) in\n\u2208\n3 and Definition 1 of 5).\n\u00a7 \u00a7 7. Inverse and Implicit Functions. Open and Closed Maps 65\n\u00a7\nBy Theorem 4, 3, det[F\u2032(p~,~q)] = det[\u03c6] = 0 (explain!).\n\u00a7 6\nThus Theorem 1 above shows that F is one-to-one on some globe G about\n(p~,~q).\nClearly G contains an open interval about (p~,~q). We denote it by P Q\n\u00d7\nwhere p~ P, ~q Q; P is open in En(Cn) and Q is open in Em(Cm).4\n\u2208 \u2208\nBy Theorem 3, F (F restricted to P Q) has an inverse\nP\u00d7Q\n\u00d7\ng: A P Q,\n\u2190on\u2192to \u00d7\nwhere A = F[P Q] is open in E\u2032 (Theorem 2), and g CD1 on A. Let\n\u00d7 \u2208\nthe map u = (g ,...,g ) comprise the first n components of g (exactly as f\n1 n\ncomprises the first n components of F).\nThen\ng(~x,~y) = (u(~x,~y),~y)\nexactly as F(~x,~y) = (f(~x,~y),~y). Also, u: A P is of class CD1 on A, as g\n\u2192\nis (explain!).\nNow set\nH(~y) = u(~0,~y);\nhere ~y Q, while\n\u2208\n(~0,~y) A = F[P Q],\n\u2208 \u00d7\nfor F preserves ~y (the last m coordinates). Also set\n\u03b1(~x,~y) = ~x.\nThen f = \u03b1 F (why?), and\n\u25e6\nf(H(~y),~y) = f(u(~0,~y),~y) = f(g(~0,~y)) = \u03b1(F(g(~0,~y)) = \u03b1(~0,~y) =~0\nby our choice of \u03b1 and g (inverse to F). Thus\nf(H(~y),~y) =~0, ~y Q,\n\u2208\nas desired.\nMoreover, as H(~y) = u(~0,~y), we have\n\u2202 \u2202\nH(~y) = u(~0,~y), ~y Q,i m.\n\u2202y \u2202y \u2208 \u2264\ni i\nAs u CD1, all \u2202u/\u2202y are continuous (Definition 1 in 5); hence so are the\ni\n\u2208 \u00a7\n\u2202H/\u2202y . Thus by Theorem 3 in 3, H CD1 on Q.\ni\n\u00a7 \u2208\n4This can be made more precise using the theory of product spaces (Chapter 4, 11).\n\u2217\n\u00a7 66 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nFinally, H is unique for the given P, Q; for\nf(~x,~y) =~0 = (f(~x,~y),~y) = (~0,~y)\n\u21d2\n= F(~x,~y) = (~0,~y)\n\u21d2\n= g(F(~x,~y)) = g(~0,~y)\n\u21d2\n= (~x,~y) = g(~0,~y) = (u(~0,~y),~y)\n\u21d2\n= ~x = u(~0,~y) = H(~y).\n\u21d2\nThus f(~x,~y) =~0 implies ~x = H(~y); so H(~y) is the only solution for ~x. (cid:3)\nNote 3. H is said to be implicitly defined by the equation f(~x,~y) =~0. In\nthis sense we say that H(~y) is an implicit function, given by f(~x,~y) =~0.\nSimilarly, under suitable assumptions, f(~x,~y) = ~0 defines ~y as a function\nof ~x.\nNote 4. While H is unique for a given P Y\nneighborhoodP Q of (p~,~q), another im-\n\u00d7 Q\nplicitfunctionmayresultifP Qor(p~,~q)\n\u00d7\nis changed.\nX\nFor example, let\nO\nf(x,y) = x2 +y2 25\n\u2212 Q\n(a polynomial; hence f CD1 on all of P\n\u2208\nE2). Geometrically, x2 +y2 25 = 0 de-\n\u2212 Figure 28\nscribes a circle.\nSolving for x, we get x = 25 y2. Thus we have two functions:\n\u00b1 \u2212\np\nH (y) = + 25 y2\n1\n\u2212\np\nand\nH (y) = 25 y2.\n2\n\u2212 \u2212\np\nIf P Q is in the upper part of the circle, the resulting function is H . Other-\n1\n\u00d7\nwise, it is H . See Figure 28.\n2\nV. Implicit Differentiation. Theorem 4 only states the existence (and\nuniqueness) of a solution, but does not show how to find it, in general.\nThe knowledge itself that H CD1 exists, however, enables us to use its\n\u2208\nderivative or partials and compute it by implicit differentiation, known from\ncalculus.5\n5For more on implicit differentiation, see 10.\n\u00a7 7. Inverse and Implicit Functions. Open and Closed Maps 67\n\u00a7\nExamples.\n(a) Let f(x,y) = x2 +y2 25 = 0, as above.\n\u2212\nThis time treating y as an implicit function of x,y = H(x), and writing\ny\u2032 for H\u2032(x), we differentiate both sides of x2 +y2 25 = 0 with respect\n\u2212\nto x, using the chain rule for the term y2 = [H(x)]2.\nThis yields 2x+2yy\u2032 = 0, whence y\u2032 = x/y.\n\u2212\nActually (see Note 4), two functions are involved: y = \u221a25 x2; but\n\u00b1 \u2212\nboth satisfy x2 +y2 25 = 0; so the result y\u2032 = x/y applies to both.\n\u2212 \u2212\nOf course, this method is possible only if the derivative y\u2032 is known to\nexist. This is why Theorem 4 is important.\n(b) Let\nf(x,y,z) = x2 +y2 +z2 1 = 0, x,y,z E1.\n\u2212 \u2208\nAgain f satisfies Theorem 4 for suitable x, y, and z.\nSetting z = H(x,y), differentiate the equation f(x,y,z) = 0 partially\nwith respect to x and y. From the resulting two equations, obtain \u2202z\n\u2202x\nand \u2202z.\n\u2202y\nProblems on Inverse and Implicit\nFunctions, Open and Closed Maps\n1. Discuss: In Definition 1, G can equivalently be replaced by G = G (\u03b4)\np~\n(an open globe).\n2. Prove that if the set D is open (closed) in (S,\u03c1), then the map f: S T\n\u2192\nis open (closed, respectively) on D iff f (f restricted to D) has this\nD\nproperty as a map of D into f[D].\n[Hint: Use Theorem 4 in Chapter 3, 12.]\n\u00a7\n3. Complete the missing details in the proofs of Theorems 1\u20134.\n\u2032\n3 Verify footnotes 2 and 3.\n4. Show that a map f: E\u2032 E may fail to be one-to-one on all of E\u2032 even\n\u2192\nif f satisfies Theorem 1 near every p~ E\u2032. Nonetheless, show that this\n\u2208\ncannot occur if E\u2032 = E = E1.\n[Hints: Forthefirstpart,takeE =C,f(x+iy)=ex(cosy+isiny). Forthesecond,\n\u2032\nuse Theorem 1 in Chapter 5, 2.]\n\u00a7\n4\u2032 . (i) For maps f: E1 E1, prove that the existence of a bijective\n\u2192\ndf(p; ) is equivalent to f\u2032(p) = 0.\n\u00b7 6\n(ii) Let\n1\nf(x) = x+x2sin , f(0) = 0.\nx\nShow that f\u2032(0) = 0, and f CD1 near any p = 0; yet f is not\n6 \u2208 6\none-to-one near 0. What is wrong? 68 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n5. Show that a map f: En(Cn) En(Cn), f CD1, may be bijective\n\u2192 \u2208\neven if det[f\u2032(p~)] = 0 at some p~, but then f\u22121 cannot be differentiable\nat ~q = f(p~).\n[Hint: For the first clause, take f(x) = x3, p = 0; for the second, note that if f 1\n\u2212\nis differentiable at ~q, then Note 2 in 4 implies that det[df(p~; )] det[df 1(q~; )]=\n\u2212\n\u00a7 \u00b7 \u00b7 \u00b7\n1=0, since f f 1 is the identity map.]\n\u2212\n6 \u25e6\n6. Prove Corollary 2 for the general case of complete E\u2032 and E.\n[Outline: Given a closed X G, take any convergent sequence y~ f[X]. By\n\u2286 { n} \u2286\nProblem 8 in Chapter 4, \u00a78, f \u22121(~y n) = ~xn is a Cauchy sequence in X (why?). By\nthe completeness of E \u2032, ( ~x X) ~xn ~x (Theorem 4 of Chapter 3, 16). Infer\n\u2203 \u2208 \u2192 \u00a7\nthat lim~y =f(~x) f[X], so f[X] is closed.]\nn \u2208\n7. Prove that \u201cthe composite of two open (closed) maps is open (closed).\u201d\nState the theorem precisely. Prove it also for the uniform Lipschitz\nproperty.\n8. Prove in detail that f: (S,\u03c1) (T,\u03c1\u2032) is open on D S iff f maps the\n\u2192 \u2286\ninterior of D into that of f[D]; that is, f[D0] (f[D])0.\n\u2286\n9. Verify by examples that f may be:\n(i) closed but not open;\n(ii) open but not closed.\n[Hints: (i) Consider f = constant. (ii) Define f: E2 E1 by f(x,y)=x and let\n\u2192\n1\nD = (x,y) E2 y = , x>0 ;\n\u2208 x\nn (cid:12) o\nuse Theorem 4(iii) in Chapter 3, 16 and(cid:12) continuity to show that D is closed in\n(cid:12)\n\u00a7\nE2, but f[D] = (0,+ ) is not closed in E1. However, f is open on all of E2 by\n\u221e\nProblem 8. (Verify!)]\n10. Continuing Problem 9(ii), define f: En E1 (or Cn C) by f(~x) =\n\u2192 \u2192\nx for a fixed k n (the \u201ckth projection map\u201d). Show that f is open,\nk\n\u2264\nbut not closed, on En(Cn).\n11. (i) In Example (a), take (p,q) = (5,0) or ( 5,0). Are the conditions\n\u2212\nof Theorem 4 satisfied? Do the conclusions hold?\n(ii) Verify Example (b).\n12. (i) Treating z as a function of x and y, given implicitly by\nf(x,y,z) = z3 +xz2 yz = 0, f: E3 E1,\n\u2212 \u2192\ndiscuss the choices of P and Q that satisfy Theorem 4. Find \u2202z\n\u2202x\nand \u2202z.\n\u2202y\n(ii) Do the same for f(x,y,z) = exyz 1 = 0.\n\u2212\n13. Given f: En(Cn) Em(Cm), n > m, prove that if f CD1 on a\n\u2192 \u2208\nglobe G, f cannot be one-to-one.\n[Hint for f: E2 E1: If, say, D f =0 on G, set F(x,y)=(f(x,y),y).]\n1\n\u2192 6 7. Inverse and Implicit Functions. Open and Closed Maps 69\n\u00a7\n14. Suppose that f satisfies Theorem 1 for every p~ in an open set A E\u2032,\n\u2286\nand is one-to-one on A (cf. Problem 4). Let g = f\u22121 (restrict f to A\nA\nand take its inverse). Show that f and g are open and of class CD1 on\nA and f[A], respectively.\n15. Given ~v E and a scalar c = 0, define T : E E (\u201ctranslation by ~v\u201d)\n~v\n\u2208 6 \u2192\nand M : E E (\u201cdilation by c\u201d), by setting\nc\n\u2192\nT (~x) = ~x +~v and M (~x) = c~x.\n~v c\nProve the following.\n(i) T and T\u22121(= T ) are bijective, continuous, and \u201cclopen\u201d on E;\n~v ~v \u2212~v\nso also are M and M\u22121(= M ).\nc c 1/c\n(ii) Similarly for the Lipschitz property on E.\n(iii) If G = G (\u03b4) E, then T [G] = G (\u03b4), and M [G] = G ( c\u03b4 ).\nq~ ~v q~+~v c c~q\n\u2282 | |\n(iv) If f: E\u2032 E is linear, and ~v = f(p~) for some p~ E\u2032, then\n\u2192 \u2208\nT f = f T\u2032 and M f = f M\u2032, where T\u2032 and M\u2032 are the\n~v \u25e6 \u25e6 p~ c \u25e6 \u25e6 c p~ c\ncorresponding maps on E\u2032. If, further, f is continuous at p~, it is\ncontinuous on all of E\u2032.\n[Hint for (iv): Fix any ~x E . Set ~v = f(~x p~), g = T f T . Verify\n\u2208 \u2032 \u2212 ~v \u25e6 \u25e6 p~\u2032 ~x\nthat g =f, T (~x)=p~, and g is continuous at ~x.] \u2212\np~\u2032 ~x\n\u2212\n16. Show that if f: E\u2032 E is linear and if f[G\u2217] is open in E for some\n\u2192\nG\u2217 = G (\u03b4) E\u2032, then\np~\n\u2286\n(i) f is open on all of E\u2032;\n(ii) f is onto E.\n[Hints: (i) By Problem 8, it suffices to show that the set f[G] is open, for any globe\nG (why?). First take G=G (\u03b4). Then use Problems 7 and 15(i)\u2013(iv), with suitable\n~0\n~v and c.\n(ii) To prove E =f[E ], fix any ~y E. As f =G (\u03b4) is open, it contains a globe\n\u2032 ~0\n\u2208\nG =G (r). For small c, c~y G f[E ]. Hence ~y f[E ] (Problem 10 in 2).]\n\u2032 ~0 \u2032 \u2032 \u2032\n\u2208 \u2286 \u2208 \u00a7\n17. Continuing Problem 16, show that if f is also one-to-one on G\u2217, then\nf: E\u2032 E,\n\u2190on\u2192to\nf L(E\u2032,E), f\u22121 L(E,E\u2032), f is clopen on E\u2032, and f\u22121 is so on E.\n\u2208 \u2208\n[Hints: Toprovethatf isone-to-oneonE \u2032,letf(~x)=f(~x\u2032)=~y forsome~x,~x\u2032 E \u2032.\n\u2208\nShow that\n( \u2203c, \u03b5>0) c~y \u2208G ~0(\u03b5) \u2286f[G ~0(\u03b4)] and f(c~x+p~)=f(c~x\u2032+p~) \u2208f[G p~(\u03b4)]=f[G\u2217].\nDeduce that c~x +p~ = c~x\u2032 +p~ and ~x = ~x\u2032. Then use Problem 15(v) in Chapter 4,\n2, and Note 1.]\n\u00a7\n18. A map\nf: (S,\u03c1) (T,\u03c1\u2032)\n\u2190on\u2192to 70 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nis said to be bicontinuous, or a homeomorphism, (from S onto T) iff\nboth f and f\u22121 are continuous. Assuming this, prove the following.\n(i) x p in S iff f(x ) f(p) in T;\nn n\n\u2192 \u2192\n(ii) A is closed (open, compact, perfect) in S iff f[A] is so in T;\n(iii) B = A in S iff f[B] = f[A] in T;\n(iv) B = A0 in S iff f[B] = (f[A])0 in T;\n(v) A is dense in B (i.e., A B A S) in (S,\u03c1) iff f[A] is dense in\n\u2286 \u2286 \u2286\nf[B] (T,\u03c1\u2032).\n\u2286\n[Hint: Use Theorem 1 of Chapter 4, 2, and Theorem 4 in Chapter 3, 16, for closed\n\u00a7 \u00a7\nsets; see also Note 1.]\n19. Given A,B E, ~v E and a scalar c, set\n\u2286 \u2208\nA+~v = ~x +~v ~x A and cA = c~x ~x A .\n{ | \u2208 } { | \u2208 }\nAssuming c = 0, prove that\n6\n(i) A is closed (open, compact, perfect) in E iff cA+~v is;\n(ii) B = A iff cB +~v = cA+~v;\n(iii) B = A0 iff cB +~v = (cA+~v)0;\n(iv) A is dense in B iff cA+~v is dense in cB +~v.\n[Hint: ApplyProblem18tothemapsT andMc ofProblem15,notingthatA+~v =\n~v\nT ~v[A] and cA=Mc[A].]\n20. Prove Theorem 2, for a reduced \u03b4, assuming that only one of E\u2032 and E\nis En(Cn), and the other is just complete.\n[Hint: If,say,E =En(Cn),thenf[G]iscompact(beingclosedandbounded),andso\nis G=f 1[f[G]]. (Why?) Thus the Lemma works out as before, i.e.,f[G] G (\u03b1).\n\u2212 q~\n\u2287\nNow use the continuity of f to obtain a globe G = G (\u03b4 ) G such that\n\u2032 p~ \u2032\n\u2286\nf[G \u2032] G ~q(\u03b1). Let g = f G\u22121, further restricted to G ~q(\u03b1). Apply Problem 15(v) in\n\u2286\nChapter 4, 2, to g, with S =G (\u03b1), T =E .]\n~q \u2032\n\u00a7\n\u2217\n\u00a78. Baire Categories. More on Linear Maps\nWe pause to outline the theory of so-called sets of Category I or Category II,\nas introduced by Baire. It is one of the most powerful tools in higher analysis.\nBelow, (S,\u03c1) is a metric space.\nDefinition 1.\nA set A (S,\u03c1) is said to be nowhere dense (in S) iff its closure A has\n\u2286\nno interior points (i.e., contains no globes): (A)0 = .\n\u2205\nEquivalently, the set A is nowhere dense iff every open set G\u2217 = in\n6 \u2205\nS contains a globe G disjoint from A. (Why?) 8. Baire Categories. More on Linear Maps 71\n\u2217\n\u00a7\nDefinition 2.\nA set A (S,\u03c1) is meagre, or of Category I (in S), iff\n\u2286\n\u221e\nA = A ,\nn\nn=1\n[\nfor some sequence of nowhere dense sets A .\nn\nOtherwise, A is said to be nonmeagre or of Category II.\nA is residual iff A is meagre, but A is not.\n\u2212\nExamples.\n(a) is nowhere dense.\n\u2205\n(b) Any finite set in a normed space E is nowhere dense.\n(c) The set N of all naturals in E1 is nowhere dense.\n(d) So also is Cantor\u2019s set P (Problem 17 in Chapter 3, 14); indeed, P is\n\u00a7\nclosed (P = P) and has no interior points (verify!), so (P)0 = P0 = .\n\u2205\n(e) The set R of all rationals in E1 is meagre; for it is countable (see Chap-\nter 1, 9), hence a countable union of nowhere dense singletons r ,\nn\n\u00a7 { }\nr R. But R is not nowhere dense; it is even dense in E1, since R = E1\nn\n\u2208\n(see Definition 2, in Chapter 3, 14). Thus a meagre set need not be\n\u00a7\nnowhere dense. (But all nowhere dense sets are meagre\u2014why?)\nExamples (c) and (d) show that a nowhere dense set may be infinite (even\nuncountable). Yet, sometimes nowhere dense sets are treated as \u201csmall\u201d or\n\u201cnegligible,\u201d in comparison with other sets. Most important is the following\ntheorem.\nTheorem 1 (Baire). In a complete metric space (S,\u03c1), every open set G\u2217 =\n6 \u2205\nis nonmeagre. Hence the entire space S is residual.\nProof. Seeking a contradiction, suppose G\u2217 is meagre, i.e.,\n\u221e\nG\u2217 = A\nn\nn=1\n[\nfor some nowhere dense sets A . Now, as A is nowhere dense, G\u2217 contains a\nn 1\nclosed globe\nG = G (\u03b4 ) A .\n1 x1 1 1\n\u2286 \u2212\nAgain, as A is nowhere dense, G contains a globe\n2 1\n1\nG = G (\u03b4 ) A , with 0 < \u03b4 \u03b4 .\n2 x2 2 2 2 1\n\u2286 \u2212 \u2264 2 72 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nBy induction, we obtain a contracting sequence of closed globes\n1\nG = G (\u03b4 ), with 0 < \u03b4 \u03b4 0.\nn xn n n \u2264 2n 1 \u2192\nAs S is complete, so are the G (Theorem 5 in Chapter 3, 17). Thus, by\nn\n\u00a7\nCantor\u2019s theorem (Theorem 5 of Chapter 4, 6), there is\n\u00a7\n\u221e\np G .\nn\n\u2208\nn=1\n\\\nAs G\u2217 G , we have p G\u2217. But, as G A , we also have ( n) p A ;\nn n n n\n\u2287 \u2208 \u2286 \u2212 \u2200 6\u2208\nhence\n\u221e\np A = G\u2217\nn\n6\u2208\nn=1\n[\n(the desired contradiction!). (cid:3)\nWe shall need a lemma based on Problems 15 and 19 in 7. (Review them!)\n\u00a7\nLemma. Let f L(E\u2032,E), E\u2032 complete. Let G = G (1) be the unit globe in\n~0\n\u2208\nE\u2032. If f[G] (closure of f[G] in E) contains a globe G = G (r) E, then\n0 0\n\u2282\nG f[G].\n0\n\u2286\nNote. Recall that we \u201carrow\u201d only vectors from E\u2032 (e.g.,~0), but not those\nfrom E (e.g., 0).\nProof of lemma. Let A = f[G] G G . We claim that A is dense in\n0 0\n\u2229 \u2286\nG ; i.e., G A. Indeed, by assumption, any q G is in f[G]. Thus by\n0 0 0\n\u2286 \u2208\nTheorem 3 in Chapter 3, 16, any G meets f[G] G = A if q G . Hence\nq 0 0\n\u00a7 \u2229 \u2208\n( q G ) q A,\n0\n\u2200 \u2208 \u2208\ni.e., G A, as claimed.\n0\n\u2286\nNow fix any q G = G (r) and a real c (0 < c < 1). As A is dense in G ,\n0 0 0 0\n\u2208\nA G (cr) = ;\nq0\n\u2229 6 \u2205\nso let q A G (cr) f[G]. Then\n1 q0\n\u2208 \u2229 \u2286\nq q < cr, q G (cr).\n1 0 0 q1\n| \u2212 | \u2208\nAs q f[G], we can fix some p~ G = G (1), with f(p~ ) = q . Also, by\n1 \u2208 1 \u2208 0 1 1\nProblems 19(iv) and 15(iii) in 7, cA+q is dense in cG +q = G (cr). But\n1 0 1 q1\n\u00a7\nq G (cr). Thus\n0 q1\n\u2208\nG (c2r) (cA+q ) = ;\nq0 1\n\u2229 6 \u2205\nso let q G (c2r) (cA+q ), so q G (c2r), etc.\n2 q0 1 0 q2\n\u2208 \u2229 \u2208\nInductively, we fix for each n > 1 some q G (cnr), with\nn q0\n\u2208\nq cn\u22121A+q ,\nn n\u22121\n\u2208 8. Baire Categories. More on Linear Maps 73\n\u2217\n\u00a7\ni.e.,\nq q cn\u22121A.\nn n\u22121\n\u2212 \u2208\nAs A f[G (1)], linearity yields\n0\n\u2286\nq q f[cn\u22121G (1)] = f[G (cn\u22121)], n > 1.\nn n\u22121 0 0\n\u2212 \u2208\nThus for each n > 1, there is p~ G (cn\u22121), (i.e., p~ < cn\u22121) such that\nn \u2208 0 | n|\nf(p~ ) = q q . Now, as p~ < cn\u22121 and 0 < c < 1,\nn n \u2212 n\u22121 | n|\n\u221e\np~ < + ;\n| n| \u221e\n1\nX\nso by the completeness of E\u2032, p~ converges in E\u2032 (Theorem 1 in Chapter 4,\nn\n\u221e\n13). Let p~ = p~ ; then\n\u00a7 k=1 k P\nP n n\nf(p~) = f lim p~ = lim f p~\nk k\nn\u2192\u221e n\u2192\u221e\n(cid:18) k=1 (cid:19) (cid:18)k=1 (cid:19)\nX X\nn\n= lim f(p~ ) for f L(E\u2032,E).\nn\u2192\u221e k \u2208\nk=1\nX\nBut f(p~ ) = q q (k > 1), and f(p~ ) = q ; so\nk k \u2212 k\u22121 1 1\nn n\nf(p~ ) = q + (q q ) = q .\nk 1 k \u2212 k\u22121 n\nk=1 k=2\nX X\nThus\nn\nf(p~) = lim f(p~ ) = lim q = q .1\nk n 0\nn\u2192\u221e n\u2192\u221e\nk=1\nX\nMoreover, p~ < ck\u22121 (k 1). Thus\n| k| \u2265\n\u221e \u221e\n1\np~ p~ < ck\u22121 = ;\n| | \u2264 | k| 1 c\nk=1 k=1 \u2212\nX X\ni.e.,\n1\np~ G .\n~0\n\u2208 1 c\n(cid:16) \u2212 (cid:17)\nBut q = f(p~); so\n0\n1\nq f G .\n0 ~0\n\u2208 1 c\nh (cid:16) \u2212 (cid:17)i\n1Note that qn \u2192q 0, since qn \u2208Gq0(cnr) implies |qn \u2212q |<cnr \u21920, as 0<c<1.\n0 74 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nAs q G (r) was arbitrary, we have\n0 0\n\u2208\n1\nG (r) f G ,\n0 0\n\u2286 1 c\nh (cid:16) \u2212 (cid:17)i\nor by linearity,\nG (r(1 c)) f[G (1)] = f[G].\n0 0\n\u2212 \u2286\nThis holds for any c (0,1). Hence\n\u2208\nf[G] G (r(1 c)) = G (r). (Verify!)\n0 0\n\u2287 \u2212\n0<c<1\n[\nThus all is proved. (cid:3)\nWe can now establish an important result due to S. Banach.\nTheorem 2 (Banach). Let f L(E\u2032,E), with E\u2032 complete. Then f[E\u2032] is\n\u2208\nmeagre in E or f[E\u2032] = E, according to whether f[G (1)] is or is not nowhere\n~0\ndense.2\nProof. If f[G (1)] is nowhere dense in E, so also is f[G (n)], n > 0. (Verify\n0 0\nby Problems 15 and 19 in 7.) But then\n\u00a7\n\u221e \u221e\nf[E\u2032] = f G (n) = f[G (n)]\n0 ~0\n(cid:20)n=1 (cid:21) n=1\n[ [\nis a countable union of nowhere dense sets, hence meagre, by definition.\nNow suppose f[G (1)] is not nowhere dense; so f[G (1)] contains some\n~0 ~0\nG (r) E. We may assume q f[G (1)] (if not, replace q by a close point\nq ~0\n\u2286 \u2208\nfrom f[G (1)]). Then q = f(p~) for some p~ G (1). The latter implies\n~0 ~0\n\u2208\np~ = p~ = \u03c1(p~,~0) < 1;\n|\u2212 | | |\nso\nG (1) G (2).\n\u2212p~ ~0\n\u2286\nAlso, as f[G (1)] G (r), translation by q = f( p~) yields\n~0 q\n\u2287 \u2212 \u2212\nf[G (1)]+f( p~) G (r) q = G (r),\n~0 q 0\n\u2212 \u2287 \u2212\ni.e.,\nG (r) f[G (1)] f[G (2)].\n0 \u2212p~ ~0\n\u2286 \u2286\nHence f[G (1)] G (1r) (why?); so, by the Lemma\n~0 \u2287 0 2\n1\n(1) f[G (1)] G r in E.\n~0 0\n\u2287 2\n(cid:16) (cid:17)\n2Of course, if E is meagre, so is f[E ] in both cases.\n\u2032 8. Baire Categories. More on Linear Maps 75\n\u2217\n\u00a7\nThis implies f[G (2n)] G (nr), and so\n~0 0\n\u2287\n\u221e\nf[E\u2032] G (nr) = E,\n0\n\u2287\nn=1\n[\ni.e., f[E\u2032] = E, as required. Thus the theorem is proved. (cid:3)\nTheorem 3 (Openmapprinciple). Let f L(E\u2032,E), with E\u2032 and E complete.\n\u2208\nThen the map f is open on E\u2032 iff f[E\u2032] = E, i.e., iff f is onto E.\nProof. If f[E\u2032] = E, then by Theorem 1, f[E\u2032] is nonmeagre in E, as is E\nitself. Thus by Theorem 2, f[G (1)] is not nowhere dense, and (1) follows as\n~0\nbefore. Hence by Problems 15(iii) and 19 in 7, f[G ] some G whenever\np~ q\n\u00a7 \u2287\nq = f(p~). (Why?) Therefore, G A E\u2032 implies\np~\n\u2286 \u2286\nG f[G ] f[A];\nf(p~) p~\n\u2286 \u2286\ni.e., f maps any interior point p~ A into such a point of f[A]. By Problem 8\n\u2208\nin 7, f is open on E\u2032.\n\u00a7\nConversely, if so, then f[E\u2032] is an open set = in E, a complete space; so by\n6 \u2205\nTheorems 1 and 2, f[E\u2032] is nonmeagre and equals E. (See also Problem 16(ii)\nin 7.) (cid:3)\n\u00a7\nNote 1. Theorem 3 holds even if f is not one-to-one.\nNote 2. If in Theorem 3, however, f is bijective, it is open on E\u2032, and\nso f\u22121 L(E,E\u2032) by Note 1 in 7. (This is the promised general proof of\n\u2208 \u00a7\nCorollary 2 in 6.)\n\u00a7\nTheorem 4 (Banach\u2013Steinhaus uniform boundedness principle). Let E\u2032 be\ncomplete. Let be a family of maps f L(E\u2032,E) such that\nN \u2208\n(2) ( x E\u2032) ( k E1) ( f ) f(~x) < k.\n\u2200 \u2208 \u2203 \u2208 \u2200 \u2208 N | |\n(\u201c is bounded at each ~x.\u201d)\nN\nThen is \u201cnorm-bounded,\u201d i.e.,\nN\n( K E1) ( f ) f < K,\n\u2203 \u2208 \u2200 \u2208 N k k\nwith as in 2.\nk k \u00a7\nProof. It suffices to show that is \u201cuniformly\u201d bounded on some globe,\nN\n(3) ( c E1) ( G = G (r)) ( f ) ( ~x G) f(~x) c.\np~\n\u2203 \u2208 \u2203 \u2200 \u2208 N \u2200 \u2208 | | \u2264\nFor then ~x p~ r implies\n| \u2212 | \u2264\n2c > f(~x) f(p~) = f(~x p~) ,\n| \u2212 | | \u2212 |\nor (setting ~x p~ = r~y) ~y < 1 implies\n\u2212 | |\n2c\n( f ) f(~y) < (why?);\n\u2200 \u2208 N | | r 76 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nso\n2c\n( f ) f = sup f(~y) < .\n\u2200 \u2208 N k k | | r\n|y~|\u22641\nThus, seeking a contradiction, suppose (3) fails and assume its negation:\n(4) ( c E1) ( G = G (r)) ( f ) ( ~x G = G (r)) f(~x) > c.\np~ p~\n\u2200 \u2208 \u2200 \u2203 \u2208 N \u2203 \u2208 | |\nThen for c = 1, we can fix some f and G (r ) such that 0 < r < 1 and\n1 ~x1 1 1\n\u2208 N\nf (~x ) > 1.\n1 1\n| |\nBy the continuity of the norm , we can choose r so small that\n1\n| |\n( ~x G (r )) f(~x) > 1.\n~x1 1\n\u2200 \u2208 | |\nAgain by (4), we fix f and ~x G (r ) such that f > 2 on some globe\n2 2 ~x1 1 2\n\u2208 N \u2208 | |\nG (r ) G (r ),\n~x2 2 ~x1 1\n\u2286\nwith 0 < r < 1/2. Inductively, we thus form a contracting sequence of closed\n2\nglobes\n1\nG (r ), 0 < r < ,\n~xn n n\nn\nand a sequence f , such that\nn\n{ } \u2286 N\n( n) f > n on G (r ) E\u2032.\nn ~xn n\n\u2200 | | \u2286\nAs E\u2032 is complete, so are the closed globes G (r ) E\u2032. Also, 0 < r <\n~xn n n\n\u2286\n1/n 0. Thus by Cantor\u2019s theorem (Theorem 5 of Chapter 4, 6), there is\n\u2192 \u00a7\n\u221e\n~x G (r ).\n0 ~xn n\n\u2208\nn=1\n\\\nAs ~x is in each G (r ), we have\n0 ~xn n\n( n) f (~x ) > n;\nn 0\n\u2200 | |\nso is not bounded at ~x , contrary to (2). This contradiction completes the\n0\nN\nproof. (cid:3)\nNote 3. Complete normed spaces are also called Banach spaces.\nProblems on Baire Categories and Linear Maps\n1. Verify the equivalence of the various formulations in Definition 1. Dis-\ncuss: A is nowhere dense iff it is not dense in any open set = .\n6 \u2205\n2. Verify Examples (a) to (e). Show that Cantor\u2019s set P is uncountable.\n[Hint: Eachp \u2208P correspondstoa\u201cternaryfraction,\u201dp= \u221en=1xn/3n,alsowritten\n0.x 1,x 2,...,xn,..., where xn = 0 or xn = 2 according to whether p is to the left,\nP 8. Baire Categories. More on Linear Maps 77\n\u2217\n\u00a7\nor to the right, of the nearest \u201cremoved\u201d open interval of length 1/3n. Imitate the\nproof of Theorem 3 in Chapter 1, 9, for uncountability. See also Chapter 1, 9,\n\u00a7 \u00a7\nProblem 2(ii).]\n3. Complete the missing details in the proof of Theorems 1 to 4.\n4. Prove the following.\n(i) If B A and A is nowhere dense or meagre, so is B.\n\u2286\n(ii) If B A and B is nonmeagre, so is A.\n\u2286\n[Hint: Assume A is meagre and use (i)).]\n(iii) Any finite union of nowhere dense sets is nowhere dense. Disprove\nit for infinite unions.\n(iv) Any countable union of meagre sets is meagre.\n5. Prove that in a discrete space (S,\u03c1), only is meagre.\n\u2205\n[Hint: Use Problem 8 in Chapter 3, 17, Example 7 in Chapter 3, 12, and our\n\u00a7 \u00a7\npresent Theorem 1.]\n6. Use Theorem 1 to give a new proof for the existence of irrationals in E1.\n[Hint: The rationals R are a meagre set, while E1 is not.]\n7. What is wrong about this \u201cproof\u201d that every closed set F = in a\n6 \u2205\ncomplete space (S,\u03c1) is residual: \u201cBy Theorem 5 of Chapter 3, 17, F\n\u00a7\nis complete as a subspace. Thus by Theorem 1, F is residual.\u201d Give\ncounterexamples!\n\u221e\n8. We call K a -set and write K iff K = G for some open\nG\u03b4 \u2208 G\u03b4 n=1 n\nsets G .3\nn\nT\n(i) Prove that if K is a -set, and if K is dense in a complete metric\n\u03b4\nG\nspace (S,\u03c1), i.e., K = S, then K is residual in S.\n[Hint: Let Fn = Gn. Verify that ( n) Gn is dense in S, and Fn is nowhere\n\u2212 \u2200\ndense. Deduce that K = Gn = Fn is meagre. Use Theorem 1.]\n\u2212 \u2212\n(ii) Infer that R (the rationalTs) is noSt a -set in E1 (cf. Example (c)).\n\u03b4\nG\n9. Show that, in a complete metric space (S,\u03c1), a meagre set A cannot\nhave interior points.\n[Hint: Otherwise, A would obtain a globe G. Use Theorem 1 and Problem 4(ii).]\n10. (i) A singleton p (S,\u03c1) is nowhere dense if S clusters at p; oth-\n{ } \u2286\nerwise, it is nonmeagre in S (being a globe, and not a union of\nnowhere dense sets).\n(ii) If A S clusters at each p A, any countable set B A is\n\u2286 \u2208 \u2286\nmeagre in S.\n3Such is any closed set A=A (S,\u03c1) (see Problem 20 in Chapter 3, 16).\n\u2286 \u00a7 78 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n11. (i) Show that if = A (see Problem8) in a complete space(S,\u03c1),\n\u03b4\n\u2205 6 \u2208 G\nand A clusters at each p A, then A is uncountable.\n\u2208\n(ii) Provethatanynonemptyperfect set(Chapter3, 14)inacomplete\n\u00a7\nspace is uncountable.\n(iii) How about R (the rationals) in E1 and in R as a subspace of E1?\nWhat is wrong?\n[Hints: (i) The subspace (A,\u03c1) is complete (why?); so A is nonmeagre in A, by\nProblem 8. Use Problem 10(ii). (ii) Use Footnote 3.]\n12. If G is open in (S,\u03c1), then G G is nowhere dense in S.\n\u2212\n[Hint: G G=G ( G) is closed; so\n\u2212 \u2229 \u2212\n(G G)0 =(G G)0 =(G G)0 =\n\u2212 \u2212 \u2229\u2212 \u2205\nby Problem 15 in Chapter 3, 12 and Problem 15 in Chapter 3, 16.]\n\u00a7 \u00a7\n13. (\u201cSimplified\u201d uniform boundedness theorem.) Let f : (S,\u03c1) (T,\u03c1\u2032)\nn\n\u2192\nbe continuous for n = 1,2,..., with S complete. If f (x) is a bounded\nn\n{ }\nsequence in T for each x S, then f is uniformly bounded on some\nn\n\u2208 { }\nopen G = :\n6 \u2205\n( p T) ( k) ( n) ( x G) \u03c1\u2032(p,f (x)) k.\nn\n\u2200 \u2208 \u2203 \u2200 \u2200 \u2208 \u2264\n[Outline: Fix p T and ( n) set\n\u2208 \u2200\nFn = x S ( m) n \u03c1\u2032(p,fm(x)) .\n{ \u2208 | \u2200 \u2265 }\nUsethecontinuityoffm andof\u03c1 toshowthatFn isclosedinS,andS = \u221en=1Fn.\n\u2032\nBy Theorem 1, S is nonmeagre; so at least one Fn is not nowhere dense\u2014call it F,\nS\nso (F)0 =F0 = . Set G=F0 and show that G is as required.]\n6 \u2205\n14. Let f : (S,\u03c1) (T,\u03c1\u2032) be continuous for n = 1,2,... Show that if\nn\n\u2192\nf f (pointwise) on S, then f is continuous on S Q, with Q meagre\nn\n\u2192 \u2212\nin S.\n[Outline: ( k,m) let\n\u2200\n\u221e 1\nA = x S \u03c1\u2032(fn(x),fm(x))> .\nkm\n\u2208 k\nm [=nn (cid:12) o\n(cid:12)\nBy the continuity of \u03c1 \u2032, fn and fm, A k(cid:12) is open in S. (Why?) So by Problem 12,\nm\n\u221em=1(A \u2212A km) is meagre for k =1,2,....\nkm\nAlso, as fn \u2192f on S, \u221em=1A = \u2205. (Verify!) Thus\nS km\nT\n\u221e \u221e\n( k) A (A A ).\nkm km km\n\u2200 \u2286 \u2212\nm=1 m=1\n\\ [\n(Why?) Hence the set Q= \u221ek=1 \u221em=1A km is meagre in S.\nMoreover, S Q = \u221ekS=1 \u221emT=1( \u2212A km)0 by Problem 16 in Chapter 3, \u00a716.\n\u2212\nDeduce that if p S Q, then\n\u2208 \u2212 T S\n( \u03b5>0) ( m 0) ( Gp) ( n,m m 0) ( x G 0) \u03c1\u2032(fm(x),fn(x))<\u03b5.\n\u2200 \u2203 \u2203 \u2200 \u2265 \u2200 \u2208 8. Baire Categories. More on Linear Maps 79\n\u2217\n\u00a7\nKeeping m fixed, let n to get\n\u2192\u221e\n( \u03b5>0) ( m 0) ( Gp) ( m m 0) ( x Gp) \u03c1\u2032(fm(x),f(x)) \u03b5.\n\u2200 \u2203 \u2203 \u2200 \u2265 \u2200 \u2208 \u2264\nNow modify the proof of Theorem 2 of Chapter 4, 12, to show that this implies the\n\u00a7\ncontinuity of f at each p S Q.]\n\u2208 \u2212\n\u00a79. Local Extrema. Maxima and Minima\nWe say that f: E\u2032 E1 has a local maximum (minimum) at p~ E\u2032 iff f(p~)\n\u2192 \u2208\nis the largest (least) value of f on some globe G about p~; more precisely, iff\n( ~x G) \u2206f = f(~x) f(p~) < 0 (> 0).\n\u2200 \u2208 \u2212\nWe speak of an improper extremum if we only have \u2206f 0 ( 0) on G. In\n\u2264 \u2265\nany case, all depends on the sign of \u2206f.\nFrom Problem 6 in 1, recall the following necessary condition.\n\u00a7\nTheorem 1. If f: E\u2032 E1 has a local extremum at p~ then D f(p~) = 0 for\nu~\n\u2192\nall ~u =~0 in E\u2032.\n6\nIn the case E\u2032 = En(Cn), this means that d1f(p~; ) = 0 on E\u2032.\n\u00b7\n(Recall that d1f(p~;~t ) = n D f(p~)t . It vanishes if the D f(p~) do.)\nk=1 k k k\nNote 1. This condition is only necessary, not sufficient. For example, if\nP\nf(x,y) = xy, then d1f(~0; ) = 0; yet f has no extremum at ~0. (Verify!)\n\u00b7\nSufficient conditions were given in Theorem 2 of 5, for E\u2032 = E1. We now\n\u00a7\ntake up E\u2032 = E2.\nTheorem 2. Let f: E2 E1 be of class CD2 on a globe G = G (\u03b4). Suppose\np~\n\u2192\nd1f(p~; ) = 0 on E2. Set A = D f(p~), B = D f(p~), and C = D f(p~).\n11 12 22\n\u00b7\nThen the following statements are true.\n(i) If AC > B2, f has a maximum or minimum at p~, according to whether\nA < 0 or A > 0.\n(ii) If AC < B2, f has no extremum at p~.\nThe case AC = B is unresolved.\nProof. Let ~x G and ~u = ~x p~ =~0.\n\u2208 \u2212 6\nAs d1f(p~; ) = 0, Theorem 2 in 5, yields\n\u00b7 \u00a7\n1\n\u2206f = f(~x) f(p~) = R = d2f(~s;~u),\n1\n\u2212 2\nwith ~s L(p~,~x) G (see Corollary 1 of 5). As f CD2, we have D f =\n12\n\u2208 \u2286 \u00a7 \u2208\nD f on G (Theorem 1 in 5). Thus by formula (4) in 5,\n21\n\u00a7 \u00a7\n1 1\n(1) \u2206f = d2f(~s;~u) = [D f(~s)u2 +2D f(~s)u u +D f(~s)u2].\n2 2 11 1 12 1 2 22 2 80 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nNow, as the partials involved are continuous, we can choose G = G (\u03b4) so\np~\nsmall that the sign of expression (1) will not change if ~s is replaced by p~. Then\nthe crucial sign of \u2206f on G coincides with that of\n(2) D = Au2 +2Bu u +Cu2\n1 1 2 2\n(with A, B, and C as stated in the theorem).\nFrom (2) we obtain, by elementary algebra,\n(3) AD = (Au +Bu )2 +(AC B2)u2,\n1 2 \u2212 2\n(3\u2032) CD = (Cu +Bu )2 +(AC B2)u2.\n1 2 \u2212 2\nClearly, if AC > B2, the right-side expression in (3) is > 0; so AD > 0,\ni.e., D has the same sign as A.\nHence if A < 0, we also have \u2206f < 0 on G, and f has a maximum at p~. If\nA > 0, then \u2206f > 0, and f has a minimum at p~.\nNow let AC < B2. We claim that no matter how small G = G (\u03b4), \u2206f\np~\nchanges sign as ~x varies in G, and so f has no extremum at p~.\nIndeed, we have ~x = p~ +~u, ~u = (u ,u ) =~0. If u = 0, (3) shows that D\n1 2 2\n6\nand \u2206f have the same sign as A (A = 0).\n6\nBut if u = 0 and u = Bu /A (assuming A = 0), then D and \u2206f have\n2 1 2\n6 \u2212 6\nthe sign opposite to that of A; and ~x is still in G if u is small enough (how\n2\nsmall?).\nOne proceeds similarly if C = 0 (interchange A and C, and use (3\u2032).\n6\nFinally, ifA = C = 0, thenby(2), D = 2Bu u andB = 0(sinceAC < B2).\n1 2\n6\nAgain D and \u2206f change sign as u u does; so f has no extremum at p~. Thus\n1 2\nall is proved. (cid:3)\nBriefly, the proof utilizes the fact that the trinomial (2) is sign-changing iff\nits discriminant B2 AC is positive, i.e., A B < 0.\n\u2212 B C\nNote 2. Functions f: C E1 (of one(cid:12)comp(cid:12)lex variable) are likewise cov-\n\u2192 (cid:12) (cid:12)\nered by Theorem 2 if one treats them as functions on E2 (of two real variables).\nFunctions of n variables. Here we must rely on the algebraic theory of so-\ncalled symmetric quadratic forms, i.e., polynomials P: En E1 of the form\n\u2192\nn n\nP(~u) = a u u ,\nij i j\nj=1 i=1\nXX\nwhere ~u = (u ,... ,u ) En and a = a E1.\ni n ij ji\n\u2208 \u2208\nWe take for granted a theorem due to J. J. Sylvester (see S. Perlis, Theory\nof Matrices, 1952, p. 197), which may be stated as follows. 9. Local Extrema. Maxima and Minima 81\n\u00a7\nLet P : En E1 be a symmetric quadratic form,\n\u2192\nn n\nP(~u) = a u u .\nij i j\nj=1 i=1\nXX\n(i) P > 0 on all of En ~0 iff the following n determinants A are positive:\nk\n\u2212{ }\na a ... a\n11 12 1k\na a ... a\n(4) A = 21 22 2k , k = 1,2,... ,n.\nk (cid:12) .................. (cid:12)\n(cid:12) (cid:12)\n(cid:12)a a ... a (cid:12)\n(cid:12) k1 k2 kk(cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(ii) We have P < 0 (cid:12)on En ~0 iff ( 1)(cid:12)kA > 0 for k = 1,2,... ,n.\nk\n\u2212{ } \u2212\nNow we can extend Theorem 2 to the case f: En E1. (This will also\n\u2192\ncover f: Cn E1, treated as f: E2n E1.) The proof resembles that of\n\u2192 \u2192\nTheorem 2.\nTheorem 3. Let f: En E1 be of class CD2 on some G = G (\u03b4). Suppose\np~\n\u2192\ndf(p~; ) = 0 on En. Define the A as in (4), with a = D f(p~), i,j,k n.\nk ij ij\n\u00b7 \u2264\nThen the following statements hold.\n(i) f has a local minimum at p~ if A > 0 for k = 1,2,... ,n.\nk\n(ii) f has a local maximum at p~ if ( 1)kA > 0 for k = 1,... ,n.\nk\n\u2212\n(iii) f has no extremum at p~ if the expression\nn n\nP(~u) = a u u\nij i j\nj=1 i=1\nXX\nis > 0 for some ~u En and < 0 for others (i.e., P changes sign on En).\n\u2208\nProof. Let again ~x G, ~u = ~x p~ =~0, and use Taylor\u2019s theorem to obtain\n\u2208 \u2212 6\nn n\n1\n(5) \u2206f = f(~x) f(p~) = R = d2f(~s;~u) = D f(~s)u u ,\n1 ij i j\n\u2212 2\nj=1 i=1\nXX\nwith ~s L(~x,p~).\n\u2208\nAs f CD2, the partials D f are continuous on G. Thus we can make G so\nij\n\u2208\nsmall that the sign of the last double sum does not change if~s is replaced by p~.\nn n\nHence the sign of \u2206f on G is the same as that of P(~u) = a u u ,\nj=1 i=1 ij i j\nwith the a as stated in the theorem.\nij\nP P\nThe quadratic form P is symmetric since a = a by Theorem 1 in 5.\nij ji\n\u00a7\nThus by Sylvester\u2019s theorem stated above, one easily obtains our assertions (i)\nand (ii). Indeed, they are immediate from clauses (i) and (ii) of that theorem. 82 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nNow, for (iii), suppose P(~u) > 0 > P(~v), i.e.,\nn n n n\na u u > 0 > a v v for some ~u,~v En ~0 .\nij i j ij i j\n\u2208 \u2212{ }\nj=1 i=1 j=1 i=1\nXX XX\nIf here ~u and ~v are replaced by t~u and t~v (t = 0), then u u and v v turn\ni j i j\n6\ninto t2u u and t2v v , respectively. Hence\ni j i j\nP(t~u) = t2P(~u) > 0 > t2P(~v) = P(t~v).\nNow, for any t (0,\u03b4/ ~u ), the point ~x = p~ + t~u lies on the ~u-directed line\n\u2208 | |\nthrough p~, inside G = G (\u03b4). (Why?) Similarly for the point ~x\u2032 = p~ +t~v.\np~\nHence for such ~x and ~x\u2032, Taylor\u2019s theorem again yields formulas analogous\nto (5) for some ~s L(p~,~x) and ~s\u2032 L(p~,~x\u2032) lying on the same two lines. It\n\u2208 \u2208\nagain follows that for small \u03b4,\nf(~x) f(p~) > 0 > f(~x\u2032) f(p~),\n\u2212 \u2212\njust as P(~u) > 0 > P(~v).\nThus \u2206f changes sign on G (\u03b4), and (iii) is proved. (cid:3)\np~\nNote 3. Still unresolved are cases in which P(~u) vanishes for some ~u =~0,\n6\nwithout changing its sign; e.g., P(~u) = (u +u +u )2 = 0 for ~u = (1,1, 2).\n1 2 3\n\u2212\nThen the answer depends on higher-order terms of the Taylor formula. In par-\nticular, if d1f(p~; ) = d2f(p~; ) = 0 on En, then \u2206f = R = 1d3f(p~;~s), etc.\n\u00b7 \u00b7 2 6\nNote 4. The largest or least value of f on a set A (sometimes called the\nabsolute maximum or minimum) may occur at some noninterior (e.g., bound-\nary) point p~ A, and then fails to be among the local extrema (where, by\n\u2208\ndefinition, a globe G A is presupposed). Thus to find absolute extrema, one\np~\n\u2286\nmust also explore the behaviour of f at noninterior points of A.\nBy Theorem 1, local extrema can occur only at so-called critical points p~,\ni.e., those at which all directional derivatives vanish (or fail to exist, in which\ncase D f(p~) = 0 by convention).\n~u\nIn practice, to find such points in En(Cn), one equates the partials D f\nk\n(k n) to 0. Then one uses Theorems 2 and 3 or other considerations to\n\u2264\ndetermine whether an extremum really exists.\nExamples.\n(A) Find the largest value of\nf(x,y) = sinx+siny sin(x+y)\n\u2212\non the set A E2 bounded by the lines x = 0, y = 0 and x+y = 2\u03c0.\n\u2286\nWe have\nD f(x,y) = cosx cos(x+y) and D f(x,y) = cosy cos(x+y).\n1 2\n\u2212 \u2212 9. Local Extrema. Maxima and Minima 83\n\u00a7\nInside the triangle A, both partials vanish only at the point (2\u03c0, 2\u03c0) at\n3 3\nwhich f = 3\u221a3. On the boundary of A (i.e., on the lines x = 0, y = 0\n2\nand x+y = 2\u03c0), f = 0. Thus even without using Theorem 2, it is evident\nthat f attains its largest value,\n2\u03c0 2\u03c0 3\nf , = \u221a3,\n3 3 2\n(cid:16) (cid:17)\nat this unique critical point.\n(B) Find the largest and the least value of\nf(x,y,z) = a2x2 +b2y2 +c2z2 (ax2 +by2 +cz2)2,\n\u2212\non the condition that x2 +y2 +z2 = 1 and a > b > c > 0.\nAs z2 = 1 x2 y2, we can eliminate z from f(x,y,z) and replace f\n\u2212 \u2212\nby F: E2 E1:\n\u2192\nF(x,y) = (a2 c2)x2 +(b2 c2)y2 +c2 [(a c)x2 +(b c)y2 +c]2.\n\u2212 \u2212 \u2212 \u2212 \u2212\n(Explain!) For F, we seek the extrema on the disc G = G (1) E2,\n0\n\u2282\nwhere x2 +y2 1 (so as not to violate the condition x2 +y2 +z2 = 1).\n\u2264\nEquating to 0 the two partials\nD F(x,y) = 2x(a c) (a+c) 2[(a c)x2 +(b c)y2 +c]2 = 0,\n1\n\u2212 { \u2212 \u2212 \u2212 }\nD F(x,y) = 2y(b c) (b+c) 2[(a c)x2 +(b c)y2 +c]2 = 0\n2\n\u2212 { \u2212 \u2212 \u2212 }\nand solving this system of equations, we find these critical points in-\nside G:\n(1) x = y = 0 (F = 0);\n(2) x = 0, y = 2\u22121 2 (F = 1(b c)2); and\n\u00b1 4 \u2212\n(3) x = 2\u22121 2, y = 0 (F = 1(a c)2).\n\u00b1 4 \u2212\n(Verify!)\nNow, for the boundary of G, i.e., the circle x2 + y2 = 1, repeat this\nprocess: substitute y2 = 1 x2 in the formula for F(x,y), thus reducing\n\u2212\nit to\nh(x) = (a2 b2)x2 +b2 +[(a b)x2 +b]2, h: E1 E1,\n\u2212 \u2212 \u2192\non the interval [ 1,1] E1. In ( 1,1) the derivative\n\u2212 \u2282 \u2212\nh\u2032(x) = 2(a b)x(1 2x2)\n\u2212 \u2212\nvanishes only when\n(4) x = 0 (h = 0), and\n(5) x = 2\u22121 2 (h = 1(a b)2).\n\u00b1 4 \u2212 84 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nFinally, at the endpoints of [ 1,1], we have\n\u2212\n(6) x = 1 (h = 0).\n\u00b1\nComparing the resulting function values in all six cases, we conclude\nthat the least of them is 0, while the largest is 1(a c)2. These are the\n4 \u2212\ndesired least and largest values of f, subject to the conditions stated.\nThey are attained, respectively, at the points\n(0,0, 1), (0, 1,0), ( 1,0,0), and ( 2\u2212 21 ,0, 2\u22121 2).\n\u00b1 \u00b1 \u00b1 \u00b1 \u00b1\nAgain, the use of Theorems 2 and 3 was redundant.1 However, we\nsuggest as an exercise that the reader test the critical points of F by\nusing Theorem 2.\nCaution. Theorems 1 to 3 apply to functions of independent variables only.\nIn Example (B), x, y, z were made interdependent by the imposed equation\nx2 +y2 +z2 = 1\n(which geometrically limits all to the surface of G (1) in E3), so that one of\n~0\nthem, z, could be eliminated. Only then can Theorems 1 to 3 be used.\nProblems on Maxima and Minima\n1. Verify Note 1.\n\u2032\n1 . Complete the missing details in the proof of Theorems 2 and 3.\n2. Verify Examples (A) and (B). Supplement Example (A) by applying\nTheorem 2.\n3. Test f for extrema in E2 if f(x,y) is\nx2 y2\n(i) + (p > 0, q > 0);\n2p 2q\nx2 y2\n(ii) (p > 0, q > 0);\n2p \u2212 2q\n(iii) y2 +x4;\n(iv) y2 +x3.\n4. (i) Find the maximum volume of an interval A E3 (see Chapter 3,\n\u2282\n7)whoseedgelengthsx,y,z haveaprescribedsum: x+y+z = a.\n\u00a7\n(ii) Do the same in E4 and in En; show that A is a cube.\n1Indeed, by Theorem 2(ii) in Chapter 4, 8, absolute extrema must exist here, as all is\n\u00a7\nlimited to the compact sphere, x2+y2+z2 =1. 9. Local Extrema. Maxima and Minima 85\n\u00a7\n(iii) Hence deduce that\nn\n1\n\u221an x x x x (x 0),\n1 2 n k k\n\u00b7\u00b7\u00b7 \u2264 n \u2265\n1\nX\ni.e., the geometric mean of n nonnegative numbers is their arith-\n\u2264\nmetic mean.\n5. Find the minimum value for the sum f(x,y,z,t) = x+y+z+t of four\npositive numbers on the condition that xyzt = c4 (constant).\n[Answer: x=y =z =t=c; fmax =4c.]\n6. Among all triangles inscribed in a circle of radius R, find the one of\nmaximum area.\n[Hint: Connect the vertices with the center. Let x,y,z be the angles at the center.\nShowthattheareaofthetriangle= 1R2(sinx+siny+sinz),withz =2\u03c0 (x+y).]\n2 \u2212\n7. Among all intervals A E3 inscribed in the ellipsoid\n\u2282\nx2 y2 z2\n+ + = 1\na2 b2 c2\nfind the one of largest volume.\n[Answer: the edge lengths are 2a, 2b , 2c .]\n\u221a3 \u221a3 \u221a3\n8. Let P = (a .b ), i = 1,2,3, be 3 points in E2 forming a triangle in\ni i i\nwhich one angle (say, \u2221P ) is 2\u03c0/3.\n1\n\u2265\nFind a point P = (x,y) for which the sum of the distances,\n3\nPP +PP +PP = (x a )2 +(y b )2,\n1 2 3 i i\n\u2212 \u2212\ni=1\nXp\nis the least possible.\n[Outline: Let f(x,y)= 3 (x \u2212ai)2+(y \u2212bi)2.\ni=1\nShowthatf has nopartial derivatives atP ,P ,orP (andsoP ,P ,andP are\nP p 1 2 3 1 2 3\ncritical points at which an extremum may occur), while at other points P, partials\ndo exist but never vanish simultaneously, so that there are no other critical points.\nIndeed, prove that D f(P)=0=D f(P) would imply that\n1 2\n3 3\ncos\u03b8i =0= sin\u03b8i,\ni=1 1\nX X\nwhere \u03b8i is the angle between PPi and the x-axis; hence\nsin(\u03b8 \u03b8 )=sin(\u03b8 \u03b8 )=sin(\u03b8 \u03b8 ) (why?),\n1 2 2 3 3 1\n\u2212 \u2212 \u2212\nand so \u03b8 \u03b8 =\u03b8 \u03b8 =\u03b8 \u03b8 =2\u03c0/3, contrary to \u2221P 2\u03c0/3. (Why?)\n1 2 2 3 3 1 1\n\u2212 \u2212 \u2212 \u2265\nFrom geometric considerations, conclude that f has an absolute minimum at P .\n1\n(This shows that one cannot disregard points at which f has no partials.)] 86 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n9. Continuing Problem 8, show that if none of \u2221P , \u2221P , and \u2221P is\n1 2 3\n\u2265\n2\u03c0/3, then f attains its least value at some P (inside the triangle) such\nthat \u2221P PP = \u2221P PP = \u2221P PP = 2\u03c0/3.\n1 2 2 3 3 1\n[Hint: Verify that D f =0=D f at P.\n1 2\nUsethelawofcosinestoshowthatP P >PP +1PP andP P >PP +1PP .\n1 2 2 2 1 1 3 3 2 1\nAdding, obtain P P +P P >PP +PP +PP , i.e., f(P )>f(P). Similarly,\n1 3 1 2 1 2 3 1\nf(P )>f(P) and f(P )>f(P).\n2 3\nCombining with Problem 8, obtain the result.]\n10. In a circle of radius R inscribe a polygon with n+1 sides of maximum\narea.\n[Outline: Let x 1,x 2,... ,xn+1 be the central angles subtended by the sides of the\npolygon. Then its area A is\nn+1\n1\nR2 sinx ,\nk\n2\nk=1\nX\nwith xn+1 =2\u03c0 n k=1x k. (Why?) Thus all reduces to maximizing\n\u2212\nP n n\nf(x 1,... ,xn)= sinx +sin 2\u03c0 x ,\nk k\n\u2212\nk=1 (cid:18) k=1 (cid:19)\nX X\non the condition that 0 x and n x 2\u03c0. (Why?)\n\u2264 k k=1 k \u2264\nThese inequalities define a bounded set D En (called a simplex). Equating all\nP \u2282\npartialsoff to0,showthattheonlycriticalpointinterior toD is~x =(x 1,... ,xn),\nwith x = n2 +\u03c0 1, k \u2264n (implying that xn+1 = n2 +\u03c0 1, too). For that ~x, we get\nk\nf(~x)=(n+1)sin[2\u03c0/(n+1)].\nThis valuemust be comparedwith the \u201cboundary\u201d values of f, onthe \u201cfaces\u201d of the\nsimplex D (see Note 4).\nDo this by induction. For n=2, Problem 6 shows that f(~x) is indeed the largest\nwhenallx equal n2 +\u03c0 1. NowletDn bethe\u201cface\u201dofD,wherexn =0. Onthatface,\nk\ntreat f as a function of only n 1 variables, x 1,... ,xn 1.\n\u2212 \u2212\nBytheinductivehypothesis,thelargestvalueoff onDn isnsin(2\u03c0/n). Similarly\nfor the other \u201cfaces.\u201d As nsin(2\u03c0/n) < (n + 1)sin2\u03c0/(n+1), the induction is\ncomplete.\nThus, the area A is the largest when the polygon is regular, for which\n1 2\u03c0\nA= R2(n+1)sin .]\n2 n+1\n11. Among all triangles of a prescribed perimeter 2p, find the one of maxi-\nmum area.\n[Hint: Maximize p(p x)(p y)(p z) on the condition that x+y+z =2p.]\n\u2212 \u2212 \u2212\n12. Among all triangles of area A, find the one of smallest perimeter.\n13. Find the shortest distance from a given point p~ En to a given plane\n\u2208\n~u ~x = c (Chapter 3, 4\u20136). Answer:\n\u00b7 \u00a7\u00a7\n~u p~ c\n\u00b7 \u2212 .\n\u00b1 ~u\n| | 9. Local Extrema. Maxima and Minima 87\n\u00a7\n[Hint: First do it in E3, writing (x,y,z) for ~x.]\n\u00a710. More on Implicit Differentiation. Conditional Extrema\nI. Implicit differentiation was sketched in 7. Under suitable assumptions\n\u00a7\n(Theorem 4 in 7), one can differentiate a given system of equations,\n\u00a7\n(1) g (x ,... ,x ,y ,... ,y ) = 0, k = 1,2,... ,n,\nk 1 n 1 m\ntreating the x as implicit functions of the y without seeking an explicit solu-\nj i\ntion of the form\nx = H (y ,... ,y ).\nj j 1 m\n\u2202x\nj\nThis yields a new system of equations from which the partials D H =\ni j\n\u2202y\ncan be found directly. i\nWe now supplement Theorem 4 in 7 (review it!) by showing that this new\n\u00a7\nsystem is linear in the partials involved and that its determinant is = 0. Thus\n6\nin general, it is simpler to solve than (1).\nAs in Part IV of 7, we set\n\u00a7\n(~x,~y) = (x ,... ,x ,y ,... ,y ) and g = (g ,... ,g ),\n1 n 1 m 1 n\nreplacing the f of 7 by g. Then equations (1) simplify to\n\u00a7\n(2) g(~x,~y) =~0,\nwhere g: En+m En (or g: Cn+m Cn).\n\u2192 \u2192\nTheorem 1 (implicit differentiation). Adopt all assumptions of Theorem 4 in\n7, replacing f by g and setting H = (H ,... ,H ),\n1 n\n\u00a7\nD g (p~,~q) = a , j n+m, k n.\nj k jk\n\u2264 \u2264\nThen for each i = 1,... ,m, we have n linear equations,\nn\n(3) a D H (~q) = a , k n,\njk i j n+i,k\n\u2212 \u2264\nj=1\nX\nwith\ndet(a ) = 0, (j,k n),\njk\n6 \u2264\nthat uniquely determine the partials D H (~q) for j = 1,2,... ,n.\ni j\nProof. As usual, extend the map H: Q P of Theorem 4 in 7 to H: Em\n\u2192 \u00a7 \u2192\nEn (or Cm Cn) by setting H =~0 on Q.\n\u2192 \u2212\nAlso, define \u03c3: Em En+m (Cm Cn+m) by\n\u2192 \u2192\n(4) \u03c3(~y) = (H(~y),~y) = (H (~y),... ,H (~y),y ,... ,y ), ~y Em(Cm).\n1 n 1 m\n\u2208 88 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nThen \u03c3 is differentiable at ~q Q, as are its n + m components. (Why?)\n\u2208\nSince ~x = H(~y) is a solution of (2), equations (1) and (2) become identities\nwhen ~x is replaced by H(~y). Also, \u03c3(~q) = (H(~q),~q) = (p~,~q) since H(~q) = p~.\nMoreover,\ng(\u03c3(~y)) = g(H(~y),~y) =~0 for ~y Q;\n\u2208\ni.e., g \u03c3 =~0 on Q.\n\u25e6\nNow, by assumption, g CD1 at (p~,~q); so the chain rule (Theorem 2 in\n\u2208\n4) applies, with f, p~, ~q, n, and m replaced by \u03c3, ~q, (p~,~q), m, and n + m,\n\u00a7\nrespectively.\nAs h = g \u03c3 = ~0 on Q, an open set, the partials of h vanish on Q. So by\n\u25e6\nTheorem 2 of 4, writing \u03c3 for the jth component of \u03c3,\nj\n\u00a7\nn+m\n(5) ~0 = D g(p~,~q) D \u03c3 (~q), i m.\nj i j\n\u00b7 \u2264\nj=1\nX\nBy (4), \u03c3 = H if j n, and \u03c3 (~y) = y if j = n+i. Thus D \u03c3 = D H ,\nj j j i i j i j\n\u2264\nj n; but for j > n, we have D \u03c3 = 1 if j = n+i, and D \u03c3 = 0 otherwise.\ni j i j\n\u2264\nHence by (5),\nn\n~0 = D g(p~,~q) D H (~q)+D g(p~,~q), i = 1,2,... ,m.\nj i j n+i\n\u00b7\nj=1\nX\nAs g = (g ,... ,g ), each of these vector equations splits into n scalar ones:\n1 n\nn\n(6) 0 = D g (p~,~q) D H (~q)+D g (p~,~q), i m, k n.\nj k i j n+i k\n\u00b7 \u2264 \u2264\nj=1\nX\nWith D g (p~,~q) = a , this yields (3), where det(a ) = det(D g (p~,~q)) = 0,\nj k jk jk j k\n6\nby hypothesis (see Theorem 4 in 7).\n\u00a7\nThus all is proved. (cid:3)\nNote 1. By continuity (Note 1 in 6), we have det(D g (~x,~y)) = 0 for all\nj k\n\u00a7 6\n(~x,~y) in a sufficiently small neighborhood of (p~,~q). Thus Theorem 1 holds also\nwith (p~,~q) replaced by such (~x,~y). In practice, one does not have to memorize\n(3), but one obtains it by implicitly differentiating equations (1).\nII. We shall now apply Theorem 1 to the theory of conditional extrema.\nDefinition 1.\nWesaythatf: En+m E1 hasalocalconditional maximum(minimum)\n\u2192\nat p~ En+m, with constraints\n\u2208\ng = (g ,... ,g ) =~0\n1 n 10. More on Implicit Differentiation. Conditional Extrema 89\n\u00a7\n(g : En+m En) iff in some neighborhood G of p~ we have\n\u2192\n\u2206f = f(~x) f(p~) 0 ( 0, respectively)\n\u2212 \u2264 \u2265\nfor all ~x G for which g(~x) =~0.\n\u2208\nIn 9 (Example (B) and Problems), we found such conditional extrema by\n\u00a7\nusing the constraint equations g = ~0 to eliminate some variables and thus\nreduce all to finding the unconditional extrema of a function of fewer (inde-\npendent) variables.\nOften, however, such elimination is cumbersome since it involves solving a\nsystem (1) of possibly nonlinear equations. It is here that implicit differentia-\ntion (based on Theorem 1) is useful.\nLagrange invented a method (known as that of multipliers) for finding the\ncritical points at which such extrema may exist; to wit, we have the following:\nGiven f: En+m E1, set\n\u2192\nn\n(7) F = f + c g ,\nk k\nk=1\nX\nwhere the constants c are to be determined and g are as above.\nk k\nThen find the partials D F (j n + m) and solve the system of 2n + m\nj\n\u2264\nequations\n(8) D F(~x) = 0, j n+m, and g (~x) = 0, k n,\nj k\n\u2264 \u2264\nfor the 2n+m \u201cunknowns\u201d x (j n+m) and c (k n), the c originating\nj k k\n\u2264 \u2264\nfrom (7).\nAny ~x satisfying (8), with the c so determined is a critical point (still to\nk\nbe tested). The method is based on Theorem 2 below, where we again write\n(p~,~q) for p~ and (~x,~y) for ~x (we call it \u201cdouble notation\u201d).\nTheorem 2 (Lagrange multipliers). Suppose f: En+m E1 is differen-\n\u2192\ntiable at\n(p~,~q) = (p ,... ,p ,q ,... ,q )\n1 n 1 m\nand has a local extremum at (p~,~q) subject to the constraints\ng = (g ,... ,g ) =~0,\n1 n\nwith g as in Theorem 1, g: En+m En. Then\n\u2192\nn\n(9) c D g (p~,~q) = D f(p~,~q), j = 1,2,... ,n+m,1\nk j k j\n\u2212\nk=1\nX\nfor certain multipliers c (determined by the first n equations in (9)).\nk\n1That is, DjF(p~,q~)=0, with F as in (7). 90 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nProof. These n equations admit a unique solution for the c , as they are\nk\nlinear, and\ndet(D g (p~,~q)) = 0 (j,k n)\nj k\n6 \u2264\nby hypothesis. With the c so determined, (9) holds for j n. It remains to\nk\n\u2264\nprove (9) for n < j n+m.\n\u2264\nNow, since f has a conditional extremum at (p~,~q) as stated, we have\n(10) f(~x,~y) f(p~,~q) 0 (or 0)\n\u2212 \u2264 \u2265\nfor all (~x,~y) P Q with g(~x,~y) = ~0, provided we make the neighborhood\n\u2208 \u00d7\nP Q small enough.\n\u00d7\nDefine H and \u03c3 as in the previous proof (see (4)); so ~x = H(~y) is equivalent\nto g(~x,~y) =~0 for (~x,~y) P Q.\n\u2208 \u00d7\nThen, for all such (~x,~y), with ~x = H(~y), we surely have g(~x,~y) = ~0 and\nalso\nf(~x,~y) = f(H(~y),~y) = f(\u03c3(~y)).\nSet h = f \u03c3, h: Em E1. Then (10) reduces to\n\u25e6 \u2192\nh(~y) h(~q) 0 (or 0) for all ~y Q.\n\u2212 \u2264 \u2265 \u2208\nThis means that h has an unconditional extremum at ~q, an interior point of\nQ. Thus, by Theorem 1 in 9,\n\u00a7\nD h(~q) = 0, i = 1,... ,m.\ni\nHence, applying the chain rule (Theorem 2 of 4) to h = f \u03c3, we get, much\n\u00a7 \u25e6\nas in the previous proof,\nn+m\n0 = D f(p~,~q)D \u03c3 (~q)\nj i j\nj=1\n(11) X\nn\n= D f(p~,~q)D H (~q)+D f(p~,~q), i m.\nj i j n+i\n\u2264\nj=1\nX\n(Verify!)\nNext, as g by hypothesis satisfies Theorem 1, we get equations (3) or equiv-\nalently (6). Multiplying (6) by c , adding and combining with (11), we obtain\nk\nn n\nD f(p~,~q)+ c D g (p~,~q) D H (~q)\nj k j k i j\nj=1 k=1\nX(cid:2) X (cid:3)\nn\n+D f(p~,~q)+ c D g (p~,~q) = 0, i m.\nn+i k n+i k\n\u2264\nk=1\nX 10. More on Implicit Differentiation. Conditional Extrema 91\n\u00a7\n(Verify!) But the square-bracketed expression is 0; for we chose the c so as to\nk\nsatisfy (9) for j n. Thus all simplifies to\n\u2264\nn\nc D g (p~,~q) = D f(p~,~q), i = 1,2,... ,m.\nk n+i k n+i\n\u2212\nk=1\nX\nHence (9) holds for n < j n+m, too, and all is proved. (cid:3)\n\u2264\nRemarks. Lagrange\u2019s method has the advantage that all variables (the x\nk\nand y ) are treated equally, without singling out the dependent ones. Thus in\ni\napplications, one uses only F, i.e., f and g (not H).\nOne can also write ~x = (x ,... ,x ) for (~x,~y) = (x ,... ,x ,y ,... ,y )\n1 n+m 1 n 1 m\n(the \u201cdouble\u201d notation was good for the proof only).\nOn the other hand, one still must solve equations (8).\nTheorem2yieldsonlyanecessary condition(9)forextremawithconstraints.\nThere also are various sufficient conditions, but mostly one uses geometric and\nother considerations instead (as we did in 9). Therefore, we limit ourselves to\n\u00a7\none proposition (using \u201csingle\u201d notation this time).\nTheorem 3 (sufficient conditions). Let\nn\nF = f + c g ,\nk k\nk=1\nX\nwith f: En+m E1, g : En+m En, and c as in Theorem 2.\nk\n\u2192 \u2192\nThen f has a maximum (minimum) at p~ = (p ,... ,p ) (with constraints\n1 n+m\ng = (g ,... ,g ) = ~0) whenever F does. (A fortiori, this is the case if F has\n1 n\nan unconditional extremum at p~.)\nProof. Suppose F has a maximum at p~, with constraints g =~0. Then\nn\n0 F(~x) F(p~) = f(~x) f(p~)+ c [g (~x) g (p~)]\nk k k\n\u2265 \u2212 \u2212 \u2212\nk=1\nX\nfor those ~x near p~ (including ~x = p~) for which g(~x) =~0.\nBut for such ~x, g (~x) = g (p~) = 0, c [g (~x) g (p~)] = 0, and so\nk k k k k\n\u2212\n0 F(~x) F(p~) = f(~x) f(p~).\n\u2265 \u2212 \u2212\nHence f has a maximum at p~, with constraints as stated.\nSimilarly, \u2206F = \u2206f in case F has a conditional minimum at p~. (cid:3)\nExample 1.\nFind the local extrema of\nf(x,y,z,t) = x+y +z +t 92 Chapter 6. Differentiation on En and Other Normed Linear Spaces\non the condition that\ng(x,y,z,t) = xyzt a4 = 0,\n\u2212\nwith a > 0 and x,y,z,t > 0. (Note that inequalities do not count as\n\u201cconstraints\u201d in the sense of Theorems 2 and 3.) Here one can simply\neliminate t = a4/(xyz), but it is still easier to use Lagrange\u2019s method.\nSet F(x,y,z,t) = x + y + z + t + cxyzt. (We drop a4 since it will\nanyway disappear in differentiation.) Equations (8) then read\n0 = 1+cyzt = 1+cxzt = 1+cxyt = 1+cxyz, xyzt a4 = 0.\n\u2212\nSolving for x,z,t and c, we get c = a\u22123, x = y = z = t = a.\n\u2212\nThus F(x,y,z,t) = x+y+z+t xyzt/a3, and the only critical point\n\u2212\nis p~ = (a,a,a,a). (Verify!)\nBy Theorem 3, one can now explore the sign of F(~x) F(p~), where\n\u2212\n~x = (x,y,z,t). For ~x near p~, it agrees with the sign of d2F(p~; ). (See\n\u00b7\nproof of Theorem 2 in 9.) We shall do it below, using yet another device,\n\u00a7\nto be explained now.\nElimination of dependent differentials. If all partials of F vanish at p~\n(e.g., if p~ satisfies (9)), then d1F(p~; ) = 0 on En+m (briefly dF 0).\n\u00b7 \u2261\nConversely, if d1f(p~; ) = 0 on a globe G , for some function f on n inde-\np~\n\u00b7\npendent variables, then\nD f(p~) = 0, k = 1,2,... ,n,\nk\nsince d1f(p~; ) (a polynomial!) vanishes at infinitely many points if its coeffi-\n\u00b7\ncients D f(p~) vanish. (The latter fails, however, if the variables are interde-\nk\npendent.)\nThus, instead of working with the partials, one can equate to 0 the differen-\ntial dF or df. Using the \u201cvariable\u201d notation and the invariance of df (Note 4\nin 4), one then writes dx,dy,... for the \u201cdifferentials\u201d of dependent and inde-\n\u00a7\npendent variables alike, and tries to eliminate the differentials of the dependent\nvariables. We now redo Example 1 using this method.\nExample 2.\nWith f and g as in Example 1, we treat t as the dependent variable,\ni.e., an implicit function of x,y,z,\nt = a4/(xyz) = H(x,y,z),\nand differentiate the identity xyzt a4 = 0 to obtain\n\u2212\n0 = yztdx+xztdy +xytdz +xyzdt; 10. More on Implicit Differentiation. Conditional Extrema 93\n\u00a7\nso\ndx dy dz\n(12) dt = t + + .\n\u2212 x y z\n(cid:16) (cid:17)\nSubstituting this value of dt in df = dx+dy+dz+dt = 0 (the equation\nfor critical points), we eliminate dt and find:\nt t t\n1 dx+ 1 dy + 1 dz 0.\n\u2212 x \u2212 y \u2212 z \u2261\n(cid:16) (cid:17) (cid:16) (cid:17) (cid:16) (cid:17)\nAs x,y,z are independent variables, this identity implies that the co-\nefficients of dx, dy, and dz must vanish, as pointed out above. Thus\nt t t\n1 = 1 = 1 = 0.\n\u2212 x \u2212 y \u2212 z\nHence x = y = z = t = a. (Why?) Thus again, the only critical point is\np~ = (a,a,a,a).\nNow, returning to Lagrange\u2019s method, we use formula (5) in 5 to\n\u00a7\ncompute\n2\n(13) d2F = (dxdy +dxdz +dzdt+dxdt+dydz +dydt).\n\u2212a\n(Verify!)\nWe shall show that this expression is sign-constant (if xyzt = a4), near\nthe critical point p~. Indeed, setting x = y = z = t = a in (12), we get\ndt = (dx+dy +dz), and (13) turns into\n\u2212\n2\ndxdy +dxdz +dydz (dx+dy +dz)2\n\u2212 a \u2212\n(cid:2) 1 (cid:3)\n= dx2 +dy2 +dz2 +(dx+dy +dz)2 = d2F.\na\n(cid:2) (cid:3)\nThis expression is > 0 (for dx, dy, and dz are not all 0). Thus f has\na local conditional minimum at p~ = (a,a,a,a).\nCaution; here we cannot infer that f(p~) is the least value of f under\nthe imposed conditions: x,y,z > 0 and xyzt = a4.\nThe simplification due to the Cauchy invariant rule (Note 4 in 4)\n\u00a7\nmakes the use of the \u201cvariable\u201d notation attractive, though caution is\nmandatory.\nNote 2. When using Theorem 2, it suffices to ascertain that some n equa-\ntions from (9) admit a solution for the c ; for then, renumbering the equations,\nk\none can achieve that these become the first n equations, as was assumed. This\nmeans that the n (n+m) matrix (D g (p~,~q)) must be of rank n, i.e., con-\nj k\n\u00d7\ntains an n n-submatrix (obtained by deleting some columns), with a nonzero\n\u00d7\ndeterminant. 94 Chapter 6. Differentiation on En and Other Normed Linear Spaces\nIn the Problems we often use r,s,t,... for Lagrange multipliers.\nFurther Problems on Maxima and Minima\n1. Fill in all details in Examples 1 and 2 and the proofs of all theorems in\nthis section.\n2. Redo Example (B) in 9 by Lagrange\u2019s method.\n\u00a7\n[Hint: Set F(x,y,z) = f(x,y,z) r(x2 +y2 +z2), g(x,y,z) = x2 +y2 +z2 1.\n\u2212 \u2212\nCompare the values of f at all critical points.2]\n3. An ellipsoid\nx2 y2 z2\n+ + = 1\na2 b2 c2\nis cut by a plane ux+vy +wz = 0. Find the semiaxes of the section-\nellipse, i.e., the extrema of\n\u03c12 = [f(x,y,z)]2 = x2 +y2 +z2\nunder the constraints g = (g ,g ) =~0, where\n1 2\nx2 y2 z2\ng (x,y,z) = ux+vy +wz and g (x,y,z) = + + 1.\n1 2 a2 b2 c2 \u2212\nAssume that a > b > c > 0 and that not all u,v,w = 0.\n[Outline: By Note 2, explore the rank of the matrix\nx/a2 y/b2 z/c2\n(14) .\nu v z\n(cid:18) (cid:19)\n(Why this particular matrix?)\nSeeking a contradiction, suppose all its 2 2 determinants vanish at all points of\n\u00d7\nthesection-ellipse. Thentheupperandlowerentriesin(14)areproportional (why?);\nso x2/a2+y2/b2+z2/c2 =0 (a contradiction!).\nNext, set\nx2 y2 z2\nF(x,y,z)=x2+y2+z2+r + + +2s(ux+vy+wz).\na2 b2 c2\n(cid:16) (cid:17)\nEquate dF to 0:\nrx ry rz\n(15) x+ +su=0, y+ +sv =0, z+ +sw =0.\na2 b2 c2\nMultiplying by x,y,z, respectively, adding, and combining with g =~0, obtain r =\n\u03c12; so, by (15), for a,b,c=\u03c1,\n\u2212 6\nsua2 svb2 swc2\nx= \u2212 , y = \u2212 , z = \u2212 .\na2 \u03c12 b2 \u03c12 c2 \u03c12\n\u2212 \u2212 \u2212\nFind s,x,y,z, then compare the \u03c1-values at critical points.]\n2This suffices here, since the equation g =~0 defines a compact set S; see 9.\n\u00a7 10. More on Implicit Differentiation. Conditional Extrema 95\n\u00a7\n4. Find the least and the largest values of the quadratic form\nn\nf(~x) = a x x (a = a )\nik i k ik ki\ni,k=1\nX\non the condition that g(~x) = ~x 2 1 = 0 (f,g: En E1).\n| | \u2212 \u2192\n[Outline: Let F(~x)=f(~x) t x2+x2+...+x2 . Equating dF to 0, obtain\n\u2212 1 2 n\n(cid:0) (cid:1)\n(a t)x 1+a 12x 2+...+a 1nxn =0,\n11\n\u2212\na 21x 1+(a \u2212t)x 2+...+a 2nxn =0,\n(16) 22\n........................................\nan1x 1+an2x 2+...+(ann t)xn =0.\n\u2212\nUsing Theorem 1(iv) in 6, derive the so-called characteristic equation of f,\n\u00a7\na 11 t a 12 ... a 1n\n\u2212\n(17) (cid:12) a 21 a 22 \u2212t ... a 2n (cid:12)=0,\n(cid:12) ... ... ... ... (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12) an1 a 2n ... ann \u2212t(cid:12) (cid:12)\n(cid:12) (cid:12)\nof degree n in t. If t is(cid:12) (cid:12)one of its n roots (known to be(cid:12) (cid:12)real3), then equations (16)\nadmit a nonzero solution for ~x =(x 1,... ,xn); by replacing ~x by ~x/~x if necessary,\n| |\n~x satisfies also the constraint equation g(~x) = ~x 2 1 = 0. (Explain!) Thus each\n| | \u2212\nroot t of (17) yields a critical point ~xt =(x 1,... ,xn).\nNow, to find f(~xt), multiply the kth equation in (16) by x k, k = 1,... ,n, and\nadd to get\nn n\n0= a ikxix \u2212t x2 =f(~xt) \u2212t.\nk k\ni,k=1 k=1\nX X\nHence f(~xt)=t.\nThus the values of f at the critical points ~xt are simply the roots of (17). The\nlargest(smallest)rootisalsothelargest(least)valueoff onS = ~x En ~x =1 .\n{ \u2208 || | }\n(Explain!)]\n5. Use the method of Problem 4 to find the semiaxes of\n(i) the quadric curve in E2, centered at~0, given by 2 a x x =\ni,k=1 ik i k\n1; and\nP\n(ii) the quadric surface 3 a x x = 1 in E3, centered at ~0.\ni,k=1 ik i k\nAssume a = a .\nik ki P\n[Hint: Explore the extrema of f(~x)= ~x 2 on the condition that\n| |\ng(~x)= a ikxix 1=0.]\nk\n\u2212\ni,k\nX\n6. Using Lagrange\u2019s method, redo Problems 4, 5, 6, 7, 11, 12, and 13 of 9.\n\u00a7\n7. In E2, find the shortest distance from ~0 to the parabola y2 = 2(x+a).\n3See S. Perlis, Theory of Matrices, Reading, Mass., 1952, Theorem 9-25. 96 Chapter 6. Differentiation on En and Other Normed Linear Spaces\n8. In E3, find the shortest distance from ~0 to the intersection line of two\nplanes given by the formulas ~u ~x = a and ~v ~x = b with ~u and ~v\n\u00b7 \u00b7\ndifferent from ~0. (Rewrite all in coordinate form!)\n9. In En, find the largest value of ~a ~x if ~x = 1. Use Lagrange\u2019s method.\n| \u00b7 | | |\n*10. (Hadamard\u2019s theorem.) If A = det(x ) (i,k n), then\nik\n\u2264\nn\nA ~x ,\ni\n| | \u2264 | |\ni=1\nY\nwhere ~x = (x ,x ,... ,x ).\ni i1 i2 in\n[Hints: Set ai = ~xi . Treat A as a function of n2 variables. Using Lagrange\u2019s\n| |\nmethod, prove that, under the n constraints |~xi |2 a2 = 0, A cannot have an\n\u2212 i\nextremum unless A2 =det(y ik), with y =0 (if i 6=k) and yii =a2 i.]\nik Chapter 7\nVolume and Measure\nOur intuitive idea of \u201cvolume\u201d is rather vague. We just tend to assume that\n\u201cbodies\u201d in space (i.e., in E3) somehow have numerically expressed \u201cvolumes,\u201d\nbutit remainsunclearwhichsetsin E3 are\u201cbodies\u201dandhow volumeis defined.\nWe also intuitively assume that volumes behave \u201cadditively.\u201d That is, if a\nbody is split into disjoint parts, then the volume of the whole equals the sum of\nthe volumes of the parts. Similarly for \u201careas\u201d in E2. In elementary calculus,\nthat is often just taken for granted.\nThe famous mathematician Henri Lebesgue (1875\u20131941) extended the idea\nof \u201cvolume\u201d to a large, strictly defined family of sets in En, called Lebesgue-\nmeasurable sets, thus giving rise to whatis called measure theory. Its basic idea\nremains that of additivity, precisely formulated and proved. Moderntheory has\nstill moregeneralizedtheseideas. In this text, wehave so fardefined\u201cvolumes\u201d\nforintervalsinEn only. Thusitisnaturaltotakeintervalsasourstartingpoint.\nThis will also lead to the important idea of a semiring of sets and its extension:\na ring of sets.\nn\n\u00a71. More on Intervals in E . Semirings of Sets\nI. As a prologue, we turn to intervals in En (Chapter 3, 7).\n\u00a7\nTheorem 1. If A and B are intervals in En, then\n(i) A B is an interval ( counts as an interval);\n\u2229 \u2205\n(ii) A B is the union of finitely many disjoint intervals (but need not be an\n\u2212\ninterval itself).\nProof. The easy proof for E1 is left to the reader.\nAn interval in E2 is the cross-product of two line intervals.\nLet\nA = X Y and B = X\u2032 Y\u2032,\n\u00d7 \u00d7\nwhere X, Y, X\u2032, and Y\u2032 are intervals in E1. Then (see Figure 29)\nA B = (X Y) (X\u2032 Y\u2032) = (X X\u2032) (Y Y\u2032)\n\u2229 \u00d7 \u2229 \u00d7 \u2229 \u00d7 \u2229 98 Chapter 7. Volume and Measure\nand\nA B = [(X X\u2032) Y] [(X X\u2032) (Y Y\u2032)];\n\u2212 \u2212 \u00d7 \u222a \u2229 \u00d7 \u2212\nsee Problem 8 in Chapter 1, 1\u20133. B\nX\n\u00a7\u00a7 \u2032\nAs the theorem holds in E1,\nX X\u2032 and Y Y\u2032\nY\n\u2229 \u2229 \u2032\nA B Y Y\nare intervals in E1, while \u2229 \u2229 \u2032\nY\nX Y\u2032 and Y Y\u2032\n\u2212 \u2212 Y Y \u2032\n\u2212\nare finite unions of disjoint line intervals. X \u2212X \u2032 X \u2229X \u2032\n(In Figure 29 they are just intervals, but A X\nFigure 29\nin general they are not.)\nIt easily follows that A B is an interval in E2, while A B splits into\n\u2229 \u2212\nfinitely many such intervals. (Verify!) Thus the theorem holds in E2.\nFinally, for En, use induction. An interval in En is the cross-product of an\ninterval in En\u22121 by a line interval. Thus if the theorem holds in En\u22121, the\nsame argument shows that it holds in En, too. (Verify!)\nThis completes the inductive proof. (cid:3)\nActually, Theorem 1 applies to many other families of sets (not necessarily\nintervals or sets in En). We now give such families a name.\nDefinition 1.\nA family of arbitrary sets is called a semiring iff\nC\n(i) ( is a member), and\n\u2205 \u2208 C \u2205\n(ii) for any sets A and B from , we have A B , while A B is the\nC \u2229 \u2208 C \u2212\nunion of finitely many disjoint sets from .\nC\nBriefly: is a semiring iff it satisfies Theorem 1.\nC\nNote that here is not just a set, but a whole family of sets. Recall (Chap-\nC\nter 1, 1\u20133) that a set family (family of sets) is a set whose members are\n\u00a7\u00a7 M\nother sets. If A is a member of , we call A an -set and write A (not\nM M \u2208 M\nA ).\n\u2286 M\nSometimes we use index notation:\n= X i I ,\ni\nM { | \u2208 }\nbriefly\n= X ,\ni\nM { }\nwhere the X are -sets distinguished from each other by the subscripts i\ni\nM\nvarying over some index set I. 1. More on Intervals in En. Semirings of Sets 99\n\u00a7\nA set family = X and its union\ni\nM { }\nX\ni\ni\n[\nare said to be disjoint iff\nX X = whenever i = j.\ni j\n\u2229 \u2205 6\nNotation:\nX (disjoint).\ni\n[\nIn our case, A means that A is a -set (a member of the semiring ).\n\u2208 C C C\nThe formula\n( A,B ) A B\n\u2200 \u2208 C \u2229 \u2208 C\nmeans that the intersection of two -sets in a -set itself.\nC C\nHenceforth, we will often speak of semirings in general. In particular, this\nC\nwill apply to the case = intervals . Always keep this case in mind!\nC { }\nNote 1. By Theorem 1, the intervals in En form a semiring. So also do\nthe half-open and the half-closed intervals separately (same proof!), but not\nthe open (or closed) ones. (Why?)\nCaution. The union and difference of two -sets need not be a -set. To\nC C\nremedy this, we now enlarge .\nC\nDefinition 2.\nWe say that a set A (from or not) is -simple and write\nC C\nA \u2032\n\u2208 Cs\niff A is a finite union of disjoint -sets (such as A B in Theorem 1).\nC \u2212\nThus \u2032 is the family of all -simple sets.\nCs C\nEvery -set is also a \u2032-set, i.e., a -\nC Cs C\nsimple one. (Why?) Briefly:\n\u2032.\nC \u2286 Cs\nIf is the set of all intervals, a -simple\nC C\nset may look as in Figure 30. Figure 30\nTheorem 2. If is a semiring, and if A and B are -simple, so also are\nC C\nA B, A B, and A B.\n\u2229 \u2212 \u222a\nIn symbols,\n( A,B \u2032) A B \u2032, A B \u2032, and A B \u2032.\n\u2200 \u2208 Cs \u2229 \u2208 Cs \u2212 \u2208 Cs \u222a \u2208 Cs 100 Chapter 7. Volume and Measure\nWe give a proof outline and suggest the proof as an exercise. Before at-\ntempting it, the reader should thoroughly review the laws and problems of\nChapter 1, 1-3.\n\u00a7\u00a7\n(1) To prove A B \u2032, let\n\u2229 \u2208 Cs\nm n\nA = A (disjoint) and B = B (disjoint),\ni k\ni=1 k=1\n[ [\nwith A ,B . Verify that\ni k\n\u2208 C\nn m\nA B = (A B ) (disjoint),\ni k\n\u2229 \u2229\nk=1i=1\n[ [\nand so A B \u2032.\n\u2229 \u2208 Cs\n(2) Next prove that A B \u2032 if A \u2032 and B .\n\u2212 \u2208 Cs \u2208 Cs \u2208 C\nIndeed, if\nm\nA = A (disjoint),\ni\ni=1\n[\nthen\nm m\nA B = A B = (A B) (disjoint).\ni i\n\u2212 \u2212 \u2212\ni=1 i=1\n[ [\nVerify and use Definition 2.\n(3) Prove that\n( A,B \u2032) A B \u2032;\n\u2200 \u2208 Cs \u2212 \u2208 Cs\nwe suggest the following argument.\nLet\nn\nB = B , B .\nk k\n\u2208 C\nk=1\n[\nThen\nn n\nA B = A B = (A B )\nk k\n\u2212 \u2212 \u2212\nk=1 k=1\n[ \\\nby duality laws. But A B is -simple by step (2). Hence so is\nk\n\u2212 C\nm\nA B = (A B )\nk\n\u2212 \u2212\nk=1\n\\\nby step (1) plus induction. 1. More on Intervals in En. Semirings of Sets 101\n\u00a7\n(4) To prove A B \u2032, verify that\n\u222a \u2208 Cs\nA B = A (B A),\n\u222a \u222a \u2212\nwhere B A \u2032, by (3).\n\u2212 \u2208 Cs\nNote 2. By induction, Theorem 2 extends to any finite number of \u2032-sets.\nCs\nIt is a kind of \u201cclosure law.\u201d\nWe thus briefly say that \u2032 is closed under finite unions, intersections, and\nCs\nset differences. Any (nonempty) set family with these properties is called a set\nring (see also 3).\n\u00a7\nThus Theorem 2 states that if is a semiring, then \u2032 is a ring.\nC Cs\nCaution. An infinite union of -simple sets need not be -simple. Yet we\nC C\nmay consider such unions, as we do next.\nIn Corollary 1 below, \u2032 may be replaced by any set ring .\nCs M\nCorollary 1. If A is a finite or infinite sequence of sets from a semiring\nn\n{ }\n(or from a ring such as \u2032), then there is a disjoint sequence of -simple\nC M Cs C\nsets (or -sets) B A such that\nn n\nM \u2286\nA = B .\nn n\nn n\n[ [\nProof. Let B = A and for n = 1,2,...,\n1 1\nn\nB = A A , A .\nn+1 n+1 k k\n\u2212 \u2208 C\nk=1\n[\nn\nBy Theorem 2, the B are -simple (as are A and A ). Show that\nn C n+1 k=1 k\nthey are disjoint (assume the opposite and find a contradiction) and verify that\nS\nA = B : If x A , take the least n for which x A . Then n > 1\nn n n n\n\u2208 \u2208\nand\nS S S n\u22121\nx A A = B ,\nn k n\n\u2208 \u2212\nk=1\n[\nor n = 1 and x A = B . (cid:3)\n1 1\n\u2208\nNote 3. In Corollary 1, B \u2032, i.e., B = mn C for some disjoint sets\nn \u2208 Cs n i=1 ni\nC . Thus\nni\n\u2208 C mn S\nA = C\nn ni\nn n i=1\n[ [ [\nis also a countable disjoint union of -sets.\nC\nII. Recall that the volume of intervals is additive (Problem 9 in Chapter 3,\n7). That is, if A is split into finitely many disjoint subintervals, then vA\n\u00a7 \u2208 C\n(the volume of A) equals the sum of the volumes of the parts. 102 Chapter 7. Volume and Measure\nWe shall need the following lemma.\nLemma 1. Let X ,X ,... ,X (intervals in En). If the X are mutually\n1 2 m i\n\u2208 C\ndisjoint, then\nm m\n(i) X Y implies vX vY; and\ni i\n\u2286 \u2208 C \u2264\ni=1 i=1\n[ X\nm p m p\n(ii) X Y (with Y ) implies vX vY .\ni k k i k\n\u2286 \u2208 C \u2264\ni=1 k=1 i=1 k=1\n[ [ X X\nProof. (i) By Theorem 2, the set\nm\nY X\ni\n\u2212\ni=1\n[\nis -simple; so\nC\nm q\nY X = C\ni j\n\u2212\ni=1 j=1\n[ [\nfor some disjoint intervals C . Hence\nj\nY = X C (all disjoint).\ni j\n\u222a\n[ [\nThus by additivity,\nm q m\nvY = vX + vC vX ,\ni j i\n\u2265\ni=1 j=1 i=1\nX X X\nas claimed.\n(ii) By set theory (Problem 9 in Chapter 1, 1\u20133),\n\u00a7\u00a7\np\nX Y\ni k\n\u2286\nk=1\n[\nimplies\np p\nX = X Y = (X Y ).\ni i k i k\n\u2229 \u2229\nk=1 k=1\n[ [\nIf it happens that the Y are mutually disjoint also, so certainly are the\nk\nsmaller intervals X Y ; so by additivity,\ni k\n\u2229\np\nvX = v(X Y ).\ni i k\n\u2229\nk=1\nX 1. More on Intervals in En. Semirings of Sets 103\n\u00a7\nHence\nm m p p m\nvX = v(X Y ) = v(X Y ) .\ni i k i k\n\u2229 \u2229\ni=1 i=1k=1 k=1(cid:20)i=1 (cid:21)\nX XX X X\nBut by (i),\nm\nv(X Y ) vY (why?);\ni k k\n\u2229 \u2264\ni=1\nX\nso\nm p\nvX vY ,\ni k\n\u2264\ni=1 k=1\nX X\nas required.\nIf, however, the Y are not disjoint, Corollary 1 yields\nk\nY = B (disjoint),\nk k\n[ [\nwith\nmk\nY B = C (disjoint), C .\nk k kj kj\n\u2287 \u2208 C\nj=1\n[\nBy (i),\nmk\nvC vY .\nkj k\n\u2264\nj=1\nX\nAs\nm p p p mk\nX Y = B = C (disjoint),\ni k k kj\n\u2286\ni=1 k=1 k=1 k=1j=1\n[ [ [ [ [\nall reduces to the previous disjoint case. (cid:3)\nCorollary 2. Let A \u2032 ( = intervals in En). If\n\u2208 Cs C\nm p\nA = X (disjoint) = Y (disjoint)\ni k\ni=1 k=1\n[ [\nwith X ,Y , then\ni k\n\u2208 C\nm p\nvX = vY .\ni k\ni=1 k=1\nX X\n(Use part (ii) of the lemma twice.)\nThus we can (and do) unambiguously define vA to be either of these sums. 104 Chapter 7. Volume and Measure\nProblems on Intervals and Semirings\n1. Complete the proof of Theorem 1 and Note 1.\n\u2032\n1 . Prove Theorem 2 in detail.\n2. Fill in the details in the proof of Corollary 1.\n\u2032\n2 . Prove Corollary 2.\n3. Show that, in the definition of a semiring, the condition is equiv-\n\u2205 \u2208 C\nalent to = .\nC 6 \u2205\n[Hint: Consider \u2205=A \u2212A= m i=1Ai (A,Ai \u2208C) to get \u2205=Ai \u2208C.]\n4. Given a set S, show thatSthe following are semirings or rings.\n(a) = all subsets of S ;\nC { }\n(b) = all finite subsets of S ;\nC { }\n(c) = ;\nC {\u2205}\n(d) = and all singletons in S .\nC {\u2205 }\nDisprove it for = and all two-point sets in S , S = 1,2,3,... .\nC {\u2205 } { }\nIn (a)\u2013(c), show that \u2032 = . Disprove it for (d).\nCs C\n5. Show that the cubes in En (n > 1) do not form a semiring.\n6. Using Corollary 2 and the definition thereafter, show that volume is\nadditive for -simple sets. That is,\nC\nm m\nif A = A (disjoint) then vA = vA (A,A \u2032).\ni i i \u2208 Cs\ni=1 i=1\n[ X\n7. Prove the lemma for -simple sets.\nC\n[Hint: Use Problem 6 and argue as before.]\n8. Prove that if is a semiring, then \u2032 ( -simple sets) = , the family of\nC Cs C Cs\nall finite unions of -sets (disjoint or not).\nC\n[Hint: Use Theorem 2.]\n\u00a72. C \u03c3-Sets. Countable Additivity. Permutable Series\nWe now want to further extend the definition of volume by considering count-\nable unions of intervals, called -sets ( being the semiring of all intervals\n\u03c3\nC C\nin En).\nWe also ask, if A is split into countably many such sets, does additivity still\nhold? This is called countable additivity or \u03c3-additivity (the \u03c3 is used whenever\ncountable unions are involved).\nWe need two lemmas in addition to that of 1.\n\u00a7 2. \u03c3-Sets. Countable Additivity. Permutable Series 105\n\u00a7 C\nLemma 1. If B is a nonempty interval in En, then given \u03b5 > 0, there is an\nopen interval C and a closed one A such that\nA B C\n\u2286 \u2286\nand\nvC \u03b5 < vB < vA+\u03b5.\n\u2212\nProof. Let the endpoints of B be\n\u00af\na\u00af = (a ,... ,a ) and b = (b ,... ,b ).\n1 n 1 n\nFor each natural number i, consider the open interval C , with endpoints\ni\n1 1 1 1 1 1\na , a , ... , a and b + , b + , ... , b + .\n1 2 n 1 2 n\n\u2212 i \u2212 i \u2212 i i i i\n(cid:16) (cid:17) (cid:16) (cid:17)\nThen B C and\ni\n\u2286\nn n\n1 1 2\nvC = b + a = b a + .\ni k k k k\ni \u2212 \u2212 i \u2212 i\nk Y=1h (cid:16) (cid:17)i k Y=1(cid:16) (cid:17)\nMaking i , we get\n\u2192 \u221e\nn\nlim vC = (b a ) = vB.\ni k k\ni\u2192\u221e \u2212\nk=1\nY\n(Why?) Hence by the sequential limit definition, given \u03b5 > 0, there is a natural\ni such that\nvC vB < \u03b5,\ni\n\u2212\nor\nvC \u03b5 < vB.\ni\n\u2212\nAs C is open and B, it is the desired interval C.\ni\n\u2287\nSimilarly, one finds the closed interval A B. (Verify!) (cid:3)\n\u2286\nLemma 2. Any open set G En is a countable union of open cubes A and\nk\n\u2286\nalso a disjoint countable union of half-open intervals.\n(See also Problem 2 below.)\nProof. If G = , take all A = .\nk\n\u2205 \u2205\nIf G = , every point p G has a cubic neighborhood\n6 \u2205 \u2208\nC G,\np\n\u2286\ncentered at p (Problem 3 in Chapter 3, 12). By slightly shrinking this C ,\np\n\u00a7\none can make its endpoints rational, with p still in it (but not necessarily its\ncenter), and make C open, half-open, or closed, as desired. (Explain!)\np 106 Chapter 7. Volume and Measure\nChoose such a cube C for every p G; so\np\n\u2208\nG C .\np\n\u2286\np\u2208G\n[\nBut by construction, G contains all C , so that\np\nG = C .\np\np\u2208G\n[\nMoreover, because the coordinates of the endpoints of all C are rational,\np\nthe set of ordered pairs of endpoints of the C is countable, and thus, while the\np\nset of all p G is uncountable, the set of distinct C is countable. Thus one\np\n\u2208\ncan put the family of all C in a sequence and rename it A :\np k\n{ }\n\u221e\nG = A .\nk\nk=1\n[\nIf, further, the A are half-open, we can use Corollary 1 and Note 3, both\nk\nfrom 1, to make the union disjoint (half-open intervals form a semiring!). (cid:3)\n\u00a7\nNow let be the family of all possible countable unions of intervals in En,\n\u03c3\nC\nsuch as G in Lemma 2 (we use for all finite unions). Thus A means\ns \u03c3\nC \u2208 C\nthat A is a -set, i.e.,\n\u03c3\nC\n\u221e\nA = A\ni\ni=1\n[\nfor some sequence of intervals A . Such are all open sets in En, but there\ni\n{ }\nalso are many other -sets.\n\u03c3\nC\nWe can always make the sequence A infinite (add null sets or repeat a\ni\n{ }\nterm!).\nBy Corollary 1 and Note 3 of 1, we can decompose any -set A into count-\n\u03c3\n\u00a7 C\nably many disjoint intervals. This can be done in many ways. However, we\nhave the following result.\nTheorem 1. If\n\u221e \u221e\nA = A (disjoint) = B (disjoint)\ni k\ni=1 k=1\n[ [\nfor some intervals A ,B in En, then\ni k\n\u221e \u221e\nvA = vB .1\ni k\ni=1 k=1\nX X\n1Recall that a positive series always has a (possibly infinite) sum. 2. \u03c3-Sets. Countable Additivity. Permutable Series 107\n\u00a7 C\nThus we can (and do) unambiguously define either of these sums to be the\nvolume vA of the -set A.\n\u03c3\nC\nProof. We shall use the Heine\u2013Borel theorem (Problem 10 in Chapter 4, 6;\n\u00a7\nreview it!).\nSeeking a contradiction, let (say)\n\u221e \u221e\nvA > vB ,\ni k\ni=1 k=1\nX X\nso, in particular,\n\u221e\nvB < + .\nk\n\u221e\nk=1\nX\nAs\n\u221e m\nvA = lim vA ,\ni i\nm\u2192\u221e\ni=1 i=1\nX X\nthere is an integer m for which\nm \u221e\nvA > vB .\ni k\ni=1 k=1\nX X\nWe fix that m and set\nm \u221e\n2\u03b5 = vA vB > 0.\ni k\n\u2212\ni=1 k=1\nX X\nDropping \u201cempties\u201d (if any), we assume A = and B = .\ni k\n6 \u2205 6 \u2205\nThen Lemma 1 yields open intervals Y B , with\nk k\n\u2287\n\u03b5\nvB > vY , k = 1,2,... ,\nk k \u2212 2k\nand closed ones X A , with\ni i\n\u2286\n\u03b5\nvX + > vA ;\ni i\nm\nso\nm \u221e m \u221e\n\u03b5 \u03b5\n2\u03b5 = vA vB < vX + vY\ni \u2212 k i m \u2212 k \u2212 2k\nXi=1 k X=1 Xi=1(cid:16) (cid:17) k X=1(cid:16) (cid:17)\nm \u221e\n= vX vY +2\u03b5.\ni k\n\u2212\ni=1 k=1\nX X\nThus\nm \u221e\n(1) vX > vY .\ni k\ni=1 k=1\nX X 108 Chapter 7. Volume and Measure\n(Explain in detail!)\nNow, as\n\u221e \u221e\nX A A = B Y ,\ni i k k\n\u2286 \u2286 \u2286\nk=1 k=1\n[ [\neach of the closed intervals X is covered by the open sets Y .\ni k\nm\nBy the Heine\u2013Borel theorem, X is already covered by a finite number\ni=1 i\nof the Y , say,\nk\nmS p\nX Y .\ni k\n\u2286\ni=1 k=1\n[ [\nThe X are disjoint, for even the larger sets A are. Thus by Lemma 1(ii) in 1,\ni i\n\u00a7\nm p \u221e\nvX vY vY ,\ni k k\n\u2264 \u2264\ni=1 k=1 k=1\nX X X\ncontrary to (1). This contradiction completes the proof. (cid:3)\nCorollary 1. If\n\u221e\nA = B (disjoint)\nk\nk=1\n[\nfor some intervals B , then\nk\n\u221e\nvA = vB .\nk\nk=1\nX\nIndeed, this is simply the definition of vA contained in Theorem 1.\nNote 1. Inparticular, Corollary1holdsifAisanintervalitself. Weexpress\nthis by saying that the volume of intervals is \u03c3-additive or countably additive.\nThis also shows that our previous definition of volume (for intervals) agrees\nwith the definition contained in Theorem 1 (for -sets).\n\u03c3\nC\nNote 2. As all open sets are -sets (Lemma 2), volume is now defined for\n\u03c3\nC\nany open set A En (in particular, for A = En).\n\u2286\nCorollary 2. If A ,B are intervals in En, with\ni k\n\u221e \u221e\nA B ,\ni k\n\u2286\ni=1 k=1\n[ [\nthen provided the A are mutually disjoint,\ni\n\u221e \u221e\n(2) vA vB .\ni k\n\u2264\ni=1 k=1\nX X 2. \u03c3-Sets. Countable Additivity. Permutable Series 109\n\u00a7 C\nThe proof is as in Theorem 1 (but the B need not be disjoint here).\nk\nCorollary 3 (\u201c\u03c3-subadditivity\u201d2 of the volume). If\n\u221e\nA B ,\nk\n\u2286\nk=1\n[\nwhere A and the B are intervals in En, then\n\u03c3 k\n\u2208 C\n\u221e\nvA vB .\nk\n\u2264\nk=1\nX\nProof. Set\n\u221e\nA = A (disjoint), A ,\ni i\n\u2208 C\ni=1\n[\nand use Corollary 2. (cid:3)\nCorollary 4 (\u201cmonotonicity\u201d2). If A,B , with\n\u03c3\n\u2208 C\nA B,\n\u2286\nthen\nvA vB.\n\u2264\n(\u201cLarger sets have larger volumes.\u201d)\nThis is simply Corollary 3, with B = B.\nk k\nCorollary 5. The volume of all of En is (we write for + ).\nS\n\u221e \u221e \u221e\nProof. We have A En for any interval A.\n\u2286\nThus, by Corollary 4, vA vEn.\n\u2264\nAs vA can be chosen arbitrarily large, vEn must be infinite. (cid:3)\nCorollary 6. For any countable set A En, vA = 0. In particular, v = 0.\n\u2282 \u2205\nProof. First let A = a\u00af be a singleton. Then we may treat A as a degenerate\n{ }\ninterval [a\u00af,a\u00af]. As all its edge lengths are 0, we have vA = 0.\nNext, if A = a\u00af ,a\u00af ,... is a countable set, then\n1 2\n{ }\nA = a\u00af ;\nk\n{ }\nk\n[\nso\nvA = v a\u00af = 0\nk\n{ }\nk\nX\nby Corollary 1.\n2This notion is treated in more detail in 5.\n\u00a7 110 Chapter 7. Volume and Measure\nFinally, is the degenerate open interval (a\u00af,a\u00af); so v = 0. (cid:3)\n\u2205 \u2205\nNote 3. Actually, all these propositions hold also if all sets involved are\n-sets, not just intervals (split each -set into disjoint intervals!).\n\u03c3 \u03c3\nC C\nPermutable Series. Since \u03c3-additivity involves countable sums, it appears\nuseful to generalize the notion of a series.\nWe say that a series of constants,\na ,\nn\nX\nis permutable iff it has a definite (possibly infinite) sum obeying the general\ncommutative law:\nGiven any one\u2013one map\nonto\nu: N N\n\u2190\u2192\n(N = the naturals), we have\na = a ,\nn un\nn n\nX X\nwhere u = u(n).\nn\n(Such are all positive and all absolutely convergent series in a complete space\nE; see Chapter 4, 13.) If the series is permutable, the sum does not depend\n\u00a7\non the choice of the map u.\nonto\nThus, given any u: N J (where J is a countable index set) and a set\n\u2190\u2192\na i J E\ni\n{ | \u2208 } \u2286\n(where E is E\u2217 or a normed space), we can define\n\u221e\na = a\ni un\ni\u2208J n=1\nX X\nif a is permutable.\nn un\nIn particular, if\nP\nJ = N N\n\u00d7\n(a countable set, by Theorem 1 in Chapter 1, 9), we call\n\u00a7\na\ni\ni\u2208J\nX\na double series, denoted by symbols like\na (k,n N).\nkn\n\u2208\nn,k\nX 2. \u03c3-Sets. Countable Additivity. Permutable Series 111\n\u00a7 C\nNote that\na\ni\n| |\ni\u2208J\nX\nis always defined (being a positive series).\nIf\na < ,\ni\n| | \u221e\ni\u2208J\nX\nwe say that a converges absolutely.\ni\u2208J i\nFor a positive series, we obtain the following result.\nP\nTheorem 2.\n(i) All positive series in E\u2217 are permutable.\n(ii) For positive double series in E\u2217, we have\n\u221e \u221e \u221e \u221e \u221e\n(3) a = a = a .\nnk nk nk\nn,k=1 n=1(cid:18)k=1 (cid:19) k=1(cid:18)n=1 (cid:19)\nX X X X X\nProof. (i) Let\n\u221e m\ns = a and s = a (a 0).\nn m n n\n\u2265\nn=1 n=1\nX X\nThen clearly\ns = s +a s ;\nm+1 m m+1 m\n\u2265\ni.e., s , and so\nm\n{ }\u2191\ns = lim s = sups\nm m\nm\u2192\u221e m\nby Theorem 3 in Chapter 3, 15.\n\u00a7\nHence s certainly does not exceed the lub of all possible sums of the form\na ,\ni\ni\u2208I\nX\nwhere I is a finite subset of N (the partial sums s are among them). Thus\nm\n(4) s sup a ,\ni\n\u2264\ni\u2208I\nX\nover all finite sets I N.\n\u2282\nOn the other hand, every such a is exceeded by, or equals, some s .\ni\u2208I i m\nHence in (4), the reverse inequality holds, too, and so\nP\ns = sup a .\ni\ni\u2208I\nX 112 Chapter 7. Volume and Measure\nBut sup a clearly does not depend on any arrangement of the a .\ni\u2208I i i\nTherefore, the series a is permutable, and assertion (i) is proved.\nn\nP\nAssertion (ii) follows similarly by considering sums of the form a ,\nP i\u2208I i\nwhere I is a finite subset of N N, and showing that the lub of such sums\nexpressi\u00d7 reader.P(cid:3)\nequals each of the three ons in (3). We leave it to the\nA similar formula holds for absolutely convergent series (see Problems).\nProblems on C -Sets, \u03c3-Additivity, and Permutable Series\n\u03c3\n1. Fill in the missing details in the proofs of this section.\n\u2032\n1 . Prove Note 3.\n2. Show that every open set A = in En is a countable union of disjoint\n6 \u2205\nhalf-open cubes.\n[Outline: For each natural m, show that En is split into such cubes of edge length\n2 m by the hyperplanes\n\u2212\ni\nx = i=0, 1, 2,... ; k =1,2,... ,n,\nk 2m \u00b1 \u00b1\nand that the family m of such cubes is countable.\nC\nFor m > 1, let Cm1,Cm2,... be the sequence of those cubes from m (if any)\nC\nthat lie in A but not in any cube Csj with s<m.\nAs A is open, x A iff x some Cmj.]\n\u2208 \u2208\n3. ProvethatanyopensetA E1 isacountableunionofdisjoint (possibly\n\u2286\ninfinite) open intervals.\n[Hint: By Lemma 2, A = n(an,bn). If, say, (a 1,b 1) overlaps with some (am,bm),\nreplace both by their union. Continue inductively.]\nS\n4. Prove that is closed under finite intersections and countable unions.\n\u03c3\nC\n5. (i) Find A,B such that A B .\n\u03c3 \u03c3\n\u2208 C \u2212 6\u2208 C\n(ii) Show that is not a semiring.\n\u03c3\nC\n[Hint: Try A=E1, B =R (the rationals).]\nNote. Inthefollowingproblems, J iscountablyinfinite, a E (E complete).\ni\n\u2208\n6. Prove that\na <\ni\n| | \u221e\ni\u2208J\nX\niff for every \u03b5 > 0, there is a finite set\nF J (F = )\n\u2282 6 \u2205\nsuch that\na < \u03b5\ni\n| |\ni\u2208I\nX\nfor every finite I J F.\n\u2282 \u2212 2. \u03c3-Sets. Countable Additivity. Permutable Series 113\n\u00a7 C\nonto\n[Outline: By Theorem 2, fix u: N J with\n\u2190\u2192\n\u221e\nai = aun .\n| | | |\ni J n=1\nX\u2208 X\nBy Cauchy\u2019s criterion,\n\u221e\naun <\n| | \u221e\nn=1\nX\niff\nn\n( \u2200\u03b5>0) ( \u2203q) ( \u2200n>m>q) |auk|<\u03b5.\nk=m\nX\nLet F = u 1,... ,uq . If I is as above,\n{ }\n( n>m>q) um,... ,un I;\n\u2203 { }\u2287\nso\nn\n|ai |auk|<\u03b5.]\n|\u2264\ni I k=m\nX\u2208 X\n7. Prove that if\na < ,\ni\n| | \u221e\ni\u2208J\nX\nthen for every \u03b5 > 0, there is a finite F J (F = ) such that\n\u2282 6 \u2205\na a < \u03b5\ni i\n\u2212\n(cid:12)i\u2208J i\u2208K (cid:12)\n(cid:12)X X (cid:12)\n(cid:12) (cid:12)\nfor each finite K F (K (cid:12) J). (cid:12)\n\u2283 \u2282\n[Hint: Proceed as in Problem 6, with I =K F and q so large that\n\u2212\n1 1\nai ai < \u03b5 and ai < \u03b5.]\n\u2212 2 2\n(cid:12)i J i F (cid:12) (cid:12)i F (cid:12)\n(cid:12)X\u2208 X\u2208 (cid:12) (cid:12)X\u2208 (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n8. Show that if\n\u221e\nJ = I (disjoint),\nn\nn=1\n[\nthen\n\u221e\na = b , where b = a .\ni n n i\n| | | |\nXi\u2208J n X=1 i X\u2208In\n(Use Problem 8\u2032 below.)\n\u2032\n8 . Show that\na = sup a\ni i\n| | | |\nF\ni\u2208J i\u2208F\nX X\nover all finite sets F J (F = ).\n\u2282 6 \u2205 114 Chapter 7. Volume and Measure\n[Hint: Argue as in Theorem 2.]\n9. Show that if = I J, then\n\u2205 6 \u2286\na a .\ni i\n| | \u2264 | |\ni\u2208I i\u2208J\nX X\n[Hint: Use Problem 8 and Corollary 2 of Chapter 2, 8\u20139.]\n\u2032\n\u00a7\u00a7\n10. Continuing Problem 8, prove that if\n\u221e\na = b < ,\ni n\n| | \u221e\ni\u2208J n=1\nX X\nthen\n\u221e\na = c with c = a .\ni n n i\nXi\u2208J n X=1 i X\u2208In\n[Outline: By Problem 9,\n( n) ai < ;\n\u2200 | | \u221e\ni X\u2208In\nso\ncn = ai\ni X\u2208In\nand\n\u221e\ncn\nn=1\nX\nconverge absolutely.\nFix \u03b5 and F as in Problem 7. Choose the largest q N with\n\u2208\nF Iq =\n\u2229 6 \u2205\n(why does it exist?), and fix any n>q. By Problem 7, ( k n)\n\u2200 \u2264\n( k n) ( finite F J F F Iq)\nk k\n\u2200 \u2264 \u2203 | \u2287 \u2287 \u2229\nn\n1\n( finite H I H F k) ai c < \u03b5.\nk k k k\n\u2200 | \u2287 \u2287 \u2212 2\n(cid:12) (cid:12)i \u2208XHk k X=1 (cid:12)\n(cid:12)\n(cid:12) (cid:12)\n(Explain!) Let (cid:12) (cid:12)\nn\nK = H ;\nk\nk=1\n[\nso\nn\nc ai <\u03b5\nk\n\u2212\n(cid:12)k=1 i J (cid:12)\n(cid:12)X X\u2208 (cid:12)\n(cid:12) (cid:12)\nand K F. By Problem 7, (cid:12) (cid:12)\n\u2283\nai ai <\u03b5.\n\u2212\n(cid:12)i K i J (cid:12)\n(cid:12)X\u2208 X\u2208 (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12) 2. \u03c3-Sets. Countable Additivity. Permutable Series 115\n\u00a7 C\nDeduce\nn\nc ai <2\u03b5.\nk\n\u2212\n(cid:12)k=1 i J (cid:12)\n(cid:12)X X\u2208 (cid:12)\n(cid:12) (cid:12)\nLet n ; then \u03b5 0.] (cid:12) (cid:12)\n\u2192\u221e \u2192\n11. (Double series.) Prove that if one of the expressions\n\u221e \u221e \u221e \u221e \u221e\na , a , a\nnk nk nk\n| | | | | |\nn,k=1 n=1(cid:18)k=1 (cid:19) k=1(cid:18)n=1 (cid:19)\nX X X X X\nis finite, so are the other two, and\na = a = a ,\nnk nk nk\nn,k n (cid:18) k (cid:19) k (cid:18) n (cid:19)\nX X X X X\nwith all series involved absolutely convergent.\n[Hint: Use Problems 8 and 10, with J =N N,\n\u00d7\nIn = (n,k) J k =1,2,... for each n;\n{ \u2208 | }\nso\n\u221e \u221e\nbn = a and cn = a nk.\nnk\n| |\nk=1 k=1\nX X\nThus obtain\na = a .\nnk nk\nn,k n k\nX XX\nSimilarly,\na = a .]\nnk n,k\nn,k k n\nX XX\n\u00a73. More on Set Families\n1\nLebesgue extended his theory far beyond -sets. For a deeper insight, we shall\n\u03c3\nC\nconsider set families in more detail, starting with set rings. First, we rephrase\nand supplement our former definition of that notion, given in 1.\n\u00a7\nDefinition 1.\nA family of subsets of a set S is a ring or set ring (in S) iff\nM\n(i) , i.e., the empty set is a member; and\n\u2205 \u2208 M\n(ii) is closed under finite unions and differences:\nM\n( X,Y ) X Y and X Y .\n\u2200 \u2208 M \u222a \u2208 M \u2212 \u2208 M\n1For a limited approach (see the preface), this topic may be omitted. 116 Chapter 7. Volume and Measure\n(For intersections, see Theorem 1 below.)\nIf is also closed under countable unions, we call it a \u03c3-ring (in S).\nM\nThen\n\u221e\nX\ni\n\u2208 M\ni=1\n[\nwhenever\nX for i = 1,2,....\ni\n\u2208 M\nIf S itself is a member of a ring (\u03c3-ring) , we call a set field\nM M\n(\u03c3-field), or a set algebra (\u03c3-algebra), in S.\nNote that S is only a member of , S , not to be confused with\nM \u2208 M\nitself.\nM\nThe family of all subsets of S (the so-called power set of S) is denoted by\n2S or (S).\nP\nExamples.\n(a) In any set S, 2S is a \u03c3-field. (Why?)\n(b) The family , consisting of alone, is a \u03c3-ring; ,S is a \u03c3-field in S.\n{\u2205} \u2205 {\u2205 }\n(Why?)\n(c) The family of all finite (countable) subsets of S is a ring (\u03c3-ring) in S.\n(d) For any semiring , \u2032 is a ring (Theorem 2 in 1). Not so for\nC Cs \u00a7 C\u03c3\n(Problem 5 in 2).\n\u00a7\nTheorem 1. Any set ring is closed under finite intersections.\nA \u03c3-ring is closed under countable intersections.\nProof. Let be a \u03c3-ring (the proof for rings is similar).\nM\nGiven a sequence A , we must show that A .\n{ n } \u2286 M n n \u2208 M\nLet\nT\nU = A .\nn\nn\n[\nBy Definition 1,\nU and U A ,\nn\n\u2208 M \u2212 \u2208 M\nas is closed under these operations. Hence\nM\n(U A )\nn\n\u2212 \u2208 M\nn\n[\nand\nU (U A ) ,\nn\n\u2212 \u2212 \u2208 M\nn\n[ 3. More on Set Families 117\n\u00a7\nor, by duality,\n[U (U A )] ,\nn\n\u2212 \u2212 \u2208 M\nn\n\\\ni.e.,\nA . (cid:3)\nn\n\u2208 M\nn\n\\\nCorollary 1. Any set ring (field, \u03c3-ring, \u03c3-field) is also a semiring.\nIndeed, by Theorem 1 and Definition 1, if is a ring, then and\nM \u2205 \u2208 M\n( A,B ) A B and A B .\n\u2200 \u2208 M \u2229 \u2208 M \u2212 \u2208 M\nHere we may treat A B as (A B) , a union of two disjoint -sets. Thus\n\u2212 \u2212 \u222a\u2205 M\nhas all properties of a semiring.\nM\nSimilarly for \u03c3-rings, fields, etc.\nIn 1 we saw that any semiring can be enlarged to become a ring, \u2032. More\n\u00a7 C Cs\ngenerally, we obtain the following result.\nTheorem 2. For any set family in a space S ( 2S), there is a unique\nM M \u2286\n\u201csmallest\u201d set ring such that\nR\nR \u2287 M\n(\u201csmallest\u201d in the sense that\n\u2032\nR \u2286 R\nfor any other ring \u2032 with \u2032 ).\nR R \u2287 M\nThe of Theorem2 is called the ring generated by . Similarly for \u03c3-rings,\nR M\nfields, and \u03c3-fields in S.\nProof. We give the proof for \u03c3-fields; it is similar in the other cases.\nThere surely are \u03c3-fields in S that contain ; e.g., take 2S. Let be\ni\nM {R }\nthe family of all possible \u03c3-fields in S such that . Let\ni\nR \u2287 M\n= .\ni\nR R\ni\n\\\nWe shall show that this is the required \u201csmallest\u201d \u03c3-field containing .\nR M\nIndeed, by assumption,\n= .\ni\nM \u2286 R R\ni\n\\\nWe now verify the \u03c3-field properties for .\nR\n(1) We have that\n( i) and S\ni i\n\u2200 \u2205 \u2208 R \u2208 R 118 Chapter 7. Volume and Measure\n(for is a \u03c3-field, by assumption). Hence\ni\nR\n= .\ni\n\u2205 \u2208 R R\ni\n\\\nSimilarly, S . Thus\n\u2208 R\n,S .\n\u2205 \u2208 R\n(2) Suppose\nX,Y = .\ni\n\u2208 R R\ni\n\\\nThen X,Y are in every , and so is X Y. Hence X Y is in\ni\nR \u2212 \u2212\n= .\ni\nR R\ni\n\\\nThus is closed under differences.\nR\n(3) Take any sequence\nA = .\nn i\n{ } \u2286 R R\ni\n\\\nThen all A are in each . A is in each ; so\nn Ri n n Ri\nS A .\nn\n\u2208 R\nn\n[\nThus is closed under countable unions.\nR\nWe see that is indeed a \u03c3-field in S, with . As is the intersection\nR M \u2286 R R\nof all (i.e., all \u03c3-fields ), we have\ni\nR \u2287 M\n( i) ;\ni\n\u2200 R \u2286 R\nso is the smallest of such \u03c3-fields.\nR\nIt is unique; for if \u2032 is another such \u03c3-field, then\nR\n\u2032\nR \u2286 R \u2286 R\n(as both and \u2032 are \u201csmallest\u201d); so\nR R\n= \u2032. (cid:3)\nR R\nNote 1. This proof also shows that the intersection of any family of\ni\n{R }\n\u03c3-fields is a \u03c3-field. Similarly for \u03c3-rings, fields, and rings.\nCorollary 2. The ring generated by a semiring coincides with\nR C\n= all finite unions of -sets\ns\nC { C }\nand with\n\u2032 = disjoint finite unions of -sets .\nCs { C } 3. More on Set Families 119\n\u00a7\nProof. By Theorem 2 in 1, \u2032 is a ring ; and\n\u00a7 Cs \u2287 C\n\u2032\nCs \u2286 Cs \u2286 R\n(for is closed under finite unions, being a ring ).\nR \u2287 C\nMoreover, as is the smallest ring , we have\nR \u2287 C\n\u2032 .\nR \u2286 Cs \u2286 Cs \u2286 R\nHence\n= \u2032 = ,\nR Cs Cs\nas claimed. (cid:3)\nIt is much harder to characterize the \u03c3-ring generated by a semiring. The\nfollowing characterization proves useful in theory and as an exercise.2\nTheorem 3. The \u03c3-ring generated by a semiring coincides with the small-\nR C\nest set family such that\nD\n(i) ;\nD \u2287 C\n(ii) is closed under countable disjoint unions;\nD\n(iii) J X whenever X , J , and X J.\n\u2212 \u2208 D \u2208 D \u2208 C \u2286\nProof. We give a proof outline, leaving the details to the reader.\n(1) The existence of a smallest such follows as in Theorem 2. Verify!\nD\n(2) Writing briefly AB for A B and A\u2032 for A, prove that\n\u2229 \u2212\n(A B)C = A (AC\u2032 BC).\n\u2212 \u2212 \u222a\n(3) For each I , set\n\u2208 D\n= A AI , A I .\nI\nD { \u2208 D | \u2208 D \u2212 \u2208 D}\nThen prove that if I , the set family has the properties (i)\u2013(iii) specified\nI\n\u2208 C D\nin the theorem. (Use the set identity (2) for property (iii).)\nHence by the minimality of , . Therefore,\nI\nD D \u2286 D\n( A ) ( I ) AI and A I .\n\u2200 \u2208 D \u2200 \u2208 C \u2208 D \u2212 \u2208 D\n(4) Using this, show that satisfies (i)\u2013(iii) for any I .\nI\nD \u2208 D\nDeduce\n;\nI\nD \u2286 D\nso is closed under finite intersections and differences.\nD\nCombining with property (ii), show that is a \u03c3-ring (see Problem 12\nD\nbelow).\n2It may be deferred until Chapter 8, 8, though.\n\u00a7 120 Chapter 7. Volume and Measure\nBy its minimality, is the smallest \u03c3-ring (for any other such \u03c3-ring\nD \u2287 C\nclearly satisfies (i)\u2013(iii)).\nThus = , as claimed. (cid:3)\nD R\nDefinition 2.\nGiven a set family , we define (following Hausdorff)\nM\n(a) = all countable unions of -sets (cf. in 2);\n\u03c3 \u03c3\nM { M } C \u00a7\n(b) = all countable intersections of -sets .\n\u03b4\nM { M }\nWe use and for similar notions, with \u201ccountable\u201d replaced by\ns d\nM M\n\u201cfinite.\u201d\nClearly,\n\u03c3 s\nM \u2287 M \u2287 M\nand\n.\n\u03b4 d\nM \u2287 M \u2287 M\nWhy?\nNote 2. Observe that is closed under finite (countable) unions iff\nM\n= ( = ).\ns \u03c3\nM M M M\nVerify! Interpret = ( = ) similarly.\nd \u03c3\nM M M M\nIn conclusion, we generalize Theorem 1 in 1.\n\u00a7\nDefinition 3.\nThe product\n.\nM\u00d7N\nof two set families and is the family of all sets of the form\nM N\nA B,\n\u00d7\nwith A and B .\n\u2208 M \u2208 N\n. .\n(The dot in is to stress that is not really a Cartesian product.)\n\u00d7 M\u00d7N\n.\nTheorem 4. If and are semirings, so is .\nM N M\u00d7N\nThe proof runs along the same lines as that of Theorem 1 in 1, via the set\n\u00a7\nidentities\n(X Y) (X\u2032 Y\u2032) = (X X\u2032) (Y Y\u2032)\n\u00d7 \u2229 \u00d7 \u2229 \u00d7 \u2229\nand\n(X Y) (X\u2032 Y\u2032) = [(X X\u2032) Y] [(X X\u2032) (Y Y\u2032)].\n\u00d7 \u2212 \u00d7 \u2212 \u00d7 \u222a \u2229 \u00d7 \u2212\nThe details are left to the reader.\nNote 3. As every ring is a semiring (Corollary 1), the product of two rings\n(fields, \u03c3-rings, \u03c3-fields) is a semiring. However, see Problem 6 below. 3. More on Set Families 121\n\u00a7\nProblems on Set Families\n1. Verify Examples (a), (b), and (c).\n\u2032\n1 . Prove Theorem 1 for rings.\n2. Show that in Definition 1 \u201c \u201d may be replaced by \u201c = .\u201d\n\u2205 \u2208 M M 6 \u2205\n[Hint: =A A.]\n\u2205 \u2212\n\u21d23. Prove that is a field (\u03c3-field) iff = , is closed under finite\nM M 6 \u2205 M\n(countable) unions, and\n( A ) A .\n\u2200 \u2208 M \u2212 \u2208 M\n[Hint: A B = ( A B); S = .]\n\u2212 \u2212 \u2212 \u222a \u2212\u2205\n4. Prove Theorem 2 for set fields.\n\u2217 \u2032\n4 . Does Note 1 apply to semirings?\n5. Prove Note 2.\n\u2032\n5 . Prove Theorem 3 in detail.\n.\n6. Prove Theorem 4 and show that the product of two rings need\nM\u00d7N\nnot be a ring.\n[Hint: Let S =E1 and = =2S. Take A,B as in Theorem 1 of 1. Verify that\n. M N \u00a7\nA B .]\n\u2212 6\u2208M\u00d7N\n\u21d27. Let , \u2032 be the rings (\u03c3-rings, fields, \u03c3-fields) generated by and ,\nR R M N\nrespectively. Prove the following.\n(i) If , then \u2032.\nM \u2286 N R \u2286 R\n(ii) If , then = \u2032.\nM \u2286 N \u2286 R R R\n(iii) If\n= open intervals in En\nM { }\nand\n= all open sets in En ,\nN { }\nthen = \u2032.\nR R\n[Hint: Use Lemma 2 in 2 for (iii). Use the minimality of and .]\n\u2032\n\u00a7 R R\n8. Is any of the following a semiring, ring, \u03c3-ring, field, or \u03c3-field? Why?\n(a) All infinite intervals in E1.\n(b) All open sets in a metric space (S,\u03c1).\n(c) All closed sets in (S,\u03c1).\n(d) All \u201cclopen\u201d sets in (S,\u03c1).\n(e) X 2S X finite .\n{ \u2208 | \u2212 }\n(f) X 2S X countable .\n{ \u2208 | \u2212 } 122 Chapter 7. Volume and Measure\n\u21d29. Prove that for any sequence A in a ring , there is\nn\n{ } R\n(a) an expanding sequence B such that\nn\n{ } \u2286 R\n( n) B A\nn n\n\u2200 \u2287\nand\nB = A ; and\nn n\nn n\n[ [\n(b) a contracting sequence C A , with\nn n\n\u2286\nC = A .\nn n\nn n\n\\ \\\n(The latter holds in semirings, too.)\n[Hint: Set Bn = n A k, Cn = n A k.]\n1 1\n\u21d210. The symmetricSdifference,TA B, of two sets is defined\n\u25b3\nA B = (A B) (B A).\n\u25b3 \u2212 \u222a \u2212\nInductively, we also set\n1\nA = A\nk 1\n\u25b3\nk=1\nand\nn+1 n\nA = A A .\nk k n+1\n\u25b3 \u25b3 \u25b3\nk=1 (cid:18)k=1 (cid:19)\nShow that symmetric differences\n(i) are commutative,\n(ii) are associative, and\n(iii) satisfy the distributive law:\n(A B) C = (A C) (B C).\n\u25b3 \u2229 \u2229 \u25b3 \u2229\n[Hintfor(ii): SetA = A,A B =A B . Expand(A B) C intoanexpression\n\u2032 \u2032\n\u2212 \u2212 \u2229 \u25b3 \u25b3\nsymmetric with respect to A, B, and C.]\n11. Prove that is a ring iff\nM\n(i) ;\n\u2205 \u2208 M\n(ii) ( A,B ) A B and A B (see Problem 10);\n\u2200 \u2208 M \u25b3 \u2208 M \u2229 \u2208 M\nequivalently,\n(ii\u2032) A B and A B .\n\u25b3 \u2208 M \u222a \u2208 M\n[Hint: Verify that\nA B =(A B) (A B)\n\u222a \u25b3 \u25b3 \u2229\nand\nA B =(A B) B,\n\u2212 \u222a \u25b3 3. More on Set Families 123\n\u00a7\nwhile\nA B =(A B) (A B).]\n\u2229 \u222a \u25b3 \u25b3\n12. Show that a set family = is a \u03c3-ring iff one of the following condi-\nM 6 \u2205\ntions holds.\n(a) is closed under countable unions and proper differences (X Y\nM \u2212\nwith X Y);\n\u2287\n(b) is closed under countable disjoint unions, proper differences,\nM\nand finite intersections; or\n(c) is closed under countable unions and symmetric differences (see\nM\nProblem 10).\n[Hints: (a) X Y =(X Y) Y, a proper difference.\n\u2212 \u222a \u2212\n(b) X Y =X (X Y) reduces any difference to a proper one; then\n\u2212 \u2212 \u2229\nX Y =(X Y) (Y X) (X Y)\n\u222a \u2212 \u222a \u2212 \u222a \u2229\nshows that is closed under all finite unions; so is a ring. Now use Corollary 1\nM M\nin 1 for countable unions.\n\u00a7\n(c) Use Problem 11.]\n13. From Problem 10, treating as addition and as multiplication, show\n\u25b3 \u2229\nthat any set ring is an algebraic ring with unity, i.e., satisfies the six\nM\nfield axioms (Chapter 2, 1\u20134), except V(b) (existence of multiplicative\n\u00a7\u00a7\ninverses).\n14. A set family is said to be hereditary iff\nH\n( X ) ( Y X) Y H.\n\u2200 \u2208 H \u2200 \u2286 \u2208\nProve the following.\n(a) For every family 2S, there is a \u201csmallest\u201d hereditary ring\nM \u2286\n( is said to be generated by ). Similarly for \u03c3-rings,\nH \u2287 M H M\nfields, and \u03c3-fields.\n(b) The hereditary \u03c3-ring generated by consists of those sets which\nM\ncan be covered by countably many -sets.\nM\n15. Prove that the field (\u03c3-field) in S, generated by a ring (\u03c3-ring) , con-\nR\nsists exactly of all -sets and their complements in S.\nR\n16. Show that the ring generated by a set family = consists of all sets\nR C 6 \u2205\nof the form\nn\nA\nk\n\u25b3\nk=1\n(see Problem 10), where each A (finite intersection of -sets).\nk d\n\u2208 C C\n[Outline: ByProblem11, must containthefamily(callit )ofallsuch n A .\nR M \u25b3k=1 k\n(Why?) It remains to show that is a ring .\nM \u2287C 124 Chapter 7. Volume and Measure\nWrite A+B for A B and AB for A B; so each -set is a \u201csum\u201d of finitely\n\u25b3 \u2229 M\nmany \u201cproducts\u201d\nA 1A An.\n2\n\u00b7\u00b7\u00b7\nByalgebra,the\u201csum\u201dand\u201cproduct\u201doftwosuch\u201cpolynomials\u201dissuchapolynomial\nitself. Thus\n( X,Y ) X Y and X Y .\n\u2200 \u2208M \u25b3 \u2229 \u2208M\nNow use Problem 11.]\n17. UseProblem16toobtainanewproofofTheorem 2in 1andCorollary2\n\u00a7\nin the present section.\n[Hints: For semirings, = . (Why?) Thus in Problem 16, A .\nd k\nC C \u2208C\nAlso,\n( A,B ) A B =(A B) (B A)\n\u2200 \u2208C \u25b3 \u2212 \u222a \u2212\nwhere A B and B A are finite disjoint unions of -sets. (Why?)\n\u2212 \u2212 C\nDeduce that A B and, by induction,\n\u2208Cs\u2032\n\u25b3\nn\nA \u2208Cs\u2032;\nk\n\u25b3\nk=1\nso . (Why?)]\nR\u2286Cs\u2032\n\u2286R\n18. Given a set A and a set family , let\nM\n.\nA\n\u2229M\nbe the family of all sets A X, with X ; similarly,\n\u2229 \u2208 M\n. .\n( A) = all sets Y (X A), with Y , X , etc.\nN \u222a M\u2212 { \u222a \u2212 \u2208 N \u2208 M}\nShow that if generates the ring , then A . generates the ring\nM R \u2229M\n\u2032 = A . .\nR \u2229R\nSimilarly for \u03c3-rings, fields, \u03c3-fields.\n[Hint for rings: Prove the following.\n(i) A . is a ring.\n\u2229R\n. .\n(ii) ( A), with as above.\n\u2032 \u2032\nM\u2286R \u222a R\u2212 R\n. .\n(iii) ( A) is a ring (call it ).\nR\u222a R\u2212 N\n(iv) By (ii), , so A . A . .\n\u2032\nR\u2286N \u2229R\u2286 \u2229N \u2286R\n(v) A . (for A . A . ).\n\u2032\n\u2229R\u2287R \u2229R\u2287 \u2229M\nHence =A . .]\n\u2032\nR \u2229R\n\u00a74. Set Functions. Additivity. Continuity\nI. Theletter\u201cv\u201dinvAmaybetreatedasacertainfunction symbol thatassigns\na numerical value (called \u201cvolume\u201d) to the set A. So far we have defined such\n\u201cvolumes\u201d for all intervals, then for -simple sets, and even for -sets in En.\n\u03c3\nC C 4. Set Functions. Additivity. Continuity 125\n\u00a7\nMathematically this means that the volume function v has been defined first\non (the intervals), then on \u2032 ( -simple sets), and finally on .\nC Cs C C\u03c3\nThus we have a function v which assigns values (\u201cvolumes\u201d) not just to\nsingle points, as ordinary \u201cpoint functions\u201d do, but to whole sets, each set\nbeing treated as one thing.\nIn other words, the domain of the function v is not just a set of points, but\na set family ( , \u2032, or ).\nC Cs C\u03c3\nThe\u201cvolumes\u201dassignedtosuchsetsarethefunction values (for and \u2032-sets\nC Cs\nthey are real numbers; for -sets they may reach + ). This is symbolized by\n\u03c3\nC \u221e\nv: E1\nC \u2192\nor\nv: E\u2217;\n\u03c3\nC \u2192\nmore precisely,\nv: [0, ],\n\u03c3\nC \u2192 \u221e\nsince volume is nonnegative.\nIt is natural to call v a set function (as opposedto ordinary point functions).\nAs we shall see, there are many other set functions. The function values need\nnot be real; they may be complex numbers or vectors. This agrees with our\ngeneral definition of a function as a certain set of ordered pairs (Definition 3\nin Chapter 1, 4\u20137); e.g.,\n\u00a7\u00a7\nA B C\nv = \u00b7\u00b7\u00b7 .\nvA vB vC\n(cid:18) \u00b7\u00b7\u00b7 (cid:19)\nHere the domain consists of certain sets A,B,C,.... This leads us to the\nfollowing definition.\nDefinition 1.\nA set function is a mapping\ns: E\nM \u2192\nwhose domain is a set family .\nM\nThe range space E is assumed to be E1, E\u2217, C (the complex field), En,\nor another normed space. Thus s may be real, extended real, complex,\nor vector valued.\nTo each set X , the function s assigns a unique function value\n\u2208 M\ndenoted s(X) or sX (which is an element of the range space E).\nWe say that s is finite on a set family iff\nN \u2286 M\n( X ) sX < ;\n\u2200 \u2208 N | | \u221e\nbriefly, s < on . (Thisisautomaticifsiscomplexorvectorvalued.)\n| | \u221e N 126 Chapter 7. Volume and Measure\nWe call s semifinite if at least one of is excluded as function value,\n\u00b1\u221e\ne.g., if s 0 on ; i.e.,\n\u2265 M\ns: [0, ].\nM \u2192 \u221e\n(The symbol stands for + throughout.)\n\u221e \u221e\nDefinition 2.\nA set function\ns: E\nM \u2192\nis called additive (or finitely additive) on iff for any finite disjoint\nN \u2286 M\nunion A , we have\nk k\nS\nsA = s A ,\nk k\nk (cid:18) k (cid:19)\nX [\nprovided A and all the A are -sets.\nk k k N\nIf this also holds for countable disjoint unions, s is called \u03c3-additive\nS\n(or countably additive or completely additive) on .\nN\nIf = here, we simply say that s is additive (\u03c3-additive, respec-\nN M\ntively).\nNote 1. As A is independent of the order of the A , \u03c3-additivity pre-\nk k\nsupposes and implies that the series\nS\nsA\nk\nis permutable ( 2) for any disjoint sXequence\n\u00a7\nA .\nk\n{ } \u2286 N\n(The partial sums do exist, by our conventions (2\u2217) in Chapter 4, 4.)\n\u00a7\nThe set functions in the examples below are additive; v is even \u03c3-additive\n(Corollary 1 in 2).\n\u00a7\nExamples (b)\u2013(d) show that set functions may arise from ordinary \u201cpoint\nfunctions.\u201d\nExamples.\n(a) The volume function v: E1 on (= intervals in En), discussed\nC \u2192 C\nabove, is called the Lebesgue premeasure (in En).\n(b) Let = all finite intervals I E1 .\nM { \u2282 }\nGiven f: E1 E, set\n\u2192\n( I ) sI = V [I],\nf\n\u2200 \u2208 M\nthe total variation of f on the closure of I (Chapter 5, 7).\n\u00a7\nThen s: [0, ] is additive by Theorem 1 of Chapter 5, 7.\nM \u2192 \u221e \u00a7 4. Set Functions. Additivity. Continuity 127\n\u00a7\n(c) Let and f be as in Example (b).\nM\nSuppose f has an antiderivative (Chapter 5, 5) on E1. For each\n\u00a7\ninterval X with endpoints a,b E1 (a b), set\n\u2208 \u2264\nb\nsX = f.\nZa\nThis yields a set function s: E (real, complex, or vector valued),\nM \u2192\nadditive by Corollary 6 in Chapter 5, 5.\n\u00a7\n(d) Let = all finite intervals in E1 .\nC { }\nSuppose\n\u03b1 : E1 E1\n\u2192\nhas finite one-sided limits\n\u03b1(p+) and \u03b1(p )\n\u2212\nat each p E1. The Lebesgue\u2013Stieltjes (LS) function\n\u2208\ns : E1\n\u03b1\nC \u2192\n(important for Lebesgue\u2013Stieltjes integration) is defined as follows.\nSet s = 0. For nonvoid intervals, including [a,a] = a , set\n\u03b1\n\u2205 { }\ns [a,b] = \u03b1(b+) \u03b1(a ),\n\u03b1\n\u2212 \u2212\ns (a,b] = \u03b1(b+) \u03b1(a+),\n\u03b1\n\u2212\ns [a,b) = \u03b1(b ) \u03b1(a ), and\n\u03b1\n\u2212 \u2212 \u2212\ns (a,b) = \u03b1(b ) \u03b1(a+).\n\u03b1\n\u2212 \u2212\nFor the properties of s see Problem 7ff., below.\n\u03b1\n(e) Let mX be the mass concentrated in the part X of the physical space S.\nThen m is a nonnegative set function defined on\n2S = all subsets X S ( 3).\n{ \u2286 } \u00a7\nIf instead mX were the electric load of X, then m would be sign\nchanging.\nII. The rest of this section is redundant for a \u201climited approach.\u201d\nLemmas. Let s: E be additive on . Let\nM \u2192 N \u2286 M\nA,B , A B.\n\u2208 N \u2286\nThen we have the following.\n(1) If sA < and B A , then\n| | \u221e \u2212 \u2208 N\ns(B A) = sB sA (\u201csubtractivity\u201d).\n\u2212 \u2212 128 Chapter 7. Volume and Measure\n(2) If , then s = 0 provided sX < for at least one X .\n\u2205 \u2208 N \u2205 | | \u221e \u2208 N\n(3) If is a semiring, then sA = implies sB = . Hence\nN \u00b1\u221e | | \u221e\nsB < sA < .\n| | \u221e \u21d2 | | \u221e\nIf further s is semifinite then\nsA = sB =\n\u00b1\u221e \u21d2 \u00b1\u221e\n(same sign).\nProof.\n(1) As B A, we have\n\u2287\nB = (B A) A (disjoint);\n\u2212 \u222a\nso by additivity,\nsB = s(B A)+sA.\n\u2212\nIf sA < , we may transpose to get\n| | \u221e\nsB sA = s(B A),\n\u2212 \u2212\nas claimed.\n(2) Hence\ns = s(X X) = sX sX = 0\n\u2205 \u2212 \u2212\nif X, , and sX < .\n\u2205 \u2208 N | | \u221e\n(3) If is a semiring, then\nN\nn\nB A = A (disjoint)\nk\n\u2212\nk=1\n[\nfor some -sets A ; so\nk\nN\nn\nB = A A (disjoint).\nk\n\u222a\nk=1\n[\nBy additivity,\nn\nsB = sA+ sA ;\nk\nk=1\nX\nso by our conventions,\nsA = sB = .\n| | \u221e \u21d2 | | \u221e\nIf, further, s is semifinite, one of is excluded. Thus sA and sB, if\n\u00b1\u221e\ninfinite, must have the same sign. This completes the proof. (cid:3) 4. Set Functions. Additivity. Continuity 129\n\u00a7\nIn 1 and 2, we showed how to extend the notion of volume from intervals\n\u00a7\u00a7\nto a larger set family, preserving additivity. We now generalize this idea.\nTheorem 1. If\ns: E\nC \u2192\nis additive on , an arbitrary semiring, there is a unique set function\nC\ns\u00af: E,\ns\nC \u2192\nadditive on , with s\u00af= s on , i.e.,\ns\nC C\ns\u00afX = sX for X .\n\u2208 C\nWe call s\u00af the additive extension of s to = \u2032 (Corollary 2 in 3).\nCs Cs \u00a7\nProof. If s 0 (s: [0, ]), proceed as in Lemma 1 and Corollary 2, all\n\u2265 C \u2192 \u221e\nof 1.\n\u00a7\nThe general proof (which may be omitted or deferred) is as follows.\nEach X \u2032 has the form\n\u2208 Cs\nm\nX = X (disjoint), X .\ni i\n\u2208 C\ni=1\n[\nThus if s\u00af is to be additive, the only way to define it is to set\nm\ns\u00afX = sX .\ni\ni=1\nX\nThis already makes s\u00af unique, provided we show that\nm\nsX\ni\ni=1\nX\ndoes not depend on the particular decomposition\nm\nX = X\ni\ni=1\n[\n(otherwise, all is ambiguous).\nThen take any other decomposition\nn\nX = Y (disjoint), Y .\nk k\n\u2208 C\nk=1\n[\nAdditivity implies\nn m\n( i,k) sX = s(X Y ) and sY = s(X Y ).\ni i k k i k\n\u2200 \u2229 \u2229\nk=1 i=1\nX X 130 Chapter 7. Volume and Measure\n(Verify!) Hence\nm n\nsX = s(X Y ) = sY .\ni i k k\n\u2229\ni=1 i,k k=1\nX X X\nThus, indeed, it does not matter which particular decomposition we choose,\nand our definition of s\u00af is unambiguous.\nIf X , we may choose (say)\n\u2208 C\n1\nX = X , X = X;\ni 1\ni=1\n[\nso\ns\u00afX = sX = sX;\n1\ni.e., s\u00af= s on , as required.\nC\nFinally, for the additivity of s\u00af, let\nm\nA = B (disjoint), A,B \u2032.\nk k \u2208 Cs\nk=1\n[\nHere we may set\nnk\nB = C (disjoint), C .\nk ki ki\n\u2208 C\ni=1\n[\nThen\nA = C (disjoint);\nki\nk,i\n[\nso by our definition of s\u00af,\nm nk m\ns\u00afA = sC = sC = s\u00afB ,\nki ki k\nk,i k=1(cid:18)i=1 (cid:19) k=1\nX X X X\nas required. (cid:3)\nContinuity. We write X X to mean that\nn\n\u0580\n\u221e\nX = X\nn\nn=1\n[\nand X , i.e.,\nn\n{ }\u2191\nX X , n = 1,2,....\nn n+1\n\u2286\nSimilarly, X X iff\nn\n\u0581\n\u221e\nX = X\nn\nn=1\n\\ 4. Set Functions. Additivity. Continuity 131\n\u00a7\nand X , i.e.,\nn\n{ }\u2193\nX X , n = 1,2,....\nn n+1\n\u2287\nIn both cases, we set\nX = lim X .\nn\nn\u2192\u221e\nThis suggests the following definition.\nDefinition 3.\nA set function s: E is said to be\nM \u2192\n(i) left continuous (on ) iff\nM\nsX = lim sX\nn\nn\u2192\u221e\nwhenever X X and X,X ;\nn n\n\u0580 \u2208 M\n(ii) right continuous iff\nsX = lim sX\nn\nn\u2192\u221e\nwhenever X X, with X,X and sX < .\nn n j\n\u0581 \u2208 M | | \u221e\nThus in case (i),\n\u221e\nlim sX = s X\nn n\nn\u2192\u221e\nn=1\n[\n\u221e\nif all X and X are -sets.\nn n=1 n M\nIn case (ii),\nS\n\u221e\nlim sX = s X\nn n\nn\u2192\u221e\nn=1\n\\\n\u221e\nif all X and X are in , and sX < .\nn n=1 n M | 1 | \u221e\nNote 2. The last restriction applies to right continuity only. (We choose\nT\nsimply to exclude from consideration sequences X , with sX = ; see\nn 1\n{ }\u2193 | | \u221e\nProblem 4.)\nTheorem 2. If s: E is \u03c3-additive and semifinite on , a semiring, then\nC \u2192 C\ns is both left and right continuous (briefly, continuous).\nProof. We sketch the proof for rings; for semirings, see Problem 1.\nLeft continuity. Let X X with X ,X and\nn n\n\u0580 \u2208 C\n\u221e\nX = X .\nn\nn=1\n[\nIf sX = for some n, then (Lemma 3)\nn\n\u00b1\u221e\nsX = sX = for m n,\nm\n\u00b1\u221e \u2265 132 Chapter 7. Volume and Measure\nsince X X X ; so\nm n\n\u2287 \u2287\nlimsX = = sX,\nm\n\u00b1\u221e\nas claimed.\nThus assume all sX finite; so s = 0, by Lemma 2.\nn\n\u2205\nSet X = . As is easily seen,\n0\n\u2205\n\u221e \u221e\nX = X = (X X ) (disjoint),\nn n n\u22121\n\u2212\nn=1 n=1\n[ [\nand\n( n) X X (a ring).\nn n\u22121\n\u2200 \u2212 \u2208 C\nAlso,\nm\n( m n) X = (X X ) (disjoint).\nm n n\u22121\n\u2200 \u2265 \u2212\nn=1\n[\n(Verify!) Thus by additivity,\nm\nsX = s(X X ),\nm n n\u22121\n\u2212\nn=1\nX\nand by the assumed \u03c3-additivity,\n\u221e \u221e\nsX = s (X X ) = s(X X )\nn n\u22121 n n\u22121\n\u2212 \u2212\nn=1 n=1\n[ X\nm\n= lim s(X X ) = lim sX ,\nn n\u22121 m\nm\u2192\u221e \u2212 m\u2192\u221e\nn=1\nX\nas claimed.\nRight continuity. Let X X with X,X ,\nn n\n\u0581 \u2208 C\n\u221e\nX = X ,\nn\nn=1\n\\\nand\nsX < .\n1\n| | \u221e\nAs X X X , Lemma 3 yields that\nn 1\n\u2286 \u2286\n( n) sX <\nn\n\u2200 | | \u221e\nand sX < .\n| | \u221e\nAs\n\u221e\nX = X ,\nk\nk=1\n\\ 4. Set Functions. Additivity. Continuity 133\n\u00a7\nwe have\n\u221e\n( n) X = X (X X ) (disjoint).\nn k\u22121 k\n\u2200 \u222a \u2212\nk=n+1\n[\n(Verify!) Thus by \u03c3-additivity,\n\u221e\n( n) sX = sX + s(X X ),\nn k\u22121 k\n\u2200 \u2212\nk=n+1\nX\nwith sX < , sX < (see above).\nn\n| | \u221e | | \u221e\nHence the sum\n\u221e\ns(X X ) = sX sX\nk\u22121 k n\n\u2212 \u2212\nk=n+1\nX\nis finite. Therefore, it tends to 0 as n (being the \u201cremainder term\u201d of a\n\u2192 \u221e\nconvergent series). Thus n yields\n\u2192 \u221e\n\u221e\nlim sX = sX +lim s(X X ) = sX,\nn k\u22121 k\nn\u2192\u221e \u2212\nk=n+1\nX\nas claimed. (cid:3)\nProblems on Set Functions\n1. Prove Theorem 2 in detail for semirings.\n[Hint: We know that\nmn\nXn Xn = Yni (disjoint)\n1\n\u2212 \u2212\ni=1\n[\nfor some Yni , so\n\u2208C mn\ns\u00af(Xn Xn 1)= sYni,\n\u2212 \u2212\ni=1\nX\nwith s\u00afas in Theorem 1.]\n2. Let s be additive on , a ring. Prove that s is also \u03c3-additive provided\nM\ns is either\n(i) left continuous, or\n(ii) finite on and right-continuous at ; i.e.,\nM \u2205\nlim sX = 0\nn\nn\u2192\u221e\nwhen X (X ).\nn n\n\u0581 \u2205 \u2208 M\n[Hint: Let\nA= An (disjoint), A,An .\n\u2208M\nn\n[ 134 Chapter 7. Volume and Measure\nSet\nn\nXn = A k, Yn =A Xn.\n\u2212\nk=1\n[\nVerify that Xn,Yn , Xn A, Yn .\n\u2208M \u0580 \u0581\u2205\nIn case (i),\n\u221e\nsA=limsXn = sA k.\nk=1\nX\n(Why?)\nFor (ii), use the Yn.]\n3. Let\n= all intervals in the rational field R E1 .\nM { \u2282 }\nLet\nsX = b a\n\u2212\nif a,b are the endpoints of X (a,b R, a b). Prove that\n\u2208 M \u2208 \u2264\n(i) is a semiring;\nM\n(ii) s is continuous;\n(iii) s is additive but not \u03c3-additive; thus Problem 2 fails for semirings.\n[Hint: R is countable. Thus each X is a countable union of singletons x =\n\u2208 M { }\n[x,x]; hence sX =0 if s were \u03c3-additive.]\n\u2032\n3 . Let N = naturals . Let\n{ }\n= all finite subsets of N and their complements in N .\nM { }\nIf X , let sX = 0 if X is finite, and sX = otherwise. Show that\n\u2208 M \u221e\n(i) is a set field;\nM\n(ii) s is right continuous and additive, but not \u03c3-additive.\nThus Problem 2(ii) fails if s is not finite.\n4. Let\n= finite and infinite intervals in E1 .\nC { }\nIf a,b are the endpoints of an interval X (a,b E\u2217, a < b), set\n\u2208\nb a, a < b,\nsX = \u2212\n0, a = b.\n(cid:26)\nShow that s is \u03c3-additive on , a semiring.\nC\nLet\nX = (n, );\nn\n\u221e\nso sX = n = and X . (Verify!) Yet\nn n\n\u221e\u2212 \u221e \u0581 \u2205\nlimsX = = s .\nn\n\u221e 6 \u2205 4. Set Functions. Additivity. Continuity 135\n\u00a7\nDoes this contradict Theorem 2?\n5. Fill in the missing proof details in Theorem 1.\n6. Let s be additive on . Prove the following.\nM\n(i) If is a ring or semiring, so is\nM\n= X sX <\nN { \u2208 M | | | \u221e}\nif = .\nN 6 \u2205\n(ii) If is generated by a set family , with s < on , then\nM C | | \u221e C\ns < on .\n| | \u221e M\n[Hint: Use Problem 16 in 3.]\n\u00a7\n\u21d27. (Lebesgue\u2013Stieltjes set functions.) Let \u03b1 and s be as in Example (d).\n\u03b1\nProve the following.\n(i) s 0 on iff \u03b1 on E1 (see Theorem 2 in Chapter 4, 5).\n\u03b1\n\u2265 C \u2191 \u00a7\n(ii) s p = s [p,p] = 0 iff \u03b1 is continuous at p.\n\u03b1 \u03b1\n{ }\n(iii) s is additive.\n\u03b1\n[Hint: If\nn\nA= Ai (disjoint),\ni=1\n[\nthe intervals Ai 1, Ai must be adjacent. For two such intervals, consider all\n\u2212\ncases like\n(a,b] (b,c), [a,b) [b,c], etc.\n\u222a \u222a\nThen use induction on n.]\n(iv) If \u03b1 is right continuous at a and b, then\ns (a,b] = \u03b1(b) \u03b1(b).\n\u03b1\n\u2212\nIf \u03b1 is continuous at a and b, then\ns [a,b] = s (a,b] = s [a,b) = s (a,b).\n\u03b1 \u03b1 \u03b1 \u03b1\n(v) If \u03b1 on E1, then s satisfies Lemma 1 and Corollary 2 in 1\n\u03b1\n\u2191 \u00a7\n(same proof), as well as Lemma 1, Theorem 1, Corollaries 1\u20134,\nand Note 3 in 2 (everything except Corollaries 5 and 6).\n\u00a7\n[Hint: Use(i)and(iii). ForLemma 1in 2,takefirstahalf-open B =(a,b];use\n\u00a7\nthe definition of a right-side limit along with Theorems 1 and 2 in Chapter 4,\n5, to prove\n\u00a7\n( \u03b5>0) ( c>b) 0 \u03b1(c ) \u03b1(b+)<\u03b5;\n\u2200 \u2203 \u2264 \u2212 \u2212\nthen set C = (a,c). Similarly for B = [a,b), etc. and for the closed interval\nA B.]\n\u2286\n(vi) If \u03b1(x) = x then s = v, the volume (or length) function in E1.\n\u03b1 136 Chapter 7. Volume and Measure\n8. Construct LS set functions (Example (d)), with \u03b1 (see Problem 7(v)),\n\u2191\nso that\n(i) s [0,1] = s [1,2];\n\u03b1 \u03b1\n6\n(ii) s E1 = 1 (after extending s to -sets in E1);\n\u03b1 \u03b1 \u03c3\nC\n(ii\u2032) s E1 = c for a fixed c (0, );\n\u03b1\n\u2208 \u221e\n(iii) s 0 = 1 and s [0,1] > s (0,1].\n\u03b1 \u03b1 \u03b1\n{ }\nDescribe s if \u03b1(x) = [x] (the integral part of x).\n\u03b1\n[Hint: See Figure 16 in Chapter 4, 1.]\n\u00a7\n9. For an arbitrary \u03b1: E1 E1, define \u03c3 : E1 by\n\u03b1\n\u2192 C \u2192\n\u03c3 [a,b] = \u03c3 (a,b] = \u03c3 [a,b) = \u03c3 (a,b) = \u03b1(b) \u03b1(a)\n\u03b1 \u03b1 \u03c3 \u03b1\n\u2212\n(the original Stieltjes method). Prove that \u03c3 is additive but not \u03c3-\n\u03b1\nadditive unless \u03b1 is continuous (for Theorem 2 fails).\n\u00a75. Nonnegative Set Functions. Premeasures. Outer Measures\nWe now concentrate on nonnegative set functions\nm : [0, ]\nM \u2192 \u221e\n(we mostly denote them by m or \u00b5). Such functions have the advantage that\n\u221e\nmX\nn\nn=1\nX\nexists and is permutable (Theorem 2 in 2) for any sets X , since mX\nn n\n\u00a7 \u2208 M \u2265\n0. Several important notions apply to such functions (only). They \u201cmimic\u201d\n1 and 2.\n\u00a7\u00a7\nDefinition 1.\nA set function\nm : [0, ]\nM \u2192 \u221e\nis said to be\n(i) monotone (on ) iff\nM\nmX mY\n\u2264\nwhenever\nX Y and X,Y ;\n\u2286 \u2208 M 5. Nonnegative Set Functions. Premeasures. Outer Measures 137\n\u00a7\n(ii) (finitely) subadditive (on ) iff for any finite union\nM\nn\nY ,\nk\nk=1\n[\nwe have\nm\n(1) mX mY\nk\n\u2264\nk=1\nX\nwhenever X,Y and\nk\n\u2208 M\nn\nX Y (disjoint or not);\nk\n\u2286\nk=1\n[\n(iii) \u03c3-subadditive (on ) iff (1) holds for countable unions, too.\nM\nRecall that Y is called a covering of X iff\nk\n{ }\nX Y .\nk\n\u2286\nk\n[\nWecallitan -coveringofX ifallY are -sets. Wenowobtainthefollowing\nk\nM M\ncorollary.\nCorollary 1. Subadditivity implies monotonicity.\nTake n = 1 in formula (1).\nCorollary 2. If m : [0, ] is additive (\u03c3-additive) on , a semiring, then\nC \u2192 \u221e C\nm is also subadditive (\u03c3-subadditive, respectively), hence monotone, on .\nC\nThe proof is a mere repetition of the argument used in Lemma 1 in 1.\n\u00a7\nTaking n = 1 in formula (ii) there, we obtain finite subadditivity.\nFor \u03c3-subadditivity, one only has to use countable unions instead of finite\nones.\nNote 1. The converse fails: subadditivity does not imply additivity.\nNote 2. Of course, Corollary 2 applies to rings, too (see Corollary 1 in 3).\n\u00a7\nDefinition 2.\nA premeasures is a set function\n\u00b5: [0, ]\nC \u2192 \u221e\nsuch that\nand \u00b5 = 0.\n\u2205 \u2208 C \u2205\n( may, but need not, be a semiring.)\nC 138 Chapter 7. Volume and Measure\nA premeasure space is a triple\n(S, ,\u00b5),\nC\nwhere is a family of subsets of S (briefly, 2S) and\nC C \u2286\n\u00b5: [0, ]\nC \u2192 \u221e\nis a premeasure. In this case, -sets are also called basic sets.\nC\nIf\nA B ,\nn\n\u2286\nn\n[\nwith B , the sequence B is called a basic covering of A, and\nn n\n\u2208 C { }\n\u00b5B\nn\nn\nX\nis a basic covering value of A; B may be finite or infinite.\nn\n{ }\nExamples.\n(a) The volume function v on (= intervals in En) is a premeasure, as v 0\nC \u2265\nand v = 0. (En, ,v) is the Lebesgue premeasure space.\n\u2205 C\n(b) The LS set function s is a premeasure if \u03b1 (see Problem 7 in 4). We\n\u03b1\n\u2191 \u00a7\ncall it the \u03b1-induced Lebesgue\u2013Stieltjes (LS) premeasure in E1.\nWenowdevelopamethodforconstructing\u03c3-subadditive premeasures. (This\nis a first step toward achieving \u03c3-additivity; see 4.)\n\u00a7\nDefinition 3.\nFor any premeasurespace(S, ,\u00b5), we definethe \u00b5-induced outer measure\nC\nm\u2217 on 2S (= all subsets of S) by setting, for each A S,\n\u2286\n(2) m\u2217A = inf \u00b5B A B , B ,\nn n n\n\u2286 \u2208 C\n(cid:26) n (cid:12) n (cid:27)\nX (cid:12) [\ni.e., m\u2217A (called the outer meas(cid:12) ure of A) is the glb of all basic covering\n(cid:12)\nvalues of A.\nIf \u00b5 = v, m\u2217 is called the Lebesgue outer measure in En.\nNote 3. If A has no basic coverings, we set m\u2217A = . More generally, we\n\u221e\nmake the convention that inf = + .\n\u2205 \u221e\nNote 4. By the properties of the glb, we have\n( A S) 0 m\u2217A.\n\u2200 \u2286 \u2264\nIf A , then A is a basic covering; so\n\u2208 C { }\nm\u2217A \u00b5A.\n\u2264 5. Nonnegative Set Functions. Premeasures. Outer Measures 139\n\u00a7\nIn particular, m\u2217 = \u00b5 = 0.\n\u2205 \u2205\nTheorem 1.1 The set function m\u2217 so defined is \u03c3-subadditive on 2S.\nProof. Given\nA A S,\nn\n\u2286 \u2282\nn\n[\nwe must show that\nm\u2217A m\u2217A .\nn\n\u2264\nn\nX\nThis is trivial if m\u2217A = for some n. Thus assume\nn\n\u221e\n( n) m\u2217A <\nn\n\u2200 \u221e\nand fix \u03b5 > 0.\nBy Note 3, each A has a basic covering\nn\nB , k = 1,2,...\nnk\n{ }\n(otherwise, m\u2217A = ). By properties of the glb, we can choose the B\nn nk\n\u221e\nso that\n\u03b5\n( n) \u00b5B < m\u2217A + .\n\u2200 nk n 2n\nk\nX\n(Explain from (2)). The sets B (for all n and all k) form a countable basic\nnk\ncovering of all A , hence of A. Thus by Definition 3,\nn\nn\n\u03b5\nm\u2217A \u00b5B m\u2217A + m\u2217A +\u03b5.\n\u2264 nk \u2264 n 2n \u2264 n\nn (cid:18) k (cid:19) n (cid:18) (cid:19)\nX X X X\nAs \u03b5 is arbitrary, we can let \u03b5 0 to obtain the desired result. (cid:3)\n\u2192\nNote 5. In view of Theorem 1, we now generalize the notion of an outer\nmeasure in S to mean any \u03c3-subadditive premeasure defined on all of 2S.\nBy Note 4, m\u2217 \u00b5 on , not m\u2217 = \u00b5 in general. However, we obtain the\n\u2264 C\nfollowing result.\nTheorem 2. With m\u2217 as in Definition 3, we have m\u2217 = \u00b5 on iff \u00b5 is\nC\n\u03c3-subadditive on . Hence, in this case, m\u2217 is an extension of \u00b5.\nC\nProof. Suppose \u00b5 is \u03c3-subadditive and fix any A . By Note 4,\n\u2208 C\nm\u2217A \u00b5A.\n\u2264\nWe shall show that\n\u00b5A m\u2217A,\n\u2264\n1Theorems 1\u20133 are redundant for a \u201climited approach\u201d (see the preface). Pass to Chap-\nter 8, 1.\n\u00a7 140 Chapter 7. Volume and Measure\ntoo, and hence \u00b5A = m\u2217A.\nNow, as A , A surely has basic coverings, e.g., A . Take any basic\n\u2208 C { }\ncovering:\nA B , B .\nn n\n\u2286 \u2208 C\nn\n[\nAs \u00b5 is \u03c3-subadditive,\n\u00b5A \u00b5B .\nn\n\u2264\nn\nX\nThus \u00b5A does not exceed any basic covering values of A; so it cannot exceed\ntheir glb, m\u2217A. Hence \u00b5 = m\u2217, indeed.\nConversely, if \u00b5 = m\u2217 on , then the \u03c3-subadditivity of m\u2217 (Theorem 1)\nC\nimplies that of \u00b5 (on ). Thus all is proved. (cid:3)\nC\nNote 6. If, in (2), we allow only finite basic coverings, then the \u00b5-induced\nset function is called the \u00b5-induced outer content, c\u2217. It is only finitely subad-\nditive, in general.\nIn particular, if \u00b5 = v (Lebesgue premeasure), we speak of the Jordan outer\ncontent in En. (It is superseded by Lebesgue theory but still occurs in courses\non Riemann integration.)\nWe add two more definitions related to the notion of coverings.\nDefinition 4.\nA set function s: E ( 2S) is called \u03c3-finite iff every X\nM \u2192 M \u2286 \u2208 M\ncan be covered by a sequence of -sets X , with\nn\nM\nsX < ( n).\nn\n| | \u221e \u2200\nAny set A S which can be so covered is said to be \u03c3-finite with\n\u2286\nrespect to s (briefly, (s) \u03c3-finite).\nIf the whole space S can be so covered, we say that s is totally \u03c3-finite.\nFor example, the Lebesgue premeasure v on En is totally \u03c3-finite.\nDefinition 5.\nA set function s: E\u2217 is said to be regular with respect to a set\nM \u2192\nfamily (briefly, -regular) iff for each A ,\nA A \u2208 M\n(3) sA = inf sX A X, X ;\n{ | \u2286 \u2208 A}\nthat is, sA is the glb of all sX, with A X and X .\n\u2286 \u2208 A\nThese notions are important for our later work. At present, we prove only\none theorem involving Definitions 3 and 5. 5. Nonnegative Set Functions. Premeasures. Outer Measures 141\n\u00a7\nTheorem 3. For any premeasure space (S, ,\u00b5), the \u00b5-induced outer measure\nC\nm\u2217 is -regular whenever\nA\n2S.\n\u03c3\nC \u2286 A \u2286\nThus in this case,\n(4) ( A S) m\u2217A = inf m\u2217X A X, X .\n\u2200 \u2286 { | \u2286 \u2208 A}\nProof. As m\u2217 is monotone, m\u2217A is surely a lower bound of\nm\u2217X A X, X .\n{ | \u2286 \u2208 A}\nWe must show that there is no greater lower bound.\nThis is trivial if m\u2217A = .\n\u221e\nThus let m\u2217A < ; so A has basic coverings (Note 3). Now fix any \u03b5 > 0.\n\u221e\nBy formula (2), there is a basic covering B such that\nn\n{ } \u2286 C\nA B\nn\n\u2286\nn\n[\nand\nm\u2217A+\u03b5 > \u00b5B m\u2217B m\u2217 B .\nn n n\n\u2265 \u2265\nn n n\nX X [\n(m\u2217 is \u03c3-subadditive!)\nLet\nX = B .\nn\nn\n[\nThen X is in , hence in , and A X. Also,\n\u03c3\nC A \u2286\nm\u2217A+\u03b5 > m\u2217X.\nThus m\u2217A+\u03b5 is not a lower bound of\nm\u2217X A X, X .\n{ | \u2286 \u2208 A}\nThis proves (4). (cid:3)\nProblems on Premeasures and Related Topics\n1. Fill in the missing details in the proofs, notes, and examples of this\nsection.\n2. Describe m\u2217 on 2S induced by a premeasure \u00b5: E\u2217 such that each\nC \u2192\nof the following hold.\n(a) = S, , \u00b5S = 1.\nC { \u2205}\n(b) = S, , and all singletons ; \u00b5S = , \u00b5 x = 1.\nC { \u2205 } \u221e { }\n(c) as in (b), with S uncountable; \u00b5S = 1, and \u00b5X = 0 otherwise.\nC 142 Chapter 7. Volume and Measure\n(d) = all proper subsets of S ; \u00b5X = 1 when X S; \u00b5 = 0.\nC { } \u2205 \u2282 \u2282 \u2205\n3. Show that the premeasures\nv\u2032: \u2032 [0, ]\nC \u2192 \u221e\ninduce one and the same (Lebesgue) outer measure m\u2217 in En, with\nv\u2032 = v (volume, as in 2):\n\u00a7\n(a) \u2032 = open intervals ;\nC { }\n(b) \u2032 = half-open intervals ;\nC { }\n(c) \u2032 = closed intervals ;\nC { }\n(d) \u2032 = ;\n\u03c3\nC C\n(e) \u2032 = open sets ;\nC { }\n(f) \u2032 = half-open cubes .\nC { }\n[Hints: (a) Let m be the v -induced outer measure; let = all intervals . As\n\u2032 \u2032\nC { }\n, m A m A. (Why?) Also,\n\u2032 \u2032 \u2217\nC \u2286C \u2265\n( \u03b5>0) ( B ) A B and vB m\u2217A+\u03b5.\nk k k\n\u2200 \u2203{ }\u2286C \u2286 \u2264\nk\n[ X\n(Why?) By Lemma 1 in 2,\n\u00a7\n\u03b5\n( \u2203{C }\u2286C\u2032) B \u2286C and vB + >v\u2032C k.\nk k k k 2k\nDeduce that m A m A, m = m . Similarly for (b) and (c). For (d), use\n\u2217 \u2032 \u2217 \u2032\n\u2265\nCorollary 1 and Note 3 in 1. For (e), use Lemma 2 in 2. For (f), use Problem 2\n\u00a7 \u00a7\nin 2.]\n\u00a7\n3\u2032 . Do Problem 3(a)\u2013(c), with m\u2217 replaced by the Jordan outer content c\u2217\n(Note 6).\n4. Do Problem 3, with v and m\u2217 replaced by the LS premeasure and outer\nmeasure. (Use Problem 7 in 4.)\n\u00a7\n5. Show that a set A En is bounded iff its outer Jordan content is finite.\n\u2286\n6. Find a set A E1 such that\n\u2286\n(i) its Lebesgue outer measure is 0 (m\u2217A = 0), while its Jordan outer\ncontent c\u2217A = ;\n\u221e\n(ii) m\u2217A = 0, c\u2217A = 1 (see Corollary 6 in 2).\n\u00a7\n7. Let\n\u00b5 ,\u00b5 : [0, ]\n1 2\nC \u2192 \u221e\nbe two premeasures in S and let m\u2217 and m\u2217 be the outer measures\n1 2\ninduced by them.\nProve that if m\u2217 = m\u2217 on , then m\u2217 = m\u2217 on all of 2S.\n1 2 C 1 2 5. Nonnegative Set Functions. Premeasures. Outer Measures 143\n\u00a7\n8. With the notation of Definition 3 and Note 6, prove the following.\n(i) If A B S and m\u2217B = 0, then m\u2217A = 0; similarly for c\u2217.\n\u2286 \u2286\n[Hint: Use monotonicity.]\n(ii) The set family\nX S c\u2217A = 0\n{ \u2286 | }\nis a hereditary set ring, i.e., a ring such that\nR\n( B ) ( A B) A .\n\u2200 \u2208 R \u2200 \u2286 \u2208 R\n(iii) The set family\nX S m\u2217X = 0\n{ \u2286 | }\nis a hereditary \u03c3-ring.\n(iv) So also is\n= those X S that have basic coverings ;\nH { \u2286 }\nthus is the hereditary \u03c3-ring generated by (see Problem 14\nH C\nin 3).\n\u00a7\n9. Continuing Problem 8(iv), prove that if \u00b5 is \u03c3-finite (Definition 4), so is\nm\u2217 when restricted to .\nH\nShow, moreover, that if is a semiring, then each X has a basic\nC \u2208 H\ncovering Y , with m\u2217Y < and with all Y disjoint.\nn n n\n{ } \u221e\n[Hint: Show that\n\u221e \u221e\nX B\nnk\n\u2286\nn=1k=1\n[ [\nfor some sets B , with \u00b5B < . Then use Note 4 in 5 and Corollary 1\nnk nk\n\u2208 C \u221e \u00a7\nof 1.]\n\u00a7\n10. Show that if\ns : E\u2217\nC \u2192\nis \u03c3-finite and additive on , a semiring, then the \u03c3-ring generated\nC R\nby equals the \u03c3-ring \u2032 generated by\nC R\n\u2032 = X sX <\nC { \u2208 C | | | \u221e}\n(cf. Problem 6 in 4).\n\u00a7\n[Hint: By \u03c3-finiteness,\n( X ) ( An sAn < ) X An;\n\u2200 \u2208C \u2203{ }\u2286C || | \u221e \u2286\nn\n[\nso\nX = (X An), X An \u2032.\n\u2229 \u2229 \u2208C\nn\n[\n(Use Lemma 3 in 4.)\n\u00a7 144 Chapter 7. Volume and Measure\nThus ( X ) X is a countable union of -sets; so . Deduce .\n\u2032 \u2032 \u2032\n\u2200 \u2208 C C C \u2286 R R \u2286 R\nProceed.]\n11. With all as in Theorem 3, prove that if A has basic coverings, then\n( B ) A B and m\u2217A = m\u2217B.\n\u03b4\n\u2203 \u2208 A \u2286\n[Hint: By formula (4),\n1\n( n N) ( Xn A Xn) m\u2217A mXn m\u2217A+ .\n\u2200 \u2208 \u2203 \u2208A| \u2286 \u2264 \u2264 n\n(Explain!) Set\n\u221e\nB = Xn \u03b4.\n\u2208A\nn=1\n\\\nProceed. For , see Definition 2(b) in 3.]\n\u03b4\nA \u00a7\n12. Let (S, ,\u00b5) and m\u2217 be as in Definition 3. Show that if is a \u03c3-field in\nC C\nS, then\n( A S) ( B ) A B and m\u2217A = \u00b5B.\n\u2200 \u2286 \u2203 \u2208 C \u2286\n[Hint: Use Problem 11 and Note 3.]\n\u2217\n\u21d2 13. Show that if\ns : E\nC \u2192\nis \u03c3-finite and \u03c3-additive on , a semiring, then s has at most one \u03c3-\nC\nadditive extension to the \u03c3-ring generated by .\nR C\n(Note that s is automatically \u03c3-finite if it is finite, e.g., complex or\nvector valued.)\n[Outline: Let\ns\u2032,s\u2032\u2032: E\nR\u2192\nbe two \u03c3-additive extensions of s. By Problem 10, is also generated by\nR\n\u2032 = X sX < .\nC { \u2208C || | \u221e}\nNow set\n\u2217 = X s\u2032X =s\u2032\u2032X .\nR { \u2208R| }\nShow that satisfies properties (i)\u2013(iii) of Theorem 3 in 3, with replaced by ;\n\u2217 \u2032\nR \u00a7 C C\nso = .]\n\u2217\nR R\n14. Let m\u2217 (n = 1,2,...) be outer measures in S such that\nn\n( X S) ( n) m\u2217X m\u2217 X.\n\u2200 \u2286 \u2200 n \u2264 n+1\nSet\n\u00b5\u2217 = lim m\u2217.\nn\nn\u2192\u221e\nShow that \u00b5\u2217 is an outer measure in S (see Note 5). 5. Nonnegative Set Functions. Premeasures. Outer Measures 145\n\u00a7\n15. An outer measure m\u2217 in a metric space (S,\u03c1) is said to have the\nCarath\u00b4eodory property (CP) iff\nm\u2217(X Y) m\u2217X +m\u2217Y\n\u222a \u2265\nwhenever \u03c1(X,Y) > 0, where\n\u03c1(X,Y) = inf \u03c1(x,y) x X,y Y .\n{ | \u2208 \u2208 }\nFor such m\u2217, prove that\nm\u2217 X = m\u2217X\nk k\n(cid:18) k (cid:19) k\n[ X\nif X 2S and\nk\n{ } \u2286\n\u03c1(X ,X ) > 0 (i = k).\ni k\n6\n[Hint: For finite unions, use the CP, subadditivity, and induction. Deduce that\nn\n\u221e\n( n) m\u2217X m\u2217 X k.\nk\n\u2200 \u2264\nk=1 k=1\nX [\nLet n . Proceed.]\n\u2192\u221e\n16. Let (S, ,\u00b5) and m\u2217 be as in Definition 3, with \u03c1 a metric for S. Let \u00b5\nn\nC\nbe the restriction of \u00b5 to the family of all X of diameter\nn\nC \u2208 C\n1\ndX .\n\u2264 n\nLet m\u2217 be the \u00b5 -induced outer measure in S.\nn n\nProve that\n(i) m\u2217 as in Problem 14;\n{ n}\u2191\n(ii) the outer measure\n\u00b5\u2217 = lim m\u2217\nn\nn\u2192\u221e\nhas the CP (see Problem 15), and\n\u00b5\u2217 m\u2217 on 2S.\n\u2265\n[Outline: Let \u03c1(X,Y)>\u03b5>0 (X,Y S).\n\u2286\nIf for some n, X Y has no basic covering from n, then\n\u222a C\n\u00b5\u2217(X \u222aY) \u2265m\u2217n(X \u222aY)= \u221e\u2265\u00b5\u2217X+\u00b5\u2217Y,\nand the CP follows. (Explain!)\nThus assume\n1 \u221e\nn> ( k) ( B n) X Y B nk.\nnk\n\u2200 \u03b5 \u2200 \u2203 \u2208C \u222a \u2286\n(cid:16) (cid:17) k [=1 146 Chapter 7. Volume and Measure\nOne can choose the B so that\nnk\n\u221e\n\u00b5B \u2264m\u2217n(X \u222aY)+\u03b5.\nnk\nk=1\nX\n(Why?) As\n1\ndB <\u03b5,\nnk\n\u2264 n\nsome B cover X only, others Y only. (Why?) Deduce that\nnk\n1 \u221e\n\u2200n> m\u2217nX+m\u2217nY \u00b5nB \u2264m\u2217n(X \u222aY)+\u03b5.\nnk\n\u03b5 \u2264\n(cid:16) (cid:17) k X=1\nLet \u03b5 0 and then n .\n\u2192 \u2192\u221e\nAlso, m m \u00b5 . (Why?)]\n\u2217 \u2217n \u2217\n\u2264 \u2264\n17. Continuing Problem 16, suppose that\n( \u03b5 > 0) ( n,k) ( B ) ( B )\nnk n\n\u2200 \u2200 \u2200 \u2208 C \u2203 \u2208 C\n\u221e \u221e\nB B and \u00b5B +\u03b5 \u00b5B .\nnk nk\n\u2286 \u2265\nk=1 k=1\n[ X\nShow that\nm\u2217 = lim \u00b5\u2217 = \u00b5\u2217,\nn\nn\u2192\u221e\nso m\u2217 itself has the CP.\n[Hints: It suffices to prove that m A \u00b5 A if m A< . (Why?)\n\u2217 \u2217 \u2217\n\u2265 \u221e\nNow, given \u03b5>0, A has a covering\nBi\n{ }\u2286C\nsuch that\nm\u2217A+\u03b5 \u00b5Bi.\n\u2265\nX\n(Why?) By assumption,\n( \u2200n) Bi \u2286 \u221e B ni k \u2208Cn and \u00b5Bi+ 2\u03b5 i \u2265 \u221e \u00b5B ni k.\nk=1 k=1\n[ X\nDeduce that\nm\u2217A+\u03b5> \u00b5Bi \u221e \u221e \u00b5B ni 2\u03b5 = \u00b5B ni k\u2212\u03b5 \u2265m\u2217nA \u2212\u03b5.\n\u2265 k\u2212 i\ni=1(cid:18)k=1 (cid:19) i,k\nX X X X\nLet \u03b5 0; then n .]\n\u2192 \u2192\u221e\n18. Using Problem 17, show that the Lebesgue and Lebesgue\u2013Stieltjes outer\nmeasures have the CP. 6. Measure Spaces. More on Outer Measures 147\n\u00a7\n\u00a76. Measure Spaces. More on Outer Measures\n1\nI. In 5, we considered premeasure spaces, stressing mainly the idea of \u03c3-\n\u00a7\nsubadditivity (Note 5 in 5). Now we shall emphasize \u03c3-additivity.\n\u00a7\nDefinition 1.\nA premeasure\nm: [0, ]\nM \u2192 \u221e\nis called a measure (in S) iff is a \u03c3-ring (in S), and m is \u03c3-additive\nM\non .\nM\nIf so, the system\n(S, ,m)\nM\nis called a measure space; mX is called the measure of X ; -sets\n\u2208 M M\nare called m-measurable sets.\nNote that m is nonnegative and m = 0, as m is a premeasure (Definition 2\n\u2205\nin 5).\n\u00a7\nCorollary 1. Measures are \u03c3-additive, \u03c3-subadditive, monotone, and contin-\nuous.\nProof. Use Corollary 2 in 5 and Theorem 2 in 4, noting that is a \u03c3-\n\u00a7 \u00a7 M\nring. (cid:3)\nCorollary 2. In any measure space (S, ,m), the union and intersection of\nM\nany sequence of m-measurable sets is m-measurable itself. So also is X Y if\n\u2212\nX,Y .\n\u2208 M\nThis is obvious since is a \u03c3-ring.\nM\nAs measures and other premeasuresare understood to be 0, we often write\n\u2265\nm: E\u2217\nM \u2192\nfor\nm: [0, ].\nM \u2192 \u221e\nWe also briefly say \u201cmeasurable\u201d for \u201cm-measurable.\u201d\nNote that , but not always S .\n\u2205 \u2208 M \u2208 M\nExamples.\n(a) The volume of intervals in En is a \u03c3-additive premeasure, but not a\nmeasure since its domain (the intervals) is not a \u03c3-ring.\n(b) Let = 2S. Define\nM\n( X S) mX = 0.\n\u2200 \u2286\n1Sections 6\u201312 are not needed for a \u201climited approach.\u201d (Pass to Chapter 8, 1.)\n\u00a7 148 Chapter 7. Volume and Measure\nThen m is trivially a measure (the zero-measure). Here each set X S\n\u2286\nis measurable, with mX = 0.\n(c) Let again = 2S. Let mX be the number of elements in X, if finite,\nM\nand mX = otherwise.\n\u221e\nThen m is a measure (\u201ccounting measure\u201d). Verify!\n(d) Let = 2S. Fix some p S. Let\nM \u2208\n1 if p X,\nmX = \u2208\n0 otherwise.\n(cid:26)\nThen m is a measure (it describes a \u201cunit mass\u201d concentrated at p).\n(e) A probability space is a measure space (S, ,m), with\nM\nS and mS = 1.\n\u2208 M\nIn probability theory, measurable sets are called events; mX is called the\nprobability of X, often denoted by pX or similar symbols.\nIn Examples (b), (c), and (d),\n= 2S (all subsets of S).\nM\nMore often, however,\n= 2S,\nM 6\ni.e., there are nonmeasurable sets X S for which mX is not defined.\n\u2286\nOf special interest are sets X , with mX = 0, and their subsets. We\n\u2208 M\ncall them m-null or null sets. One would like them to be measurable, but this\nis not always the case for subsets of X.\nThis leads us to the following definition.\nDefinition 2.\nA measure m : E\u2217 is called complete iff all null sets (subsets of sets\nM \u2192\nof measure zero) are measurable.\nWe now develop a general method for constructing complete measures.\nII. From 5 (Note 5) recall that an outer measure in S is a \u03c3-subadditive\n\u00a7\npremeasuredefinedonall of 2S (even if itis notderivedvia Definition 3 in 5).2\n\u00a7\nIn Examples (b), (c), and (d), m is both a measure and an outer measure.\n(Why?)\nAn outer measure\nm\u2217: 2S E\u2217\n\u2192\n2Some authors consider outer measures on smaller domains; we shall not do so. 6. Measure Spaces. More on Outer Measures 149\n\u00a7\nneed not be additive; but consider this fact:\nAny set A S splits S into two parts: A itself and A.\n\u2286 \u2212\nIt also splits any other set X into X A and X A; indeed,\n\u2229 \u2212\nX = (X A) (X A) (disjoint).\n\u2229 \u222a \u2212\nWe want to single out those sets A for which m\u2217 behaves \u201cadditively,\u201d i.e.,\nso that\nm\u2217X = m\u2217(X A)+m\u2217(X A).\n\u2229 \u2212\nThis motivates our next definition.\nDefinition 3.\nGiven an outer measure m\u2217: 2S E\u2217 and a set A S, we say that A is\n\u2192 \u2286\nm\u2217-measurable iff all sets X S are split \u201cadditively\u201d by A; that is,\n\u2286\n(1) ( X S) m\u2217X = m\u2217(X A)+m\u2217(X A).\n\u2200 \u2286 \u2229 \u2212\nAs is easily seen (see Problem 1), this is equivalent to\n(2) ( X A) ( Y A) m\u2217(X Y) = m\u2217X +m\u2217Y.\n\u2200 \u2286 \u2200 \u2286 \u2212 \u222a\nThe family of all m\u2217-measurable sets is usually denoted by \u2217. The\nM\nsystem (S, \u2217,m\u2217) is called an outer measure space.\nM\nNote 1. Definition 3 applies to outer measures only. For measures, \u201cm-\nmeasurable\u201d means simply \u201cmember of the domain of m\u201d (Definition 1).\nNote 2. In (1) and (2), we may equivalently replace the equality sign (=)\nby ( ). Indeed, X is covered by\n\u2265\nX A,X A ,\n{ \u2229 \u2212 }\nand X Y is covered by X,Y ; so the reverse inequality ( ) anyway holds,\n\u222a { } \u2264\nby subadditivity.\nOur main objective is to prove the following fundamental theorem.\nTheorem 1. In any outer measure space\n(S, \u2217,m\u2217),\nM\nthe family \u2217 of all m\u2217-measurable sets is a \u03c3-field in S, and m\u2217, when re-\nM\nstricted to \u2217, is a complete measure (denoted by m and called the m\u2217-induced\nM\nmeasure; so m\u2217 = m on \u2217).\nM\nWe split the proof into several steps (lemmas). 150 Chapter 7. Volume and Measure\nLemma 1. \u2217 is closed under complementation:\nM\n( A \u2217) A \u2217.\n\u2200 \u2208 M \u2212 \u2208 M\nIndeed, the measurability criterion (2) is same for A and A alike.\n\u2212\nLemma 2. and S are \u2217-sets. So are all sets of outer measure 0.\n\u2205 M\nProof. Let m\u2217A = 0. To prove A \u2217, use (2) and Note 2.\n\u2208 M\nThus take any X A and Y A. Then by monotonicity,\n\u2286 \u2286 \u2212\nm\u2217X m\u2217A = 0\n\u2264\nand\nm\u2217Y m\u2217(X Y).\n\u2264 \u222a\nThus\nm\u2217X +m\u2217Y = 0+m\u2217Y m\u2217(X Y),\n\u2264 \u222a\nas required.\nIn particular, as m\u2217 = 0, is m\u2217-measurable ( \u2217).\n\u2205 \u2205 \u2205 \u2208 M\nSo is S (the complement of ) by Lemma 1. (cid:3)\n\u2205\nLemma 3. \u2217 is closed under finite unions:\nM\n( A,B \u2217) A B \u2217.\n\u2200 \u2208 M \u222a \u2208 M\nProof. This time we shall use formula (1). By Note 2, it suffices to show that\n( X S) m\u2217X m\u2217(X (A B))+m\u2217(X (A B)).\n\u2200 \u2286 \u2265 \u2229 \u222a \u2212 \u222a\nFix any X S; as A \u2217, we have\n\u2286 \u2208 M\n(3) m\u2217X = m\u2217(X A)+m\u2217(X A).\n\u2229 \u2212\nSimilarly, as B \u2217, we have (replacing X by X A in (1))\n\u2208 M \u2212\nm\u2217(X A) = m\u2217((X A) B)+m\u2217(X A B)\n(4) \u2212 \u2212 \u2229 \u2212 \u2212\n= m\u2217(X A B)+m\u2217(X (A B)),\n\u2229\u2212 \u2229 \u2212 \u222a\nsince\nX A = X A\n\u2212 \u2229\u2212\nand\nX A B = X (A B).\n\u2212 \u2212 \u2212 \u222a\nCombining (4) with (3), we get\n(5) m\u2217X = m\u2217(X A)+m\u2217(X A B)+m\u2217(X (A B)).\n\u2229 \u2229\u2212 \u2229 \u2212 \u222a\nNow verify that\n(X A) (X A B) X (A B).\n\u2229 \u222a \u2229\u2212 \u2229 \u2287 \u2229 \u222a 6. Measure Spaces. More on Outer Measures 151\n\u00a7\nAs m is subadditive, this yields\nm\u2217(X A)+m\u2217(X A B) m\u2217(X (A B)).\n\u2229 \u2229\u2212 \u2229 \u2265 \u2229 \u222a\nCombining with (5), we get\nm\u2217X m\u2217(X (A B))+m\u2217(X (A B)),\n\u2265 \u2229 \u222a \u2212 \u222a\nso that A B \u2217, indeed. (cid:3)\n\u222a \u2208 M\nInduction extends Lemma 3 to all finite unions of \u2217-sets.\nM\nNote that by Problem 3 in 3, \u2217 is a set field, hence surely a ring. Thus\n\u00a7 M\nCorollary 1 in 1 applies to it. (We use it below.)\n\u00a7\nLemma 4. Let\nX A S, k = 0,1,2,...,\nk k\n\u2286 \u2286\nwith all A pairwise disjoint.\nk\nLet A \u2217 for k 1. (A and the X need not be \u2217-sets.) Then\nk 0 k\n\u2208 M \u2265 M\n\u221e \u221e\n(6) m\u2217 X = m\u2217X .\nk k\n(cid:18)k=0 (cid:19) k=0\n[ X\nProof. We start with two sets, A and A ; so\n0 1\nA \u2217, A A = , X A , and X A .\n1 0 1 0 0 1 1\n\u2208 M \u2229 \u2205 \u2286 \u2286\nAs A A = , we have A A ; hence also X A .\n0 1 0 1 0 1\n\u2229 \u2205 \u2286 \u2212 \u2286 \u2212\nSince A \u2217, we use formula (2), with\n1\n\u2208 M\nX = X A and Y = X A,\n1 1 0\n\u2286 \u2286 \u2212\nto obtain\nm\u2217(X X ) = m\u2217X +m\u2217X .\n0 1 0 1\n\u222a\nThus (6) holds for two sets.\nInduction now easily yields\nn n \u221e\n( n) m\u2217X = m\u2217 X m\u2217 X\nk k k\n\u2200 \u2264\nk=0 (cid:18)k=0 (cid:19) (cid:18)k=0 (cid:19)\nX [ [\nby monotonicity of m\u2217. Now let n and pass to the limit to get\n\u2192 \u221e\n\u221e \u221e\nm\u2217X m\u2217 X .\nk k\n\u2264\nk=0 (cid:18)k=0 (cid:19)\nX [\nAs X is covered by the X , the \u03c3-subadditivity of m\u2217 yields the reverse\nk k\ninequality as well. Thus (6) is proved. (cid:3)\nS 152 Chapter 7. Volume and Measure\nProof of Theorem 1. As we noted, \u2217 is a field. To show that it is also\nM\nclosed under countable unions (a \u03c3-field), let\n\u221e\nU = A , A \u2217.\nk k\n\u2208 M\nk=1\n[\nWe have to prove that U \u2217; or by (2) and Note 2,\n\u2208 M\n(7) ( X U) ( Y U) m\u2217(X Y) m\u2217X +m\u2217Y.\n\u2200 \u2286 \u2200 \u2286 \u2212 \u222a \u2265\nWemaysafelyassumethattheA aredisjoint. (Ifnot, replacethembydisjoint\nk\nsets B \u2217, as in Corollary 1 of 1.)\nk\n\u2208 M \u00a7\nTo prove (7), fix any X U and Y U, and let\n\u2286 \u2286 \u2212\nX = X A A ,\nk k k\n\u2229 \u2286\nA = U, and X = Y, satisfying all assumptions of Lemma 4. Thus by (6),\n0 0\n\u2212\nwriting the first term separately, we have\n\u221e \u221e\n(8) m\u2217 Y X = m\u2217Y + m\u2217X .\nk k\n\u222a\n(cid:18) k=1 (cid:19) k=1\n[ X\nBut\n\u221e \u221e \u221e\nX = (X A ) = X A = X U = X\nk k k\n\u2229 \u2229 \u2229\nk=1 k=1 k=1\n[ [ [\n(as X U). Also, by \u03c3-subadditivity,\n\u2286\nm\u2217X m\u2217 X = m\u2217X.\nk k\n\u2265\nTherefore, (8) implies (7X ); so \u2217 is a \u03c3-[ field.\nM\nMoreover, m\u2217 is \u03c3-additive on \u2217, as follows from Lemma 4 by taking\nM\nX = A \u2217, A = .\nk k 0\n\u2208 M \u2205\nThus m\u2217 acts as a measure on \u2217.\nM\nBy Lemma 2, m\u2217 is complete; for if X is \u201cnull\u201d (X A and m\u2217A = 0), then\n\u2286\nm\u2217X = 0; so X \u2217, as required.\n\u2208 M\nThus all is proved. (cid:3)\nWe thus have a standard method for constructing measures: From a pre-\nmeasure\n\u00b5: E\u2217\nC \u2192\nin S, we obtain the \u00b5-induced outer measure\nm\u2217: 2S E\u2217 ( 5);\n\u2192 \u00a7 6. Measure Spaces. More on Outer Measures 153\n\u00a7\nthis, in turn, induces a complete measure\nm: \u2217 E\u2217.\nM \u2192\nBut we need more: We want m to be an extension of \u00b5, i.e.,\nm = \u00b5 on ,\nC\nwith \u2217 (meaning that all -sets are m\u2217-measurable). We now explore\nC \u2286 M C\nthis question.\nLemma 5. Let (S, ,\u00b5) and m\u2217 be as in Definition 3 of 5. Then for a set\nC \u00a7\nA S to be m\u2217-measurable, it suffices that\n\u2286\n(9) m\u2217X m\u2217(X A)+m\u2217(x A) for all X .\n\u2265 \u2229 \u2212 \u2208 C\nProof. Assume (9). We must show that (9) holds for any X S, even not a\n\u2286\n-set.\nC\nThis is trivial if m\u2217X = . Thus assume m\u2217X < and fix any \u03b5 > 0.\n\u221e \u221e\nBy Note 3 in 5, X must have a basic covering B so that\nn\n\u00a7 { } \u2286 C\nX B\nn\n\u2286\nn\n[\nand\n(10) m\u2217X +\u03b5 > \u00b5B m\u2217B .\nn n\n\u2265\nX X\n(Explain!)\nNow, as X B , we have\nn\n\u2286\nS X A B A = (B A).\nn n\n\u2229 \u2286 \u2229 \u2229\n[ [\nSimilarly,\nX A = X A (B A).\nn\n\u2212 \u2229\u2212 \u2286 \u2212\nHence, as m\u2217 is \u03c3-subadditive and monoton[ e, we get\nm\u2217(X A)+m\u2217(X A) m\u2217 (B A) +m\u2217 (B A)\nn n\n\u2229 \u2212 \u2264 \u2229 \u2212\n(11)\n(cid:16) [m[\u2217(B A)(cid:17) +m\u2217(B(cid:16)[ (cid:17)\nA)].\nn n\n\u2264 \u2229 \u2212\nX\nBut by assumption, (9) holds for any -set, hence for each B . Thus\nn\nC\nm\u2217(B A)+m\u2217(B A) m\u2217B ,\nn n n\n\u2229 \u2212 \u2264\nand (11) yields\nm\u2217(X A)+m\u2217(X A) [m\u2217(B A)+m\u2217(B A)] m\u2217B .\nn n n\n\u2229 \u2212 \u2264 \u2229 \u2212 \u2264\nX X 154 Chapter 7. Volume and Measure\nTherefore, by (10),\nm\u2217(X A)+m\u2217(X A) m\u2217X +\u03b5.\n\u2229 \u2212 \u2264\nMaking \u03b5 0, we prove (10) for any X S, so that A \u2217, as required. (cid:3)\n\u2192 \u2286 \u2208 M\nTheorem 2. Let the premeasure\n\u00b5: E\u2217\nC \u2192\nbe \u03c3-additive on , a semiring in S. Let m\u2217 be the \u00b5-induced outer measure,\nC\nand\nm: \u2217 E\u2217\nM \u2192\nbe the m\u2217-induced measure. Then\n(i) \u2217 and\nC \u2286 M\n(ii) \u00b5 = m\u2217 = m on .\nC\nThus m is a \u03c3-additive extension of \u00b5 (called its Lebesgue extension) to \u2217.\nM\nProof. By Corollary 2 in 5, \u00b5 is also \u03c3-subadditive on the semiring . Thus\n\u00a7 C\nby Theorem 2 in 5, \u00b5 = m\u2217 on .\n\u00a7 C\nTo prove that \u2217, we fix A and show that A satisfies (9), so that\nC \u2286 M \u2208 C\nA \u2217.\n\u2208 M\nThus take any X . As is a semiring, X A and\n\u2208 C C \u2229 \u2208 C\nn\nX A = A (disjoint)\nk\n\u2212\nk=1\n[\nfor some sets A . Hence\nk\n\u2208 C\nn\nm\u2217(X A)+m\u2217(X A) = m\u2217(X A)+m\u2217 A\nk\n\u2229 \u2212 \u2229\nk=1\n(12) [\nn\nm\u2217(X A)+ m\u2217A .\nk\n\u2264 \u2229\nk=1\nX\nAs\nX = (X A) (X A) = (X A) A (disjoint),\nk\n\u2229 \u222a \u2212 \u2229 \u222a\nthe additivity of \u00b5 and the equality \u00b5 = m\u2217 on [yield\nC\nn\nm\u2217X = m\u2217(X A)+ m\u2217A .\nk\n\u2229\nk=1\nX\nHence by (12),\nm\u2217X m\u2217(X A)+m\u2217(X A);\n\u2265 \u2229 \u2212\nso by Lemma 5, A \u2217, as required.\n\u2208 M 6. Measure Spaces. More on Outer Measures 155\n\u00a7\nAlso, by definition, m = m\u2217 on \u2217, hence on . Thus\nM C\n\u00b5 = m\u2217 = m on ,\nC\nas claimed. (cid:3)\nNote 3. In particular, Theorem 2 applies if\n\u00b5: E\u2217\nM \u2192\nis a measure (so that = is even a \u03c3-ring).\nC M\nThus any such \u00b5 can be extended to a complete measure m (its Lebesgue\nextension) on a \u03c3-field\n\u2217\nM \u2287 M\nvia the \u00b5-induced outer measure (call it \u00b5\u2217 this time), with\n\u00b5\u2217 = m = \u00b5 on .\nM\nMoreover,\n\u2217\n\u03c3\nM \u2287 M \u2287 M\n(see Note 2 in 3); so \u00b5\u2217 is -regular and \u2217-regular (Theorem 3 of 5).\n\u00a7 M M \u00a7\nNote 4. A reapplication of this process to m does not change m (Prob-\nlem 16).\nProblems on Measures and Outer Measures\n1. Show that formulas (1) and (2) are equivalent.\n[Hints: (i) Assume (1) and let X A, Y A.\n\u2286 \u2286\u2212\nAs X in (1) is arbitrary, we may replace it by X Y. Simplifying, obtain (2) on\n\u222a\nnoting that X A=X, X A= , Y A= , and Y A=Y.\n\u2229 \u2229\u2212 \u2205 \u2229 \u2205 \u2229\u2212\n(ii)Assume(2). TakeanyX andsubstituteX AandX AforX andY in(2).]\n\u2229 \u2212\n2. Given an outer measure space (S, \u2217,m\u2217) and A S, set\nM \u2286\nA . \u2217 = A X X \u2217\n\u2229M { \u2229 | \u2208 M }\n(all sets of the form A X with X \u2217).\n\u2229 \u2208 M\nProve that A . \u2217 is a \u03c3-field in A, and m\u2217 is \u03c3-additive on it.\n\u2229M\n[Hint: Use Lemma 4, with X =A A A . .]\nk k \u2217\n\u2229 \u2208 \u2229M\n3. Prove Lemmas 1 and 2, using formula (1).\n\u2032\n3 . Prove Corollary 1.\n4. Verify Examples (b), (c), and (d). Why is m an outer measure as well?\n[Hint: Use Corollary 2 in 5.]\n\u00a7\n5. Fill in all details (induction, etc.) in the proofs of this section. 156 Chapter 7. Volume and Measure\n6. Verify that m\u2217 is an outer measure and describe \u2217 under each of the\nM\nfollowing conditions.\n(a) m\u2217A = 1 if A S; m\u2217 = 0.\n\u2205 \u2282 \u2286 \u2205\n(b) m\u2217A = 1 if A S; m\u2217S = 2; m\u2217 = 0.\n\u2205 \u2282 \u2282 \u2205\n(c) m\u2217A = 0 if A S is countable; m\u2217A = 1 otherwise (S is uncount-\n\u2286\nable).\n(d) S = N (naturals); m\u2217A = 1 if A is infinite; m\u2217A = n if A has\nn+1\nn elements.\n7. Prove the following.\n(i) An outer measure m\u2217 is \u2217-regular (Definition 5 in 5) iff\nM \u00a7\n( A S) ( B \u2217) A B and m\u2217A = mB.\n\u2200 \u2286 \u2203 \u2208 M \u2286\nB is called a measurable cover of A.\n[Hint: If\nm\u2217A=inf mX A X \u2217 ,\n{ | \u2286 \u2208M }\nthen\n1\n( n) ( Xn \u2217) A Xn and mXn m\u2217A+ .\n\u2200 \u2203 \u2208M \u2286 \u2264 n\nSet B = \u221en=1Xn.]\n(ii) If m\u2217 isTas in Definition 3 of 5, with \u2217, then m\u2217 is \u2217-\n\u00a7 C \u2286 M M\nregular.\n8. Show that if m\u2217 is \u2217-regular (Problem 7), it is left continuous.\nM\n[Hints: Let An ; let Bn be a measurable cover of An; set\n{ }\u2191\n\u221e\nCn = B k.\nk=n\n\\\nVerify that Cn , Bn Cn An, and mCn =m \u2217An.\n{ }\u2191 \u2287 \u2287\nBy the left continuity of m (Theorem 2 in 4),\n\u00a7\n\u221e \u221e\nlimm\u2217An =limmCn =m Cn m\u2217 An.\n\u2265\nn=1 n=1\n[ [\nProve the reverse inequality as well.]\n9. Continuing Problems 6\u20138, verify the following.\n(i) In 6(a), with S = N, m\u2217 is \u2217-regular, but not right continuous.\nM\nHint: Take An = x N x n .\n{ \u2208 | \u2265 }\n(ii) In 6(b), with S = N, m\u2217 is neither \u2217-regular nor left continuous.\nM\n(iii) In 6(d), m\u2217 is not \u2217-regular; yet it is left continuous. (Thus\nM\nProblem 8 is not a necessary condition.) 6. Measure Spaces. More on Outer Measures 157\n\u00a7\n10. In Problem 2, let n\u2217 be the restriction of m\u2217 to 2A. Prove the following.\n(a) n\u2217 is an outer measure in A.\n(b) A . \u2217 \u2217 = n\u2217-measurable sets .\n\u2229M \u2286 N { }\n(c) A . \u2217 = \u2217 if A \u2217, or if m\u2217 is \u2217-regular (see Problem 7)\n\u2229M N \u2208 M M\nand finite.\n(d) n\u2217 is \u2217-regular if m\u2217 is \u2217-regular.\nN M\n11. Show that if m\u2217 is \u2217-regular and finite, then A S is m\u2217-\nM \u2286\nmeasurable iff\nmS = m\u2217A+m\u2217( A).\n\u2212\n[Hint: Assume the latter. By Problem 7,\n( X S) ( B \u2217, B X) m\u2217X =mB;\n\u2200 \u2286 \u2203 \u2208M \u2287\nso\nm\u2217A=m\u2217(A B)+m\u2217(A B).\n\u2229 \u2212\nSimilarly for A. Deduce that\n\u2212\nm\u2217(A B)+m\u2217(A B)+m\u2217(B A)+m\u2217( A B)=mS =mB+m( B);\n\u2229 \u2212 \u2212 \u2212 \u2212 \u2212\nhence\nm\u2217X =mB m\u2217(B A)+m\u2217(B A) m\u2217(X A)+m\u2217(X A),\n\u2265 \u2229 \u2212 \u2265 \u2229 \u2212\nso A .]\n\u2217\n\u2208M\n12. Using Problem 15 in 5, prove that if m\u2217 has the CP then each open set\n\u00a7\nG S is in \u2217.\n\u2286 M\n[Outline: Show that\n( X G) ( Y G) m\u2217(X Y) m\u2217X +m\u2217Y,\n\u2200 \u2286 \u2200 \u2286\u2212 \u222a \u2265\nassuming m X < . (Why?) Set\n\u2217\n\u221e\nD = x X \u03c1(x, G) 1\n0\n{ \u2208 | \u2212 \u2265 }\nand\n1 1\nD = x X \u03c1(x, G)< , k 1.\nk\n\u2208 k+1 \u2264 \u2212 k \u2265\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nProve that (cid:12)\n(cid:12)\n\u221e\n(i) X = D\nk\nk=0\n[\nand\n(ii) \u03c1(D ,D )>0;\nk k+2\nso by Problem 15 in 5,\n\u00a7\n\u221e \u221e \u221e\nm\u2217D 2n =m\u2217 D 2n m\u2217 Dn =m\u2217X < .\n\u2264 \u221e\nn=0 n=0 n=0\nX [ [ 158 Chapter 7. Volume and Measure\nSimilarly,\n\u221e\nm\u2217D 2n+1 m\u2217X < .\n\u2264 \u221e\nn=0\nX\nHence\n\u221e\nm\u2217Dn < ;\n\u221e\nn=0\nX\nso\n\u221e\nlim m\u2217D =0.\nk\nn\n\u2192\u221ek=n\nX\n(Why?) Thus\n\u221e\n( \u03b5>0) ( n) m\u2217D <\u03b5.\nk\n\u2200 \u2203\nk=n\nX\nAlso,\nn 1\n\u221e \u2212 \u221e\nX = D = D D ;\nk k k\n\u222a\nk=0 k=0 k=n\n[ [ [\nso\nn 1 n 1\n\u2212 \u221e \u2212\nm\u2217X m\u2217 D + m\u2217D <m\u2217 D +\u03b5.\nk k k\n\u2264\nk=0 k=n k=0\n[ X [\nAdding m Y on both sides, get\n\u2217\nn 1\n\u2212\n(iii) m\u2217X +m\u2217Y m\u2217 D +m\u2217Y +\u03b5.\nk\n\u2264\nk=0\n[\nMoreover,\nn 1\n\u2212\n\u03c1 D ,Y >0,\nk\n(cid:18)k=0 (cid:19)\n[\nfor Y G and\n\u2286\u2212 1\n\u03c1(D , G) .\nk\n\u2212 \u2265 k+1\nHence by the CP,\nn 1 n 1\n\u2212 \u2212\nm\u2217Y + m\u2217D =m\u2217 Y D <m\u2217(Y X).\nk k\n\u222a \u222a\nk=0 (cid:18) k=0 (cid:19)\nX [\n(Why?) Combining with (iii), obtain\nm\u2217X+m\u2217Y m\u2217(X Y)+\u03b5.\n\u2264 \u222a\nNow let \u03b5 0.]\n\u2192\n\u21d213. Show that if m: E\u2217 is a measure, there is P , with\nM \u2192 \u2208 M\nmP = max mX X .\n{ | \u2208 M}\n[Hint: Let\nk =sup mX X\n{ | \u2208M} 6. Measure Spaces. More on Outer Measures 159\n\u00a7\nin E \u2217. As k 0, there is a sequence rn k, rn < k. (If k = , set rn = n; if\n\u2265 \u0580 \u221e\nk < \u221e, rn =k n1.) By lub properties,\n\u2212\n( n) ( Xn ) rn <mXn k,\n\u2200 \u2203 \u2208M \u2264\nwith Xn (Problem 9 in 3). Set\n{ }\u2191 \u00a7\n\u221e\nP = Xn.\nn=1\n[\nShow that\nmP = lim mXn =k.]\nn\n\u2192\u221e\n\u21d2\u2217 14. Given a measure m: E\u2217, let\nM \u2192\n= all sets of the form X Z where X and Z is m-null .\nM { \u222a \u2208 M }\nProve that is a \u03c3-ring .\nM \u2287 M\n[Hint: To prove that\n( A,B ) A B ,\n\u2200 \u2208M \u2212 \u2208M\nsuppose first A and B is \u201cnull,\u201d i.e., B U , mU =0.\n\u2208M \u2286 \u2208M\nShow that\nA B =X Z,\n\u2212 \u222a\nwith X =A U and Z =A U B m-null (Z is shaded in Figure 31).\n\u2212 \u2208M \u2229 \u2212\nNext, if A,B , let A = X Z,\n\u2208 M \u222a\nB = X Z , where X,X and\n\u2032 \u222a \u2032 \u2032 \u2208 M A\nZ,Z are m-null. Hence\n\u2032\nU\nA B =(X Z) B\n\u2212 \u222a \u2212\n=(X B) (Z B)\n\u2212 \u222a \u2212 X\n=(X B) Z\u2032\u2032, B\n\u2212 \u222a\nwhere\nZ\u2032\u2032 =Z B\n\u2212\nis m-null. Also, B =X Z implies\n\u2032 \u2032\n\u222a\nX B =(X X\u2032) Z\u2032 ,\n\u2212 \u2212 \u2212 \u2208M Figure 31\nby the first part of the proof.\nDeduce that\nA B =(X B) Z\u2032\u2032\n\u2212 \u2212 \u222a \u2208M\n(after checking closure under unions).]\n\u21d2\u2217 15. Continuing Problem 14, define m: E\u2217 by setting mA = mX\nM \u2192\nwhenever A = X Z, with X and Z m-null. (Show that mA does\n\u222a \u2208 M\nnot depend on the particular representation of A as X Z.)\n\u222a\nProve the following.\n(i) m is a complete measure(called the completion of m), with m = m\non .\nM 160 Chapter 7. Volume and Measure\n(ii) m is the least complete extension of m; that is, if n: E\u2217 is\nN \u2192\nanother complete measure, with and n = m on , then\nM \u2286 N M\nand n = m on .\nM \u2286 N M\n(iii) m = m iff m is complete.\n\u2217 16. Show that if m: \u2217 E\u2217 is induced by an \u2217-regular outer measure\nM \u2192 M\n\u00b5\u2217, then m equals its Lebesgue extension m\u2032 and completion m (see\nProblem 15).\n[Hint: By Definition 3 in 5, m induces an outer measure m . By Theorem 3 in 5,\n\u2217\n\u00a7 \u00a7\nm\u2217A=inf mX A X \u2217 =\u00b5\u2217A\n{ | \u2286 \u2208M }\n(for \u00b5 is -regular).\n\u2217 \u2217\nM\nAs m =\u00b5 , we get m =m. Also, m=m, by Problem 15(iii).]\n\u2217 \u2217 \u2032\n\u2217 17. Prove that if a measure \u00b5: E\u2217 is \u03c3-finite (Definition 4 in 5), with\nM \u2192 \u00a7\nS , then its Lebesgueextension m: \u2217 E\u2217 equals its completion\n\u2208 M M \u2192\n\u00b5 (see Problem 15).\n[Outline: It suffices to prove . (Why?)\n\u2217\nM \u2286M\nTo start with, let A , mA< . By Problem 12 in 5,\n\u2217\n\u2208M \u221e \u00a7\n( B ) A B and m\u2217A=mA=mB < ;\n\u2203 \u2208M \u2286 \u221e\nso\nm(B A)=mB mA=0.\n\u2212 \u2212\nAlso,\n( H ) B A H and \u00b5H =m(B A)=0.\n\u2203 \u2208M \u2212 \u2286 \u2212\nThus B A is \u00b5-null; so B A . (Why?) Deduce that\n\u2212 \u2212 \u2208M\nA=B (B A) .\n\u2212 \u2212 \u2208M\nThus contains any A with mA< . Use the \u03c3-finiteness of \u00b5 to show\n\u2217\nM \u2208M \u221e\n( x \u2217) ( An \u2217) mAn < and X = An .]\n\u2200 \u2208M \u2203{ }\u2286M \u221e \u2208M\nn\n[\n\u00a77. Topologies. Borel Sets. Borel Measures\nI. Our theory of set families leads quite naturally to a generalization of metric\nspaces. As we know, in any such space (S,\u03c1), there is a family of open sets,\nG\nand a family of all closed sets. In Chapter 3, 12, we derived the following\nF \u00a7\ntwo properties.\n(i) is closed under any (even uncountable) unions and under finite inter-\nG\nsections (Chapter 3, 12, Theorem 2). Moreover,\n\u00a7\nand S .\n\u2205 \u2208 G \u2208 G 7. Topologies. Borel Sets. Borel Measures 161\n\u00a7\n(ii) has these properties, with \u201cunions\u201d and \u201cintersections\u201d interchanged\nF\n(Chapter 3, 12, Theorem 3). Moreover, by definition,\n\u00a7\nA iff A .\n\u2208 F \u2212 \u2208 G\nNow, quite often, it is not so important to have distances (i.e., a metric)\ndefined in S, but rather to single out two set families, and , with proper-\nG F\nties (i) and (ii), in a suitable manner. For examples, see Problems 1 to 4 below.\nOnce and are given, one does not need a metric to define such notions as\nG F\ncontinuity, limits, etc. (See Problems 2 and 3.) This leads us to the following\ndefinition.\nDefinition 1.\nA topology for a set S is any set family 2S, with properties (i).\nG \u2286\nThe pair (S, ) then is called a topological space. If confusion is un-\nG\nlikely, we simply write S for (S, ).\nG\n\u2013sets are called open sets; their complements form the family\nG F\n(called cotopology) of all closed sets in S; satisfies (ii) (the proof is\nF\nas in Theorem 3 of Chapter 3, 12).\n\u00a7\nAny metric space may be treated as a topological one (with defined as in\nG\nChapter 3, 12), but the converse is not true. Thus (S, ) is more general.\n\u00a7 G\nNote 1. By Problem 15 in Chapter 4, 2, a map\n\u00a7\nf: (S,\u03c1) (T,\u03c1\u2032)\n\u2192\nis continuous iff f\u22121[B] is open in S whenever B is open in T.\nWe adopt this as a definition, for topological spaces S,T.\nMany other notions (neighborhoods, limits, etc.) carry over from metric\nspaces by simply treating G as \u201can open set containing p.\u201d (See Problem 3.)\np\nNote 2. By (i), is surely closed under countable unions. Thus by Note 2\nG\nin 3,\n\u00a7\n= .\n\u03c3\nG G\nAlso, = and\nd\nG G\n= = ,\n\u03b4 s\nF F F\nbut not\n= or =\n\u03b4 \u03c3\nG G F F\nin general.\nand need not be rings or \u03c3-rings (closure fails for differences). But by\nG F\nTheorem 2 in 3, and can be \u201cembedded\u201d in a smallest \u03c3-ring. We name\n\u00a7 G F\nit in the following definition. 162 Chapter 7. Volume and Measure\nDefinition 2.\nThe \u03c3-ring generated by a topology in S is called the Borel field in\nB G\nS. (It is a \u03c3-field, as S .)\n\u2208 G \u2286 B\nEquivalently, is the least \u03c3-ring . (Why?)\nB \u2287 F\n-sets are called Borel sets in (S, ).\nB G\nAs is closed under countable unions and intersections, we have not only\nB\nand ,\nB \u2287 G B \u2287 F\nbut also\n, , [i.e., ( ) ], , etc.\n\u03b4 \u03c3 \u03b4\u03c3 \u03b4 \u03c3 \u03c3\u03b4\nB \u2287 G B \u2287 F B \u2287 G G B \u2287 F\nNote that\n= , = , etc. (Why?)\n\u03b4\u03b4 \u03b4 \u03c3\u03c3 \u03c3\nG G F F\nII. Special notions apply to measures in metric and topological spaces.\nDefinition 3.\nA measure m: E\u2217 in (S, ) is called topological iff , i.e., all\nM \u2192 G G \u2286 M\nopen sets are measurable; m is a Borel measure iff = .\nM B\nNote 3. If (a \u03c3-ring), then also since is, by definition,\nG \u2286 M B \u2286 M B\nthe least \u03c3-ring .\n\u2287 G\nThus m is topological iff (hence surely , , ,\n\u03b4 \u03c3\nB \u2286 M F \u2286 M G \u2286 M F \u2286 M\netc.).\nIt also follows that any topological measure can be restricted to to obtain\nB\na Borel measure, called its Borel restriction.\nDefinition 4.\nA measure m: E\u2217 in (S, ) is called regular iff it is regular with\nM \u2192 G\nrespect to , the measurable open sets; i.e.,\nM\u2229G\n( A ) mA = inf mX A X .\n\u2200 \u2208 M { | \u2286 \u2208 M\u2229G}\nIf m is topological ( ), this simplifies to\nG \u2286 M\n(1) mA = inf mX A X ,\n{ | \u2286 \u2208 G}\ni.e., m is -regular (Definition 5 in 5).\nG \u00a7\nDefinition 5.\nA measure m is strongly regular iff for any A and \u03b5 > 0, there is an\n\u2208 M\nopen set G and a closed set F such that\n\u2208 M \u2208 M\n(2) F A G, with m(A F) < \u03b5 and m(G A) < \u03b5;\n\u2286 \u2286 \u2212 \u2212 7. Topologies. Borel Sets. Borel Measures 163\n\u00a7\nthus A canbe\u201capproximated\u201dby opensupersetsandclosedsubsets, both\nmeasurable. As is easily seen, this implies regularity.\nA kind of converse is given by the following theorem.\nTheorem 1. If a measure m: E\u2217 in (S, ) is regular and \u03c3-finite (see\nM \u2192 G\nDefinition 4 in 5), with S , then m is also strongly regular.\n\u00a7 \u2208 M\nProof. Fix \u03b5 > 0 and let mA < .\n\u221e\nBy regularity,\nmA = inf mX A X ;\n{ | \u2286 \u2208 M\u2229G}\nso there is a set X (measurable and open), with\n\u2208 M\u2229G\nA X and mX < mA+\u03b5.\n\u2286\nThen\nm(X A) = mX mA < \u03b5,\n\u2212 \u2212\nand X is the open set G required in (2).\nIf, however, mA = , use \u03c3-finiteness to obtain\n\u221e\n\u221e\nA X\nk\n\u2286\nk=1\n[\nfor some sets X , mX < ; so\nk k\n\u2208 M \u221e\nA = (A X ).\nk\n\u2229\nk\n[\nPut\nA = A X .\nk k\n\u2229 \u2208 M\n(Why?) Then\nA = A ,\nk\nk\n[\nand\nmA mX < .\nk k\n\u2264 \u221e\nNow, by what was proved above, for each A there is an open measurable\nk\nG A , with\nk k\n\u2287 \u03b5\nm(G A ) < .\nk \u2212 k 2k\nSet\n\u221e\nG = G .\nk\nk=1\n[ 164 Chapter 7. Volume and Measure\nThen G and G A. Moreover,\n\u2208 M\u2229G \u2287\nG A = G A (G A ).\nk k k k\n\u2212 \u2212 \u2286 \u2212\nk k k\n[ [ [\n(Verify!) Thus by \u03c3-subadditivity,\n\u221e\n\u03b5\nm(G A) m(G A ) < = \u03b5,\n\u2212 \u2264 k \u2212 k 2k\nk k=1\nX X\nas required.\nTo find also the closed set F, consider\nA = S A .\n\u2212 \u2212 \u2208 M\nAs shown above, there is an open measurable set G\u2032 A, with\n\u2287 \u2212\n\u03b5 > m(G\u2032 ( A)) = m(G\u2032 A) = m(A ( G\u2032)).\n\u2212 \u2212 \u2229 \u2212 \u2212\nThen\nF = G\u2032 A\n\u2212 \u2286\nis the desired closed set, with m(A F) < \u03b5. (cid:3)\n\u2212\nTheorem 2. If m: E\u2217 is a strongly regular measure in (S, ), then for\nM \u2192 G\nany A , there are measurable sets H and K such that\n\u03c3 \u03b4\n\u2208 M \u2208 F \u2208 G\n(3) H A K and m(A H) = 0 = m(K A);\n\u2286 \u2286 \u2212 \u2212\nhence\nmA = mH = mK.\nProof. Let A . By strong regularity, given \u03b5 = 1/n, one finds measur-\nn\n\u2208 M\nable sets\nG and F , n = 1,2,...,\nn n\n\u2208 G \u2208 F\nsuch that\nF A G\nn n\n\u2286 \u2286\nand\n1 1\n(4) m(A F ) < and m(G A) < , n = 1,2,....\nn n\n\u2212 n \u2212 n\nLet\n\u221e \u221e\nH = F and K = G .\nn n\nn=1 n=1\n[ \\\nThen H,K , H , K , and\n\u03c3 \u03b4\n\u2208 M \u2208 F \u2208 G\nH A K.\n\u2286 \u2286 7. Topologies. Borel Sets. Borel Measures 165\n\u00a7\nAlso, F H and G K.\nn n\n\u2286 \u2287\nHence\nA H A F and K A G A;\nn n\n\u2212 \u2286 \u2212 \u2212 \u2286 \u2212\nso by (4),\n1 1\nm(A H) < 0 and m(K A) < 0.\n\u2212 n \u2192 \u2212 n \u2192\nFinally,\nmA = m(A H)+mH = mH,\n\u2212\nand similarly mA = mK.\nThus all is proved. (cid:3)\nProblems on Topologies, Borel Sets, and Regular Measures\n1. Show that is a topology in S (in (a)\u2013(c), describe also), given\nG B\n(a) = 2S;\nG\n(b) = ,S ;\nG {\u2205 }\n(c) = and all sets in S, containing a fixed point p ; or\nG {\u2205 }\n(d) S = E\u2217; consists of all possible unions of sets of the form (a,b),\nG\n(a, ], and [ ,b), with a,b E1.\n\u221e \u2212\u221e \u2208\n2. (S,\u03c1) is called a pseudometric space (and \u03c1 is a pseudometric) iff the\nmetric laws (i)\u2013(iii) of Chapter 3, 11 hold, but (i\u2032) is weakened to\n\u00a7\n\u03c1(x,x) = 0\n(so that \u03c1(x,y) may be 0 even if x = y).\n6\n(a) Define \u201cglobes,\u201d \u201cinteriors,\u201d and \u201copen sets\u201d (i.e., ) as in Chap-\nG\nter 3, 12; then show that is a topology for S.\n\u00a7 G\n(b) Let S = E2 and\n\u03c1(x\u00af,y\u00af) = x y ,\n1 1\n| \u2212 |\nwhere x\u00af = (x ,x ) and y\u00af= (y ,y ). Show that \u03c1 is a pseudometric\n1 2 1 2\nbut not a metric (the Hausdorff properly fails!).\n3. Define \u201cneighborhood,\u201d \u201cinterior,\u201d \u201ccluster point,\u201d \u201cclosure,\u201d and\n\u201cfunction limit\u201d for topological spaces. Specify some notions (e.g., \u201cdi-\nameter,\u201d \u201cuniform continuity\u201d) that do not carry over (they involve\ndistances).\n4. In a topological space (S, ), define\nG\n0 = , 1 = , 2 = , ...\n\u03b4 \u03b4\u03c3\nG G G G G G 166 Chapter 7. Volume and Measure\nand\n0 = , 1 = , 2 = , 3 = , etc.\n\u03c3 \u03c3\u03b4 \u03c3\u03b4\u03c3\nF F F F F F F F\n(Give an inductive definition.) Then prove by induction that\n(a) n , n ;\nG \u2286 B F \u2286 B\n(b) n\u22121 n, n\u22121 n;\nG \u2286 G F \u2286 F\n(c) ( X S) X n iff X n;\n\u2200 \u2286 \u2208 F \u2212 \u2208 G\n(d) ( X,Y n) X Y n, X Y n; same for n;\n\u2200 \u2208 F \u2229 \u2208 F \u222a \u2208 F G\n(e) ( X n) ( Y n) X Y n and Y X n.\n\u2200 \u2208 G \u2200 \u2208 F \u2212 \u2208 G \u2212 \u2208 F\n[Hint: X Y =X Y.]\n\u2212 \u2229\u2212\n5. For metric and pseudometric spaces (see Problem 2) prove that\nn n+1 and n n+1\nF \u2286 G G \u2286 F\n(cf. Problem 4).\n[Hint for : Let F . Set\n\u03b4\nF \u2286G \u2208F\n1\nGn = Gp ;\nn\np [\u2208F (cid:16) (cid:17)\nso\n( n) F Gn .\n\u2200 \u2286 \u2208G\nHence\nF Gn \u03b4.\n\u2286 \u2208G\nn\n\\\nAlso,\nGn =F =F\nn\n\\\nby Theorem 3 in Chapter 3, 16. Hence deduce that\n\u00a7\n( F ) F ,\n\u03b4\n\u2200 \u2208F \u2208G\nso \u03b4; hence \u03c3 by Problem 4(c). Now use induction.]\nF \u2286G G \u2286F\n6. If m is as in Definition 5, then prove the following.\n(i) m is regular.\n(ii) ( A ) mA = sup mX A X .\n\u2200 \u2208 M { | \u2287 \u2208 M\u2229F}\n(iii) The latter implies strong regularity if m < and S .\n\u221e \u2208 M\n7. Let \u00b5: E\u2217 be a Borel measure in a metric space (S,\u03c1). Set\nB \u2192\n( A S) n\u2217A = inf \u00b5X A X .\n\u2200 \u2286 { | \u2286 \u2208 G}\nProve that\n(i) n\u2217 is an outer measure in S;\n(ii) n\u2217 = \u00b5 on ;\nG 7. Topologies. Borel Sets. Borel Measures 167\n\u00a7\n(iii) the n\u2217-induced measure, n: \u2217 E\u2217, is topological (so \u2217);\nN \u2192 B \u2286 N\n(iv) n \u00b5 on ;\n\u2265 B\n(v) ( A S) ( H ) A H and \u00b5H = n\u2217A.\n\u03b4\n\u2200 \u2286 \u2203 \u2208 G \u2286\n[Hints: (iii) Using Problem 15 in 5 and Problem 12 in 6, let\n\u00a7 \u00a7\n1 1\n\u03c1(X,Y)>\u03b5>0, U = Gx \u03b5 , V = Gy \u03b5 .\n2 2\nx [\u2208X (cid:16) (cid:17) y [\u2208Y (cid:16) (cid:17)\nVerify that U,V , U X, V Y, U V = .\n\u2208G \u2287 \u2287 \u2229 \u2205\nBy the definition of n ,\n\u2217\n( G ) G X Y and n\u2217G n\u2217(X Y)+\u03b5;\n\u2203 \u2208G \u2287 \u222a \u2264 \u222a\nalso, X G U and Y G V. Thus by (ii),\n\u2286 \u2229 \u2286 \u2229\nn\u2217X \u00b5(G U) and n\u2217Y \u00b5(G V).\n\u2264 \u2229 \u2264 \u2229\nHence\nn\u2217X+n\u2217Y \u00b5(G U)+\u00b5(G V)=\u00b5((G U) (G V)) \u00b5G=n\u2217G n\u2217(X Y)+\u03b5.\n\u2264 \u2229 \u2229 \u2229 \u222a \u2229 \u2264 \u2264 \u222a\nLet \u03b5 0 to get the CP: n X+n Y n (X Y).\n\u2217 \u2217 \u2217\n\u2192 \u2264 \u222a\n(iv) We have ( A )\n\u2200 \u2208B\nnA=n\u2217A=inf \u00b5X A X inf \u00b5X A X =\u00b5A.\n{ | \u2286 \u2208G}\u2265 { | \u2286 \u2208B}\n(Why?)\n(v) Use the hint to Problem 11 in 5.]\n\u00a7\n8. From Problem 7 with m = \u00b5, prove that if\nA G ,\n\u2286 \u2208 G\nwith mG < and A , then mA = nA.\n\u221e \u2208 B\n[Hint: A, G, and (G A) . By Problem 7(iii), N and n is additive on ;\n\u2217\n\u2212 \u2208 B B \u2286 B\nso by Problem 7(ii)(iv),\nnA=nG n(G A) mG m(G A)=mA nA.\n\u2212 \u2212 \u2264 \u2212 \u2212 \u2264\nThus mA=nA. Explain all!]\n9. Let m, n, and n\u2217 be as in Problems 7 and 8. Suppose\n\u221e\nS = G ,\nn\nn=1\n[\nwith G and mG < (this is called \u03c30-finiteness).\nn n\n\u2208 G \u221e\nProve that\n(i) m = n on , and\nB\n(ii) m and n are strongly regular. 168 Chapter 7. Volume and Measure\n[Hints: Fix A . Show that\n\u2208B\nA= An (disjoint)\n[\nfor some Borel sets An Gn (use Corollary 1 in 1). By Problem 8, mAn = nAn\n\u2286 \u00a7\nsince\nAn Gn\n\u2286 \u2208G\nand mGn < . Now use \u03c3-additivity to find mA=nA.\n\u221e\n(ii) Use -regularity, part (i), and Theorem 1.]\nG\n10. Continuing Problems 8 and 9, show that n is the Lebesgue extension of\nm (see Theorem 2 in 6 and Note 3 in 6).\n\u00a7 \u00a7\nThus every \u03c30-finite Borel measure m in (S,\u03c1) and its Lebesgue ex-\ntension are strongly regular.\n[Hint: m induces an outer measure m , with m =m on . It suffices to show that\n\u2217 \u2217\nB\nm =n on 2S. (Why?)\n\u2217 \u2217\nSo let A S. By Problem 7(v),\n\u2286\n( H ) A H and n\u2217A=mH =m\u2217H.\n\u2203 \u2208B \u2286\nAlso,\n( K ) A K and m\u2217A=mK\n\u2203 \u2208B \u2286\n(Problem 12 in 5). Deduce that\n\u00a7\nn\u2217A n(H K)=m(H K) mH =n\u2217A\n\u2264 \u2229 \u2229 \u2264\nand\nn\u2217A=m(H K)=m\u2217A.]\n\u2229\n\u00a78. Lebesgue Measure\nWe shall now consider the most important example of a measure in En, due to\nLebesgue. Thismeasuregeneralizesthenotionofvolume andassigns\u201cvolumes\u201d\ntoalargesetfamily, the\u201cLebesguemeasurable\u201dsets,sothat\u201cvolume\u201dbecomes\na complete topological measure. For \u201cbodies\u201d in E3, this measure agrees with\nour intuitive idea of \u201cvolume.\u201d\nWe start with the volume function v: E1 (\u201cLebesgue premeasure\u201d)\nC \u2192\non the semiring of all intervals in En ( 1). As we saw in 5 and 6, this\nC \u00a7 \u00a7\u00a7\npremeasure induces an outer measure m\u2217 on all subsets of En; and m\u2217, in\nturn, induces a measure m on the \u03c3-field \u2217 of m\u2217-measurable sets. These\nM\nsets are, by definition, the Lebesgue-measurable (briefly L-measurable) sets; m\u2217\nand m so definedare the (n-dimensional) Lebesgue outer measure and Lebesgue\nmeasure. 8. Lebesgue Measure 169\n\u00a7\nTheorem 1. Lebesgue premeasure v is \u03c3-additive on , the intervals in En.\nC\nHence the latter are Lebesgue measurable ( \u2217), and the volume of each\nC \u2286 M\ninterval equals its Lebesgue measure:\nv = m\u2217 = m on .\nC\nThis follows by Corollary 1 in 2 and Theorem 2 of 6.\n\u00a7 \u00a7\nNote 1. As \u2217 is a \u03c3-field ( 6), it is closed under countable unions, count-\nM \u00a7\nable intersections, and differences. Thus\n\u2217 implies \u2217;\n\u03c3\nC \u2286 M C \u2286 M\ni.e., any countable union of intervals is L-measurable. Also, En \u2217.\n\u2208 M\nCorollary 1. Any countable set A En is L-measurable, with mA = 0.\n\u2282\nThe proof is as in Corollary 6 of 2.\n\u00a7\nCorollary 2. The Lebesgue measure of En is .\n\u221e\nProve as in Corollary 5 of 2.\n\u00a7\nExamples.\n(a) Let\nR = rationals in E1 .\n{ }\nThen R is countable (Corollary 3 of Chapter 1, 9); so mR = 0 by Corol-\n\u00a7\nlary 1. Similarly for Rn (rational points in En).\n(b) The measure of an interval with endpoints a,b in E1 is its length, b a.\n\u2212\nLet\nR = all rationals in [a,b] ;\no\n{ }\nso mR = 0. As [a,b] and R are in \u2217 (a \u03c3-field), so is\no o\nM\n[a,b] R ,\no\n\u2212\nthe irrationals in [a,b]. By Lemma 1 in 4, if b > a, then\n\u00a7\nm([a,b] R ) = m([a,b]) mR = m([a,b]) = b a > 0 = mR .\no o o\n\u2212 \u2212 \u2212\nThisshowsagainthattheirrationalsforma\u201clarger\u201dsetthantherationals\n(cf. Theorem 3 of Chapter 1, 9).\n\u00a7\n(c) Thereareuncountable setsofmeasurezero(seeProblems8and10below).\nTheorem 2. Lebesgue measure in En is complete, topological, and totally \u03c3-\nfinite. That is,\n(i) all null sets (subsets of sets of measure zero) are L-measurable;\n(ii) so are all open sets ( \u2217 ), hence all Borel sets ( \u2217 ); in partic-\nM \u2287 G M \u2287 B\nular, \u2217 , \u2217 , \u2217 , \u2217 , etc.;\n\u03b4 \u03c3 \u03c3\u03b4\nM \u2287 F M \u2287 G M \u2287 F M \u2287 F 170 Chapter 7. Volume and Measure\n(iii) each A \u2217 is a countable union of disjoint sets of finite measure.\n\u2208 M\nProof. (i) This follows by Theorem 1 in 6.\n\u00a7\n(ii) By Lemma 2 in 2, each open set is in , hence in \u2217 (Note 1). Thus\n\u03c3\n\u00a7 C M\n\u2217 . But by definition, the Borel field is the least \u03c3-ring . Hence\nM \u2287 G B \u2287 G\n\u2217 \u2217.\nM \u2287 B\n(iii) As En is open, it is a countable union of disjoint half-open intervals,\n\u221e\nEn = A (disjoint),\nk\nk=1\n[\nwith mA < (Lemma 2 in 2). Hence\nk\n\u221e \u00a7\n( A En) A A ;\nk\n\u2200 \u2286 \u2286\nso [\nA = (A A ) (disjoint).\nk\n\u2229\nk\n[\nIf, further, A \u2217, then A A \u2217, and\nk\n\u2208 M \u2229 \u2208 M\nm(A A ) mA < . (Why?) (cid:3)\nk k\n\u2229 \u2264 \u221e\nNote 2. More generally, a \u03c3-finite set A in a measure space (S, ,\u00b5)\n\u2208 M M\nis a countable union of disjoint sets of finite measure (Corollary 1 of 1).\n\u00a7\nNote 3. Not all L-measurable sets are Borel sets. On the other hand, not\nall sets in En are L-measurable (see Problems 6 and 9 below.)\nTheorem 3.\n(a) Lebesgue outer measure m\u2217 in En is -regular; that is,\nG\n(1) ( A En) m\u2217A = inf mX A X\n\u2200 \u2286 { | \u2286 \u2208 G}\n( = open sets in En).\nG\n(b) Lebesgue measure m is strongly regular (Definition 5 and Theorems 1\nand 2, all in 7).\n\u00a7\nProof. By definition, m\u2217A is the glb of all basic covering values of A. Thus\ngiven \u03b5 > 0, there is a basic covering B of nonempty sets B such that\nk k\n{ } \u2286 C\n1\n(2) A B and m\u2217A+ \u03b5 vB .\nk k\n\u2286 2 \u2265\nk\n[ X\n(Why? What if m\u2217A = ?)\n\u221e\nNow, by Lemma 1 in 2, fix for each B an open interval C B such that\nk k k\n\u00a7 \u2287\n\u03b5\nvC < vB .\nk \u2212 2k+1 k 8. Lebesgue Measure 171\n\u00a7\nThen (2) yields\n1 \u03b5 1\nm\u2217A+ \u03b5 vC = vC \u03b5;\n2 \u2265 k \u2212 2k+1 k \u2212 2\nXk (cid:16) (cid:17) Xk\nso by \u03c3-subadditivity,\n(3) m C mC = vC m\u2217A+\u03b5.\nk k k\n\u2264 \u2264\nk k k\n[ X X\nLet\nX = C .\nk\nk\n[\nThen X is open (as the C are). Also, A X, and by (3),\nk\n\u2286\nmX m\u2217A+\u03b5.\n\u2264\nThus, indeed, m\u2217A is the glb of all mX, A X , proving (a).\n\u2286 \u2208 G\nIn particular, if A \u2217, (1) shows that m is regular (for m\u2217A = mA).\n\u2208 M\nAlso, by Theorem 2, m is \u03c3-finite, and En \u2217; so (b) follows by Theorem 1\n\u2208 M\nin 7. (cid:3)\n\u00a7\nDefinition.\nGiven A En and p\u00af En, let p\u00af+A or A+p\u00afdenote the set of all points\n\u2286 \u2208\nof the form\nx\u00af+p\u00af, x\u00af A.\n\u2208\nWe call A+p\u00afthe translate of A by p\u00af.\nTheorem 4. Lebesgue outer measure m\u2217 and Lebesgue measure m in En are\ntranslation invariant. That is,\n(i) ( A En) ( p\u00af En) m\u2217A = m\u2217(A+p\u00af);\n\u2200 \u2286 \u2200 \u2208\n(ii) if A is L-measurable, so is A+p\u00af, and mA = m(A+p\u00af).\nSee also Problem 7 in 10.\n\u00a7\n\u00af\nProof. (i) If A is an interval with endpoints a\u00af and b, then A+p\u00afis the interval\n\u00af\nwith endpoints a\u00af+p\u00af and b+p\u00af. (Verify!)\nHence the edge lengths of A and A+p\u00af are the same,\n\u2113 = b a = (b +p ) (a +p ), k = 1,2,... ,n.\nk k k k k k k\n\u2212 \u2212\nThus\nn\nmA = vA = \u2113 = m(A+p\u00af);\nk\nk=1\nY\nso the theorem holds for intervals. 172 Chapter 7. Volume and Measure\nIn the general case, m\u2217A is the glb of all basic covering values of A. But a\nbasic covering consists of intervals that, when translated by p\u00af, cover A+p\u00afand\nretain the same volumes, as was shown above.\nHence any covering value for A is also one for A+p\u00af, and conversely (since\nA, in turn, is a translate of A+p\u00af by p\u00af).\n\u2212\nThus the basic covering values of A and of A+p\u00afare the same, with one and\nthe same glb. Hence\nm\u2217A = m\u2217(A+p\u00af),\nas claimed.\n(ii) Now let A \u2217. We must show that\n\u2208 M\nA+p\u00af \u2217,\n\u2208 M\ni.e., that\n( X A+p\u00af) ( Y (A+p\u00af)) m\u2217X +m\u2217Y = m\u2217(X Y).\n\u2200 \u2286 \u2200 \u2286 \u2212 \u222a\nThus fix X A+p\u00af and Y (A+p\u00af).\n\u2286 \u2286 \u2212\nAs is easily seen, X p\u00af A and Y p\u00af A (translate all by p\u00af). Since\n\u2212 \u2286 \u2212 \u2286 \u2212 \u2212\nA \u2217, we get\n\u2208 M\nm\u2217(X p\u00af)+m\u2217(Y p\u00af) = m\u2217((X Y) p\u00af).\n\u2212 \u2212 \u222a \u2212\n(Why?) But by (i), m\u2217X = m\u2217(X p\u00af), m\u2217Y = m\u2217(Y p\u00af), and\n\u2212 \u2212\nm\u2217(X Y) = m\u2217((X Y) p\u00af).\n\u222a \u222a \u2212\nHence\nm\u2217X +m\u2217Y = m\u2217(X Y),\n\u222a\nand so A+p\u00af \u2217.\n\u2208 M\nNow, as m\u2217 = m on \u2217, (i) yields mA = m(A+p\u00af), proving (ii) also. (cid:3)\nM\nProblems on Lebesgue Measure\n1. Fill in all details in the proof of Theorems 3 and 4.\n\u2032\n1 . Prove Note 2.\n2. From Theorem 3 deduce that\n( A En) ( B ) A B and m\u2217A = mB.\n\u03b4\n\u2200 \u2286 \u2203 \u2208 G \u2286\n[Hint: See the hint to Problem 7 in 5.]\n\u00a7\n3. Review Problem 3 in 5.\n\u00a7\n4. Consider all translates\nR+p (p E1)\n\u2208 8. Lebesgue Measure 173\n\u00a7\nof\nR = rationals in E1 .\n{ }\nProve the following.\n(i) Any two such translates are either disjoint or identical.\n(ii) Each R+p contains at least one element of [0,1].\n[Hint for (ii): Fix a rational y ( p,1 p), so 0<y+p<1. Then y+p R+p,\n\u2208 \u2212 \u2212 \u2208\nand y+p [0,1].]\n\u2208\n5. Continuing Problem 4, choose one element q [0,1] from each R +p.\n\u2208\nLet Q be the set of all q so chosen.\nCall a translate of Q, Q+r, \u201cgood\u201d iff r R and r < 1. Let U be\n\u2208 | |\nthe union of all \u201cgood\u201d translates of Q.\nProve the following.\n(a) There are only countably many \u201cgood\u201d Q+r.\n(b) All of them lie in [ 1,2].\n\u2212\n(c) Any two of them are either disjoint or identical.\n(d) [0,1] U [ 1,2]; hence 1 m\u2217U 3.\n\u2286 \u2286 \u2212 \u2264 \u2264\n[Hint for (c): Suppose\ny (Q+r) (Q+r\u2032).\n\u2208 \u2229\nThen\ny =q+r =q\u2032+r\u2032 (q,q\u2032 Q, r,r\u2032 R);\n\u2208 \u2208\nso q =q +(r r), with (r r) R.\n\u2032 \u2032 \u2032\n\u2212 \u2212 \u2208\nThus q R+q and q =0+q R+q . Deduce that q = q and r =r ; hence\n\u2032 \u2032 \u2032 \u2032 \u2032 \u2032\n\u2208 \u2208\nQ+r =Q+r .]\n\u2032\n6. Show that Q in Problem 5 is not L-measurable.\n[Hint: Otherwise, by Theorem 4, each Q+r is L-measurable, with m(Q+r)=mQ.\nBy 5(a)(c), U is a countable disjoint union of \u201cgood\u201d translates.\nDeduce that mU =0 if mQ=0, or mU = , contrary to 5(d).]\n\u221e\n7. Show that if f: S T is continuous, then f\u22121[X] is a Borel set in S\n\u2192\nwhenever X in T.\n\u2208 B\n[Hint: Using Note 1 in 7, show that\n\u00a7\n= X T f\u22121[X] in S\nR { \u2286 | \u2208B }\nis a \u03c3-ring in T. As is the least \u03c3-ring , (the Borel field in T.]\nB \u2287G R\u2287B\n8. Prove that every degenerate interval in En has Lebesgue measure 0,\neven if it is uncountable. Give an example in E2. Prove uncountability.\n[Hint: Take a\u00af =(0,0),\u00afb=(0,1). Define f: E1 E2 by f(x)=(0,x). Show that f\nis one-to-one and that [a\u00af,\u00afb] is the f-image of [0,\u2192 1]. Use Problem 2 of Chapter 1, 9.]\n\u00a7 174 Chapter 7. Volume and Measure\n9. Show that not all L-measurable sets are Borel sets in En.\n[Hint for E2: With [a\u00af,\u00afb] and f as in Problem 8, show that f is continuous (use the\nsequential criterion). As m[a\u00af,\u00afb] = 0, all subsets of [a\u00af,\u00afb] are in (Theorem 2(i)),\n\u2217\nM\nhence in if we assume = . But then by Problem 7, the same would apply to\n\u2217\nB M B\nsubsets of [0,1], contrary to Problem 6.\nGive a similar proof for En (n>1).\nNote: In E1, too, = , but a different proof is necessary. We omit it.]\n\u2217\nB 6 M\n10. Show that Cantor\u2019s set P (Problem 17 in Chapter 3, 14) has Lebesgue\n\u00a7\nmeasure zero, even though it is uncountable.\n[Outline: Let\nU =[0,1] P;\n\u2212\nso U is the union of open intervals removed from [0,1]. Show that\n1 \u221e 2 n\nmU = =1\n2 3\nn X=1(cid:16) (cid:17)\nand use Lemma 1 in 4.]\n\u00a7\n11. Let \u00b5: E\u2217 be the Borel restriction of Lebesgue measure m in En\nB \u2192\n( 7). Prove that\n\u00a7\n(i) \u00b5 in incomplete;\n(ii) m is the Lebesgue extension (\u2217and completion, as in Problem 15\nof 6) of \u00b5.\n\u00a7\n[Hints: (i) By Problem 9, some \u00b5-null sets are not in . (ii) See the proof (end) of\nB\nTheorem 2 in 9 (the next section).]\n\u00a7\n12. Prove the following.\n(i) All intervals in En are Borel sets.\n(ii) The \u03c3-ring generated by any one of the families or \u2032 in\nC C\nProblem 3 of 5 coincides with the Borel field in En.\n\u00a7\n[Hints: (i)Anyintervalarisesfromaclosed onebydroppingsome\u201cfaces\u201d(degenerate\nclosed intervals). (ii) Use Lemma 2 from 2 and Problem 7 of 3.]\n\u00a7 \u00a7\n\u2217 13. Show that if a measure m\u2032: \u2032 E\u2217 in En agrees on intervals with\nM \u2192\nLebesgue measure m: \u2217 E\u2217, then the following are true.\nM \u2192\n(i) m\u2032 = m on , the Borel field in En.\nB\n(ii) If m\u2032 is also complete, then m\u2032 = m on \u2217.\nM\n[Hint: (i) Use Problem 13 of 5 and Problem 12 above.]\n\u00a7\n14. Show that globes of equal radius have the same Lebesgue measure.\n[Hint: Use Theorem 4.]\n15. Let f: En En, with\n\u2192\nf(x\u00af) = cx\u00af (0 < c < ).\n\u221e 8. Lebesgue Measure 175\n\u00a7\nProve the following.\n(i) ( A En) m\u2217f[A] = cnm\u2217A (m\u2217 = Lebesgue outer measure).\n\u2200 \u2286\n(ii) A \u2217 iff f[A] \u2217.\n\u2208 M \u2208 M\n[Hint: If, say, A = (a\u00af,\u00afb], then f[A] = (ca\u00af,c\u00afb]. (Why?) Proceed as in Theorem 4,\nusing f 1 also.]\n\u2212\n16. From Problems 14 and 15 show that\n(i) mG (cr) = cn mG (r);\np\u00af p\u00af\n\u00b7\n(ii) mG (r) = mG (r);\np\u00af p\u00af\n(iii) mG (r) = a mI, where I is the cube inscribed in G (r) and\np\u00af p\u00af\n\u00b7\n1 n\na = \u221an mG (1).\n\u00af0\n2 \u00b7\n(cid:16) (cid:17)\n[Hints: (i) f[G\u00af0(r)]=G\u00af0(cr). (ii) Prove that\nmGp\u00af mGp\u00af cnmGp\u00af\n\u2264 \u2264\nif c>1. Let c 1.]\n\u2192\n17. Given a < b in E1, let r be the sequence of all rationals in A = [a,b].\nn\n{ }\nSet ( n)\n\u2200\nb a\n\u03b4 = \u2212\nn 2n+1\nand\n1 1\nG = (a ,b ) = (a,b) r \u03b4 , r + \u03b4 .\nn n n n n n n\n\u2229 \u2212 2 2\n(cid:16) (cid:17)\nLet\n\u221e\nP = A G .\nn\n\u2212\nn=1\n[\nProve the following.\n(i) \u221e \u03b4 = 1(b a) = 1mA.\nn=1 n 2 \u2212 2\n(ii) P is closed; Po = , yet mP > 0.\nP\n\u2205\n(iii) The G can be made disjoint (see Problem 3 in 2), with mP still\nn\n\u00a7\n> 0.\n(iv) Construct such a P A (P = P, Po = ) of prescribed measure\n\u2286 \u2205\nmP = \u03b5 > 0.\n18. Find an open set G E1, with mG < mG < .\n\u2282 \u221e\n[Hint: G= \u221en=1Gn with Gn as in Problem 17.]\n\u2217 19. If A EnSis open and convex, then mA = mA.\n\u2286\n[Hint: Let first \u00af0 A. Argue as in Problem 16.]\n\u2208 176 Chapter 7. Volume and Measure\n\u00a79. Lebesgue\u2013Stieltjes Measures\nLet\n\u03b1: E1 E1\n\u2192\nbe a nondecreasing function (\u03b1 ). Consider the Lebesgue\u2013Stieltjes set function\n\u2191\ns (Example (d) in 4).\n\u03b1\n\u00a7\nAs we noted in Problem 7 of 4, s 0 when \u03b1 ; for then\n\u03b1\n\u00a7 \u2265 \u2191\ns (a,b) = \u03b1(b ) \u03b1(a+) 0.\n\u03b1\n\u2212 \u2212 \u2265\nSimilarly for other intervals. Also, and s = 0 by definition.\n\u03b1\n\u2205 \u2208 C \u2205\nThus s is a premeasure on (finite intervals in E1), called the \u03b1-induced\n\u03b1\nC\nLebesgue\u2013Stieltjes (LS) premeasure in E1.\nThe outer measure m\u2217 induced by s ( 5) is called the \u03b1-induced LS outer\n\u03b1 \u03b1 \u00a7\nmeasure; itsrestrictiontothefamily \u2217 ofm\u2217-measurable(orLS-measurable)\nM\u03b1 \u03b1\nsets is the \u03b1-induced LS measure on E1, denoted m .\n\u03b1\nRecall that, by our definitions, premeasures, outer measures, and measures\nare all nonnegative.\nNote 1. No generality is lost by assuming that \u03b1 is right continuous (if not,\nreplace it by the right-continuous function \u03b2 , with \u03b2(x) = \u03b1(x+)). Similarly,\n\u2191\none achieves left continuity by setting \u03b2(x) = \u03b1(x ).\n\u2212\nNote 2. If \u03b1 is right continuous, one often restricts s to the family \u2217 of\n\u03b1\nC\nall half-open intervals (for motivation, see Problem 7(iv) in 4). This does not\n\u00a7\naffect m\u2217 or m (Problem 3\u2032 in 5), and simplifies the proof of additivity\n\u03b1 \u03b1 \u00a7\ns (a,b]+s (b,c] = \u03b1(b) \u03b1(a)+\u03b1(c) \u03b1(b) = \u03b1(c) \u03b1(a) = s (a,c].\n\u03b1 \u03b1 \u03b1\n\u2212 \u2212 \u2212\nRecall that both and \u2217 are semirings (Note 1 in 1).\nC C \u00a7\nTheorem 1. The LS premeasure s is \u03c3-additive on the semiring of all\n\u03b1\nC\nfinite intervals in E1.\nHence (by Theorem 2 in 6) all such intervals are LS-measurable ( \u2217),\n\u00a7 C \u2286 M\u03b1\nand\nm A = s A\n\u03b1 \u03b1\nfor any such interval A.\nProof. As is easily seen, s is additive (Problem 7 of 4).\n\u03b1\n\u00a7\nIt also satisfies Lemma 1 of 1 and Lemma 1 in 2 (Problem 7(v) in 4).\n\u00a7 \u00a7 \u00a7\nThe proof of \u03c3-additivity is then quite analogous to that of Theorem 1 of 2;\n\u00a7\nwe omit its repetition.\nThe rest is immediate by Theorem 2 of 6. (cid:3)\n\u00a7 9. Lebesgue\u2013Stieltjes Measures 177\n\u00a7\nSimilarly, the proofs of Theorems 2 and 3 (but not 4) of 8 carry over to\n\u00a7\nLS measures. Thus LS measures are complete, topological, totally \u03c3-finite and\nstrongly regular.\nAs in 8, it follows that singletons and countable sets are measurable, but\n\u00a7\ntheir LS measure need not be 0 (Problem 8(iii) in 4).\n\u00a7\nAlso, E1 \u2217, but m E1 may be finite (Problem 8(ii)(ii\u2032) in 4).\n\u2208 M\u03b1 \u03b1 \u00a7\nSince the proofs are the same as in 8, we omit them.\n\u00a7\nNote, however, the following facts.\n(i) For singletons, m p = 0 iff \u03b1 is continuous at p (Problem 7(ii) in 4).\n\u03b1\n{ } \u00a7\n(ii) Hence\nm [a,b] = m (a,b] = m [a,b) = m (a,b) = \u03b1(b) \u03b1(a)\n\u03b1 \u03b1 \u03b1 \u03b1\n\u2212\niff \u03b1 is continuous at a and b (Problem 7(iv) in 4).\n\u00a7\n(iii) LS measures need not be translation invariant (Problem 8(i) of 4).\n\u00a7\n(iv) If \u03b1(x) = x on E1, then m\u2217 = m\u2217 (= Lebesgue outer measure in E1).\n\u03b1\nThus Lebesgue measure is a special case of LS measure.\nThe latter is a kind of \u201cweighted length.\u201d Imagine that mass is distributed\nalong the line, with \u03b1(x) equal to the mass of\n( ,x].\n\u2212\u221e\nFor simplicity, assume that \u03b1 is right-continuous (cf. Notes 1 and 2). Then the\nmass of (a,b] is\n\u03b1(b) \u03b1(a),\n\u2212\nand p is a \u201cpoint mass\u201d iff\nm p > 0.\n\u03b1\n{ }\nOurnexttheoremshowsthatLSmeasurespracticallyexhaustalltopological\nmeasures in E1 of any importance. We shall use Notes 1 and 2 above.\n\u2217Theorem 2. Let m: E\u2217 be a topological measure in E1, finite on \u2217\nM \u2192 C\n(half-open intervals). Then there is an LS measure m such that\n\u03b1\nm = m\n\u03b1\non the Borel field in E1.\nB\nIf m is also complete, then m = m on all of \u2217.\n\u03b1 M\u03b1\nProof. Define \u03b1 as follows:\nm(0,x] if x 0,\n\u03b1(x) = \u2265\nm(x,0] if x < 0.\n(cid:26) \u2212\nClearly, \u03b1 on E1. Also, the right continuity of m (Theorem 2 of 4) implies\n\u2191 \u00a7\nthat of \u03b1. (Verify!) 178 Chapter 7. Volume and Measure\nThus \u03b1 induces an LS measure m , with\n\u03b1\nm (a,b] = s (a,b] = \u03b1(b) \u03b1(a)\n\u03b1 \u03b1\n\u2212\n(Problem 7(iv) in 4). We claim that m = m on .\n\u03b1\n\u00a7 B\nFirst, consider any (a,b] \u2217. If 0 a b, then\n\u2208 C \u2264 \u2264\nm(a,b] = m(0,b] m(0,a] = \u03b1(b) \u03b1(a) = m (a,b].\n\u03b1\n\u2212 \u2212\nSimilarly in the cases a < 0 b and a b < 0. Thus\n\u2264 \u2264\nm = m (finite) on \u2217.\n\u03b1\nC\nBy Problem 13 in 5,\n\u00a7\nm = m on ,\n\u03b1\nB\nthe \u03c3-ring generated by \u2217 (Problem 12 of 8). Thus m and m have the same\n\u03b1\nC \u00a7\nrestriction to (call it \u00b5).\nB\nNow, by Note 3 in 6, \u00b5 induces an outer measure \u00b5\u2217.\n\u00a7\nAs \u2217, both \u00b5\u2217 and m\u2217 are -regular, by Theorem 3 in 5. Thus\nB \u2287 C\u03c3 \u03b1 B \u00a7\n( A E1) m\u2217(A) = inf \u00b5X A X B = \u00b5\u2217A,\n\u2200 \u2286 \u03b1 { | \u2286 \u2208 }\ni.e., m\u2217 = \u00b5\u2217, and so m is the restriction of both m\u2217 and \u00b5\u2217 to measurable\n\u03b1 \u03b1 \u03b1\nsets. Hence m is the Lebesgue extension of \u00b5, by definition.\n\u03b1\nBy Problem 17 in 6, m = \u00b5 is the \u201cleast\u201d complete extension of \u00b5. Thus\n\u03b1\n\u00a7\nif m is complete, it is an extension of m ; so m = m on \u2217, as claimed. (cid:3)\n\u03b1 \u03b1 M\u03b1\nProblems on Lebesgue\u2013Stieltjes Measures\n1. Do Problems 7 and 8 in 4 and Problem 3\u2032 in 5, if not done before.\n\u00a7 \u00a7\n2. Prove in detail Theorems 1 to 3 in 8 for LS measures and outer mea-\n\u00a7\nsures.\n3. Do Problem 2 in 8 for LS-outer measures in E1.\n\u00a7\n4. Prove that f: E1 (S,\u03c1) is right (left) continuous at p iff\n\u2192\nlim f(x ) = f(p) as x p (x p).\nn n n\nn\u2192\u221e \u0581 \u0580\n[Hint: Modify the proof of Theorem 1 in Chapter 4, 2.]\n\u00a7\n5. Fill in all proof details in Theorem 2.\n[Hint: Use Problem 4.]\n6. In Problem 8(iv) of 4, describe m\u2217 and M\u2217.\n\u00a7 \u03b1 \u03b1\n7. Show that if \u03b1 = c (constant) on an open interval I E1 then\n\u2286\n( A I) m\u2217(A) = 0.\n\u2200 \u2286 \u03b1\nDisprove it for nonopen intervals I (give a counterexample). 9. Lebesgue\u2013Stieltjes Measures 179\n\u00a7\n8. Let m\u2032: E\u2217 be a topological, translation-invariant measure in E1,\nM \u2192\nwith m\u2032(0,1] = c < . Prove the following.\n\u221e\n(i) m\u2032 = cm on the Borel field . (Here m: \u2217 E\u2217 is Lebesgue\nB M \u2192\nmeasure in E1.)\n\u2217(ii) If m\u2032 is also complete, then m\u2032 = cm on \u2217.\nM\n(iii) If 0 < c < , some set Q [0,1] is not m\u2032-measurable.\n\u221e \u2282\n\u2217(iv) If \u2032 = , then cm is the completion of m\u2032 (Problem 15 in 6).\nM B \u00a7\n[Outline: (i) By additivity and translation invariance,\nm\u2032(0,r]=cm(0,r]\nfor rational\nn\nr = , n,k N\nk \u2208\n(first take r =n, then r = 1, then r = n).\nk k\nBy right continuity (Theorem 2 in 4), prove it for real r > 0 (take rationals\n\u00a7\nri r).\n\u0581\nBy translation, m =cm on half-open intervals. Proceed as in Problem 13 of 8.\n\u2032\n\u00a7\n(iii) See Problems 4 to 6 in 8. Note that, by Theorem 2, one may assume\n\u00a7\nm =m\u03b1 (a translation-invariant LS measure). As m\u03b1 =cm on half-open intervals,\n\u2032\nLemma 2 in \u00a72 yields m\u03b1 = cm on (open sets). Use G-regularity to prove m =\n\u2217\u03b1\nG\ncm and = .]\n\u2217 M\u2217\u03b1 M\u2217\n\u2217 9. (LS measures in En.) Let\n\u2217 = half-open intervals in En .\nC { }\nFor any map G: En E1 and any (a\u00af,\u00af b] \u2217, set\n\u2192 \u2208 C\n\u00af\n\u2206 G(a\u00af,b] = G(x ,... ,x ,b ,x ,... ,x )\nk 1 k\u22121 k k+1 n\nG(x ,... ,x ,a ,x ,... ,x ), 1 k n.\n1 k\u22121 k k+1 n\n\u2212 \u2264 \u2264\nGiven \u03b1: En E1, set\n\u2192\n\u00af \u00af\ns (a\u00af,b] = \u2206 (\u2206 ( (\u2206 \u03b1(a\u00af,b]) )).\n\u03b1 1 2 n\n\u00b7\u00b7\u00b7 \u00b7\u00b7\u00b7\nFor example, in E2,\ns (a,b] = \u03b1(b ,b ) \u03b1(b ,a ) [\u03b1(a ,b ) \u03b1(a ,a )].\n\u03b1 1 2 1 2 1 2 1 2\n\u2212 \u2212 \u2212\nShow that s is additive on \u2217. Check that the order in which the \u2206\n\u03b1 k\nC\nare applied is immaterial. Set up a formula for s in E3.\n\u03b1\n[Hint: First take two disjoint intervals\n(a\u00af,q\u00af] (p\u00af,\u00afb]=(a\u00af,\u00afb],\n\u222a\nasinFigure2inChapter3, 7. Thenuseinduction,asinProblem9ofChapter3, 7.]\n\u00a7 \u00a7 180 Chapter 7. Volume and Measure\n\u2217\n10. If s in Problem 9 is nonnegative, and \u03b1 is right continuous in each\n\u03b1\nvariable x separately, we call \u03b1 a distribution function, and s is called\nk \u03b1\nthe \u03b1-induced LS premeasure in En; the LS outer measure m\u2217 and\n\u03b1\nmeasure\nm : \u2217 E\u2217\n\u03b1 M\u03b1 \u2192\nin En (obtained from s as shown in 5 and 6) are said to be induced\n\u03b1\n\u00a7\u00a7\nby \u03b1.\nFor s , m\u2217, and m so defined, redo Problems 1\u20133 above.\n\u03b1 \u03b1 \u03b1\n\u2217\n\u00a710. Vitali Coverings\nLebesgue measure m leads to an interesting analogue of the Heine\u2013Borel the-\norem. Below, m\u2217 is Lebesgue outer measure in En. We start with some\ndefinitions.\nDefinition 1.\nA sequence I of sets in a metric space (S,\u03c1) converges to a point p\nk\n{ }\n(I p) iff\nk\n\u2192\n\u221e\np I\nk\n\u2208\nk=1\n\\\nand\nlim dI = 0,\nk\nk\u2192\u221e\nwhere dI = diameter of I .\nk k\nDefinition 2.\nA family of nonempty sets in (S,\u03c1) is a Vitali covering (V-covering)\nK\nof a set A (S,\u03c1) iff for each p A there is a sequence I , with\nk\n\u2286 \u2208 { } \u2286 K\nI p.\nk\n\u2192\nWe then also say that covers A in the Vitali sense (V-sense).\nK\nTheorem 1 (Vitali). If a set of nondegenerate cubes (or globes) in En\nK\ncovers A in the V-sense, then\nm\u2217(A I ) = 0\nk\n\u2212\nk\n[\nfor some disjoint sequence I .\nk\n{ } \u2286 K\nProof. We give the proof for cubes (it is similar for globes).\nFirst, suppose A Io for some open cube Io. Then A is also covered in the\n\u2286\nV-sense by the subfamily o of those cubes that lie in Io. (Why?) We also\nK \u2286 K 10. Vitali Coverings 181\n\u2217\n\u00a7\nassume that A * I for any disjoint finite sequence I (otherwise, all\nj j\n{ } \u2286 K\nis trivial). Finally , we assume that all cubes in are closed; for other kinds\nS K\nof cubes, the theorem then easily follows (see Problem 3 below).\nWe claim that\nh\n(1) ( disjoint cubes I ,... ,I o) ( I o) I I = .\n1 h j\n\u2200 \u2208 K \u2203 \u2208 K \u2229 \u2205\nj=1\n[\nIndeed, as\nh\nA * I ,\nj\nj=1\n[\nthere is some\nh\np\u00af A I .\nj\n\u2208 \u2212\nj=1\n[\nBy assumption, all I are closed; so\nj\nh\nI\nj\n\u2212\nj=1\n[\nis open. Hence there is a globe\nh\nG (\u03b4) I .\np\u00af j\n\u2286 \u2212\nj=1\n[\nAs o is a V-covering, it contains a sequence I p\u00af, dI 0; so there is\ni i\nK \u2192 \u2192\nI = I o with p\u00af I and dI < \u03b4. Therefore,\ni\n\u2208 K \u2208\nh\nI G (\u03b4) I ;\np\u00af j\n\u2286 \u2286 \u2212\nj=1\n[\nso\nh\nI I = ,\nj\n\u2229 \u2205\nj=1\n[\nas claimed.\nNow, using induction, suppose we have already fixed k disjoint cubes I in\nj\no. By (1), there are cubes I o with\nK \u2208 K\nk\nI I = .\nj\n\u2229 \u2205\nj=1\n[ 182 Chapter 7. Volume and Measure\nLet \u03b4 be the lub of their diameters. As all I o lie in Io,\nk\n\u2208 K\nk\n\u03b4 = sup dI I o, I I dIo < .\nk j\n\u2208 K \u2286 \u2212 \u2264 \u221e\n(cid:26) (cid:12) j=1 (cid:27)\n(cid:12) [\n(cid:12)\nHence by properties of the l(cid:12)ub, we find a cube I o such that\nk+1\n\u2208 K\nk\nI I\nk j\n\u2286 \u2212\nj=1\nand dI > 1\u03b4 . [\nk+1 2 k\nIn this way, taking k = 1,2,..., we select a disjoint sequence I o\nk\n{ } \u2286 K\nwith dI > 1\u03b4 for all k. We shall show that\nk+1 2 k\n\u221e\nm\u2217 A I = 0\nk\n\u2212\n(cid:18) k=1 (cid:19)\n[\nin four steps.\n(I) Let \u2113 be the edge length of I ; so dI = \u2113 \u221an. (Why?)\nk k k k\nEnclose each I in a cube J with the\nk k\nJ\nsame center and with edge length k\n(4n+1)\u2113 .\nk\nThen \u2113 k\n( x\u00af I ) ( y\u00af J )\nk k\n\u2200 \u2208 \u2200 6\u2208 I k x\u00af 4\u2113 k y\u00af\n(2) \u03c1(x\u00af,y\u00af) > 2n\u2113 2\u2113 \u221an\nk k\n\u2265\n= 2dI > \u03b4 .\nk k\u22121\n(See Figure 32, where n = 2.) Also,\n9\u2113\nk\nmJ = (4n+1)nmI .\nk k\n(II) As the I lie in Io, the \u03c3-additivity of m yieldsFigure 32\nk\n\u221e \u221e\nmJ = (4n+1)n mI\nk k\nk=1 k=1\nX X\n\u221e\n= (4n+1)nm I\nk\nk=1\n[\n(4n+1)nmIo < .\n\u2264 \u221e\nThus the series mJ converges; so its \u201cremainder\u201d tends to 0:\nk\n\u221e\nP\nlim mJ = 0.\nk\nr\u2192\u221e\nk=r\nX 10. Vitali Coverings 183\n\u2217\n\u00a7\nAlso, mJ 0. But by definition,\nk\n\u2192\n\u03b4 < 2dI < 2dJ = 2\u221an(mJ )1/n (n fixed).\nk k+1 k+1 k+1\nHence lim \u03b4 = 0, too.\nk\nk\u2192\u221e\n(III) Now, seeking a contradiction, suppose\n\u221e\nm\u2217 A I > 0.\nk\n\u2212\n(cid:18) k=1 (cid:19)\n[\nThen as\n\u221e\nlim mJ = 0,\nk\nr\u2192\u221e\nk=r\nX\nthere is r such that\n\u221e \u221e \u221e\nm J mJ < m\u2217 A I .\nk k k\n\u2264 \u2212\nk=r k=r (cid:18) k=1 (cid:19)\n[ X [\nHence\n\u221e \u221e\nA I * J .\nk k\n\u2212\nk=1 k=r\n[ [\n(Why?) Thus there is\n\u221e\np\u00af A I\nk\n\u2208 \u2212\nk=1\n[\nnot in\n\u221e\nJ ,\nk\nk=r\n[\nso that\n\u221e \u221e\n(3) ( k r) p\u00af= J , p\u00af A, and p\u00af I I .\nk k k\n\u2200 \u2265 6 \u2208 \u2208 \u2212 \u2286 \u2212\nk=1 k=r\n[ [\nAs\nr\nI ,\nk\n\u2212 \u2208 G\nk=1\n[\nwe find (as before) a cube K o such that p\u00af K and\n\u2208 K \u2208\nr\nK I = .\nk\n\u2229 \u2205\nk=1\n[ 184 Chapter 7. Volume and Measure\nAlso, as \u03b4 0, we have \u03b4 < dK for large k. But by our choice of the \u03b4 , this\nk k k\n\u2192\nimplies\nk\nK I =\nj\n\u2229 6 \u2205\nj=1\n[\nfor large k (why?), whereas\nr\nK I = ,\nj\n\u2229 \u2205\nj=1\n[\nas shown above.\nThus there is a least k > r, call it q, such that\nK I = ,\nq\n\u2229 6 \u2205\nand \u03b4 < dK \u03b4 .\nq q\u22121\n\u2264\nBy (3), p\u00af J . As\nq\n6\u2208\nK I = ,\nq\n\u2229 6 \u2205\nlet x\u00af K I . Since x\u00af,p\u00af K,\nq\n\u2208 \u2229 \u2208\n\u03c1(x\u00af,p\u00af) dK < \u03b4 .\nq\u22121\n\u2264\nBut as x\u00af I and p\u00af J , we have\nq k\n\u2208 6\u2208\n\u03c1(x\u00af,p\u00af) > \u03b4\nq\u22121\nby (2).\nThis contradiction proves the theorem for bounded sets A.\n(IV) If A is not bounded, use Lemma 2 in 2 to find a sequence K of\ni\n\u00a7 { }\ndisjoint half-open intervals with\nK = En A.\ni\n\u2287\n[\nLet\nA = A Ko,\ni \u2229 i\nwhere Ko is the open interval with the same endpoints; so mK = mKo and\ni i i\nm(K Ko) = 0.\ni \u2212 i\nSet\n\u221e\nZ = (K Ko);\ni \u2212 i\ni=1\n[\nso mZ = 0 and\n\u221e\nKo = En Z.\ni \u2212\ni=1\n[ 10. Vitali Coverings 185\n\u2217\n\u00a7\n(Why?) As A = A Ko, we have\ni \u2229 i\n\u221e \u221e\n(4) A = A Ko = A (En Z) = A Z.\ni \u2229 i \u2229 \u2212 \u2212\ni=1 i=1\n[ [\nClearly, each A is covered in the V-sense by those -cubes that lie in Ko.\ni K i\nThus as shown above,\n( i) m\u2217 A I = 0\nij\n\u2200 \u2212\n(cid:18) j (cid:19)\n[\nfor disjoint cubes I Ko. That is,\nij \u2286 i\n( i) I Z A ,\nij i i\n\u2200 \u222a \u2287\nj\n[\nwhere\nZ = A I\ni i ij\n\u2212\nj\n[\nand mZ = 0. Hence by (4),\ni\n\u221e\nI Z A = A Z,\nij i i\n\u222a \u2287 \u2212\ni=1 j i i\n[ [ [ [\nso that\nm\u2217 A I = 0.\nij\n\u2212\n(cid:18) i,j (cid:19)\n[\nRearranging the I in a single sequence I , we complete the proof. (cid:3)\nij k\n{ }\nTheorem 2. If m\u2217A < in Theorem 1, then for every \u03b5 > 0 there is a finite\n\u221e\ndisjoint sequence I such that\nk\n{ } \u2286 K\nm\u2217 A I < \u03b5.\nk\n\u2212\n(cid:18) k (cid:19)\n[\nProof. Fix \u03b5 > 0. As m\u2217A < , the -regularity of m\u2217 (Theorem 3 of 8)\n\u221e G \u00a7\nyields an open G A such that\n\u2287\nmG < m\u2217A+\u03b5.\nClearly, A is covered in the V-sense by the subfamily o of those -sets that\nK K\nlie in G. Thus by Theorem 1,\nm\u2217 A I = 0\nk\n\u2212\n(cid:16) [ (cid:17) 186 Chapter 7. Volume and Measure\nfor a disjoint sequence I o. Also,\nk\n{ } \u2286 K\nI G,\nk\n\u2286\n[\nand so\nmI = m I mG < .\nk k\n\u2264 \u221e\nX [\nThus mI converges; so\nk\n\u221e\nP mI < \u03b5\nk\nk=r\nX\nfor large r.\nOn the other hand,\nr \u221e \u221e\nA I A I I .\nk k k\n\u2212 \u2286 \u2212 \u222a\nk=1 (cid:18) k=1 (cid:19) k=r\n[ [ [\nHence\nr \u221e \u221e \u221e\nm\u2217 A I m\u2217 A I +m\u2217 I 0+ mI < \u03b5,\nk k k k\n\u2212 \u2264 \u2212 \u2264\n(cid:18) k=1 (cid:19) (cid:18) k=1 (cid:19) k=r k=r\n[ [ [ X\nas required. (cid:3)\nAs an application, we obtain the following important theorem.\nTheorem 3 (Lebesgue). If f: E1 E1 is monotone, it is differentiable al-\n\u2192\nmost everywhere (\u201ca.e.\u201d), i.e., on E1 Z for some Z of Lebesgue measure\n\u2212\nzero.\nWe sketch the proof in a few steps (lemmas). These lemmas anticipate a\nmore general approach to be taken in 12, with the notation in the following\n\u00a7\ndefinition.\nDefinition 3.\nLet m = Lebesgue measure and\n= all cubes I En with mI > 0 .\nK { \u2282 }\nLet\ns: \u2032 [0, ], \u2032 ,\nM \u2192 \u221e M \u2287 K\nbe another measure in En, finite on .\nK\nFor any natural r > 0, and p\u00af En, we set\n\u2208\nsI 1\ng (p\u00af) = inf p\u00af I , dI <\nr\nmI \u2208 \u2208 K r\n(cid:26) (cid:12) (cid:27)\n(cid:12)\n(cid:12)\n(cid:12) 10. Vitali Coverings 187\n\u2217\n\u00a7\nand\nsI 1\nh (p\u00af) = sup p\u00af I , dI < ;\nr\nmI \u2208 \u2208 K r\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nfurthermore, we denote (cid:12)\n(cid:12)\nDs(p\u00af) = supg (p\u00af) and Ds(p\u00af) = infh (p\u00af).\nr r\nr r\nClearly, g , h , and\nr r\n{ }\u2191 { }\u2193\n0 Ds = lim g lim h = Ds\nr r\n\u2264 r\u2192\u221e \u2264 r\u2192\u221e\nat each p\u00af En. (Why?)\n\u2208\nWe also write J(Ds > i) for\nx\u00af J Ds(x\u00af) > i ,\n{ \u2208 | }\nJ(Ds = a) for\nx\u00af J Ds(x\u00af) = a ,\n{ \u2208 | }\netc.\nLemma 1. With the above notation, 0 Ds Ds < a.e. on En.\n\u2264 \u2264 \u221e\nProof Outline. Fixanyopen setJ En, withmJ < andsJ < (e.g.,an\n\u2282 \u221e \u221e\nopen cube in ).\nK\nFor i = 1,2,... set\nA = J(Ds > i)\ni\nand\nsI\n= I I J, > i .\ni\nK \u2208 K \u2286 mI\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nVerify that is a V-covering of A ;(cid:12)so there is a disjoint sequence I ,\nKi i (cid:12) { k } \u2286 Ki\nwith\nm\u2217 A I = 0\ni k\n\u2212\n(cid:16) [ (cid:17)\nand\nI J.\nk\n\u2286\n[\nHence (cf. Problem 3 below)\n1 1 sJ\nm\u2217A m I = mI sI = s I , i = 1,2,....\ni k k k k\n\u2264 \u2264 i i \u2264 i\n[ X X [\nIt follows that\n\u221e\nm\u2217 A = 0.\ni\ni=1\n\\ 188 Chapter 7. Volume and Measure\n(Why?) But\n\u221e\nA = J(Ds = ).\ni\n\u221e\ni=1\n\\\n(Why?) This implies that\nm\u2217J(Ds = ) = 0,\n\u221e\nand so Ds < on J, except for a null set.\n\u221e\nBut by Lemma 2 in 2, all of En is a countable union of such sets J (open\n\u00a7\ncubes). Thus Ds < on En Z, where Z is a countable union of null sets:\n\u221e \u2212\nmZ = 0.\nAs 0 Ds Ds on all of En, we have\n\u2264 \u2264\n0 Ds Ds < a.e. on En,\n\u2264 \u2264 \u221e\nas claimed. (cid:3)\nLemma 2. With the same notation, Ds = Ds a.e. on En.\nProof Outline. With J as in the previous proof, let\nH = J(Ds > Ds).\nThen H is a countable union of sets\nH = J(Ds > v > u > Ds)\nuv\nover rational u,v. Thus it suffices to show that all such H are m-null.\nuv\nLet Q be one of them; so Q J and\n\u2286\nm\u2217Q mJ < .\n\u2264 \u221e\nHence given \u03b5 > 0, there is an open set G J with G Q and\n\u2286 \u2287\nmG < m\u2217Q+\u03b5.\n(Why?) We fix this G and set\nsI\n= I I G, < u .\nK \u2208 K \u2286 mI\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nBy the definition of Ds, is a V-co(cid:12)vering of Q (verify!); so by Problem 3,\nK (cid:12)\nm\u2217 Q Io = m\u2217Q\n\u2229 k\n(cid:16) [ (cid:17)\nfor a disjoint sequence\nI , I G.\nk k\n{ } \u2286 K \u2286\n[ 10. Vitali Coverings 189\n\u2217\n\u00a7\nLet\n\u221e\nG\u2032 = Io\nk\nk=1\n[\n(an open set), and Q = Q G\u2032; so\no\n\u2229\nm\u2217Q = m\u2217Q mG\u2217 mG < m\u2217Q+\u03b5.\no\n\u2264 \u2264\n(Explain!)\nNext, let\nsI\n\u2032 = I I G\u2032, > v\nK \u2208 K \u2286 mI\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nIt is a V-covering of Q (why?); so (cid:12)\no (cid:12)\nm\u2217 Q I\u2032 = 0\no \u2212 k\n(cid:16) [ (cid:17)\nfor a disjoint sequence I\u2032 \u2032. Verify that\n{ k} \u2286 K\nu (m\u2217Q+\u03b5) > u mG\u2032 = u mIo\n\u00b7 \u00b7 \u00b7 k\nsIo = sG\u2032X\n\u2265 k\nXsI\u2032\n\u2265 k\nXv mI\u2032 = v m I\u2032\n\u2265 \u00b7 k \u00b7 k\nv mX\u2217 Q I\u2032 [ = v m\u2217Q = v m\u2217Q.\n\u2265 \u00b7 o \u2229 k \u00b7 o \u00b7\n(cid:16) [ (cid:17)\nThus\n( \u03b5 > 0) u (m\u2217Q+\u03b5) v m\u2217Q.\n\u2200 \u00b7 \u2265 \u00b7\nMaking \u03b5 0, we get\n\u2192\nu m\u2217Q v m\u2217Q.\n\u00b7 \u2265 \u00b7\nAs u < v, m\u2217A must be 0. This is the desired result. (cid:3)\nProof of Theorem 3. To fix ideas, let f .\n\u2191\nLet s = m be the f-induced LS measure in E1 ( 9) so that\nf\n\u00a7\ns[p,x] = f(x+) f(p ).\n\u2212 \u2212\nBy Lemmas 1 and 2, it suffices to show that f is differentiable at every p E1,\n\u2208\nwith\nDs(p) = Ds(p) = .\n6 \u221e\nFix any such p and set\nq = Ds(p) = Ds(p) = .\n6 \u221e 190 Chapter 7. Volume and Measure\nThen f is continuous at p; for otherwise,\nf(p+) f(p ) > 0,\n\u2212 \u2212\nwhence\nDs(p) = .\n\u221e\n(Why?) Also, by Definition 3, given \u03b5 > 0, there is a natural r such that\nq \u03b5 < g (p) h (p) < q +\u03b5.\nr r\n\u2212 \u2264\nLet\n1\nx G .\n\u00acp\n\u2208 r\n(cid:16) (cid:17)\nIf x > p, then\n\u2206x = x p = m[p,x],\n\u2212\nand by continuity,\n\u2206f = f(x) f(p) f(x+) f(p)\n\u2212 \u2264 \u2212\n= f(x+) f(p ) = s[p,x]\n\u2212 \u2212\n\u2206x h (p) < \u2206x(q +\u03b5).\nr\n\u2264 \u00b7\nAlso, if x > y > p, then\n\u2206f f(y+) f(p ) = s[p,y] \u2206y g (p) > \u2206y(q \u03b5),\nr\n\u2265 \u2212 \u2212 \u2265 \u00b7 \u2212\nwhere\n\u2206y = y p = m[p,y].\n\u2212\nMaking y x, with x fixed, we get\n\u0580\n(q \u03b5)\u2206x \u2206f < (q +\u03b5)\u2206x.\n\u2212 \u2264\nSimilarly in the case x < p.\nThus with \u03b5 0, we obtain\n\u2192\n\u2206f\nf\u2032(p) = lim = q = . (cid:3)\nx\u2192p \u2206x 6 \u221e\nProblems on Vitali Coverings\n1. Prove Theorem 1 for globes, filling in all details.\n[Hint: Use Problem 16 in 8.]\n\u00a7\n\u21d22. Show that any (even uncountable) union of globes or nondegenerate\ncubes J En is L-measurable.\ni\n\u2282\n[Hint: Includein eachglobe(cube)thatliesinsomeJi. ThenTheorem1represents\nK\nJi as a countable union plus a null set.]\nS 10. Vitali Coverings 191\n\u2217\n\u00a7\n3. Supplement Theorem 1 by proving that\nm\u2217 A Io = 0\n\u2212 k\n(cid:16) [ (cid:17)\nand\nm\u2217A = m\u2217 A Io ;\n\u2229 k\nhere Io = interior of I. (cid:16) [ (cid:17)\n4. Fill in all proof details in Lemmas 1 and 2. Do it also for = globes .\nK { }\n5. Given mZ = 0 and \u03b5 > 0, prove that there are open globes\nG\u2217 En,\nk \u2286\nwith\n\u221e\nZ G\u2217\n\u2282 k\nk=1\n[\nand\n\u221e\nmG\u2217 < \u03b5.\nk\nk=1\nX\n[Hint: Use Problem 3(f) in 5 and Problem 16(iii) from 8.]\n\u00a7 \u00a7\n6. Do Problem 3 in 5 for\n\u00a7\n(i) \u2032 = open globes , and\nC { }\n(ii) \u2032 = all globes in En .\nC { }\n[Hints for (i): Let m = outer measure induced by v : E1. From Problem 3(e)\n\u2032 \u2032 \u2032\nC \u2192\nin 5, show that\n\u00a7\n( A En) m\u2032A m\u2217A.\n\u2200 \u2286 \u2265\nTo prove m A m A also, fix \u03b5>0 and an open set G A with\n\u2032 \u2217\n\u2264 \u2287\nm\u2217A+\u03b5 mG (Theorem 3 of 8).\n\u2265 \u00a7\nGlobes inside G cover A in the V-sense (why?); so\nA Z G (disjoint)\nk\n\u2286 \u222a\n[\nfor some globes G and null set Z. With G as in Problem 5,\nk \u2217k\nm\u2032A (mG +mG\u2217k) \u2264mG+\u03b5 \u2264m\u2217A+2\u03b5.]\nk\n\u2264\nX\n7. Suppose f: En onto En is an isometry, i.e., satisfies\n\u2190\u2192\nf(x\u00af) f(y\u00af) = x\u00af y\u00af for x\u00af,y\u00af En.\n| \u2212 | | \u2212 | \u2208\nProve that\n(i) ( A En) m\u2217A = m\u2217f[A], and\n\u2200 \u2286 192 Chapter 7. Volume and Measure\n(ii) A \u2217 iff f[A] \u2217.\n\u2208 M \u2208 M\n[Hints: If A is a globe of radius r, so is f[A] (verify!); thus Problems 14 and 16 in 8\n\u00a7\napply. In the general case, argue as in Theorem 4 of 8, replacing intervals by globes\n\u00a7\n(see Problem 6). Note that f 1 is an isometry, too.]\n\u2212\n7\u2032 . FromProblem7inferthatLebesguemeasureinEn isrotation invariant.\n(A rotation about p\u00afis an isometry f such that f(p\u00af) = p\u00af.)\n8. A V-covering of A En is called normal iff\nK \u2286\n(i) ( I K) 0 < mI = mIo, and\n\u2200 \u2208\n(ii) for every p\u00af A, there is some c (0, ) and a sequence\n\u2208 \u2208 \u221e\nI p\u00af ( I )\nk k\n\u2192 { } \u2286 K\nsuch that\n( k) ( cube J I ) c m\u2217I mJ .\nk k k k\n\u2200 \u2203 \u2287 \u00b7 \u2265\n(We then say that p\u00af and I are normal; specifically, c-normal.)\nk\n{ }\nProve Theorems 1 and 2 for any normal .\nK\n[Hints: By Problem 21 of Chapter 3, 16, dI =dI.\n\u00a7\nFirst, suppose is uniformly normal, i.e., all p\u00af A are c-normal for the same c.\nK \u2208\nIn the general case, let\nAi = x\u00af A x\u00af is i-normal , i=1,2,...;\n{ \u2208 | }\nso is uniform for Ai. Verify that Ai A.\nK \u0580\nThen select, step by step, as in Theorem 1, a disjoint sequence I and\nk\n{ } \u2286 K\nnaturals n <n < <ni < such that\n1 2\n\u00b7\u00b7\u00b7 \u00b7\u00b7\u00b7\nni\n1\n( i) m\u2217 Ai I < .\nk\n\u2200 \u2212 i\n(cid:18) k=1 (cid:19)\n[\nLet\n\u221e\nU = I .\nk\nk=1\n[\nThen\n1\n( i) m\u2217(Ai U)<\n\u2200 \u2212 i\nand\nAi U A U.\n\u2212 \u0580 \u2212\n(Why?) Thus by Problems 7 and 8 in 6,\n\u00a7\n1\nm\u2217(A U) lim =0.]\n\u2212 \u2264i i\n\u2192\u221e\n\u2217\n9. A V-covering of En is called universal iff\nK\n\u2217\n(i) ( I ) 0 < mI = mIo < , and\n\u2200 \u2208 K \u221e 10. Vitali Coverings 193\n\u2217\n\u00a7\n\u2217\n(ii) whenever a subfamily covers a set A En in the V-sense,\nK \u2286 K \u2286\nwe have\nm\u2217 A I = 0\nk\n\u2212\n(cid:16) [ (cid:17)\nfor a disjoint sequence\nI .\nk\n{ } \u2286 K\nShow the following.\n\u2217\n(a) \u2217.\nK \u2286 M\n\u2217\n(b) Lemmas 1 and 2 are true with replaced by any universal . (In\nthis case, write D\u2217s and D\u2217 s fK or the analogues of Ds andK Ds.)\n(c) Ds = D\u2217s = D\u2217 s = Ds a.e.\n[Hints: (a) By (i), I =I minus a null set Z I Io.\n\u2286 \u2212\n(c) Argue as in Lemma 2, but set\nQ=J(D\u2217s>u>v >Ds)\nand\nsI\n\u2032 = I \u2217 I G\u2032, >v\nK \u2208K \u2286 mI\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nto prove a.e. that D s Ds; similarly f(cid:12)or Ds D s.\n\u2217 \u2264 (cid:12) \u2264 \u2217\nThroughout assume that s: E ( \u2217) is a measure in En, finite\n\u2032 \u2217 \u2032\nM \u2192 M \u2287K\u222aK\non \u2217.]\nK\u222aK\n10. Continuing Problems 8 and 9, verify that\n(a) = nondegenerate cubes is a normal and universal V-covering\nK { }\nof En;\no\n(b) so also is = all globes in En ;\nK { }\n(c) = nondegenerate intervals is normal.\nC { }\nNote that is not universal.1\nC\n11. ContinuingDefinition3, wecallq aderivate ofs, andwriteq Ds(p\u00af),iff\n\u223c\nsI\nk\nq = lim\nk\u2192\u221e mI k\nfor some sequence I p\u00af, with I .\nk k\n\u2192 \u2208 K\nSet\nD = q E\u2217 q Ds(p\u00af)\np\u00af\n{ \u2208 | \u223c }\nand prove that\nDs(p\u00af) = minD and Ds(p\u00af) = maxD .\np\u00af p\u00af\n1See M. E. Munroe, Measure and Integration, Addison\u2013Wesley (1971), pp. 173\u2013175. 194 Chapter 7. Volume and Measure\n12. Let \u2217 be a normal V-covering of En (see Problem 8). Given a measure\nK\ns in En, finite on \u2217 , write\nK \u222aK\nq D\u2217s(p\u00af)\n\u223c\niff\nsI\nk\nq = lim\nk\u2192\u221e mI k\nfor some normal sequence I p\u00af, with I \u2217.\nk k\n\u2192 \u2208 K\nSet\nD\u2217 = q E\u2217 q D\u2217s(p\u00af) ,\np\u00af { \u2208 | \u223c }\nand then\nD\u2217s(p\u00af) = infD\u2217 and D\u2217 s(p\u00af) = supD\u2217.\np\u00af p\u00af\nProve that\nDs = D\u2217s = D\u2217 s = Ds a.e. on En.\n[Hint: En = \u221ei=1Ei, where\nS Ei = x\u00af En x\u00af is i-normal .\n{ \u2208 | }\nOn each Ei, is uniformly normal. To prove Ds = D \u2217s a.e. on Ei, \u201cimitate\u201d\n\u2217\nK\nProblem 9(c). Proceed.]\n\u2217\n\u00a711. Generalized Measures. Absolute Continuity\nI. We nowreturnto general setfunctionss: E, with E asinDefinition 1\nM \u2192\nof 4.\n\u00a7\nDefinition 1.\nA set function s: E is a generalized measure in a set S, and\nM \u2192\n(S, ,s) is a generalized measure space, iff s is \u03c3-additive and semifi-\nM\nnite (i.e., s = + or s = ) on , a \u03c3-ring in S, and s = 0.\n6 \u221e 6 \u2212\u221e M \u2205\nWe call s a signed measure iff E E\u2217 (i.e., s is real or extended real);\n\u2286\nif s 0 then s is a measure; s may also be complex (E = C) or vector\n\u2265\nvalued.\nDefinition 2.\nGiven a set function s: E, we define its total variation\nM \u2192\nv : [0, ]\ns\nM \u2192 \u221e\nby\n( A ) v A = sup sX ,\ns i\n\u2200 \u2208 M | |\ni\nX 11. Generalized Measures. Absolute Continuity 195\n\u2217\n\u00a7\ntaking the sup over all countable disjoint subfamilies X with\ni\n{ } \u2286 M\nX A.\ni i \u2286\nNoSte 1. If is a \u03c3-ring, we may equivalently require that\nM\nX = A\ni\n[\nwith X a disjoint sequence in (add the term X = A X if neces-\n{ i } M o \u2212 i i\nsary).1\nS\nCorollary 1. If s and v are as in Definition 2, then\ns\n(i) v is monotone on , and\ns\nM\n(ii) sA v A for every A .\ns\n| | \u2264 \u2208 M\nProof. For (i), let A B, A,B . Take any disjoint sequence X ,\ni\n\u2286 \u2208 M { } \u2286 M\nwith\nX A B.\ni\n\u2286 \u2286\n[\nBy definition,\nsX v B.\ni s\n| | \u2264\ni\nX\nThus v B is an upper bound of all such sums, with X A. Hence\ns i\n\u2286\nv A = lub sX v B,S\ns i s\n| | \u2264\nX\nproving (i).\nTo prove (ii), just let X consist of A alone. (cid:3)\ni\n{ }\nTheorem 1. If s: E is a generalized measure, then v is a measure\ns\nM \u2192\non .\nM\nProof. By definition, v 0 on , a \u03c3-ring, and v = 0. (Why?) It remains\ns s\n\u2265 M \u2205\nto prove \u03c3-additivity.\nThus let\nA = A (disjoint),\nn\nn\n[\nwith A,A . To show that\nn\n\u2208 M\nv A = v A ,\ns s n\nn\nX\ntake any -partition X of A. Then\ni\nM { }\n( i) X = X A = X A = (X A ) (disjoint).\ni i i n i n\n\u2200 \u2229 \u2229 \u2229\nn n\n[ [\n1Any such Xi is called an -partition of A (Chapter 8, 1); it may consist of A alone.\n{ } M \u00a7 196 Chapter 7. Volume and Measure\nSimilarly,\n( n) A = (A X );\nn n i\n\u2200 \u2229\ni\n[\nso by definition,\n( n) s(A X ) v A .\nn i s n\n\u2200 | \u2229 | \u2264\ni\nX\nHence as\nX = (X A ),\ni i n\n\u2229\nn\n[\nwe get\nsX = s (A X ) = s(A X )\ni n i n i\n| | \u2229 \u2229\ni i (cid:12) n (cid:12) i (cid:12) n (cid:12)\nX X(cid:12) [ (cid:12) X(cid:12)X (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\ns(A X ) v A .\n(cid:12) (cid:12) (cid:12) n i (cid:12) s n\n\u2264 | \u2229 | \u2264\nn,i n\nX X\nAs X was an arbitrary -partition of A,\ni\n{ } M\nv A = sup sX v A .\ns i s n\n| | \u2264\nn\nX X\nIt remains to show that\nv A v A.\ns n s\n\u2264\nn\nX\nThis is trivial if v A = .\ns\n\u221e\nThus let v A < . Then\ns\n\u221e\n( n) v A v A <\ns n s\n\u2200 \u2264 \u221e\nby Corollary 1(i). Now fix \u03b5 > 0. By properties of lub, each A has an -\nn\nM\npartition,\nA = X ,\nn nk\nk\n[\nsuch that\n\u03b5\nv A < sX .\ns n \u2212 2n | nk |\nk\nX\nAll X combined (for all n and k) form an -partition of A. Thus by defini-\nnk\nM\ntion,\n\u03b5\nv A sX v A v A \u03b5.\ns \u2265 | nk | \u2265 s n \u2212 2n \u2265 s n \u2212\nXn Xk Xn (cid:16) (cid:17) Xn\nWith \u03b5 0, we get\n\u2192\nv A v A,\ns n s\n\u2264\nn\nX 11. Generalized Measures. Absolute Continuity 197\n\u2217\n\u00a7\nas required. (cid:3)\nDefinition 3.\nGiven\ns: E and t: \u2032 E\u2032,2\nM \u2192 M \u2192\nwe say that s is\n(i) t-continuous (written s t) iff\n\u226a\nv X = 0 = sX = 0 (X \u2032);\nt\n\u21d2 | | \u2208 M\n(ii) absolutely t-continuous (or absolutely continuous with respect to\nt) iff\nv X 0 = sX 0,\nt\n\u2192 \u21d2 \u2192\ni.e.,\n( \u03b5 > 0) ( \u03b4 > 0) ( X \u2032) v X < \u03b4 = sX < \u03b5;\nt\n\u2200 \u2203 \u2200 \u2208 M \u21d2 | |\n(iii) t-finite iff\nv X < = sX < (X \u2032).\nt\n\u221e \u21d2 | | \u221e \u2208 M\nCorollary 2. If two set functions s,u: E are t-continuous (absolutely\nM \u2192\nt-continuous) so are s u, and so is ks for any k from the scalar field of E.3\n\u00b1\nThe proof is left to the reader. (Use Definition 3(i)(ii), quantified formula.)\nTheorem 2. Let s: E and t: \u2032 E\u2032.\nM \u2192 M \u2192\n(i) If s t, then v t.\ns\n\u226a \u226a\n(ii) If, in addition, s and t are generalized measures and v is t-finite, then\ns\nboth v and s are absolutely t-continuous.\ns\n(iii) v t implies s t (which is obvious).\ns\n\u226a \u226a\nProof. Fix A and any disjoint sequence X , with\ni\n\u2208 M \u2208 M\nX A.\ni\n\u2286\n[\nIf v A = 0, then (Corollary 1)\nt\n( i) v X = 0;\nt i\n\u2200\n2Fortherestofthissection,weassumethat and satisfyX wheneverX\n\u2032 \u2032\nM M \u2208M \u2208M\nand vtX < .\n\u221e\n3If E =E , we assume k E1. If s is scalar valued, k may be a vector in E.\n\u2217\n\u2208 198 Chapter 7. Volume and Measure\nso by the t-continuity of s, sX = 0, and hence sX = 0. As this holds for\ni i\n| | | |\nany such sum, we also have\nP\nv A = sup sX = 0\ns i\n| |\nX\nwhenever v A = 0. This proves assertion (i).\nt\nNow, let s and t be as in (ii); so v and v are measures by Theorem 1.\ns t\nSuppose v is not absolutely t-continuous. Then\ns\n( \u03b5 > 0) ( \u03b4 > 0) ( X \u2032) v X < \u03b4 and v X \u03b5.\nt s\n\u2203 \u2200 \u2203 \u2208 M \u2265\n(Why?) Taking\n\u03b4 = 2\u2212n,\nn\nfix ( n) a set X \u2032, with\nn\n\u2200 \u2208 M\nv X < 2\u2212n and v X \u03b5.\nt n s n\n\u2265\nLet\n\u221e \u221e\nY = X and Y = Y ;\nn k n\nk=n n=1\n[ \\\nso Y,Y \u2032, Y Y, and\nn n\n\u2208 M \u0581\n\u221e \u221e\nv Y v X < 2\u2212k 21\u2212n.\nt n t k\n\u2264 \u2264\nk=n k=n\nX X\nThus by Theorem 2 in 4 (right continuity),\n\u00a7\nv Y = lim v Y lim 21\u2212n = 0.\nt t n\nn\u2192\u221e \u2264 n\u2192\u221e\nHence by the t-continuity of v (see (i)),\ns\nv Y = 0 < \u03b5.\ns\nOn the other hand, as Y X , we have\nn n\n\u2287\nv Y v X \u03b5.\ns n s n\n\u2265 \u2265\nAlso, v Y 21\u2212n implies v Y < (v is t-finite). Hence\nt n s n s\n\u2264 \u221e\nv Y = lim v Y \u03b5,\ns s n\nn\u2192\u221e \u2265\na contradiction. Thus v is absolutely t-continuous.\ns\nSo is s; for by Corollary 1(ii), we have\n( \u03b5 > 0) ( \u03b4 > 0) ( X \u2032) v X < \u03b4 = sX v X < \u03b5,\nt s\n\u2200 \u2203 \u2200 \u2208 M \u21d2 | | \u2264\nproving (ii). (cid:3) 11. Generalized Measures. Absolute Continuity 199\n\u2217\n\u00a7\nNote 2. Absolute t-continuity always implies t-continuity.4\nII. Specialnotionsapplytosigned measures. Firstofall, wehavethefollowing\ndefinition.\nDefinition 4.\nA set A S in a signed measure space (S, ,s) is called positive (nega-\n\u2286 M\ntive) iff sX 0 (sX 0, respectively) whenever\n\u2265 \u2264\nA X, X .\n\u2287 \u2208 M\nWe set\n+ = X X is positive\nM { \u2208 M | }\nand\n\u2212 = X X is negative .\nM { \u2208 M | }\nThe easy proof of Lemmas 1 and 2 is left to the reader.\nLemma 1. In any signed measure space, + and \u2212 are \u03c3-rings.\nM M\nLemma 2. If s,t are signed measures on , then\nM\n(i) so is ks (k E1);\n\u2208\n(ii) so also are s t, provided s or t is finite on .\n\u00b1 M\nNote 3. Lemma 2 applies to generalized measures s,t: E as well.\nM \u2192\nLemma 3. Let s: E\u2217 be a signed measure. Let A , 0 < sA < .\nM \u2192 \u2208 M \u221e\nThen A has a subset Q + such that\n\u2208 M\n0 < sA sQ < .\n\u2264 \u221e\nProof. If A +, take Q = A.\n\u2208 M\nOtherwise, A has subsets of negative measure. Let then n be the least\n1\nnatural for which there is a set A , with\n1\n\u2208 M\n1\nA A and sA < .\n1 1\n\u2286 \u2212n\n1\n(why does such n exist?); then\n1\ns(A A ) > sA > 0.\n1\n\u2212\nNow, if A A +, take Q = A A . If not, let n be the least natural\n1 1 2\n\u2212 \u2208 M \u2212\nfor which there is A , with\n2\n\u2208 M\n1\nA A A and sA < .\n2 1 2\n\u2286 \u2212 \u2212n\n2\n4For if vtX = 0, then vtX < \u03b4 for any \u03b4 > 0. Thus Definition 3(ii) implies ( \u03b5 > 0)\n\u2200\nsX <\u03b5; hence sX =0.\n| | | | 200 Chapter 7. Volume and Measure\nAgain, if\n2\nA A\ni\n\u2212\ni=1\n[\nis positive, put\n2\nQ = A A .\ni\n\u2212\ni=1\n[\nIf not, let n be the least natural for which there is A , with\n3 3\n\u2208 M\n2\nA A A\n3 i\n\u2286 \u2212\ni=1\n[\nand\n1\nsA < .\n3\n\u2212n\n3\nContinuing, we either find the desired Q at some step or obtain a sequence\nA such that\nk\n{ } \u2286 M\nk\n1\n(1) ( k N) sA < and A A A\nk k+1 i\n\u2200 \u2208 \u2212n \u2286 \u2212\nk\ni=1\n[\n(so the A are disjoint). In the latter case, let\nk\n\u221e\nQ = A A ;\nk\n\u2212\nk=1\n[\nso\n\u221e\nA = Q A (disjoint),\nk\n\u222a\nk=1\n[\nand\nsQ+ sA = sA.\nk\nk\nX\nAs sA < (by assumption), sA converges. By (1), then,\nk\n| | \u221e\n1\nP\n( sA ) < .\nk\nn \u2264 \u2212 \u221e\nk\nk k\nX X\nTherefore,\n1\nlim = 0,\nk\u2192\u221e n k\ni.e.,\nlim n = .\nk\nk\u2192\u221e \u221e 11. Generalized Measures. Absolute Continuity 201\n\u2217\n\u00a7\nAlso, as sA < 0 and sA > 0, we have\nk\nsQ = sA sA > sA > 0.\nk\n\u2212\nX\nNow, given \u03b5 > 0, choose k so large that\n1\n\u03b5 > .\nn 1\nk\n\u2212\nAs\nk\nQ A A ,\ni\n\u2286 \u2212\ni=1\n[\nour definition of the n implies that Q can have no subsets X , with\nk\n\u2208 M\n1\nsX < \u03b5 < .\n\u2212 \u2212n 1\nk\n\u2212\n(Why?) As \u03b5 is arbitrary, Q has no subsets of negative measure.\nThus Q +, Q A, and\n\u2208 M \u2286\n0 < sA sQ < ,\n\u2264 \u221e\nas required. (cid:3)\nThe following theorem is named after the mathematician Hans Hahn.\nTheorem 3 (Hahn decomposition theorem). In any signed measure space\n(S, ,s), there is a positive set P S whose complement is negative. More-\nM \u2286\nover, P or P can be chosen from , according to whether s = or s =\n\u2212 M 6 \u221e 6 \u2212\u221e\non .\nM\nIf S , both P and P can be made s-measurable:\n\u2208 M \u2212\nP + and P \u2212.\n\u2208 M \u2212 \u2208 M\nProof. By definition, sis semifinite; sos = ors = on ; say, s = + .\n6 \u221e 6 \u2212\u221e M 6 \u221e\nAs + is a \u03c3-ring (Lemma 1), the restriction of s to + is a measure, with\nM M\n0 s <\n\u2264 \u221e\non +. Thus by Problem 13 in 6, we fix a set P + such that\nM \u00a7 \u2208 M\nsP = max sX X + < .\n{ | \u2208 M } \u221e\nBy Lemma 3, sP = maxsX, even on all of .\nM\nIt remains to show that P is negative. Suppose it is not. Then P has a\n\u2212 \u2212\nsubset Y , with sY > 0; so\n\u2208 M\nY P = and Y P .\n\u2229 \u2205 \u222a \u2208 M 202 Chapter 7. Volume and Measure\nBy additivity,\ns(Y P) = sY +sP > sP,\n\u222a\ncontrary to the maximality of sP. This contradiction settles the case s = + .\n6 \u221e\nIn case s = , consider s, which by Lemma 2 is likewise a signed mea-\n6 \u2212\u221e \u2212\nsure, with s = + . By what was proved above, there is a set P\u2032 that\n\u2212 6 \u221e \u2208 M\nis positive for s (hence negative for s), and whose complement is positive for\n\u2212\ns.\nFinally, if S , then P implies\n\u2208 M \u2208 M\nS P = P ;\n\u2212 \u2212 \u2208 M\nso both P and P are in . Thus all is proved. (cid:3)\n\u2212 M\nNote 4. The set P in Theorem 3 is not unique. However, if P\u2032 + is\n\u2208 M\nanother such set, then\ns(P P\u2032) = 0 = s(P\u2032 P),\n\u2212 \u2212\ni.e., any two such sets can differ by a set of measure 0 only. Indeed,\nP P\u2032 P and P P\u2032 P\u2032;\n\u2212 \u2286 \u2212 \u2286 \u2212\nso s(P P\u2032) is both 0 and 0. Thus s(P P\u2032) = 0. Similarly for P\u2032 P.\n\u2212 \u2265 \u2264 \u2212 \u2212\nTheorem 4 (Jordan decomposition). Every signed measure s: E\u2217 is\nM \u2192\nthe difference of two measures,\ns = s+ s\u2212 (s+,s\u2212 0),\n\u2212 \u2265\nwith s+ or s\u2212 bounded on .\nM\nProof. Suppose s = + on . Then by Theorem 3, there is a set P +\n6 \u221e M \u2208 M\nsuch that P is negative and sP < . Now define, for all sets A ,\n\u2212 \u221e \u2208 M\n(2) s+A = s(A P) and s\u2212A = s(A P).\n\u2229 \u2212 \u2212\nBy additivity,\nsA = s(A P)+s(A P) = s+A s\u2212A;\n\u2229 \u2212 \u2212\nso s = s+ s\u2212 on , as required. Moreover,\n\u2212 M\ns+A = s(A P) 0,\n\u2229 \u2265\nsince A P P and P is positive. Similarly,\n\u2229 \u2286\ns\u2212A = s(A P) 0,\n\u2212 \u2212 \u2265\nsince A P P and P is negative. Thus s+,s\u2212 0 on , a \u03c3-ring.\n\u2212 \u2286 \u2212 \u2212 \u2265 M\nThe \u03c3-additivity of s+ and s\u2212 easily follows from that of s (we leave the\nproof to the reader). Thus s+ and s\u2212 are measures. 11. Generalized Measures. Absolute Continuity 203\n\u2217\n\u00a7\nFinally, by (2),\ns+A = s(A P) sP <\n\u2229 \u2264 \u221e\nfor all A (for\n\u2208 M\nsP = max sX X ;\n{ | \u2208 M}\nsee the proof of Theorem 3). Thus s+ is bounded, and all is proved.\nThe case s = is similar. (cid:3)\n6 \u2212\u221e\nNote 5. For any set X A (X ), we have\n\u2286 \u2208 M\nsX = s+X s\u2212X s+X s+A,\n\u2212 \u2264 \u2264\nfor s+ and s\u2212 are 0 and monotone. Thus s+A is an upper bound of\n\u2265\nsX A X .\n{ | \u2287 \u2208 M}\nBy (2), this bound is reached when X = A P; so it is a maximum. Similarly\n\u2229\nfor s\u2212; thus\n(3) s+A = max sX A X and s\u2212A = max sX A X .\n{ | \u2287 \u2208 M} {\u2212 | \u2287 \u2208 M}\nNote 6. The decomposition is not unique, for we also have\ns = (s+ +m) (s\u2212 +m)\n\u2212\nforanyfinitemeasuremon . However, itbecomesuniqueifweaddcondition\nM\n(3). When so defined, s+ and s\u2212 are called the Jordan components of s.\nNote 7. Formula (2) shows that\n( s)+ = s\u2212 and ( s)\u2212 = s+.\n\u2212 \u2212\nCorollary 3. With s, s+, and s\u2212 as in (3), we have the following.\n(i) v = s+ +s\u2212; hence if s is a measure (s\u2212 = 0), then\ns\ns = v = s+.\ns\n(ii) v is finite (t-finite, t-continuous, absolutely t-continuous) iff s+ and s\u2212\ns\nare, i.e., iff s is.\nProof. We give only an outline here.\n(i) Take any -partition\nM\nA = X (disjoint).\ni\nSetting [\nm = s+ +s\u2212,\nverify that\nsX mX\ni i\n| | \u2264 204 Chapter 7. Volume and Measure\nand\nsX mX = m X = mA.\ni i i\n| | \u2264\nX X [\nThus mA is an upper bound of sums\nsX .\ni\n| |\nX\nThis bound is reached when X = A P, X = A P (P as in (2)).\n1 2\n\u2229 \u2212\n(ii) Use Theorem 2, Corollary 2, and Definition 3. Note that v s , s+,\ns\n\u2265 | |\nand s\u2212. (cid:3)\nCorollary 4. A t-finite signed measure s is absolutely t-continuous iff it is\nt-continuous.\nIn particular, this applies to finite measures.\nCorollary 4 follows from Theorem 2 and Note 2, by Corollary 3.\nIII. If E = En(Cn), the function\ns: E\nM \u2192\nhas n real (complex) components\ns ,... ,s ,\n1 n\nas defined in Chapter 4, 3. As in Theorem 2 of Chapter 4, 3, one easily\n\u00a7 \u00a7\nobtains the following.\nTheorem 5. A set function s: En(Cn) is t-continuous (absolutely t-\nM \u2192\ncontinuous, additive, \u03c3-additive) iff its n components are. Hence a complex\nset function s is t-continuous (etc.) iff its real and imaginary parts are.\nFor \u03c3-additivity, one can argue as follows. Let\n\u221e\nA = A (disjoint),\ni\ni=1\n[\nwith A,A . Use Theorem 2 in Chapter 3, 15, with p\u00af= sA and\ni\n\u2208 M \u00a7\nm\nx\u00af = sA ,\nm i\ni=1\nX\nto get p = s A, and\nk k\nm\nx = s A , k = 1,... ,n.\nmk k i\ni=1\nX 11. Generalized Measures. Absolute Continuity 205\n\u2217\n\u00a7\nTheorem 6. A generalized measure s: En(Cn) is t-continuous iff it is\nM \u2192\nabsolutely t-continuous. It is always bounded on , as is v .\ns\nM\nProof. As s: En is \u03c3-additive, so is each of its components s , by\nk\nM \u2192\nTheorem 5. Thus each s is a finite (real) signed measure, with\nk\ns = s+ s\u2212,\nk k \u2212 k\nas in Theorem 4. Here the measures s+ and s\u2212 are both finite (as s is).\nk k\nThus by Problem 13 in 6, they are bounded, say, s+ K and s\u2212 K on\n\u00a7 k \u2264 1 k \u2264 2\n. Hence by Corollaries 1 and 3,\nM\ns v = s+ +s\u2212 K +K ;\n| k | \u2264 sk k K \u2264 1 2\nthat is, v is bounded on (k = 1,2,... ,n). Hence so are s and v , for\nsk s\nM\ns v v\ns sk\n| | \u2264 \u2264\nk\nX\n(see Problem 4(iii)).\nNow, as v is finite, it is certainly t-finite. Thus by Theorem 2 and Note 2,\ns\ns is t-continuous iff it is absolutely t-continuous.\nThis settles the case E = En, hence also E = C = E2. The case E = Cn is\nanalogous. (cid:3)\nIV. Completion of a Generalized Measure. From Problems 14 and 15 of 6,\n\u00a7\nrecall that every measure m has a completion m. A similar construction, which\nwe now describe, applies to generalized measures s: E.\nM \u2192\nGiven such an s, let be the family of all sets X Z, where X and\nM \u222a \u2208 M\nZ is v -null, i.e., Z U for some U , v U = 0 (note that v is a measure\ns s s\n\u2286 \u2208 M\nhere, by Theorem 2). That is,\n= X Z X , Z U, U , v U = 0 .\ns\nM { \u222a | \u2208 M \u2286 \u2208 M }\nWe now define s\u00af: E by setting\nM \u2192\ns\u00afA = sX\nwhenever A = X Z, with X and Z as above.\n\u222a\nAs in Problems 14 and 15 of 6, it follows that is a \u03c3-ring , and\n\u00a7 M \u2287 M\nthat s\u00af is a \u03c3-additive extension of s, hence a generalized measure. We call s\u00af\nthe completion of s. It is complete in the sense that contains all v -null sets\ns\nM\n(but it may miss some subsets of X with sX = 0). If s 0 (a measure), then\n\u2265\ns = v ; so our present definitions agree with Problem 15 in 6. We use these\ns\n\u00a7\nideas in the following part. 206 Chapter 7. Volume and Measure\nV. Signed Lebesgue\u2013Stieltjes (LS) Measures. Motived by Theorem 3 in\nChapter 5, 7, we shall say that a function\n\u00a7\n\u03b1: E1 E1\n\u2192\nis of bounded variation on E1 iff\n\u03b1 = g h,\n\u2212\nwith g and h on all of E1.\n\u2191 \u2191\nThen g and h induce two LS measures m and m in E1.\ng h\nLet \u00b5 and \u00b5 be their restrictions to the Borel field in E1. Then\ng h\nB\n\u03c3\u2217 = \u00b5 \u00b5\n\u03b1 g \u2212 h\nis finite for sets X inside any finite interval I E1 (as \u00b5 and \u00b5 are finite\ng h\n\u2208 B \u2282\non intervals).\nBy Lemma 2, \u03c3\u2217 is a signed measure on the -sets in I. Moreover, \u03c3\u2217 does\n\u03b1 B \u03b1\nnot depend on the particular choice of g and h (g h = \u03b1) on I. For if also\n\u2191 \u2191 \u2212\n\u03b1 = u v (u , v ) on E1, set\n\u2212 \u2191 \u2191\n\u03c3\u2032 = \u00b5 \u00b5 .\n\u03b1 u \u2212 v\nThen for any (x,y] I,\n\u2286\n\u03c3\u2032 (x,y] = \u03b1(y+) \u03b1(x+) = \u03c3\u2217(x,y] (verify!);\n\u03b1 \u2212 \u03b1\nso by Problem 13 in 5, \u03c3\u2032 = \u03c3\u2217 on -sets in I.\n\u00a7 \u03b1 \u03b1 B\nThus \u03c3\u2217 is uniquely determined by \u03b1. Its completion\n\u03b1\ns = \u03c3\u2217\n\u03b1 \u03b1\nis the \u03b1-induced Lebesgue\u2013Stieltjes (LS) signed measure in I.\nIf further \u00b5 or \u00b5 is finite on all of , the same process defines a signed LS\ng h\nB\nmeasure in all of E1.\nProblems on Generalized Measures\n1. Complete the proofs of Theorems 1, 4, and 5.\n\u2032\n1 . Do it also for the lemmas and Corollary 3.\n2. Verify the following.\n(i) In Definition 2, one can equivalently replace \u201ccountable X \u201d by\ni\n{ }\n\u201cfinite X .\u201d\ni\n{ }\n(ii) If is a ring, Note 1 holds for finite sequences X .\ni\nM { }\n(iii) If s: E is additive on , a semiring, so is v .\ns\nM \u2192 M\n[Hint: Use Theorem 1 from 4.]\n\u00a7 11. Generalized Measures. Absolute Continuity 207\n\u2217\n\u00a7\n3. For any set functions s,t on , prove that\nM\n(i) v = v , and\n|s| s\n(ii) v av , provided st is defined and\nst t\n\u2264\na = sup sX X .\n{| | | \u2208 M}\n4. Given s,t: E, show that\nM \u2192\n(i) v v +v ;\ns+t s t\n\u2264\n(ii) v = k v (k as in Corollary 2); and\nks s\n| |\n(iii) if E = En(Cn) and\nn\ns = s e\u00af ,\nk k\nk=1\nX\nthen\nn\nv v v .\nsk s sk\n\u2264 \u2264\nk=1\nX\n[Hints: (i) If\nA Xi (disjoint),\n\u2287\n[\nwith Ai,Xi , verify that\n\u2208M\n(s+t)Xi sXi + tXi ,\n| |\u2264| | | |\n(s+t)Xi vsA+vtA, etc.;\n| |\u2264\nX\n(ii) is analogous.\n(iii) Use (ii) and (i), with e\u00af =1.]\nk\n| |\n5. If g , h , and \u03b1 = g h on E1, can one define the signed LS measure\n\u2191 \u2191 \u2212\ns by simply setting s = m m (assuming m < )?\n\u03b1 \u03b1 g h h\n\u2212 \u221e\n[Hint: the domains of mg and m may be different. Give an example. How about\nh\ntaking their intersection?]\n6. Find an LS measure m such that \u03b1 is continuous and one-to-one, but\n\u03b1\nm is not m-finite (m = Lebesgue measure).\n\u03b1\n[Hint: Take\nx3\n, x=0,\n\u03b1(x)= \uf8f1 x 6\n| |\n\uf8f4\uf8f2 0, x=0,\nand \uf8f4\uf8f3\n\u221e 1\nA= n,n+ .]\nn2\nn [=1(cid:16) i\n7. Construct complex and vector-valued LS measures s : \u2217 En(Cn)\n\u03b1 M\u03b1 \u2192\nin E1. 208 Chapter 7. Volume and Measure\n8. Show that if s: En(Cn) is additive and bounded on , a ring,\nM \u2192 M\nso is v .\ns\n[Hint: By Problem 4(iii), reduce all to the real case.\nUse Problem 2. Given a finite disjoint sequence Xi , let U+ (U \u2212) be the\n{ }\u2286M\nunion of those Xi for which sXi 0 (sXi <0, respectively). Show that\n\u2265\nsXi =sU+ sU\u2212 2sup s < .]\n\u2212 \u2264 | | \u221e\nX\n9. For any s: E\u2217 and A , set\nM \u2192 \u2208 M\ns+A = sup sX A X\n{ | \u2287 \u2208 M}\nand\ns\u2212A = sup sX A X .\n{\u2212 | \u2287 \u2208 M}\nProve that if s is additive and bounded on , a ring, so are s+ and s\u2212;\nM\nfurthermore,\n1\ns+ = (v +s) 0,\ns\n2 \u2265\n1\ns\u2212 = (v s) 0,\ns\n2 \u2212 \u2265\ns = s+ s\u2212, and\n\u2212\nv = s+ +s\u2212.\ns\n[Hints: Use Problem 8. Set\n1\ns\u2032 = (vs+s).\n2\nThen ( X X A)\n\u2200 \u2208M| \u2286\n2sX =sA+sX s(A X) sA+(sX + s(A X))\n\u2212 \u2212 \u2264 | | | \u2212 |\nsA+vsA=2s\u2032A.\n\u2264\nDeduce that s+A s A.\n\u2032\n\u2264\nTo prove also that s \u2032A s+A, let \u03b5 > 0. By Problems 2 and 8, fix Xi ,\n\u2264 { } \u2286 M\nwith\nn\nA= Xi (disjoint)\ni=1\n[\nand\nn\nvsA \u03b5< sXi .\n\u2212 | |\ni=1\nX\nShow that\nn\n2s\u2032A \u03b5=vsA+sA \u03b5 sU+ sU\u2212+s Xi =2sU+\n\u2212 \u2212 \u2264 \u2212\ni=1\n[\nand\n2s+A 2sU+ 2s\u2032A \u03b5.]\n\u2265 \u2265 \u2212 11. Generalized Measures. Absolute Continuity 209\n\u2217\n\u00a7\n10. Let\n= compact sets in a topological space (S, )\nK { G }\n(adopt Theorem 2 in Chapter 4, 7, as a definition). Given\n\u00a7\ns: E, 2S,\nM \u2192 M \u2286\nwe call s compact regular (CR) iff\n( \u03b5 > 0) ( A ) ( F ) ( G )\n\u2200 \u2200 \u2208 M \u2203 \u2208 K \u2203 \u2208 G\nF,G , F A G, and v G \u03b5 v A v F +\u03b5.\ns s s\n\u2208 M \u2286 \u2286 \u2212 \u2264 \u2264\nProve the following.\n(i) If s,t: E are CR, so are s t and ks (k as in Corollary 2).\nM \u2192 \u00b1\n(ii) If s is additive and CR on , a semiring, so is its extension to the\nM\nring (Theorem 1 in 4 and Theorem 4 of 3).\ns\nM \u00a7 \u00a7\n(iii) If E = En(Cn) and v < on , a ring, then s is CR iff its\ns\n\u221e M\ncomponents s are, or in the case E = E1, iff s+ and s\u2212 are\nk\n(see Problem 9).\n[Hint for (iii): Use (i) and Problem 4(iii). Consider vs(G F).]\n\u2212\n11. (Aleksandrov.) Show that if s: E is CR (see Problem 10) and\nM \u2192\nadditive on , a ring in a topological space S, and if v < on ,\ns\nM \u221e M\nthen v and s are \u03c3-additive, and v has a unique \u03c3-additive extension\ns s\nv\u00af to the \u03c3-ring generated by .\ns\nN M\nThe latter holds for s, too, if S and E = En(Cn).\n\u2208 M\n[Proof outline: The \u03c3-additivity of vs results as in Theorem 1 of 2 (first check\n\u00a7\nLemma 1 in 1 for vs).\n\u00a7\nFor the \u03c3-additivity of s, let\n\u221e\nA= Ai (disjoint), A,Ai ;\n\u2208M\ni=1\n[\nthen\nr 1\n\u2212 \u221e\nsA sAi vsAi 0\n\u2212 \u2264 \u2192\n(cid:12) i=1 (cid:12) i=r\n(cid:12) X (cid:12) X\n(cid:12) (cid:12)\nas r , for (cid:12) (cid:12)\n\u2192\u221e\n\u221e \u221e\nvsAi =vs Ai < .\n\u221e\ni=1 i=1\nX [\n(Explain!) Now, Theorem 2 of 6 extends vs to a measure on a \u03c3-field\n\u00a7\n\u2217\nM \u2287N \u2287M\n(use the minimality of ). Its restriction to is the desired v\u00afs (unique by\nN N\nProblem 15 in 6).\n\u00a7 210 Chapter 7. Volume and Measure\nA similar proof holds for s, too, if s: [0, ). The case s : En(Cn)\nM \u2192 \u221e M \u2192\nresults via Theorem 5 and Problem 10(iii) provided S ; for then by Corollary 1,\n\u2208M\nvsS < ensures the finiteness of vs, s+, and s even on .]\n\u2212\n\u221e N\n12. Do Problem 11 for semirings .\nM\n[Hint: Use Problem 10(ii).]\n\u2217\n\u00a712. Differentiation of Set Functions\nIn the proof of Theorem 3 in 10 and the lemmas of that section, we saw the\n\u00a7\nconnection between quotients of the form\n\u2206f f(x) f(p)\n= \u2212\n\u2206x x p\n\u2212\nand those of the form\nsI\n,\nmI\nwhere m is Lebesgue measure and s is another suitable measure. With this in\nmind, we now use quotients sI/mI for forming derivatives of set functions.\nBelow, m is Lebesgue measure in En;\n= nondegenerate cubes .\nK { }\nDefinition 1.\nAssume the set function\ns: \u2032 E ( \u2032 )\nM \u2192 M \u2287 K\nin En and that q E.\n\u2208\n(i) We say that q is the derivative of s at a point p\u00af En iff\n\u2208\nsI\nk\nq = lim\nk\u2192\u221e mI k\nfor all sequences I , with I p\u00af (see Definition 1 in 10),\nk k\n{ } \u2286 K \u2192 \u00a7\nNotation:\nd\nq = s\u2032(p\u00af) = s(p\u00af).\ndm\nIf, in addition, q < , we say that s is differentiable at p\u00af.\n| | \u221e\nIf\nsI\nk\nq = lim\nk\u2192\u221e mI k\nfor at least one such sequence I p\u00af, we call q a derivate of s at p\u00af\nk\n\u2192\nand write\nq Ds(p\u00af).\n\u223c 12. Differentiation of Set Functions 211\n\u2217\n\u00a7\nIf s\u2032(p\u00af) exists, it is the unique derivate of s at p\u00af.\n(ii) In case E is E\u2217 or E1, we admit infinite derivates and derivatives.\nFor any set function\ns: \u2032 E\u2217\nM \u2192\n(measure or not) with\n\u2032 ,\nM \u2287 K\nwe also define\nDs(p\u00af) and Ds(p\u00af)\nexactly as in Definition 3 of 10.\n\u00a7\nEquivalently, Ds(p\u00af) is the least and Ds(p\u00af) is the largest derivate\nof s at p\u00af(Problem 11 in 10). This shows that if E = E\u2217 or E = E1,\n\u00a7\nderivates exist at every p\u00af.\nNote 1. Hence q = s\u2032(p\u00af) in E\u2217 iff\nq = Ds(p\u00af) = Ds(p\u00af).\nNote 2. We treat Ds, Ds, and s\u2032 as functions on points of En. Thus they\nare point functions, even though s is a set function.\nThe easy proofs of Theorems 1 and 2 (with and \u2032 as above) are\nK M \u2287 K\nleft to the reader.\nTheorem 1. If s,t: \u2032 E are differentiable at p\u00af, so are s t and ks for\nM \u2192 \u00b1\nany scalar k. (If s,t are scalar valued, k may be a vector.) Moreover,\n(s t)\u2032 = s\u2032 t\u2032 and (ks)\u2032 = ks\u2032 at p\u00af.\n\u00b1 \u00b1\n(See also Problem 7.)\nTheorem 2. A set function s: \u2032 Er(Cr) is differentiable at p\u00af iff its\nM \u2192\ncomponents s ,s ,... ,s are; and then\n1 2 r\nr\ns\u2032 = (s\u2032,... ,s\u2032) = e\u00af s\u2032 at p\u00af.\n1 r i i\ni=1\nX\nIn particular, for complex functions,\ns\u2032 = s\u2032 +i s\u2032 at p\u00af.\nre \u00b7 im\nThe process described in Definition 1 will be called Lebesgue differentiation\nor -differentiation, as opposed to \u201c\u2126-differentiation,\u201d defined next.1\nK\n1We follow some ideas by E. Munroe here. 212 Chapter 7. Volume and Measure\nDefinition 2.\nLet \u00b5\u2217 be a -regular ( 5) outer measure in a metric space (S,\u03c1); re-\nG \u00a7\ncall that\n= all open sets in S .\nG { }\nLet \u00b5: E\u2217 be the \u00b5\u2217-induced ( 6) measure in S.\nM \u2192 \u00a7\nA countable (two-indexed) set family\n\u2126 = Ui (i,n = 1,2,...)\n{ n} \u2286 M\nis called a network in S (with respect to \u00b5 and \u03c1) iff\n(i\u2217) the space\n\u221e\nS = Ui (disjoint), i = 1,2,...,\nn\nn=1\n[\nwith\n0 < \u00b5Ui < , i,n = 1,2,...;2\nn \u221e\n(ii\u2217) each Ui+1 is a subset of some Ui (the Ui decrease as i increases);\nn r n\n(iii\u2217) for each p S, there is a sequence\n\u2208\nI \u2126,\nk\n{ } \u2286\nwith I p; that is,\nk\n\u2192\n\u221e\np I\nk\n\u2208\nk=1\n\\\nand dI 0 (dI = diameter of I in (S,\u03c1)).\nk k k\n\u2192\nNow, given any set function\ns: \u2032 E ( \u2032 \u2126),\nM \u2192 M \u2287\nwe define derivatives, derivates (also Ds and Ds if E E\u2217), and differentia-\n\u2286\nbility exactly as in Definition 1, replacing by \u2126, and Lebesgue measure m\nK\nby \u00b5.\nNote that these derivates and derivatives depend not only on \u00b5 and \u03c1 but\nalso on the choice of \u2126. To stress this, one might write s\u2032 and D s for s\u2032 and\n\u00b5\u2126 \u00b5\u2126\nDs, respectively. Mostly, however, no confusion is caused by simply writing s\u2032\nand Ds (and we shall do so).\nA network for En is suggested in the \u201chint\u201d to Problem 2 of 2. See also\n\u00a7\nNote 3.\n2Thus for each fixed i, the Ui are disjoint. Also, \u00b5 is \u03c3-finite, and S .\nn \u2208M 12. Differentiation of Set Functions 213\n\u2217\n\u00a7\nTheorems 1 and 2 carry over to \u2126-differentiation, with the same proofs. We\nshall also need a substitute for the Vitali theorem (Theorem 1 of 10). It is\n\u00a7\nquite simple.\nDefinition 3.\nLet \u2126 be as in Definition 2. A set family \u2126 is called an \u2126-covering\nN \u2286\nof A (S,\u03c1) iff\n\u2286\nA ,\n\u2286 N\nwhere is defined to be [X.\nN X\u2208N\nTheorem 3S. Let be an \u2126-coSvering of A S. Then there is a disjoint\nN \u2286\nsequence\nI\nk\n{ } \u2286 N\nwith\nA I\nk\n\u2286\nk\n[\nso that\n\u00b5\u2217 A I = 0\nk\n\u2212\n(cid:18) k (cid:19)\n[\nand\n\u00b5\u2217A = \u00b5\u2217 A I .\nk\n\u2229\n(cid:18) k (cid:19)\n[\nProof. As \u2126, consists of some of the Ui. For each i, let\nN \u2286 N n\ni = Ui n = 1,... ,\nN { n \u2208 N | }\ni.e., i consists of all Ui with that particular index i.\nN n \u2208 N\nNow, by Definition 2(i\u2217)(ii\u2217), any two Ui are either disjoint, or one contains\nn\nthe other. (Why?) Thus to construct I , start with all the (disjoint) 1-sets\nk\n{ } N\n(if 1 = ). Then add those U2 2 that are not subsets of any set from 1\nN 6 \u2205 n \u2208 N N\nand hence are disjoint from such sets. Next, add those U3 3 that are not\nn \u2208 N\nsubsets of any set chosen from 1 or 2, and so on.\nN N\nAll Ui so chosen form a disjoint subfamily that covers all of A, as\nn K \u2286 N\nA = .\n\u2286 N K\n(Why?) [ [\nis countable (as \u2126 is); so we can put it in a sequence I , with\nk\nK { }\nA I (disjoint),\nk\n\u2286\nk\n[\nas required. (cid:3) 214 Chapter 7. Volume and Measure\nWe can now prove our main result for - and \u2126-differentiation alike.\nK\nTheorem 4.\n(i) If s: \u2032 E\u2217(Er, Cr) is a generalized measure in En, finite on , then\nM \u2192 K\ns is differentiable a.e. on En (under Lebesgue measure m).\n(ii) Similarly for \u2126-differentiation in (S,\u03c1), provided s is finite on \u2126 and\nregular.3\nProof. Via components and the Jordan decomposition (Theorem 4 of 11),\n\u00a7\nall reduces to the case where s is a measure ( 0). Then the proof for -\n\u2265 K\ndifferentiation is as in Lemmas 1 and 2 in 10. (Verify!)\n\u00a7\nFor \u2126-differentiation, the proof of Lemma 1 in 10 still works, with -\n\u00a7 K\ncoverings replaced by \u2126-coverings.\nIn the proof of Lemma 2, after choosing rationals v > u, we choose Q,\nG Q, the \u2126-covering\n\u2287\nsI\n= I \u2126 I G, < u\nK \u2208 \u2286 \u00b5I\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nof Q, and the sequence I ,(cid:12) as before. (In selecting G, we use the\nk\n{ } \u2286 K(cid:12)\n-regularity of \u00b5\u2217; the I need not be cubes here, of course.)\nk\nG\nThen, however, instead of forming the set Q , we use the regularity of s to\no\nselect an open set G\u2032 \u2032 with\n\u2208 M\nG\u2032 I Q\nk\n\u2287 \u2287\nk\n[\nand\nsG\u2032 \u03b5 s I sI .\nk k\n\u2212 \u2264 \u2264\nThe set family [ X\nsI\n\u2032 = I \u2126 I G\u2032, > v\nK \u2208 \u2286 \u00b5I\n(cid:26) (cid:12) (cid:27)\n(cid:12)\nis then an \u2126-covering of Q (why?); (cid:12)so we find a disjoint sequence I\u2032 \u2032\n(cid:12) { k} \u2286 K\nwith\nQ I\u2032 G\u2032 G\n\u2286 k \u2286 \u2286\nand obtain [\nu (\u00b5\u2217Q+\u03b5) u \u00b5G u \u00b5I sI sG\u2032 \u03b5 sI\u2032 \u03b5\n\u00b7 \u2265 \u00b7 \u2265 \u00b7 k \u2265 k \u2265 \u2212 \u2265 k \u2212\nk k k\nX X X\nv \u00b5I\u2032 \u03b5 = v \u00b5 I\u2032 \u03b5 v \u00b5\u2217Q \u03b5.\n\u2265 \u00b7 k \u2212 \u00b7 k \u2212 \u2265 \u00b7 \u2212\nk\nX [\n3A signed measure s is called regular iff s+ and s are regular (Definition 4 in 7). A\n\u2212\n\u00a7\ncomplex measure s is regular iff sre and s are. Finally, s: Er(Cr) is regular iff all\nim \u2032\nM \u2192\nits components si are. 12. Differentiation of Set Functions 215\n\u2217\n\u00a7\nThus\n( \u03b5 > 0) u (\u00b5\u2217Q+\u03b5) v \u00b5\u2217Q \u03b5.\n\u2200 \u00b7 \u2265 \u00b7 \u2212\nThe rest is as in Lemma 2 of 10. (cid:3)\n\u00a7\nNote 3. If \u00b5\u2217 = m\u2217, -derivatives equal \u2126-derivatives a.e. for a regular s\nK\n(Problem 6). One may use \u2126 in En, thus avoiding Theorem 1 of 10 (Prob-\n\u00a7\nlem 13).\nProblems on Differentiation of Set Functions\n1. Complete the proofs of Theorems 1 to 4 in detail. Verify Note 1.\n2. Verify that the hint for Problem 2 in 2 describes a network for En (see\n\u00a7\nNote 3).\n3. Show that the measure \u00b5 in Definition 2 is necessarily topological.\n[Hint: Any G is a countable union of \u2126-sets. Why?]\n\u2208G\n4. (i) Show that the derivates of s at p\u00af form exactly the set D\u2032 of all\np\u00af\ncluster points of sequences sI /mI with I p\u00af and I .\nk k k k\n\u2192 { } \u2286 K\nDo the same considering sequences sI /\u00b5I with I p\u00af and\nk k k\n\u2192\nI \u2126.\nk\n{ } \u2286\n(ii) Do Problem 11 in 10 for \u2126-differentiation. Must s be regular\n\u00a7\nhere?\n5. Verify that if\n( I \u2126) \u00b5I = \u00b5Io,\n\u2200 \u2208\nthen Theorem 4 holds for \u2126-differentiation even if s is not regular.\n[Hint: The proof of Lemma 2 of 10 holds unchanged.]\n\u00a7\n6. Prove Note 3 assuming that (i) s is regular, or (ii) ( I \u2126) \u00b5I = \u00b5Io\n\u2200 \u2208\n(see Problem 5).\n[Hint: Imitate Problem 9(b) in 10 and the \u201c\u2126\u201d part in the proof of Theorem 4.]\n\u00a7\n7. Prove for - and \u2126-differentiation that if\nK\ns = t u (s,t,u: \u2032 E\u2217)\n\u00b1 M \u2192\nand if u is differentiable at p, then Ds = Dt u\u2032 and Ds = Dt u\u2032 at p.\n\u00b1 \u00b1\n8. In Theorem 4 show that Ds = Ds a.e. even if s is not finite on all of\n(\u2126).\nK\n[Hint: For s 0, Lemma 1 in 10, still holds. For signed measures, use Problem 7,\n\u2265 \u00a7\nnoting that s+ or s is finite, hence differentiable a.e.]\n\u2212\n9. Prove that if f and s = m are as in the proof of Theorem 3 in 10,\nf\n\u00a7\nthen s and f are differentiable at the same points in E1, and s\u2032 = f\u2032\nthere. 216 Chapter 7. Volume and Measure\n[Hint: UseNote1,Definition1, andChapter5, 1, Problem9, consideringone-sided\n\u00a7\nderivatives, f and f .]\n+\u2032 \u2032\n\u2212\n\u2217 \u2217\n10. Given a universal V-covering (see Problem 9 in 10), develop -\nK \u2217\u00a7 K\ndifferentiation as in Definition 1, replacing by and writing s\u2032\u2217,\nK K\nD\u2217s, ... for s\u2032, Ds, etc.\n\u2217\nExtendTheorems1\u20134andProblem7to -differentiation. Underthe\nK\nassumptions of Theorem 4, show that s\u2032\u2217 = s\u2032 a.e. on En (use Problem 9\nin 10).\n\u00a7\n11. Given a normal V-covering \u2217 of En (Problem 8 in 10), develop \u2217-\nK \u00a7 K\ndifferentiation along the lines of Problem 12 in 10 (admitting normal\n\u00a7\nsequences I only). Do the same questions as in Problem 10, for\nk\n{ }\n\u2217-differentiation.\nK\n12. Describe what changes if, in Problem 11, we drop the normality restric-\ntion on sequences I p\u00af (call it strong \u2217-differentiation; write D\u2217\u2217s,\nk\n\u2192 K\ns\u2032\u2217\u2217, etc.).\nShow that\nD\u2217\u2217s D\u2217s D\u2217 s D\u2217\u2217 s\n\u2264 \u2264 \u2264\non En, and so the existence of s\u2032\u2217\u2217 implies that of s\u2032\u2217.\nHowever the proof of Lemmas 1 and 2 in 10 fails for D\u2217\u2217s and D\u2217\u2217 s\n\u00a7\n(at what step?). So does the proof of Theorem 4. What about Theo-\nrems 1 and 2? Chapter 8\nMeasurable Functions. Integration\n\u00a71. Elementary and Measurable Functions\nFrom set functions, we now return to point functions\nf: S (T,\u03c1\u2032)\n\u2192\nwhose domain D consists of points of a set S. The range space T will mostly\nf\nbe E, i.e., E1, E\u2217, C, En, or another normed space. We assume f(x) = 0\nunless defined otherwise. (In a general metric space T, we may take some fixed\nelement q for 0.) Thus D is all of S, always.\nf\nWe also adopt a convenient notation for sets:\n\u201cA(P)\u201d for \u201c x A P(x) .\u201d\n{ \u2208 | }\nThus\nA(f = a) = x A f(x) = a ,\n6 { \u2208 | 6 }\nA(f = g) = x A f(x) = g(x) ,\n{ \u2208 | }\nA(f > g) = x A f(x) > g(x) , etc.\n{ \u2208 | }\nDefinition 1.\nA measurable space is a set S = together with a set ring of subsets\n6 \u2205 M\nof S, denoted (S, ).\nM\nHenceforth, (S, ) is fixed.\nM\nDefinition 2.\nAn -partition of a set A is a countable set family = A such that\ni\nM P { }\nA = A (disjoint),\ni\ni\nwith A,A .1 [\ni\n\u2208 M\nWe briefly say \u201cthe partition A = A .\u201d\ni\n1 may be finite; it may even consist of A alonS e.\nP 218 Chapter 8. Measurable Functions. Integration\nAn -partition \u2032 = B is a refinement of = A (or \u2032 refines\nik i\nM P { } P { } P\n, or \u2032 is finer than ) iff\nP P P\n( i) A = B ;\ni ik\n\u2200\nk\n[\ni.e., each B is contained in some A .\nik i\nThe intersection \u2032 . \u2032\u2032 of \u2032 = A and \u2032\u2032 = B is understood\ni k\nP \u2229P P { } P { }\nto be the family of all sets of the form\nA B , i,k = 1,2,....\ni k\n\u2229\nIt is an -partition that refines both \u2032 and \u2032\u2032.\nM P P\nDefinition 3.\nA map (function) f: S T is elementary, or -elementary, on a set\n\u2192 M\nA iff there is an -partition = A of A such that f is constant\ni\n\u2208 M M P { }\n(f = a ) on each A .\ni i\nIf = A ,... ,A is finite, we say that f is simple, or -simple,\n1 q\nP { } M\non A.\nIf the A are intervals in En, we call f a step function; it is a simple\ni\nstep function if is finite.2\nP\nThe function values a are elements of T (possibly vectors). They may be\ni\ninfinite if T = E\u2217. Any simple map is also elementary, of course.\nDefinition 4.\nA map f: S (T,\u03c1\u2032) is said to be measurable (or -measurable) on a\n\u2192 M\nset A in (S, ) iff\nM\nf = lim f (pointwise) on A\nm\nm\u2192\u221e\nfor some sequence of functions f : S T, all elementary on A. (See\nm\n\u2192\nChapter 4, 12 for \u201cpointwise.\u201d)\n\u00a7\nNote 1. This implies A , as follows from Definitions 2 and 3. (Why?)\n\u2208 M\nCorollary 1. If f: S (T,\u03c1\u2032) is elementary on A, it is measurable on A.\n\u2192\nProof. Set f = f, m = 1,2,..., in Definition 4. Then clearly f f\nm m\n\u2192\non A. (cid:3)\nCorollary 2. If f is simple, elementary, or measurable on A in (S, ), it\nM\nhas the same property on any subset B A with B .\n\u2286 \u2208 M\n2Onlysimple step functions areneededfora\u201climitedapproach.\u201d (Onemayproceedfrom\nhere to 4, treating m as an additive premeasure.)\n\u00a7 1. Elementary and Measurable Functions 219\n\u00a7\nProof. Let f be simple on A; so f = a on A , i = 1,2,... ,n, for some finite\ni i\nn\n-partition, A = A .\nM i=1 i\nIf A B , then\n\u2287 \u2208 M S\nB A , i = 1,2,... ,n,\ni\n{ \u2229 }\nis a finite -partition of B (why?), and f = a on B A ; so f is simple on B.\ni i\nM \u2229\nFor elementary maps, use countable partitions.\nNow let f be measurable on A, i.e.,\nf = lim f\nm\nm\u2192\u221e\nfor some elementary maps f on A. As shown above, the f are elementary\nm m\non B, too, and f f on B; so f is measurable on B. (cid:3)\nm\n\u2192\nCorollary 3. If f is elementary or measurable on each of the (countably\nmany) sets A in (S, ), it has the same property on their union A = A .\nn M n n\nProof. Let f be elementary on each A (so A by Note 1).\nn n S\n\u2208 M\nBy Corollary 1 of Chapter 7, 1,\n\u00a7\nA = A = B\nn n\n[ [\nfor some disjoint sets B A (B ).\nn n n\n\u2286 \u2208 M\nBy Corollary 2, f is elementary on each B ; i.e., constant on sets of some\nn\n-partition B of B .\nni i\nM { }\nAll B combined (for all n and all i) form an -partition of A,\nni\nM\nA = B = B .\nn ni\nn n,i\n[ [\nAs f is constant on each B , it is elementary on A.\nni\nFor measurable functions f, slightly modify the method used in Corol-\nlary 2. (cid:3)\nCorollary 4. If f: S (T,\u03c1\u2032) is measurable on A in (S, ), so is the com-\n\u2192 M\nposite map g f, provided g: T (U,\u03c1\u2032\u2032) is relatively continuous on f[A].\n\u25e6 \u2192\nProof. By assumption,\nf = lim f (pointwise)\nm\nm\u2192\u221e\nfor some elementary maps f on A.\nm\nHence by the continuity of g,\ng(f (x)) g(f(x)),\nm\n\u2192\ni.e., g f g f (pointwise) on A.\nm\n\u25e6 \u2192 \u25e6 220 Chapter 8. Measurable Functions. Integration\nMoreover, all g f are elementary on A (for g f is constant on any\nm m\n\u25e6 \u25e6\npartition set, if f is).\nm\nThus g f is measurable on A, as claimed. (cid:3)\n\u25e6\nTheorem 1. If the maps f,g,h: S E1(C) are simple, elementary, or mea-\n\u2192\nsurable on A in (S, ), so are f g, fh, f a (for real a = 0) and f/h (if\nM \u00b1 | | 6\nh = 0 on A).\n6\nSimilarly for vector-valued f and g and scalar-valued h.\nProof. First, let f and g be elementary on A. Then there are two -\nM\npartitions,\nA = A = B ,\ni k\nsuch that f = a on A and g = b [on B ,[say.\ni i k k\nThe sets A B (for all i and k) then form a new -partition of A (why?),\ni k\n\u2229 M\nsuch that both f and g are constant on each A B (why?); hence so is f g.\ni k\n\u2229 \u00b1\nThus f g is elementary on A. Similarly for simple functions.\n\u00b1\nNext, let f and g be measurable on A; so\nf = limf and g = limg (pointwise) on A\nm m\nfor some elementary maps f ,g .\nm m\nBy what was shown above, f g is elementary for each m. Also,\nm m\n\u00b1\nf g f g (pointwise) on A.\nm m\n\u00b1 \u2192 \u00b1\nThus f g is measurable on A.\n\u00b1\nThe rest of the theorem follows quite similarly. (cid:3)\nIf the range space is En (or Cn), then f has n real (complex) components\nf ,... ,f , as in Chapter 4, 3 (Part II). This yields the following theorem.\n1 n\n\u00a7\nTheorem 2. A function f: S En(Cn) is simple, elementary, or measur-\n\u2192\nable on a set A in (S, ) iff all its n component functions f ,f ,... ,f are.\n1 2 n\nM\nProof. For simplicity, consider f: S E2, f = (f ,f ).\n1 2\n\u2192\nIf f and f are simple or elementary on A then (exactly as in Theorem 1),\n1 2\none can achieve that both are constant on sets A B of one and the same\ni k\n\u2229\n-partition of A. Hence f = (f ,f ), too, is constant on each A B , as\n1 2 i k\nM \u2229\nrequired.\nConversely, let\nf = c\u00af = (a ,b ) on C\ni i i i\nfor some -partition\nM\nA = C .\ni\nThen by definition, f = a and f =[b on C ; so both are elementary (or\n1 i 2 i i\nsimple) on A. 1. Elementary and Measurable Functions 221\n\u00a7\nIn the general case (En or Cn), the proof is analogous.\nFor measurable functions, the proof reduces to limits of elementary maps\n(using Theorem 2 of Chapter 3, 15). The details are left to the reader. (cid:3)\n\u00a7\nNote 2. As C = E2, a complex function f : S C is simple, elementary,\n\u2192\nor measurable on A iff its real and imaginary parts are.\nBy Definition 4, a measurable function is a pointwise limit of elementary\nmaps. However, if is a \u03c3-ring, one can make the limit uniform. Indeed, we\nM\nhave the following theorem.\nTheorem 3. If is a \u03c3-ring, and f: S (T,\u03c1\u2032) is -measurable on A, then\nM \u2192 M\nf = lim g (uniformly) on A\nm\nm\u2192\u221e\nfor some finite elementary maps g .\nm\nThus given \u03b5 > 0, there is a finite elementary map g such that \u03c1\u2032(f,g) < \u03b5\non A.3,4\nThe proof will be given in 2 for T = E\u2217. The general case is sketched in\n\u00a7\nProblem 7 of 2. Meanwhile, we take the theorem for granted and use it below.\n\u00a7\nTheorem 4. If is a \u03c3-ring in S, if\nM\nf f (pointwise) on A\nm\n\u2192\n(f : S (T,\u03c1\u2032)), and if all f are -measurable on A, so also is f.4\nm m\n\u2192 M\nBriefly: A pointwise limit of measurable maps is measurable (unlike contin-\nuous maps; cf. Chapter 4, 12).\n\u00a7\nProof. BythesecondclauseofTheorem3, eachf isuniformly approximated\nm\nby some elementary map g on A, so that, taking \u03b5 = 1/m, m = 1,2,...,\nm\n1\n(1) \u03c1\u2032(f (x),g (x)) < for all x A and all m.\nm m\nm \u2208\nFixing such a g for each m, we show that g f (pointwise) on A, as\nm m\n\u2192\nrequired in Definition 4.\nIndeed, fix any x A. By assumption, f (x) f(x). Hence, given \u03b4 > 0,\nm\n\u2208 \u2192\n( k) ( m > k) \u03c1\u2032(f(x),f (x)) < \u03b4.\nm\n\u2203 \u2200\nTake k so large that, in addition,\n1\n( m > k) < \u03b4.\n\u2200 m\n3We briefly write \u03c1 (f,g) for sup \u03c1 (f(x),g(x)).\n\u2032 x S \u2032\n4The theorem holds also for T =E\u2208 , with \u03c1 as in Problem 5 of Chapter 3, 11.\n\u2217 \u2032\n\u00a7 222 Chapter 8. Measurable Functions. Integration\nThen by the triangle law and by (1), we obtain for m > k that\n\u03c1\u2032(f(x),g (x)) \u03c1\u2032(f(x),f (x))+\u03c1\u2032(f (x),g (x))\nm m m m\n\u2264\n1\n< \u03b4 + < 2\u03b4.\nm\nAs \u03b4 is arbitrary, this implies \u03c1\u2032(f(x),g (x)) 0, i.e., g (x) f(x) for\nm m\n\u2192 \u2192\nany (fixed) x A, thus proving the measurability of f. (cid:3)\n\u2208\nNote 3. If\n= (= Borel field in S),\nM B\nwe often say \u201cBorel measurable\u201d for -measurable. If\nM\n= Lebesgue measurable sets in En ,\nM { }\nwe say \u201cLebesgue (L) measurable\u201d instead. Similarly for \u201cLebesgue\u2013Stieltjes\n(LS) measurable.\u201d\nProblems on Measurable and\nElementary Functions in (S,M)\n1. Fill in all proof details in Corollaries 2 and 3 and Theorems 1 and 2.\n2. Show that \u2032 . \u2032\u2032 is as stated at the end of Definition 2.\nP \u2229P\n3. Given A S and f,f : S (T,\u03c1\u2032), m = 1,2,..., let\nm\n\u2286 \u2192\nH = A(f f)\nm\n\u2192\nand\n1\nA = A \u03c1\u2032(f ,f) < .\nmn m\nn\n(cid:16) (cid:17)\nProve that\n\u221e \u221e \u221e\n(i) H = A ;\nmn\nn=1k=1m=k\n\\ [ \\\n(ii) H if all A are in and is a \u03c3-ring.\nmn\n\u2208 M M M\n[Hint: x H iff\n\u2208\n( n) ( k) ( m k) x Amn.\n\u2200 \u2203 \u2200 \u2265 \u2208\nWhy?]\n3\u2032 . Do Problem 3 for T = E\u2217 and f = on H.\n\u00b1\u221e\n[Hint: If f =+ , Amn =A(fm >n).]\n\u221e\n\u21d24. Let f: S T be -elementary on A, with a \u03c3-ring in S. Show the\n\u2192 M M\nfollowing.\n(i) A(f = a) , A(f = a) .\n\u2208 M 6 \u2208 M 1. Elementary and Measurable Functions 223\n\u00a7\n(ii) If T = E\u2217, then\nA(f < a), A(f a), A(f > a), and A(f a)\n\u2265 \u2265\nare in , too.\nM\n(iii) ( B T) A f\u22121[B] .\n\u2200 \u2286 \u2229 \u2208 M\n[Hint: If\n\u221e\nA= Ai\ni=1\n[\nandf =ai onAi,thenA(f =a)isthecountable unionofthoseAi forwhichai =a.]\n5. Do Problem 4(i) for measurable f.\n[Hint: If f =limfm for elementary maps fm, then\nH =A(f =a)=A(fm a).\n\u2192\nExpress H as in Problem 3, with\n1\nAmn =A hm < ,\nn\n(cid:16) (cid:17)\nwhere hm =\u03c1 \u2032(fm,a) is elementary. (Why?) Then use Problems 4(ii) and 3(ii).]\n\u21d26. Given f,g: S (T,\u03c1\u2032), let h = \u03c1\u2032(f,g), i.e.,\n\u2192\nh(x) = \u03c1\u2032(f(x),g(x)).\nProve that if f and g are elementary, simple, or measurable on A, so\nis h.\n[Hint: Argue as in Theorem 1. Use Theorem 4 in Chapter 3, 15.]\n\u00a7\n\u21d27. A set B (T,\u03c1\u2032) is called separable (in T) iff B D (closure of D) for\n\u2286 \u2286\na countable set D T.\n\u2286\nProve that if f: S T is -measurable on A, then f[A] is separable\n\u2192 M\nin T.\n[Hint: f =limfm for elementary maps fm; say,\nfm =ami on Ami , i=1,2,....\n\u2208M\nLet D consist of all ami (m,i = 1,2,...); so D is countable (why?) and D T.\n\u2286\nVerify that\n( y f[A]) ( x A) y =f(x)=limfm(x),\n\u2200 \u2208 \u2203 \u2208\nwith fm(x) D. Hence\n\u2208\n( y f[A]) y D,\n\u2200 \u2208 \u2208\nby Theorem 3 of Chapter 3, 16.]\n\u00a7\n\u21d28. Continuing Problem 7, prove that if B D and D = q ,q ,... , then\n1 2\n\u2286 { }\n\u221e\n1\n( n) B G .\nqi\n\u2200 \u2286 n\ni [=1 (cid:16) (cid:17) 224 Chapter 8. Measurable Functions. Integration\n[Hint: If p \u2208B \u2286D, any Gp n1 contains some qi \u2208D; so\n(cid:0) (cid:1) 1 1\n\u03c1\u2032(p,qi)< n, or p \u2208Gqi .\nn\n(cid:16) (cid:17)\nThus\n\u221e 1\n( \u2200p \u2208B) p Gqi .]\n\u2208 n\ni [=1 (cid:16) (cid:17)\n9. Prove Corollaries 2 and 3 and Theorems 1 and 2, assuming that is a\nM\nsemiring only.\n10. Do Problem 4 for -simple maps, assuming that is a ring only.\nM M\n\u00a72. Measurability of Extended-Real Functions\nHenceforth we presuppose a measurable space (S, ), where is a \u03c3-ring in\nM M\nS. Our aim is to prove the following basic theorem, which is often used as a\ndefinition, for extended-real functions f: S E\u2217.\n\u2192\nTheorem 1. A function f: S E\u2217 is measurable on a set A iff it\n\u2192 \u2208 M\nsatisfies one of the following equivalent conditions (hence all of them):\n(i\u2217) ( a E\u2217) A(f > a) ; (ii\u2217) ( a E\u2217) A(f a) ;\n\u2200 \u2208 \u2208 M \u2200 \u2208 \u2265 \u2208 M\n(iii\u2217) ( a E\u2217) A(f < a) ; (iv\u2217) ( a E\u2217) A(f a) .\n\u2200 \u2208 \u2208 M \u2200 \u2208 \u2264 \u2208 M\nWe first prove the equivalence of these conditions by showing that (i\u2217)\n\u21d2\n(ii\u2217) (iii\u2217) (iv\u2217) (i\u2217), closing the \u201ccircle.\u201d\n\u21d2 \u21d2 \u21d2\n(i\u2217) (ii\u2217). Assume (i\u2217). If a = ,\n\u21d2 \u2212\u221e\nA(f a) = A\n\u2265 \u2208 M\nby assumption. If a = + ,\n\u221e\n\u221e\nA(f a) = A(f = ) = A(f > n)\n\u2265 \u221e \u2208 M\nn=1\n\\\nby (i\u2217). And if a E1,\n\u2208\n\u221e\n1\nA(f a) = A f > a .\n\u2265 \u2212 n\nn \\=1 (cid:16) (cid:17)\n(Verify!) By (i\u2217),\n1\nA f > a ;\n\u2212 n \u2208 M\n(cid:16) (cid:17)\nso A(f a) (a \u03c3-ring!).\n\u2265 \u2208 M 2. Measurability of Extended-Real Functions 225\n\u00a7\n(ii\u2217) (iii\u2217). For (ii\u2217) and A imply\n\u21d2 \u2208 M\nA(f < a) = A A(f a) .\n\u2212 \u2265 \u2208 M\n(iii\u2217) (iv\u2217). If a E1,\n\u21d2 \u2208\n\u221e\n1\nA(f a) = A f < a+ .\n\u2264 n \u2208 M\nn \\=1 (cid:16) (cid:17)\nWhat if a = ?\n\u00b1\u221e\n(iv\u2217) (i\u2217). Indeed, (iv\u2217) and A imply\n\u21d2 \u2208 M\nA(f > a) = A A(f a) .\n\u2212 \u2264 \u2208 M\nThus, indeed, each of (i\u2217) to (iv\u2217) implies the others. To finish, we need two\nlemmas that are of interest in their own right.\nLemma 1. If the maps f : S E\u2217 (m = 1,2,...) satisfy conditions (i\u2217)\u2013\nm\n\u2192\n(iv\u2217), so also do the functions\nsupf , inff , limf , and limf ,\nm m m m\ndefined pointwise, i.e.,\n(supf )(x) = supf (x),\nm m\nand similarly for the others.\nProof. Let f = supf . Then\nm\n\u221e\nA(f a) = A(f a). (Why?)\nm\n\u2264 \u2264\nm=1\n\\\nBut by assumption,\nA(f a)\nm\n\u2264 \u2208 M\n(f satisfies (iv\u2217)). Hence A(f a) (for is a \u03c3-ring).\nm\n\u2264 \u2208 M M\nThus supf satisfies (i\u2217)\u2013(iv\u2217).\nm\nSo does inff ; for\nm\n\u221e\nA(inff a) = A(f a) .\nm m\n\u2265 \u2265 \u2208 M\nm=1\n\\\n(Explain!)\nSo also do limf and limf ; for by definition,\nm m\nlimf = supg ,\nm k\nk\nwhere\ng = inf f\nk m\nm\u2265k 226 Chapter 8. Measurable Functions. Integration\nsatisfies (i\u2217)\u2013(iv\u2217), as was shown above; hence so does supg = limf .\nk m\nSimilarly for limf . (cid:3)\nm\nLemma 2. If f satisfies (i\u2217)\u2013(iv\u2217), then\nf = lim f (uniformly) on A\nm\nm\u2192\u221e\nfor some sequence of finite functions f , all -elementary on A.\nm\nM\nMoreover, if f 0 on A, the f can be made nonnegative, with f on A.\nm m\n\u2265 { }\u2191\nProof. Let H = A(f = + ), K = A(f = ), and\n\u221e \u2212\u221e\nk 1 k\nA = A \u2212 f <\nmk 2m \u2264 2m\n(cid:16) (cid:17)\nfor m = 1,2,... and k = 0, 1, 2,... , n,....\n\u00b1 \u00b1 \u00b1\nBy (i\u2217)\u2013(iv\u2217),\nH = A(f = + ) = A(f + ) ,\n\u221e \u2265 \u221e \u2208 M\nK , and\n\u2208 M\nk 1 k\nA = A f \u2212 A f < .\nmk \u2264 2m \u2229 2m \u2208 M\n(cid:16) (cid:17) (cid:16) (cid:17)\nNow define\nk 1\n( m) f = \u2212 on A ,\n\u2200 m 2m mk\nf = m on H, and f = m on K. Then each f is finite and elementary on\nm m m\n\u2212\nA since\n\u221e\n( m) A = H K A (disjoint)\nmk\n\u2200 \u222a \u222a\nk=\u2212\u221e\n[\nand f is constant on H, K, and A .\nm mk\nWe now show that f f (uniformly) on H,K, and\nm\n\u2192\n\u221e\nJ = A ,\nmk\nk=\u2212\u221e\nhence on A. [\nIndeed, on H we have\nlimf = limm = + = f,\nm\n\u221e\nand the limit is uniform since the f are constant on H.\nm\nSimilarly,\nf = m = f on K.\nm\n\u2212 \u2192 \u2212\u221e\nFinally, on A we have\nmk\n(k 1)2\u2212m f < k2\u2212m\n\u2212 \u2264 2. Measurability of Extended-Real Functions 227\n\u00a7\nand f = (k 1)2\u2212m; hence\nm\n\u2212\nf f < k2\u2212m (k 1)2\u2212m = 2\u2212m.\nm\n| \u2212 | \u2212 \u2212\nThus\nf f < 2\u2212m 0\nm\n| \u2212 | \u2192\non each A , hence on\nmk\n\u221e\nJ = A .\nmk\nk=\u2212\u221e\n[\nBy Theorem 1 of Chapter 4, 12, it follows that f f (uniformly) on J.\nm\n\u00a7 \u2192\nThus, indeed, f f (uniformly) on A.\nm\n\u2192\nIf, further, f 0 on A, then K = and A = for k 0. Moreover,\nmk\n\u2265 \u2205 \u2205 \u2264\non passage from m to m+1, each A (k > 0) splits into two sets. On one,\nmk\nf = f ; on the other, f > f . (Why?)\nm+1 m m+1 m\nThus 0 f f (uniformly) on A, and all is proved. (cid:3)\nm\n\u2264 \u0580\nProof of Theorem 1. If f is measurable on A, then by definition, f = limf\nm\n(pointwise) for some elementary maps f on A.\nm\nByProblem 4(ii)in 1, all f satisfy (i\u2217)\u2013(iv\u2217). Thussodoesf byLemma1,\nm\n\u00a7\nfor here f = limf = limf .\nm m\nThe converse follows by Lemma 2. This completes the proof. (cid:3)\nNote 1. Lemmas 1 and 2 prove Theorems 3 and 4 of 1, for f: S E\u2217.\n\u00a7 \u2192\nBy using also Theorem 2 in 1, one easily extends this to f: S En(Cn).\n\u00a7 \u2192\nVerify!\nCorollary 1. If f: S E\u2217 is measurable on A, then\n\u2192\n( a E\u2217) A(f = a) and A(f = a) .\n\u2200 \u2208 \u2208 M 6 \u2208 M\nIndeed,\nA(f = a) = A(f a) A(f a)\n\u2265 \u2229 \u2264 \u2208 M\nand\nA(f = a) = A A(f = a) .\n6 \u2212 \u2208 M\nCorollary 2. If f: S (T,\u03c1\u2032) is measurable on A in (S, ), then\n\u2192 M\nA f\u22121[G]\n\u2229 \u2208 M\nfor every globe G = G (\u03b4) in (T,\u03c1\u2032).\nq\nProof. Define h: S E1 by\n\u2192\nh(x) = \u03c1\u2032(f(x),q). 228 Chapter 8. Measurable Functions. Integration\nThen h is measurable on A by Problem 6 in 1. Thus by Theorem 1,\n\u00a7\nA(h < \u03b4) .\n\u2208 M\nBut as is easily seen,\nA(h < \u03b4) = x A \u03c1\u2032(f(x),q) < \u03b4 = A f\u22121[G (\u03b4)].\nq\n{ \u2208 | } \u2229\nHence the result. (cid:3)\nDefinition.\nGiven f,g : S E\u2217, we define the maps f g and f g on S by\n\u2192 \u2228 \u2227\n(f g)(x) = max f(x),g(x)\n\u2228 { }\nand\n(f g)(x) = min f(x),g(x) ;\n\u2227 { }\nsimilarly for f g h, f g h, etc.\n\u2228 \u2228 \u2227 \u2227\nWe also set\nf+ = f 0 and f\u2212 = f 0.\n\u2228 \u2212 \u2228\nClearly, f+ 0 and f\u2212 0 on S. Also, f = f+ f\u2212 and f = f+ +f\u2212.\n\u2265 \u2265 \u2212 | |\n(Why?) We now obtain the following theorem.\nTheorem 2. If the functions f,g: S E\u2217 are simple, elementary, or mea-\n\u2192\nsurable on A, so also are f g, fg, f g, f g, f+, f\u2212, and f a (a = 0).\n\u00b1 \u2228 \u2227 | | 6\nProof. If f and g are finite, this follows by Theorem 1 of 1 on verifying that\n\u00a7\n1\nf g = (f +g + f g )\n\u2228 2 | \u2212 |\nand\n1\nf g = (f +g f g )\n\u2227 2 \u2212| \u2212 |\non S. (Check it!)\nOtherwise, consider\nA(f = + ), A(f = ), A(g = + ), and A(g = ).\n\u221e \u2212\u221e \u221e \u2212\u221e\nBy Theorem 1, these are -sets; hence so is their union U.\nM\nOn each of them f g and f g equal f or g; so by Corollary 3 in 1, f g\n\u2228 \u2227 \u00a7 \u2228\nand f g have the desired properties on U. So also have f+ = f 0 and\n\u2227 \u2228\nf\u2212 = f 0 (take g = 0).\n\u2212 \u2228\nWe claim that the maps f g and fg are simple (hence elementary and\n\u00b1\nmeasurable) on each of the four sets mentioned above, hence on U.\nFor example, on A(f = + ),\n\u221e\nf g = + (constant)\n\u00b1 \u221e 2. Measurability of Extended-Real Functions 229\n\u00a7\nby our conventions (2\u2217) in Chapter 4, 4. For fg, split A(f = + ) into three\n\u00a7 \u221e\nsets A , A , A , with g > 0 on A , g < 0 on A , and g = 0 on A ; so\n1 2 3 1 2 3\n\u2208 M\nfg = + on A , fg = on A , and fg = 0 on A . Hence fg is simple on\n1 2 3\n\u221e \u2212\u221e\nA(f = + ).\n\u221e\nFor f a, use U = A( f = ). Again, the theorem holds on U, and also on\n| | | | \u221e\nA U, sincef andg arefinite onA U . Thusit holdsonA = (A U) U,\n\u2212 \u2212 \u2208 M \u2212 \u222a\nby Corollary 3 in 1. (cid:3)\n\u00a7\nNote 2. Induction extends Theorem 2 to any finite number of functions.\nNote 3. Combining Theorem 2 with f = f+ f\u2212, we see that f : S E\u2217\n\u2212 \u2192\nis simple (elementary, measurable) iff f+ and f\u2212 are. We also obtain the\nfollowing result.\nTheorem 3. If the functions f,g: S E are measurable on A , then\n\u2192 \u2217 \u2208 M\nA(f g) , A(f < g) , A(f = g) , and A(f = g) .\n\u2265 \u2208 M \u2208 M \u2208 M 6 \u2208 M\n(See Problem 4 below.)\nFurther Problems on Measurable Functions in (S,M)\n1. In Theorem 1, give the details in proving the equivalence of (i\u2217)\u2013(iv\u2217).\n2. Prove Note 1.\n2\u2032 . Prove that f = f+ f\u2212 and f = f+ +f\u2212.\n\u2212 | |\n3. Complete the proof of Theorem 2, in detail.\n\u21d24. Prove Theorem 3.\n[Hint: By our conventions, A(f g) = A(f g 0) even if g or f is for\n\u2265 \u2212 \u2265 \u00b1\u221e\nsome x A. (Verify all cases!) By Theorems 1 and 2, A(f g 0) ; so\n\u2208 \u2212 \u2265 \u2208 M\nA(f g) , and A(f <g)=A A(f g) . Proceed.]\n\u2265 \u2208M \u2212 \u2265 \u2208M\n5. Show that the measurability of f does not imply that of f.\n| |\n[Hint: Let f =1 on Q and f = 1 on A Q for some Q / (Q A); e.g., use Q\n\u2212 \u2212 \u2208M \u2282\nof Problem 6 in Chapter 7, 8.]\n\u00a7\n\u21d26. Show that a function f 0 is measurable on A iff f f (pointwise)\nm\n\u2265 \u0580\non A for some finite simple maps f 0, f .\nm m\n\u2265 { }\u2191\n[Hint: Modify the proof of Lemma 2, setting Hm =A(f m) and fm =m on Hm,\n\u2265\nand defining the A for 1 k m2m only.]\nmk\n\u2264 \u2264\n\u21d27. Prove Theorem 3 in 1.\n\u00a7\n[Outline: By Problems 7 and 8 in 1, there are qi T such that\n\u00a7 \u2208\n\u221e 1\n( \u2200n) f[A] Gqi .\n\u2286 n\ni [=1 (cid:16) (cid:17)\nSet\n1\nAni =A \u2229f\u22121 Gqi\nn \u2208M\nh (cid:16) (cid:17)i\nby Corollary 2; so \u03c1 \u2032(f(x),qi)< n1 on Ani. 230 Chapter 8. Measurable Functions. Integration\nBy Corollary 1 in Chapter 7, 1,\n\u00a7\n\u221e \u221e\nA= Ani = Bni (disjoint)\ni=1 i=1\n[ [\nfor some sets Bni \u2208M, Bni \u2286Ani. Now define gn =qi on Bni; so \u03c1 \u2032(f,gn)< n1 on\neach Bni, hence on A. By Theorem 1 in Chapter 4, 12, gn f (uniformly) on A.]\n\u00a7 \u2192\n\u21d28. Prove that f: S E1 is -measurable on A iff A f\u22121[B] for\n\u2192 M \u2229 \u2208 M\nevery Borel set B (equivalently, for every open set B) in E1. (In the\ncase f: S E\u2217, add: \u201cand for B = .\u201d)\n\u2192 {\u00b1\u221e}\n[Outline: Let\n= X E1 A f\u22121[X] .\nR { \u2286 | \u2229 \u2208M}\nShow that is a \u03c3-ring in E1.\nR\nNow, by Theorem 1, if f is measurable on A, contains all open intervals; for\nR\nA f\u22121[(a,b)]=A(f >a) A(f <b).\n\u2229 \u2229\nThen by Lemma 2 of Chapter 7, 2, , hence . (Why?)\n\u00a7 R\u2287G R\u2287B\nConversely, if so,\n(a, ) A f\u22121[(a, )] A(f >a) .]\n\u221e \u2208R\u21d2 \u2229 \u221e \u2208M\u21d2 \u2208M\n\u21d29. Do Problem 8 for f: S En.\n\u2192\n[Hint: If f = (f 1,... ,fn) and B = (a\u00af,\u00afb) En, with a\u00af = (a 1,... ,an) and \u00afb =\n\u2282\n(b 1,... ,bn), show that\nn\nf\u22121[B]= f k\u22121[(a k,b k)].\nk=1\n\\\nApply Problem 8 to each f : S E1 and use Theorem 2 in 1. Proceed as in\nk\n\u2192 \u00a7\nProblem 8.]\n10. Do Problem 8 for f: S Cn, treating Cn as E2n.\n\u2192\n11. Prove that f: S (T,\u03c1\u2032) is measurable on A in (S, ) iff\n\u2192 M\n(i) A f\u22121[G] for every open globe G T, and\n\u2229 \u2208 M \u2286\n(ii) f[A] is separable in T (Problem 7 in 1).\n\u00a7\n[Hint: If so, proceed as in Problem 7 (without assuming measurability of f) to show\nthatf =limgn forsomeelementary mapsgn onA. Fortheconverse, useProblem 7\nin 1 and Corollary 2 in 2.]\n\u00a7 \u00a7\n12. (i) Show that if all of T is separable (Problem 7 in 1), there is a\n\u00a7\nsequence of globes G T such that each nonempty open set\nk\n\u2286\nB T is the union of some of these G .\nk\n\u2286\n(ii) Show that En and Cn are separable.\n[Hints: (i) Use the Gqi( n1) of Problem 8 in \u00a71, putting them in one sequence.\n(ii) Take D =Rn En in Problem 7 of 1.]\n\u2282 \u00a7 2. Measurability of Extended-Real Functions 231\n\u00a7\n13. Do Problem 11 with \u201cglobe G T\u201d replaced by \u201cBorel set B T.\u201d\n\u2286 \u2286\n[Hints: Treat f as f: A T , T =f[A], noting that\n\u2032 \u2032\n\u2192\nA f\u22121[B]=A f\u22121[B T\u2032].\n\u2229 \u2229 \u2229\nBy Problem 12, if B = is open in T, then B T is a countable union of \u201cglobes\u201d\n\u2032\n6 \u2205 \u2229\nGq T in (T \u2032,\u03c1 \u2032); see Theorem 4 in Chapter 3, 12. Proceed as in Problem 8,\n\u2032\n\u2229 \u00a7\nreplacing E1 by T.]\n14. A map g: (T,\u03c1\u2032) (U,\u03c1\u2032\u2032) is said to be of Baire class 0 (g B ) on\n0\n\u2192 \u2208\nD T iff g is relatively continuous on D. Inductively, g is of Baire\n\u2286\nclass n (g B , n 1) iff g = limg (pointwise) on D for some maps\nn m\n\u2208 \u2265\ng B . Show by induction that Corollary 4 in 1 holds also if\nm n\u22121\n\u2208 \u00a7\ng B on f[A] for some n.\nn\n\u2208\n\u00a73. Measurable Functions in (S,M,m)\nI. Henceforth we shall presuppose not just a measurable space ( 1) but a mea-\n\u00a7\nsure space (S, ,m), where m: E\u2217 is a measure on a \u03c3-ring 2S.\nM M \u2192 M \u2286\nWe saw in Chapter 7 that one could often neglect sets of Lebesgue measure\nzero on En\u2014if a property held everywhere except on a set of Lebesgue measure\nzero, we said it held \u201calmost everywhere.\u201d The following definition generalizes\nthis usage.\nDefinition 1.\nWe say that a property P(x) holds for almost all x A (with respect to\n\u2208\nthe measure m) or almost everywhere (a.e.(m)) on A iff it holds on A Q\n\u2212\nfor some Q with mQ = 0.\n\u2208 M\nThus we write\nf f (a.e.) or f = limf (a.e.(m)) on A\nn n\n\u2192\niff f f (pointwise) on A Q, mQ = 0. Of course, \u201cpointwise\u201d implies\nn\n\u2192 \u2212\n\u201ca.e.\u201d (take Q = ), but the converse fails.\n\u2205\nDefinition 2.\nWe say that f: S (T,\u03c1\u2032) is almost measurable on A iff A and f\n\u2192 \u2208 M\nis -measurable on A Q, mQ = 0.\nM \u2212\nWe then also say that f is m-measurable (m being the measure in-\nvolved) as opposed to -measurable.\nM\nObserve that we may assume Q A here (replace Q by A Q).\n\u2286 \u2229\n\u2217\nNote 1. If m is a generalized measure (Chapter 7, 11), replace mQ = 0\n\u00a7\nby v Q = 0 (v = total variation of m) in Definitions 1 and 2 and in the\nm m\nfollowing proofs. 232 Chapter 8. Measurable Functions. Integration\nCorollary 1. If the functions\nf : S (T,\u03c1\u2032), n = 1,2,...,\nn\n\u2192\nare m-measurable on A, and if\nf f (a.e.(m))\nn\n\u2192\non A, then f is m-measurable on A.\nProof. By assumption, f f (pointwise) on A Q , mQ = 0. Also, f is\nn 0 0 n\n\u2192 \u2212\n-measurable on\nM\nA Q , mQ = 0, n = 1,2,....\nn n\n\u2212\n(The Q need not be the same.)\nn\nLet\n\u221e\nQ = Q ;\nn\nn=0\n[\nso\n\u221e\nmQ mQ = 0.\nn\n\u2264\nn=0\nX\nBy Corollary 2 in 1, all f are -measurable on A Q (why?), and f f\nn n\n\u00a7 M \u2212 \u2192\n(pointwise) on A Q, as A Q A Q .\n0\n\u2212 \u2212 \u2286 \u2212\nThus by Theorem 4 in 1, f is -measurable on A Q. As mQ = 0, this\n\u00a7 M \u2212\nis the desired result. (cid:3)\nCorollary 2. If f = g (a.e. (m)) on A and f is m-measurable on A, so is g.\nProof. By assumption, f = g on A Q and f is -measurable on A Q ,\n1 2\n\u2212 M \u2212\nwith mQ = mQ = 0.\n1 2\nLet Q = Q Q . Then mQ = 0 and g = f on A Q. (Why?)\n1 2\n\u222a \u2212\nBy Corollary 2 of 1, f is -measurable on A Q. Hence so is g, as\n\u00a7 M \u2212\nclaimed. (cid:3)\nCorollary 3. If f: S (T,\u03c1\u2032) is m-measurable on A, then\n\u2192\nf = lim f (uniformly) on A Q (mQ = 0),\nn\nn\u2192\u221e \u2212\nfor some maps f , all elementary on A Q.\nn\n\u2212\n(Compare Corollary 3 with Theorem 3 in 1).\n\u00a7\nQuite similarly all other propositions of 1 carry over to almost measurable\n\u00a7\n(i.e., m-measurable) functions. Note, however, that the term \u201cmeasurable\u201d in\n1 and 2 always meant \u201c -measurable.\u201d This implies m-measurability (take\n\u00a7\u00a7 M\nQ = ), but the converse fails. (See Note 2, however.)\n\u2205\nWe still obtain the following result. 3. Measurable Functions in (S, ,m) 233\n\u00a7 M\nCorollary 4. If the functions\nf : S E\u2217 (n = 1,2,...)\nn\n\u2192\nare m-measurable on a set A, so also are\nsupf , inff , limf , and limf .\nn n n n\n(Use Lemma 1 of 2).\n\u00a7\nSimilarly, Theorem 2 in 2 carries over to m-measurable functions.\n\u00a7\nNote 2. Ifmiscomplete (suchasLebesguemeasureandLSmeasures)then,\nfor f: S E\u2217(En, Cn), m- and -measurability coincide (see Problem 3\n\u2192 M\nbelow).\nII. Measurability and Continuity. To study the connection between these\nnotions, we first state two lemmas, often treated as definitions.\nLemma 1. A map f: S En(Cn) is -measurable on A iff\n\u2192 M\nA f\u22121[B]\n\u2229 \u2208 M\nfor each Borel set (equivalently, open set) B in En(Cn).\nSee Problems 8\u201310 in 2 for a sketch of the proof.\n\u00a7\nLemma 2. A map f: (S,\u03c1) (T,\u03c1\u2032) is relatively continuous on A S iff for\n\u2192 \u2286\nany open set B (T,\u03c1\u2032), the set A f\u22121[B] is open in (A,\u03c1) as a subspace of\n\u2286 \u2229\n(S,\u03c1).\n(This holds also with \u201copen\u201d replaced by \u201cclosed.\u201d)\nProof. By Chapter 4, 1, footnote 4, f is relatively continuous on A iff its\n\u00a7\nrestriction to A (call it g: A T) is continuous in the ordinary sense.\n\u2192\nNow, by Problem 15(iv)(v) in Chapter 4, 2, with S replaced by A, this\n\u00a7\nmeans that g\u22121[B] is open (closed) in (A,\u03c1) when B is so in (T,\u03c1\u2032). But\ng\u22121[B] = x A f(x) B = A f\u22121[B].\n{ \u2208 | \u2208 } \u2229\n(Why?) Hence the result follows. (cid:3)\nTheorem 1. Let m: E\u2217 be a topological measure in (S,\u03c1). If f: S\nM \u2192 \u2192\nEn(Cn) is relatively continuous on a set A , it is -measurable on A.\n\u2208 M M\nProof. Let B be open in En(Cn). By Lemma 2,\nA f\u22121[B]\n\u2229\nis open in (A,\u03c1). Hence by Theorem 4 of Chapter 3, 12,\n\u00a7\nA f\u22121[B] = A U\n\u2229 \u2229\nfor some open set U in (S,\u03c1). 234 Chapter 8. Measurable Functions. Integration\nNow, by assumption, A is in . So is U, as is topological ( ).\nM M M \u2287 G\nHence\nA f\u22121[B] = A U\n\u2229 \u2229 \u2208 M\nfor any open B En(Cn). The result follows by Lemma 1. (cid:3)\n\u2286\nNote 3. The converse fails. For example, the Dirichlet function (Exam-\nple (c) in Chapter 4, 1) is L-measurable (even simple) but discontinuous ev-\n\u00a7\nerywhere.\nNote 4. Lemma 1 and Theorem 1 hold for a map f: S (T,\u03c1\u2032), too,\n\u2192\nprovided f[A] is separable, i.e.,\nf[A] D\n\u2286\nfor a countable set D T (cf. Problem 11 in 2).\n\u2286 \u00a7\n\u2217\nIII. For strongly regular measures (Definition 5 in Chapter 7, 7), we obtain\n\u00a7\nthe following theorem.\n\u2217 Theorem 2 (Luzin). Let m: E\u2217 be a strongly regular measure in (S,\u03c1).\nM \u2192\nLet f: S (T,\u03c1\u2032) be m-measurable on A.\n\u2192\nThen given \u03b5 > 0, there is a closed set F A (F ) such that\n\u2286 \u2208 M\nm(A F) < \u03b5\n\u2212\nand f is relatively continuous on F.\n(Note that if T = E\u2217, \u03c1\u2032 is as in Problem 5 of Chapter 3, 11.)\n\u00a7\nProof.1 By assumption, f is -measurable on a set\nM\nH = A Q, mQ = 0;\n\u2212\nso by Problem 7 in 1, f[H] is separable in T. We may safely assume that f is\n\u00a7\n-measurable on S and that all of T is separable. (If not, replace S and T by\nM\nH and f[H], restricting f to H, and m to -sets inside H; see also Problems 7\nM\nand 8 below.)\nThen by Problem 12 of 2, we can fix globes G ,G ,... in T such that\n1 2\n\u00a7\n(1) each open set B = in T is the union of a subsequence of G .\nk\n6 \u2205 { }\nNow let \u03b5 > 0, and set\nS = S f\u22121[G ] = f\u22121[G ], k = 1,2,....\nk k k\n\u2229\nBy Corollary 2 in 2, S . As m is strongly regular, we find for each S\nk k\n\u00a7 \u2208 M\nan open set\nU S ,\nk k\n\u2287\n1For a simpler proof, in the case mA< , see Problem 10 below.\n\u221e 3. Measurable Functions in (S, ,m) 235\n\u00a7 M\nwith U and\nk\n\u2208 M \u03b5\nm(U S ) < .\nk \u2212 k 2k+1\nLet B = U S , D = B ; so D and\nk k \u2212 k k k \u2208 M\nS \u03b5 1\n(2) mD mB \u03b5\n\u2264 k \u2264 2k+1 \u2264 2\nk k\nX X\nand\n(2\u2032) U B = S = f\u22121[G ].\nk k k k\n\u2212\nAs D = B , we have\nk\nS ( k) B D = B ( D) = .\nk k\n\u2200 \u2212 \u2229 \u2212 \u2205\nHence by (2\u2032),\n( k) f\u22121[G ] ( D) = (U B ) ( D)\nk k k\n\u2200 \u2229 \u2212 \u2212 \u2229 \u2212\n= (U ( D)) (B ( D)) = U ( D).\nk k k\n\u2229 \u2212 \u2212 \u2229 \u2212 \u2229 \u2212\nCombining this with (1), we have, for each open set B = G in T,\ni ki\n(3) f\u22121[B] ( D) = f\u22121[G ] ( D) = U S( D).\nki ki\n\u2229 \u2212 \u2229 \u2212 \u2229 \u2212\ni i\n[ [\nSince the U are open in S (by construction), the set (3) is open in S D\nki\n\u2212\nas a subspace of S. By Lemma 2, then, f is relatively continuous on S D, or\n\u2212\nrather on\nH D = A Q D\n\u2212 \u2212 \u2212\n(since we actually substituted S for H in the course of the proof). As mQ = 0\nand mD < 1\u03b5 by (2),\n2\n1\nm(H D) < mA \u03b5.\n\u2212 \u2212 2\nFinally, as m is strongly regular and H D , there is a closed -set\n\u2212 \u2208 M M\nF H D A\n\u2286 \u2212 \u2286\nsuch that\n1\nm(H D F) < \u03b5.\n\u2212 \u2212 2\nSince f is relatively continuous on H D, it is surely so on F. Moreover,\n\u2212\nA F = (A (H D)) (H D F);\n\u2212 \u2212 \u2212 \u222a \u2212 \u2212\nso\n1 1\nm(A F) m(A (H D))+m(H D F) < \u03b5+ \u03b5 = \u03b5.\n\u2212 \u2264 \u2212 \u2212 \u2212 \u2212 2 2 236 Chapter 8. Measurable Functions. Integration\nThis completes the proof. (cid:3)\n\u2217 Lemma 3. Given [a,b] E1 and disjoint closed sets A,B (S,\u03c1), there\n\u2282 \u2286\nalways is a continuous map g: S [a,b] such that g = a on A and g = b\n\u2192\non B.\nProof. If A = or B = , set g = b or g = a on all of S.\n\u2205 \u2205\nIf, however, A and B are both nonempty, set\n(b a)\u03c1(x,A)\ng(x) = a+ \u2212 .\n\u03c1(x,A)+\u03c1(x,B)\nAs A is closed, \u03c1(x,A) = 0 iff x A (Problem 15 in Chapter 3, 14); similarly\n\u2208 \u00a7\nfor B. Thus \u03c1(x,A)+\u03c1(x,B) = 0.\n6\nAlso, g = a on A, g = b on B, and a g b on S.\n\u2264 \u2264\nFor continuity, see Chapter 4, 8, Example (e). (cid:3)\n\u00a7\n\u2217 Lemma 4 (Tietze). If f: (S,\u03c1) E\u2217 is relatively continuous on a closed set\n\u2192\nF S, there is a function g: S E\u2217 such that g = f on F,\n\u2286 \u2192\ninfg[S] = inff[F], supg[S] = supf[F],\nand g is continuous on all of S.\n(We assume E\u2217 metrized as in Problem 5 of Chapter 3, 11. If f < , the\n\u00a7 | | \u221e\nstandard metric in E1 may be used.)\nProof Outline. First, assume inff[F] = 0 and supf[F] = 1. Set\n1 1\nA = F f = F f\u22121 0,\n\u2264 3 \u2229 3\n(cid:20) (cid:21)\n(cid:16) (cid:17) h i\nand\n2 2\nB = F f = F f\u22121 ,1 .\n\u2265 3 \u2229 3\n(cid:20) (cid:21)\n(cid:16) (cid:17) h i\nAs F is closed in S, so are A and B by Lemma 2. (Why?)\nAs B A = , Lemma 3 yields a continuous map g : S [0, 1], with g = 0\n\u2229 \u2205 1 \u2192 3 1\non A, and g = 1 on B. Set f = f g on F; so f 2, and f is continuous\n1 3 1 \u2212 1 | 1 | \u2264 3 1\non F.\nApplying the same steps to f (with suitable sets A ,B F), find a con-\n1 1 1\n\u2286\ntinuous map g , with 0 g 2 1 on S. Then f = f g is continuous,\n2 \u2264 2 \u2264 3 \u00b7 3 2 1 \u2212 2\nand 0 f (2)2 on F.\n\u2264 2 \u2264 3\nContinuing, obtain two sequences g and f of real functions such that\nn n\n{ } { }\neach g is continuous on S,\nn\n1 2 n\u22121\n0 g ,\nn\n\u2264 \u2264 3 3\n(cid:16) (cid:17) 3. Measurable Functions in (S, ,m) 237\n\u00a7 M\nand f = f g is defined and continuous on F, with\nn n\u22121 n\n\u2212\n2 n\n0 f\nn\n\u2264 \u2264 3\n(cid:16) (cid:17)\nthere (f = f).\n0\nWe claim that\n\u221e\ng = g\nn\nn=1\nX\nis the desired map.\nIndeed, the series converges uniformly on S (Theorem 3 of Chapter 4, 12).\n\u00a7\nAs all g are continuous, so is g (Theorem 2 in Chapter 4, 12). Also,\nn\n\u00a7\nn\n2 n\nf g 0\nk\n\u2212 \u2264 3 \u2192\n(cid:12) k X=1 (cid:12) (cid:16) (cid:17)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\non F (why?); so f = g on F(cid:12) . Moreove(cid:12)r,\n\u221e\n1 2 n\n0 g g = 1 on S.\n1\n\u2264 \u2264 \u2264 3 3\nn X=1 (cid:16) (cid:17)\nHence infg[S] = 0 and supg[S] = 1, as required.\nNow assume\ninff[F] = a < supf[F] = b (a,b E1).\n\u2208\nSet\nf(x) a\nh(x) = \u2212\nb a\n\u2212\nso that infh[F] = 0 and suph[F] = 1. (Why?)\nAs shown above, there is a continuous map g on S, with\n0\nf a\ng = h = \u2212\n0\nb a\n\u2212\non F, infg [S] = 0, and supg [S] = 1. Set\n0 0\na+(b a)g = g.\n0\n\u2212\nThen g is the required function. (Verify!)\nFinally, if a,b E\u2217 (a < b), all reduces to the bounded case by considering\n\u2208\nH(x) = arctanf(x). (cid:3)\n\u2217 Theorem 3 (Fr\u00b4echet). Let m: E\u2217 be a strongly regular measure in\nM \u2192\n(S,\u03c1). If f: S E\u2217(En, Cn) is m-measurable on A, then\n\u2192\nf = lim f (a.e.(m)) on A\ni\ni\u2192\u221e 238 Chapter 8. Measurable Functions. Integration\nfor some sequence of maps f continuous on S. (We assume E\u2217 to be metrized\ni\nas in Lemma 4.)\nProof. Weconsiderf: S E\u2217 (theothercasesreducetoE1 viacomponents).\n\u2192\nTaking \u03b5 = 1 (i = 1,2,...) in Theorem 2, we obtain for each i a closed\ni\n-set F A such that\ni\nM \u2286 1\nm(A F ) <\ni\n\u2212 i\nand f is relatively continuous on each F . We may assume that F F (if\ni i i+1\n\u2286\ni\nnot, replace F by F ).\ni k=1 k\nNow, Lemma 4 yields for each i a continuous map f : S E\u2217 such that\nS i \u2192\nf = f on F . We complete the proof by showing that f f (pointwise) on\ni i i\n\u2192\nthe set\n\u221e\nB = F\ni\ni=1\n[\nand that m(A B) = 0.\n\u2212\nIndeed, fix any x B. Then x F for some i = i , hence also for i > i\ni 0 0\n\u2208 \u2208\n(since F ). As f = f on F , we have\ni i i\n{ }\u2191\n( i > i ) f (x) = f(x),\n0 i\n\u2200\nand so f (x) f(x) for x B. As F B, we get\ni i\n\u2192 \u2208 \u2286\n1\nm(A B) m(A F ) <\ni\n\u2212 \u2264 \u2212 i\nfor all i. Hence m(A B) = 0, and all is proved. (cid:3)\n\u2212\nProblems on Measurable Functions in (S,M,m)\n1. Fill in all proof details in Corollaries 1 to 4.\n\u2032\n1 . Verify Notes 3 and 4.\n2. Prove Theorems 1 and 2 in 1 and Theorem 2 in 2, for almost measur-\n\u00a7 \u00a7\nable functions.\n3. Prove Note 2.\n[Hint: If f: S E is -measurable on B = A Q (mQ = 0, Q A), then\n\u2217\n\u2192 M \u2212 \u2286\nA=B Q and\n\u222a\n( a E\u2217) A(f >a)=B(f >a) Q(f >a).\n\u2200 \u2208 \u222a\nHere B(f > a) by Theorem 1 in 2, and Q(f > a) if m is complete. For\n\u2208 M \u00a7 \u2208 M\nf: S En(Cn), use Theorem 2 of 1.]\n\u2192 \u00a7\n\u2217 4. Show that if m is complete and f: S (T,\u03c1\u2032) is m-measurable on A\n\u2192\nwith f[A] separable in T, then f is -measurable on A.\nM\n[Hint: Use Problem 13 in 2.]\n\u00a7 3. Measurable Functions in (S, ,m) 239\n\u00a7 M\n\u2217 5. Prove Theorem 1 for f: S (T,\u03c1\u2032), assuming that f[A] is separable\n\u2192\nin T.\n6. Given f f (a.e.) on A, prove that f g (a.e.) on A iff f = g (a.e.)\nn n\n\u2192 \u2192\non A.\n7. Given A in (S, ,m), let m be the restriction of m to\nA\n\u2208 M M\n= X X A .\nA\nM { \u2208 M | \u2286 }\nProve that\n(i) (A, ,m ) is a measure space (called a subspace of (S, ,m));\nA A\nM M\n(ii) if m is complete, topological, \u03c3-finite or (strongly) regular, so\nis m .\nA\n8. (i) ShowthatifD K (T,\u03c1\u2032), thentheclosureofD in the subspace\n\u2286 \u2286\n(K,\u03c1\u2032) is K D, where D is the closure of D in (T,\u03c1\u2032).\n\u2229\n[Hint: Use Problem 11 in Chapter 3, 16.]\n\u00a7\n(ii) Prove that if B K and if B is separable in (T,\u03c1\u2032), it is so\n\u2286\nin (K,\u03c1\u2032).\n[Hint: Use Problem 7 from 1.]\n\u00a7\n\u2217\n9. Fill in all proof details in Lemma 4.\n10. Simplify the proof of Theorem 2 for the case mA < .\n\u221e\n[Outline: (i) First, let f be elementary, with f = ai on Ai M, A = iAi\n\u2208\n(disjoint), mAi =mA< .\n\u221e S\nGiven \u03b5>0,\nP\nn\n1\n( n) mA mAi < \u03b5.\n\u2203 \u2212 2\ni=1\nX\nEach Ai has a closed subset Fi with m(Ai Fi) < \u03b5/2n. (Why?) Now use\nProblem 17 in Chapter 4, \u00a78, and\u2208 sM et F = n i=1Fi\u2212 .\n(ii) If f is -measurable on H = A Q, mQ = 0, then by Theorem 3 in 1,\nM \u2212S \u00a7\nfn f (uniformly) onH forsomeelementary maps fn. By(i), eachfn is relatively\n\u2192\ncontinuous on a closed -set Fn H, with mH mFn < \u03b5/2n; so all fn are\nM \u2286 \u2212\nrelatively continuous on F = \u221en=1Fn. Show that F is the required set.]\n11. Given f : S (T,\u03c1\u2032), nT= 1,2,..., we say that\nn\n\u2192\n(i) f f almost uniformly on A S iff\nn\n\u2192 \u2286\n( \u03b4 > 0) ( D mD < \u03b4) f f (uniformly) on A D;\nn\n\u2200 \u2203 \u2208 M | \u2192 \u2212\n(ii) f f in measure on A iff\nn\n\u2192\n( \u03b4,\u03c3 > 0) ( k) ( n > k) ( D mD < \u03b4)\nn n\n\u2200 \u2203 \u2200 \u2203 \u2208 M |\n\u03c1\u2032(f,f ) < \u03c3 on A D .\nn n\n\u2212 240 Chapter 8. Measurable Functions. Integration\nProve the following.\n(a) f f (uniformly) implies f f (almost uniformly), and the\nn n\n\u2192 \u2192\nlatter implies both f f (in measure) and f f (a.e.).\nn n\n\u2192 \u2192\n(b) Given f f (almost uniformly), we have f g (almost uni-\nn n\n\u2192 \u2192\nformly) iff f = g (a.e.); similarly for convergence in measure.\n(c) If f and f are -measurable on A, then f f in measure on\nn n\nM \u2192\nA iff\n( \u03c3 > 0) lim mA(\u03c1\u2032(f,f ) \u03c3) = 0.\nn\n\u2200 n\u2192\u221e \u2265\n12. Assuming that f : S (T,\u03c1\u2032) is m-measurable on A for n = 1,2,...,\nn\n\u2192\nthat mA < , and that f f (a.e.) on A, prove the following.\nn\n\u221e \u2192\n(i) Lebesgue\u2019s theorem: f f (in measure) on A (see Problem 11).\nn\n\u2192\n(ii) Egorov\u2019s theorem: f f (almost uniformly) on A.\nn\n\u2192\n[Outline: (i) fn and f are -measurable on H = A Q, mQ = 0 (Corollary 1),\nM \u2212\nwith fn f (pointwise) on H. For all i,k, set\n\u2192\n\u221e 1\nHi(k)= H \u03c1\u2032(fn,f)<\nk \u2208M\nn \\=i (cid:16) (cid:17)\nby Problem 6 in 1. Show that ( k) Hi(k) H; hence\n\u00a7 \u2200 \u0580\nlim mHi(k)=mH =mA< ;\ni \u221e\n\u2192\u221e\nso\n\u03b4\n( \u2200\u03b4 >0) ( \u2200k) ( \u2203i k) m(A \u2212Hik(k))< 2k,\nproving (i), since\n1\n( \u2200n>i k) \u03c1\u2032(fn,f)< on Hik(k)=A \u2212(A \u2212Hik(k)).\nk\n(ii) Continuing, set ( \u2200k) D =Hik(k) and\nk\n\u221e \u221e\nD =A D = (A D ).\nk k\n\u2212 \u2212\nk=1 k=1\n\\ [\nDeduce that D and\n\u2208M\n\u221e \u221e \u03b4\nmD m(A \u2212Hik(k))< =\u03b4.\n\u2264 2k\nk=1 k=1\nX X\nNow, from the definition of the Hi(k), show that fn f (uniformly) on A D,\n\u2192 \u2212\nproving (ii).]\n13. Disprove the converse to Problem 12(i).\n[Outline: Assume that A=[0,1); for all 0 k and all 0 i<2k, set\n\u2264 \u2264\n1 if i 2\u2212k1 \u2264x< 2i k,\ng ik(x)=\n( 0 otherwise. 3. Measurable Functions in (S, ,m) 241\n\u00a7 M\nPut the g in a single sequence by\nik\nf 2k+i =g ik.\nShow that fn 0 in L measure on A, yet for no x A does fn(x) converge as\n\u2192 \u2208\nn .]\n\u2192\u221e\n14. Prove that if f: S (T,\u03c1\u2032) is m-measurable on A and g: T (U,\u03c1\u2032\u2032) is\n\u2192 \u2192\nrelatively continuous on f[A], then g f: S (U,\u03c1\u2032\u2032) is m-measurable\n\u25e6 \u2192\non A.\n[Hint: Use Corollary 4 in 1.]\n\u00a7\n\u00a74. Integration of Elementary Functions\nIn Chapter 5, integration was treated as antidifferentiation. Now we adopt\nanother, measure-theoretical approach.\nLebesgue\u2019s original theory was based on Lebesgue measure (Chapter 7, 8).\n\u00a7\nThe more general modern treatment develops the integral for functions f: S\n\u2192\nE in an arbitrary measure space. Henceforth, (S, ,m) is fixed, and the range\nM\nspace E is E1, E\u2217, C, En, or another complete normed space. Recall that\nin such a space, a < implies that a converges and is permutable\ni| i | \u221e i\n(Chapter 7, 2).\n\u00a7 P P\nWe start with elementary maps, including simple maps as a special case.1\nDefinition 1.\nLet f: S E be elementary on A ; so f = a on A for some\ni i\n\u2192 \u2208 M\n-partition\nM\nA = A (disjoint).\ni\ni\n[\n(Note that there may be many such partitions.)\nWe say that f is integrable (with respect to m), or m-integrable, on\nA iff\na mA < .\ni i\n| | \u221e\n(The notation \u201c a mA \u201dX always makes sense by our conventions (2\u2217) in\ni i\n| |\nChapter 4, 4.) If m is Lebesgue measure, then we say that f is Lebesgue\n\u00a7\nintegrable, or L-integrable.\nWe then define f, the m-integral of f on A, by\nA\nR\n(1) f = f dm = a mA .\ni i\nZA ZA\ni\nX\n1For a \u201climited approach,\u201d use finite -partitions and -simple maps, treating m as\nM M\nan additive premeasure on , a ring.\nM 242 Chapter 8. Measurable Functions. Integration\n(The notation \u201cdm\u201d is used to specify the measure m.)\nThe \u201cclassical\u201d notation for f dm is f(x)dm(x).\nA A\nR R\nNote 1. The assumption\na mA <\ni i\n| | \u221e\nX\nimplies\n( i) a mA < ;\ni i\n\u2200 | | \u221e\nso a = 0 if mA = , and mA = 0 if a = . Thus by our conventions, all\ni i i i\n\u221e | | \u221e\n\u201cbad\u201d terms a mA vanish. Hence the sum in (1) makes sense and is finite.\ni i\nNote 2. This sum is also independent of the particular choice of A . For\ni\n{ }\nif B is another -partition of A, with f = b on B , say, then f = a = b\nk k k i k\n{ } M\non A B whenever A B = . Also,\ni k i k\n\u2229 \u2229 6 \u2205\n( i) A = (A B ) (disjoint);\ni i k\n\u2200 \u2229\nk\n[\nso\n( i) a mA = a m(A B ),\ni i i i k\n\u2200 \u2229\nk\nX\nand hence (see Theorem 2 of Chapter 7, 2, and Problem 11 there)\n\u00a7\na mA = a m(A B ) = b m(A B ) = b mB .\ni i i i k k i k k k\n\u2229 \u2229\ni i k k i k\nX XX XX X\n(Explain!)\nThis makes our definition (1) unambiguous and allows us to choose any\n-partition A , with f constant on each A , when forming integrals (1).\ni i\nM { }\nCorollary 1. Let f: S E be elementary and integrable on A . Then\n\u2192 \u2208 M\nthe following statements are true.\n(i) f < a.e. on A.2\n| | \u221e\n(ii) f and f are elementary and integrable on any -set B A, and\n| | M \u2286\nf f f .\n\u2264 | | \u2264 | |\n(cid:12)ZB (cid:12) ZB ZA\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(iii) The set B = A(f = 0) is \u03c3-finite (Definition 4 in Chapter 7, 5), and\n(cid:12) (cid:12)\n6 \u00a7\nf = f.\nZA ZB\n2That is, on A Q for some Q , with mQ=0.\n\u2212 \u2208M 4. Integration of Elementary Functions 243\n\u00a7\n(iv) If f = a (constant) on A,\nf = a mA.\n\u00b7\nZA\n(v) f = 0 iff f = 0 a.e. on A.\nA| |\n(vi) RIf mQ = 0, then\nf = f\nZA ZA\u2212Q\n(so we may neglect sets of measure 0 in integrals).\n(vii) For any k in the scalar field of E, kf is elementary and integrable, and\nkf = k f.\nZA ZA\nNote that if f is scalar valued, k may be a vector. If E = E\u2217, we assume\nk E1.\n\u2208\nProof.\n(i) By Note 1, f = a = only on those A with mA = 0. Let Q be the\ni i i\n| | | | \u221e\nunion of all such A . Then mQ = 0 and f < on A Q, proving (i).\ni\n| | \u221e \u2212\n(ii) If A is an -partition of A, B A is one for B. (Verify!) We have\ni i\n{ } M { \u2229 }\nf = a and f = a on B A A .\ni i i i\n| | | | \u2229 \u2286\nAlso,\na m(B A ) a mA < .\ni i i i\n| | \u2229 \u2264 | | \u221e\nX X\n(Why?) Thus f and f are elementary and integrable on B, and (ii)\n| |\neasily follows by formula (1).\n(iii) By Note 1, f = 0 on A if mA = . Thus f = 0 on A only if mA < .\ni i i i\n\u221e 6 \u221e\nLet A be the subsequence of those A on which f = 0; so\nik} i\n{ 6\n( k) mA < .\nik\n\u2200 \u221e\nAlso,\nB = A(f = 0) = A (\u03c3-finite!).\nik\n6 \u2208 M\nk\n[\nBy (ii), f is elementary and integrable on B. Also,\nf = a mA ,\nik ik\nZB\nk\nX\nwhile\nf = a mA .\ni i\nZA\ni\nX 244 Chapter 8. Measurable Functions. Integration\nThese sums differ only by terms with a = 0. Thus (iii) follows.\ni\nThe proof of (iv)\u2013(vii) is left to the reader. (cid:3)\nNote 3. If f: S E\u2217 is elementary and sign-constant on A, we also al-\n\u2192\nlow that\nf = a mA = .\ni i\n\u00b1\u221e\nZA\ni\nX\nThus here f exists even if f is not integrable. Apart from claims of inte-\nA\ngrability and \u03c3-finiteness, Corollary 1(ii)\u2013(vii) hold for such f, with the same\nR\nproofs.\nExample.\nLet m be Lebesgue measure in E1. Define f = 1 on R (rationals) and\nf = 0 on E1 R; see Chapter 4, 1, Example (c). Let A = [0,1].\n\u2212 \u00a7\nBy Corollary 1 in Chapter 7, 8, A R \u2217 and m(A R) = 0. Also,\n\u00a7 \u2229 \u2208 M \u2229\nA R \u2217.\n\u2212 \u2208 M\nThus A R,A R is an \u2217-partition of A, with f = 1 on A R\n{ \u2229 \u2212 } M \u2229\nand f = 0 on A R.\n\u2212\nHence f is elementary and integrable on A, and\nf = 1 m(A R)+0 m(A R) = 0.\n\u00b7 \u2229 \u00b7 \u2212\nZA\nThus f is L-integrable (even though it is nowhere continuous).\nTheorem 1 (additivity).\n(i) If f: S E is elementary and integrable or elementary and nonnegative\n\u2192\non A , then\n\u2208 M\n(2) f = f\nZA ZBk\nk\nX\nfor any -partition B of A.\nk\nM { }\n(ii) If f is elementary and integrable on each set B of a finite -partition\nk\nM\nA = B ,\nk\nk\n[\nit is elementary and integrable on all of A, and (2) holds again.\nProof. (i) If f is elementary and integrable or elementary and nonnegative on\nA = B , it is surely so on each B by Corollary 2 of 1 and Corollary 1(ii)\nk k k \u00a7\nabove.\nS 4. Integration of Elementary Functions 245\n\u00a7\nThus for each k, we can fix an -partition B = A , with f constant\nM k i ki\n(f = a ) on A , i = 1,2,.... Then\nki ki\nS\nA = B = A\nk ki\nk k i\n[ [[\nis an -partition of A into the disjoint sets A .\nki\nM \u2208 M\nNow, by definition,\nf = a mA\nki ki\nZBk\ni\nX\nand\nf = a mA = a mA = f\nki ki ki ki\nZA k,i k (cid:18) i (cid:19) k ZBk\nX X X X\nby rules for double series. This proves formula (2).\n(ii) If f is elementary and integrable on B (k = 1,... ,n), then with the\nk\nsame notation, we have\na mA <\nki ki\n| | \u221e\ni\nX\n(by integrability); hence\nn\na mA < .\nki ki\n| | \u221e\nk=1 i\nXX\nThis means, however, that f is elementary and integrable on A, and so clause\n(ii) follows. (cid:3)\nCaution. Clause (ii) fails if the partition B is infinite.\nk\n{ }\nTheorem 2.\n(i) If f,g: S E\u2217 are elementary and nonnegative on A, then\n\u2192\n(f +g) = f + g.\nZA ZA ZA\n(ii) If f,g: S E are elementary and integrable on A, so is f g, and\n\u2192 \u00b1\n(f g) = f g.\n\u00b1 \u00b1\nZA ZA ZA\nProof. Arguing as in the proof of Theorem 1 of 1, we can make f and g\n\u00a7\nconstant on sets of one and the same -partition of A, say, f = a and g = b\ni i\nM\non A ; so\ni\n\u2208 M\nf g = a b on A , i = 1,2,....\ni i i\n\u00b1 \u00b1 246 Chapter 8. Measurable Functions. Integration\nIn case (i), f,g 0; so integrability is irrelevant by Note 3, and formula (1)\n\u2265\nyields\n(f +g) = (a +b )mA = a mA + b mA = f + g.\ni i i i i i i\nZA ZA ZA\ni i\nX X X\nIn (ii), we similarly obtain\na b mA a mA + b mA < .\ni i i i i i i\n| \u00b1 | \u2264 | | | | \u221e\ni i\nX X X\n(Why?) Thus f g is elementary and integrable on A. As before, we also get\n\u00b1\n(f g) = f g,\n\u00b1 \u00b1\nZA ZA ZA\nsimply by rules for addition of convergent series. (Verify!) (cid:3)\nNote 4. As we know, the characteristic function C of a set B S is\nB\n\u2286\ndefined\n1, x B,\nC (x) = \u2208\nB\n0, x S B.\n(cid:26) \u2208 \u2212\nIf g: S E is elementary on A, so that\n\u2192\ng = a on A , 1,2,...,\ni i\nfor some -partition\nM\nA = A ,\ni\n[\nthen\ng = a C on A.\ni Ai\ni\nX\n(This sum always exists for disjoint sets A . Why?) We shall often use this\ni\nnotation.\nIf m is Lebesgue measure in E1,\nY\nthe integral\ng = a mA\ni i y =f(x)\nZA\ni\nX\nhasasimplegeometricinterpretation;\nsee Figure 33. Let A = [a,b] E1;\n\u2282\nlet g be bounded and nonnegative on\nA A A Ai\n1 2 3\nE1. Each product a imA i is the area O a b X\nof a rectangle with base A i and al- Figure 33\ntitude a . (We assume the A to be\ni i 4. Integration of Elementary Functions 247\n\u00a7\nintervals here.) The total area,\ng = a mA ,\ni i\nZA\ni\nX\ncan be treated as an approximation to the area under some curve y = f(x),\nwhere f is approximated by g (Theorem 3 in 1). Integration historically arose\n\u00a7\nfrom such approximations.\nIntegration of elementary extended-real functions. Note 3 can be extended\nto sign-changing functions as follows.\nDefinition 2.\nIf\nf = a C (a E\u2217)\ni Ai i\n\u2208\ni\nX\non\nA = A (A ),\ni i\n\u2208 M\ni\n[\nwe set\n(3) f = f+ f\u2212,\n\u2212\nZA ZA ZA\nwith\nf+ = f 0 0 and f\u2212 = ( f) 0 0;\n\u2228 \u2265 \u2212 \u2228 \u2265\nsee 2.\n\u00a7\nBy Theorem 2 in 2, f+ and f\u2212 are elementary and nonnegative on A; so\n\u00a7\nf+ and f\u2212\nZA ZA\nare defined by Note 3, and so is\nf = f+ f\u2212\n\u2212\nZA ZA ZA\nby our conventions (2*) in Chapter 4, 4.\n\u00a7\nWe shall have use for formula (3), even if\nf+ = f\u2212 = ;\n\u221e\nZA ZA\nthen we say that f is unorthodox and equate it to + , by convention;\nA \u221e\ncf. Chapter 4, 4. (Other integrals are called orthodox.) Thus for elementary\n\u00a7 R\nand (extended) real functions, f is always defined. (We further develop this\nA\nidea in 5.)\n\u00a7 R 248 Chapter 8. Measurable Functions. Integration\nNote 5. With f as above, we clearly have\nf+ = a+ and f\u2212 = a\u2212 on A ,\ni i i\nwhere\na+ = max(a ,0) and a\u2212 = max( a ,0).\ni i i \u2212 i\nThus\nf+ = a+ mA and f\u2212 = a\u2212 mA ,\ni \u00b7 i i \u00b7 i\nZA ZA\nX X\nso that\n(4) f = f+ f\u2212 = a+ mA a\u2212 mA .\n\u2212 i \u00b7 i \u2212 i \u00b7 i\nZA ZA ZA\ni i\nX X\nIf f+ < or f\u2212 < , we can subtract the two series termwise\nA \u221e A \u221e\n(Problem 14 of Chapter 4, 13) to obtain\nR R \u00a7\nf = (a+ a\u2212)mA = a mA\ni \u2212 i i i i\nZA\ni i\nX X\nfora+ a\u2212 = a . Thusformulas(3)and(4)agree with our previous definitions.3\ni \u2212 i i\nProblems on Integration of Elementary Functions\n1. Verify Note 2.\n\u2032\n1 . Prove Corollary 1(iv)\u2013(vii).\n2. Prove that f = 0 if mA = 0 or f = 0 on A. Disprove the converse\nA\nby examples.\nR\n3. Find a primitive F for f = C in our example. Show that\nR\nf dm = F(1) F(0).\n\u2212\nZ[0,1]\n4. Fill in the proof details in Theorem 2.\n[Hint: Use comparison test for series.]\n\u21d25. Show that if f and g are elementary and nonnegative with f g on\n\u2265\nA, then\nf g 0.\n\u2265 \u2265\nZA ZA\n[Hint: As in Theorem 2, let\nf = aiC and g = biC Ai.\nAi\ni i\nX X\nThen f g 0 implies ai bi 0.]\n\u2265 \u2265 \u2265 \u2265\n3For a \u201climited approach,\u201d pass from here to 9.\n\u00a7 4. Integration of Elementary Functions 249\n\u00a7\n\u21d26. Prove that if f and g are elementary and (extended) real on A, then\n(f g) = f g,\n\u00b1 \u00b1\nZA ZA ZA\nprovided\n(i) f or g is finite, or\nA A\n(ii) R f, Rg, and f g are all orthodox.\nA A A \u00b1 A\n[OutlinRe: As iRn TheoremR2, let R\nf = aiC and g = biC Ai,\nAi\ni i\nX X\nso\nf g =ai bi on Ai.\n\u00b1 \u00b1\nNow, if\nf < ,\n\u221e\n(cid:12)ZA (cid:12)\n(cid:12) (cid:12)\nthen by Problem 14 in Chapter 4,(cid:12) 13, (cid:12) (cid:12)and formula (4), aimAi converges ab-\n(cid:12)\n\u00a7\nsolutely; so its termwise addition to any other series does not affect the absolute\nP\nconvergence or divergence of the latter, i.e., the finiteness or infiniteness of its posi-\ntive and negative parts. For example,\n(ai bi)+mAi =\n\u00b1 \u221e\ni\nX\niff\nb+ mAi = \u221e.\ni\nX\nThus if\ng = ,\n\u00b1\u221e\nZA\nthen\n(f g)= g = = f g.\n\u00b1 \u00b1\u221e \u00b1\nZA ZA ZA ZA\nIf both\nf, g = ,\n6 \u00b1\u221e\nZA ZA\nTheorem 2(ii) applies. In the orthodox infinite case, a similar proof works on noting\nthat either the positive or the negative parts of both series are finite if\nf g\n\u00b1\nZA ZA\nis orthodox, too. (Verify!)]\n7. Show that if f is elementary and nonnegative on A and\nf > p E\u2217,\n\u2208\nZA 250 Chapter 8. Measurable Functions. Integration\nthen there is an elementary and nonnegative map g on A such that\nf g > p,\n\u2265\nZA ZA\ng = 0 on A(f = 0), and\nf > g on A A(f = 0).\n\u2212\n[Hints: Let\nB =A(f = )\n\u221e\nand\nC =A B;\n\u2212\nso B,C (Corollary 2 in 2). For all n>0, define\n\u2208M \u00a7\ngn =n on B\nand\n1\ngn = 1 f on C;\n\u2212 n\n(cid:16) (cid:17)\nso gn is elementary and nonnegative on A and\nf >gn on A A(f =0). (Why?)\n\u2212\nBy Theorem 1 and Corollary 1(iv)(vii),\n1 1\ngn = gn+ gn = (n)+ 1 f =n mB+ 1 f.\n\u2212 n \u00b7 \u2212 n\nZA ZB ZC ZB ZC (cid:17)ZC\n(cid:16) (cid:17) (cid:16)\nDeduce that\nlim gn = f + f = f >p;\nn\n\u2192\u221eZA ZB ZC ZA\nso\n( n) gn >p.\n\u2203\nZA\nTake g =gn for that n.]\n8. Show that if E = E\u2217, Theorem 1(i) holds also if f is infinite but\nA\northodox.\nR\n9. (i) Prove that if f is elementary and integrable on A, so is f, and\n\u2212\n( f) = f.\n\u2212 \u2212\nZA ZA\n(ii) Show that this holds also if f is elementary and (extended) real\nand f is orthodox.\nA\nR 5. Integration of Extended-Real Functions 251\n\u00a7\n\u00a75. Integration of Extended-Real Functions\nWe shall now define integrals for arbitrary functions f: S E\u2217 in a measure\n\u2192\nspace (S, ,m).1 We start with the case f 0.\nM \u2265\nDefinition 1.\nGiven f 0 on A , we define the upper and lower integrals,\n\u2265 \u2208 M\nand ,\nZ Z\nof f on A (with respect to m) by\n(1\u2032) f = f dm = inf h\nh\nZ A Z A ZA\nover all elementary maps h f on A, and\n\u2265\n(1\u2032\u2032) f = f dm = sup g\nZ A Z A g ZA\nover all elementary and nonnegative maps g f on A.\n\u2264\nIf f is not nonnegative, we use f+ = f 0 and f\u2212 = ( f) 0 ( 2),\n\u2228 \u2212 \u2228 \u00a7\nand set\nf = f dm = f+ f\u2212 and\n\u2212\n(1) Z A Z A Z A Z A\nf = f dm = f+ f\u2212.\n\u2212\nZ A Z A Z A Z A\nBy our conventions, these expressions are always defined. The integral\nf (or f) is called orthodox iff it does not have the form in\nA A \u221e\u2212\u221e\n(1), e.g., if f 0 (i.e., f\u2212 = 0), or if f < . An unorthodox integral\nR R \u2265 A \u221e\nequals + .\n\u221e R\nWe often write for and call it simply the integral (of f), even if\nR R\nf = f.2\n6\nZ A Z A\n\u201cClassical\u201d notation is f(x)dm(x).\nA\nR\n1Those who wish to consider measurable maps only should take Theorem 3 earlier.\n2There is good reason for identifying \u201cintegral\u201d with \u201cupper integral.\u201d 252 Chapter 8. Measurable Functions. Integration\nDefinition 2.\nThefunctionf iscalledintegrable (orm-integrable,orLebesgue integrable,\nwith respect to m) on A, iff\nf dm = f dm = .\n6 \u00b1\u221e\nZ A Z A\nThe process described above is called (abstract) Lebesgue integration as op-\nposed to Riemann integration (B. Riemann, 1826\u20131866). The latter deals with\nbounded functions only and allows h and g in (1\u2032) and (1\u2032\u2032) to be simple step\nfunctions only (see 9). It is inferior to Lebesgue theory.\n\u00a7\nThe values of\nf dm and f dm\nZ A Z A\ndepend on m. If m is Lebesgue measure, we speak of Lebesgue integrals, in the\nstricter sense. If m is Lebesgue\u2013Stieltjes measure, we speak of LS-integrals,\nand so on.\nNote 1. If f is elementary and (extended) real, our present definition of\nf\nZ A\nagrees with that of 4. For if f 0, f itself is the least of all elementary and\n\u00a7 \u2265\nnonnegative functions\nh f\n\u2265\nand the greatest of all elementary and nonnegative functions\ng f.\n\u2264\nThus by Problem 5 in 4,\n\u00a7\nf = min h = max g,\nh\u2265f g\u2264f\nZA ZA ZA\ni.e.,\nf = f = f.\nZA Z A Z A\nIf, however, f 0, this follows by Definition 2 in 4. This also shows that for\n6\u2265 \u00a7\nelementary and (extended) real maps,\nf = f always.\nZ A Z A\n(See also Theorem 3.) 5. Integration of Extended-Real Functions 253\n\u00a7\nNote 2. By Definition 1,\nf f always.\n\u2264\nZ A Z A\nFor if f 0, then for any elementary and nonnegative maps g,h with\n\u2265\ng f h,\n\u2264 \u2264\nwe have\ng h\n\u2264\nZA ZA\nby Problem 5 in 4. Thus\n\u00a7\nf = sup g\nZ A g ZA\nis a lower bound of all such h, and so\nA\nR\nf glb h = f.\n\u2264\nZ A ZA Z A\nIn the general formula (1), too,\nf f,\n\u2264\nZ A Z A\nsince\nf+ f+ and f\u2212 f\u2212.\n\u2264 \u2264\nZ A Z A Z A Z A\nTheorem 1. For any functions f,g: S E\u2217 and any set A , we have\n\u2192 \u2208 M\nthe following results.3\n(a) If f = a (constant) on A, then\nf = f = a mA.\n\u00b7\nZ A Z A\n(b) If f = 0 on A or mA = 0, then\nf = f = 0.\nZ A Z A\n(c) If f g on A, then\n\u2265\nf g and f g.\n\u2265 \u2265\nZ A Z A Z A Z A\n3Note that integrability is redundant here and in Theorem 2. 254 Chapter 8. Measurable Functions. Integration\n(d) If f 0 on A, then\n\u2265\nf 0 and f 0.\n\u2265 \u2265\nZ A Z A\nSimilarly if f 0 on A.\n\u2264\n(e) If 0 p < , then\n\u2264 \u221e\npf = p f and pf = p f.\nZ A Z A Z A Z A\n(e\u2032) We have\n( f) = f and ( f) = f\n\u2212 \u2212 \u2212 \u2212\nZ A Z A Z A Z A\nif one of the integrals involved in each case is orthodox. Otherwise,\n( f) = = f and ( f) = = f.\n\u2212 \u221e \u2212 \u221e\nZ A Z A Z A Z A\n(f) If f 0 on A and\n\u2265\nA B, B ,\n\u2287 \u2208 M\nthen\nf f and f f.\n\u2265 \u2265\nZ A Z B Z A Z B\n(g) We have\nf f and f f\n\u2264 | | \u2264 | |\n(cid:12)Z A (cid:12) Z A (cid:12)Z A (cid:12) Z A\n(cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n(but not\n(cid:12) (cid:12) (cid:12) (cid:12)\nf f\n\u2264 | |\n(cid:12)Z A (cid:12) Z A\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nin general).\n(cid:12) (cid:12)\n(h) If f 0 on A and f = 0 (or f 0 and f = 0), then f = 0\n\u2265 A \u2264 A\na.e. on A.\nR R\nProof. We prove only some of the above, leaving the rest to the reader.\n(a) This following by Corollary 1(iv) in 4.\n\u00a7\n(b) Use (a) and Corollary 1(v) in 4.\n\u00a7 5. Integration of Extended-Real Functions 255\n\u00a7\n(c) First, let\nf g 0 on A.\n\u2265 \u2265\nTake any elementary and nonnegative map H f on A. Then H g as\n\u2265 \u2265\nwell; so by definition,\ng = inf h H.\nh\u2265g \u2264\nZ A ZA ZA\nThus\nf H\n\u2264\nZ A ZA\nfor any such H. Hence also\ng inf H = f.\n\u2264 H\u2265f\nZ A ZA Z A\nSimilarly,\nf g\n\u2265\nZ A Z A\nif f g 0.\n\u2265 \u2265\nIn the general case, f g implies\n\u2265\nf+ g+ and f\u2212 g\u2212. (Why?)\n\u2265 \u2264\nThus by what was proved above,\nf+ g+ and f\u2212 g\u2212.\n\u2265 \u2264\nZ A Z A Z A Z A\nHence\nf+ f\u2212 g+ g\u2212;\n\u2212 \u2265 \u2212\nZ A Z A Z A Z A\ni.e.,\nf g.\n\u2265\nZ A Z A\nSimilarly, one obtains\nf g.\n\u2265\nZ A Z A\n(d) It is clear that (c) implies (d).\n(e) Let 0 p < and suppose f 0 on A. Take any elementary and\n\u2264 \u221e \u2265\nnonnegative map\nh f on A.\n\u2265 256 Chapter 8. Measurable Functions. Integration\nBy Corollary 1(vii) and Note 3 of 4,\n\u00a7\nph = p h\nZA ZA\nfor any such h. Hence\npf = inf ph = infp h = p f.\nh h\nZ A ZA ZA Z A\nSimilarly,\npf = p f.\nZ A Z A\nThe general case reduces to the case f 0 by formula (1).\n\u2265\n(e\u2032) Assertion (e\u2032) follows from (1) since\n( f)+ = f\u2212, ( f)\u2212 = f+,\n\u2212 \u2212\nand (x y) = y x if x y is orthodox. (Why?)\n\u2212 \u2212 \u2212 \u2212\n(f) Take any elementary and nonnegative map\nh f 0 on A.\n\u2265 \u2265\nBy Corollary 1(ii) and Note 3 of 4,\n\u00a7\nh h\n\u2265\nZB ZA\nfor any such h. Hence\nf = inf h inf h = f.\nh \u2264 h\nZ B ZB ZA Z A\nSimilarly for .\n(g) This follows fRrom (c) and (e\u2032) since f f implies\n\u00b1 \u2264 | |\nf f f\n| | \u2265 \u2265\nZ A Z A Z A\nand\nf ( f) f f. (cid:3)\n| | \u2265 \u2212 \u2265 \u2212 \u2265 \u2212\nZ A Z A Z A Z A\nFor (h) and later work, we need the following lemmas. 5. Integration of Extended-Real Functions 257\n\u00a7\nLemma 1. Let f: S E\u2217 and A . Then the following are true.\n\u2192 \u2208 M\n(i) If\nf < q E\u2217,\n\u2208\nZA\nthere is an elementary and (extended) real map\nh f on A,\n\u2265\nwith\nh < q.\nZA\n(ii) If\nf > p E\u2217,\n\u2208\nZA\nthere is an elementary and (extended) real map\ng f on A,\n\u2264\nwith\ng > p;\nZA\nmoreover, g can be made elementary and nonnegative if f 0 on A.\n\u2265\nProof. If f 0, this is immediate by Definition 1 and the properties of glb\n\u2265\nand lub.\nIf, however, f (cid:3) 0, and if\nq > f = f+ f\u2212,\n\u2212\nZA Z A Z A\nour conventions yield\n> f+. (Why?)\n\u221e\nZA\nThus there are u,v E\u2217 such that q = u+v and\n\u2208\n0 f+ < u <\n\u2264 \u221e\nZA\nand\nf\u2212 < v.\n\u2212\nZA\nTo see why this is so, choose u so close to f+ that\nA\nR\nq u > f\u2212\n\u2212 \u2212\nZ A 258 Chapter 8. Measurable Functions. Integration\nand set v = q u.\n\u2212\nAs the lemma holds for positive functions, we find elementary and nonneg-\native maps h\u2032 and h\u2032\u2032, with\nh\u2032 f+, h\u2032\u2032 f\u2212,\n\u2265 \u2264\nh\u2032 < u < and h\u2032\u2032 > v.\n\u221e \u2212\nZA ZA\nLet h = h\u2032 h\u2032\u2032. Then\n\u2212\nh f+ f\u2212 = f,\n\u2265 \u2212\nand by Problem 6 in 4,\n\u00a7\nh = h\u2032 h\u2032\u2032 for h\u2032 is finite! .\n\u2212\nZA ZA ZA (cid:18) ZA (cid:19)\nHence\nh > u+v = q,\nZA\nand clause (i) is proved in full.\nClause (ii) follows from (i) by Theorem 1(e\u2032) if\nf < .\n\u221e\nZ A\n(Verify!) For the case f = , see Problem 3. (cid:3)\nA \u221e\nNote 3. The preceR ding lemma shows that formulas (1\u2032) and (1\u2032\u2032) hold (and\nmight be used as definitions) even for sign-changing f, g, and h.\nLemma 2. If f: S E\u2217 and A , there are -measurable maps g and\n\u2192 \u2208 M M\nh, with\ng f h on A,\n\u2264 \u2264\nsuch that\nf = h and f = g.\nZ A Z A Z A Z A\nWe can take g,h 0 if f 0 on A.\n\u2265 \u2265\nProof. If\nf = ,\n\u221e\nZ A\nthe constant map h = satisfies the statement of the theorem.\n\u221e\nIf\n< f < ,\n\u2212\u221e \u221e\nZ A 5. Integration of Extended-Real Functions 259\n\u00a7\nlet\n1\nq = f + , n = 1,2,...;\nn\nn\nZ A\nso\nq f < q .\nn n\n\u2192\nZ A\nBy Lemma 1, for each n there is an elementary and (extended) real (hence\nmeasurable) map h f on A, with\nn\n\u2265\nq h f.\nn n\n\u2265 \u2265\nZA Z A\nLet\nh = infh f.\nn\nn \u2265\nBy Lemma 1 in 2, h is -measurable on A. Also,\n\u00a7 M\n( n) q > h h f\nn n\n\u2200 \u2265 \u2265\nZA Z A Z A\nby Theorem 1(c). Hence\nf = lim q h f,\nn\nn\u2192\u221e \u2265 \u2265\nZ A Z A Z A\nso\nf = h,\nZ A Z A\nas required.\nFinally, if\nf = ,\n\u2212\u221e\nZ A\nthe same proof works with q = n. (Verify!)\nn\n\u2212\nSimilarly, one finds a measurable map g f, with\n\u2264\nf = g. (cid:3)\nZ A Z A\nProof of Theorem 1(h). If f 0, choose h f as in Lemma 2. Let\n\u2265 \u2265\n1\nD = A(h > 0) and A = A h > ;\nn\nn\n(cid:16) (cid:17)\nso\n\u221e\nD = A (why?),\nn\nn=1\n[ 260 Chapter 8. Measurable Functions. Integration\nand D, A by Theorem 1 of 2. Also,\nn\n\u2208 M \u00a7\n1 1\n0 = f = h = mA 0.\nn\n\u2265 n n \u2265\nZ A Z A ZAn (cid:16) (cid:17)\nThus ( n) mA = 0. Hence\nn\n\u2200\n\u221e\nmD = m A = mA(h > 0) = 0;\nn\nn=1\n[\nso 0 f h 0 (i.e., f = 0) a.e. on A.\n\u2264 \u2264 \u2264\nThe case f 0 reduces to ( f) 0. (cid:3)\n\u2264 \u2212 \u2265\nCorollary 1. If\nf < ,4\n| | \u221e\nZ A\nthen f < a.e. on A, and A(f = 0) is \u03c3-finite.\n| | \u221e 6\nProof. By Lemma 1, fix an elementary and nonnegative h f with\n\u2265 | |\nh <\n\u221e\nZA\n(so h is elementary and integrable).\nNow, by Corollary 1(i)\u2013(iii) in 4, our assertions apply to h, hence certainly\n\u00a7\nto f. (cid:3)\nTheorem 2 (additivity). Given f: S E\u2217 and an -partition = B\nn\n\u2192 M P { }\nof A , we have\n\u2208 M\n(2) (a) f = f and (b) f = f,\nZ A n Z Bn Z A n Z Bn\nX X\nprovided\nf f, respectively\nZ A (cid:18)Z A (cid:19)\nis orthodox, or is finite.\nP\nHence if f is integrable on each of finitely many disjoint -sets B , it is\nn\nM\nso on\nA = B ,\nn\nn\n[\nand formulas (2)(a)(b) apply.\n4It suffices that f be integrable on A (apply the same proof to f+ and f ).\n\u2212 5. Integration of Extended-Real Functions 261\n\u00a7\nProof. Assume first f 0 on A. Then by Theorem 1(f), if one of\n\u2265\nf = ,\n\u221e\nZ Bn\nso is f, and all is trivial. Thus assume all f are finite.\nA Bn\nThen for any \u03b5 > 0 and n N, there is an elementary and nonnegative map\nR \u2208 R\nh f on B , with\nn n\n\u2265\n\u03b5\nh < f + .\nn 2n\nZBn Z Bn\n(Why?) Now define h: A E\u2217 by h = h on B , n = 1,2,....\nn n\n\u2192\nClearly,hiselementaryandnonnegativeoneachB ,henceonA(Corollary 3\nn\nin 1), and h f on A. Thus by Theorem 1 of 4,\n\u00a7 \u2265 \u00a7\n\u03b5\nf h = h f + f +\u03b5.\n\u2264 n \u2264 2n \u2264\nZ A ZA n ZBn n (cid:18)Z Bn (cid:19) n Z Bn\nX X X\nMaking \u03b5 0, we get\n\u2192\nf f.\n\u2264\nZ A n Z Bn\nX\nTo prove also\nf f,\n\u2265\nZ A n Z Bn\nX\ntake any elementary and nonnegative map H f on A. Then again,\n\u2265\nH = H f.\n\u2265\nZA n ZBn n Z Bn\nX X\nAs this holds for any such H, we also have\nf = inf H f.\nH \u2265\nZ A ZA n Z Bn\nX\nThis proves formula (a) for f 0. The proof of (b) is quite similar.\n\u2265\nIf f (cid:3) 0, we have\nf = f+ f\u2212,\n\u2212\nZ A Z A Z A\nwhere by the first part of the proof,\nf+ = f+ and f\u2212 = f\u2212.\nZ A n Z Bn Z A n Z Bn\nX X 262 Chapter 8. Measurable Functions. Integration\nIf\nf\nZ A\nis orthodox, one of these sums must be finite, and so their difference may be\nrearranged to yield\nf = f+ f\u2212 = f,\n\u2212\nZ A n (cid:18)Z Bn Z Bn (cid:19) n Z Bn\nX X\nproving (a). Similarly for (b).\nThis rearrangement works also if is finite (i.e., the sums have a finite\nP\nnumber of terms). For, then, all reduces to commutativity and associativity of\naddition, and our conventions (2\u2217) of Chapter 4, 4. Thus all is proved. (cid:3)\n\u00a7\nCorollary 2. If mQ = 0 (Q ), then for A\n\u2208 M \u2208 M\nf = f and f = f.\nZ A\u2212Q Z A Z A\u2212Q Z A\nFor by Theorem 2,\nf = f + f,\nZ A Z A\u2212Q Z A\u2229Q\nwhere\nf = 0\nZ A\u2229Q\nby Theorem 1(b).\nCorollary 3. If\nf or f\nZ A (cid:18) Z A (cid:19)\nis orthodox, so is\nf f\nZ X (cid:18)Z X (cid:19)\nwhenever A X, X .\n\u2287 \u2208 M\nFor if\nf+, f\u2212, f+, or f\u2212 is finite,\nZ A Z A Z A Z A\nitremainssoalsowhenAisreducedtoX (seeTheorem1(f)). Henceorthodoxy\nfollows by formula (1). 5. Integration of Extended-Real Functions 263\n\u00a7\nNote 4. Given f: S E\u2217, we can define two additive (by Theorem 2) set\n\u2192\nfunctions s and s by setting for X\n\u2208 M\nsX = f and sX = f.\nZ X Z X\nThey are called, respectively, the upper and lower indefinite integrals of f, also\ndenoted by\nf and f\nZ Z\n(or s and s ).\nf f\nBy Theorem 2 and Corollary 3, if\nf\nZ A\nis orthodox, then s is \u03c3-additive (and semifinite) when restricted to -sets\nM\nX A. Also,\n\u2286\ns = s = 0\n\u2205 \u2205\nby Theorem 1(b).\nSuch set functions are called signed measures (see Chapter 7, 11). In par-\n\u00a7\nticular, if f 0 on S, s and s are \u03c3-additive and nonnegative on all of ,\n\u2265 M\nhence measures on .\nM\nTheorem 3. If f: S E\u2217 is m-measurable (Definition 2 in 3) on A, then\n\u2192 \u00a7\nf = f.\nZ A Z A\nProof. First, let f 0 on A. By Corollary 2, we may assume that f is\n\u2265\n-measurable on A (drop a set of measure zero). Now fix \u03b5 > 0.\nM\nLet A = A(f = 0), A = A(f = ), and\n0 \u221e\n\u221e\nA = A (1+\u03b5)n f < (1+\u03b5)n+1 , n = 0, 1, 2,....\nn\n\u2264 \u00b1 \u00b1\nClearly, these are d(cid:0)isjoint -sets (Theorem 1(cid:1)of 2), and\nM \u00a7\n\u221e\nA = A A A .\n0 \u221e n\n\u222a \u222a\nn=\u2212\u221e\n[\nThus, setting\n0 on A ,\n0\ng = on A , and\n\uf8f1 \u221e\n\u221e\n\uf8f4 \uf8f2 (1+\u03b5)n on A (n = 0, 1, 2,...)\nn\n\u00b1 \u00b1\n\uf8f4\n\uf8f3 264 Chapter 8. Measurable Functions. Integration\nand\nh = (1+\u03b5)g on A,\nwe obtain two elementary and nonnegative maps, with\ng f h on A. (Why?)\n\u2264 \u2264\nBy Note 1,\ng = g.\nZ A Z A\nNow, if g = , then\nA \u221e\nR\nf f g\n\u2265 \u2265\nZ A Z A ZA\nyields\nf f = .\n\u2265 \u221e\nZ A Z A\nIf, however, g < , then\nA \u221e\nR\nh = (1+\u03b5)g = (1+\u03b5) g < ;\n\u221e\nZA ZA ZA\nso g and h are elementary and integrable on A. Thus by Theorem 2(ii) in 4,\n\u00a7\nh g = (h g) = ((1+\u03b5)g g) = \u03b5 g.\n\u2212 \u2212 \u2212\nZA ZA ZA ZA ZA\nMoreover, g f h implies\n\u2264 \u2264\ng f f h;\n\u2264 \u2264 \u2264\nZA Z A Z A ZA\nso\nf f h g \u03b5 g.\n\u2212 \u2264 \u2212 \u2264\n(cid:12)Z A Z A (cid:12) ZA ZA ZA\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nAs \u03b5 is arbitrary, all(cid:12)is proved for(cid:12)f 0.\n\u2265\nThe case f 0 now follows by formula (1), since f+ and f\u2212 are -\n6\u2265 M\nmeasurable (Theorem 2 in 2). (cid:3)\n\u00a7 5. Integration of Extended-Real Functions 265\n\u00a7\nProblems on Integration of Extended-Real Functions\n1. Using the formulas in (1) and our conventions, verify that\n(i) f = + iff f+ = ;\nA \u221e A \u221e\n(ii) R f = iff Rf+ = ; and\nA \u221e A \u221e\n(iii) R f = iffR f\u2212 = and f+ < .\nA \u2212\u221e A \u221e A \u221e\n(iv) RDerive a conditRion similar to (iiRi) for f = .\nA \u2212\u221e\n(v) Review Problem 6 of Chapter 4, 4. R\n\u00a7\n2. Fill in the missing proof details in Theorems 1 to 3 and Lemmas 1 and 2.\n3. Prove that if f = , there is an elementary and (extended) real map\nA \u221e\ng f on A, with g = .\n\u2264 R A \u221e\n[Outline: By Problem 1, we have\nR\nf+ = .\n\u221e\nZ A\nAs Lemmas 1 and 2 surely hold for nonnegative functions, fix a measurable F f+\n\u2264\n(F 0), with\n\u2265\nF = f+ = .\n\u221e\nZA Z A\nArguing as in Theorem 3, find an elementary and nonnegative map g F, with\n\u2264\n(1+\u03b5) g = F = ;\n\u221e\nZA ZA\nso g = and 0 g F f+ on A.\nA \u221e \u2264 \u2264 \u2264\nLet\nR\nA =A(F >0)\n+\n\u2208M\nand\nA =A(F =0)\n0\n\u2208M\n(Theorem 1 in 2). On A ,\n+\n\u00a7\ng F f+ =f (why?),\n\u2264 \u2264\nwhile on A , g =F =0; so\n0\ng = g = (why?).\n\u221e\nZA+ ZA\nNow redefine g = on A (only). Show that g is then the required function.]\n0\n\u2212\u221e\n4. For any f: S E\u2217, prove the following.\n\u2192\n(a) If f < , then f < a.e. on A.\nA \u221e \u221e\n(b) If R f is orthodox and > , then f > a.e. on A.\nA \u2212\u221e \u2212\u221e\nR 266 Chapter 8. Measurable Functions. Integration\n[Hint: UseProblem1 andapplyCorollary1 tof+; thus prove (a). Thenfor(b), use\nTheorem 1(e ).]\n\u2032\n\u21d25. For any f,g: S E\u2217, prove that\n\u2192\n(i) f + g (f +g), and\nA A \u2265 A\n(ii) R (f +Rg) R f + g if g < .\nA \u2265 A A A \u221e\n[Hint: RSuppose that R R (cid:12)R (cid:12)\n(cid:12) (cid:12)\nf + g < (f +g).\nZ A Z A Z A\nThen there are numbers\nu> f and v > g,\nZ A Z A\nwith\nu+v (f +g).\n\u2264\nZ A\n(Why?) Thus Lemma 1 yields elementary and (extended) real maps F f and\n\u2265\nG g such that\n\u2265\nu> F and v > G.\nZ A Z A\nAs f +g F +G on A, Theorem 1(c) of 5 and Problem 6 of 4 show that\n\u2264 \u00a7 \u00a7\n(f +g) (F +G)= F + G<u+v,\n\u2264\nZ A ZA ZA ZA\ncontrary to\nu+v (f +g).\n\u2264\nZ A\nSimilarly prove clause (ii).]\n6. Continuing Problem 5, prove that\n(f +g) f + g (f +g) f + g,\n\u2265 \u2265 \u2265\nZ A Z A Z A Z A Z A Z A\nprovided g < .\nA \u221e\n[Hint for the second inequality: We may assume that\n(cid:12)R (cid:12)\n(cid:12) (cid:12)\n(f +g)< and f > .\n\u221e \u2212\u221e\nZ A Z A\n(Why?) Apply Problems 5 and 4(a) to\n((f +g)+( g)).\n\u2212\nZ A\nUse Theorem 1(e ).]\n\u2032\n7. Prove the following.\n(i) f < iff < f f < .\nA| | \u221e \u2212\u221e A \u2264 A \u221e\nR R R 5. Integration of Extended-Real Functions 267\n\u00a7\n(ii) If f < and g < , then\nA| | \u221e A| | \u221e\nR R\nf g f g\n\u2212 \u2264 | \u2212 |\n(cid:12)Z A Z A (cid:12) Z A\n(cid:12) (cid:12)\nand (cid:12) (cid:12)\n(cid:12) (cid:12)\nf g f g .\n\u2212 \u2264 | \u2212 |\n(cid:12)Z A Z A (cid:12) Z A\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n[Hint: Use Problems 5 an(cid:12)d 6.] (cid:12)\n8. Show that any signed measure s (Note 4) is the difference of two mea-\nf\nsures: s = s s .\nf f+ f\u2212\n\u2212\n\u00a76. Integrable Functions. Convergence Theorems\nI. Some important theorems apply to integrable functions.\nTheorem 1 (linearity of the integral). If f,g: S E\u2217 are integrable on a set\n\u2192\nA in (S, ,m), so is\n\u2208 M M\npf +qg\nfor any p,q E1, and\n\u2208\n(pf +qg) = p f +q g;\nZA ZA ZA\nin particular,\n(f g) = f g.\n\u00b1 \u00b1\nZA ZA ZA\nProof. By Problem 5 in 5,\n\u00a7\nf + g (f +g) (f +g) f + g.\n\u2265 \u2265 \u2265\nZ A Z A Z A Z A Z A Z A\n(Here\nf, f, g, and g\nZ A Z A Z A Z A\nare finite by integrability; so all is orthodox.)\nAs\nf = f and g = g,\nZ A Z A Z A Z A 268 Chapter 8. Measurable Functions. Integration\nthe inequalities turn into equalities, so that\nf + g = (f +g) = (f +g).\nZA ZA Z A Z A\nUsing also Theorem 1(e)(e\u2032) from 5, we obtain the desired result for any\n\u00a7\np,q E1. (cid:3)\n\u2208\nTheorem 2. A function f: S E\u2217 is integrable on A in (S, ,m) iff\n\u2192 M\n(i) it is m-measurable on A, and\n(ii) f (equivalently f ) is finite.\nA A| |\nProoRf. If these conditioRns hold, f is integrable on A by Theorem 3 of 5.\n\u00a7\nConversely, let\nf = f = .\n6 \u00b1\u221e\nZ A Z A\nUsing Lemma 2 in 5, fix measurable maps g and h (g f h) on A, with\n\u00a7 \u2264 \u2264\ng = f = h = .\n6 \u00b1\u221e\nZA ZA ZA\nBy Theorem 3 in 5, g and h are integrable on A; so by Theorem 1,\n\u00a7\n(h g) = h g = 0.\n\u2212 \u2212\nZA ZA ZA\nAs\nh g h f 0,\n\u2212 \u2265 \u2212 \u2265\nwe get\n(h f) = 0,\n\u2212\nZA\nand so by Theorem 1(h) of 5, h f = 0 a.e. on A.\n\u00a7 \u2212\nHence f is almost measurable on A, and\nf =\n6 \u00b1\u221e\nZA\nby assumption. From formula (1), we then get\nf+ and f\u2212 < ,\n\u221e\nZA ZA\nand hence\nf = (f+ +f\u2212) = f+ + f\u2212 <\n| | \u221e\nZA ZA ZA ZA\nby Theorem 1 and by Theorem 2 of 2. Thus all is proved. (cid:3)\n\u00a7 6. Integrable Functions. Convergence Theorems 269\n\u00a7\nSimultaneously, we also obtain the following corollary.\nCorollary 1. A function f: S E\u2217 is integrable on A iff f+ and f\u2212 are.\n\u2192\nCorollary 2. If f,g: S E\u2217 are integrable on A, so also are\n\u2192\nf g, f g, f , and kf for k E1,\n\u2228 \u2227 | | \u2208\nwith\nkf = k f.\nZA ZA\nExercise!\nFor products fg, this holdsif f or g is bounded. Infact, we have thefollowing\ntheorem.\nTheorem 3 (weighted law of the mean). Let f be m-measurable and bounded\non A. Set\np = inff[A] and q = supf[A].\nThen if g is m-integrable on A, so is fg, and\nf g = c g\n| | | |\nZA ZA\nfor some c [p,q].\n\u2208\nIf, further, f also has the Darboux property on A (Chapter 4, 9), then\n\u00a7\nc = f(x ) for some x A.\n0 0\n\u2208\nProof. By assumption,\n( k E1) f k\n\u2203 \u2208 | | \u2264\non A. Hence if g = 0,\n| |\nZA\nf g fg k g = 0;\n| | \u2264 | | \u2264 | |\n(cid:12)ZA (cid:12) ZA ZA\n(cid:12) (cid:12)\nso any c [p,q] yields(cid:12) (cid:12)\n\u2208 (cid:12) (cid:12)\nf g = c g = 0.\n| | | |\nZA ZA\nIf, however, g = 0, the number\nA| | 6\nR\nc = f g g\n| | | |\n(cid:18)ZA (cid:19)(cid:30)ZA\nis the required constant.\nMoreover, as f and g are m-measurable on A, so is fg; and as\nfg c g < ,\n\u2264 | | | | \u221e\n(cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12) 270 Chapter 8. Measurable Functions. Integration\nfg is integrable on A by Theorem 2.\nFinally, if f has the Darboux property and if p < c < q (with p,q as above),\nthen\nf(x) < c < f(y)\nfor some x,y A (why?); hence by the Darboux property, f(x ) = c for some\n0\n\u2208\nx A.\n0\n\u2208\nIf, however,\nc inff[A] = p,\n\u2264\nthen\n(f c) g 0\n\u2212 | | \u2265\nand\n(f c) g = f g c g = 0 (why?);\n\u2212 | | | |\u2212 | |\nZA ZA ZA\nso by Theorem 1(h) in 5, f c = 0 a.e. on A. Then surely f(x ) = c for some\n0\n\u00a7 \u2212\nx A (except the trivial case mA = 0). This also implies c f[A] [p,q].\n0\n\u2208 \u2208 \u2208\nProceed similarly in the case c q. (cid:3)\n\u2265\nCorollary 3. If f is integrable on A , it is so on any B A (B ).\n\u2208 M \u2286 \u2208 M\nProof. Apply Theorem 1(f) in 5, and Theorem 3 of 5, to f+ and f\u2212. (cid:3)\n\u00a7 \u00a7\nII. Convergence Theorems. If f f on A (pointwise, a.e., or uniformly),\nn\n\u2192\ndoes it follow that\nf f?\nn\n\u2192\nZA ZA\nTo give some answers, we need a lemma.\nLemma 1. If f 0 on A and if\n\u2265 \u2208 M\nf > p E\u2217,\n\u2208\nZ A\nthere is an elementary and nonnegative map g on A such that\ng > p,\nZA\nand g < f on A except only at those x A (if any) at which\n\u2208\nf(x) = g(x) = 0.\n(We then briefly write g f on A.)\n\u2282 6. Integrable Functions. Convergence Theorems 271\n\u00a7\nProof. By Lemma 1 in 5, there is an elementary and nonnegative map G f\n\u00a7 \u2264\non A, with\nf G > p.\n\u2265\nZ A ZA\nFor the rest, proceed as in Problem 7 of 4, replacing f by G there. (cid:3)\n\u00a7\nTheorem 4 (monotone convergence). If 0 f f (a.e.) on A , i.e.,\nn\n\u2264 \u0580 \u2208 M\n0 f f ( n),\nn n+1\n\u2264 \u2264 \u2200\nand f f (a.e.) on A, then\nn\n\u2192\nf f.\nn\n\u0580\nZ A Z A\nProof for -measurable f and f on A.1 By Corollary 2 in 5, we may\nn\nM \u00a7\nassume that f f (pointwise) on A (otherwise, drop a null set).\nn\n\u0580\nBy Theorem 1(c) of 5, 0 f f implies\nn\n\u00a7 \u2264 \u0580\n0 f f,\nn\n\u2264 \u2264\nZA ZA\nand so\nlim f f.\nn\nn\u2192\u221e \u2264\nZA ZA\nThe limit, call it p, exists in E\u2217, as f . It remains to show that\n{ A n }\u2191\nR\np f = f.\n\u2265\nZ A Z A\n(We know that\nf = f,\nZ A Z A\nby the assumed measurability of f; see Theorem 3 in 5.)\n\u00a7\nSuppose\nf > p.\nZ A\nThen Lemma 1 yields an elementary and nonnegative map g f on A, with\n\u2282\np < g.\nZA\nLet\nA = A(f g), n = 1,2,....\nn n\n\u2265\n1For the general case, see Problem 5. 272 Chapter 8. Measurable Functions. Integration\nThen A and\nn\n\u2208 M\n\u221e\nA A = A .\nn n\n\u0580\nn=1\n[\nFor if f(x) = 0, then x A , and if f(x) > 0, then f(x) > g(x), so that\n1\n\u2208\nf (x) > g(x) for large n; hence x A .\nn n\n\u2208\nBy Note 4 in 5, the set function s = g is a measure, hence continuous by\n\u00a7\nTheorem 2 in Chapter 7, 4. Thus\n\u00a7 R\ng = sA = lim sA = lim g.\nn\nn\u2192\u221e n\u2192\u221e\nZA ZAn\nBut as g f on A , we have\nn n\n\u2264\ng f f .\nn n\n\u2264 \u2264\nZAn ZAn ZA\nHence\ng = lim g lim f = p,\nn\n\u2264\nZA ZAn ZA\ncontrary to p < g. This contradiction completes the proof. (cid:3)\nA\nLemma 2 (FatoRu). If f 0 on A (n = 1,2,...), then\nn\n\u2265 \u2208 M\nlimf lim f .\nn n\n\u2264\nZ A Z A\nProof. Let\ng = inf f , n = 1,2,...;\nn k\nk\u2265n\nso f g 0 and g on A. Thus by Theorem 4,\nn n n\n\u2265 \u2265 { }\u2191\nlimg = lim g = lim g lim f .\nn n n n\n\u2264\nZ A Z A Z A Z A\nBut\nlim g = supg = sup inf f = limf .\nn n k n\nn\u2192\u221e n n k\u2265n\nHence\nlimf = limg lim f ,\nn n n\n\u2264\nZ A Z A Z A\nas claimed. (cid:3) 6. Integrable Functions. Convergence Theorems 273\n\u00a7\nTheorem 5 (dominated convergence). Let f : S E be m-measurable on\nn\n\u2192\nA (n = 1,2,...). Let\n\u2208 M\nf f (a.e.) on A.\nn\n\u2192\nThen\nlim f f = 0,\nn\nn\u2192\u221e | \u2212 |\nZA\nprovided that there is a map g: S E1 such that\n\u2192\ng <\n\u221e\nZA\nand\n( n) f g a.e. on A.\nn\n\u2200 | | \u2264\nProof. Neglecting null sets, we may assume that\nf g <\nn\n| | \u2264 \u221e\non A and f f (pointwise) on A; so f g and\nn\n\u2192 | | \u2264\nf f f + f 2g\nn n\n| \u2212 | \u2264 | | | | \u2264\non A. As f < , we have\n| | \u221e\nf f 0\nn\n| \u2212 | \u2192\non A. Hence, setting\nh = 2g f f 0,\nn n\n\u2212| \u2212 | \u2265\nwe get\n2g = lim h = limh .\nn n\nn\u2192\u221e\nWe may also assume that g is measurable on A. (If not, replace it by a mea-\nsurable G g, with\n\u2265\nG = g < ,\n\u221e\nZA ZA\nby Lemma 2 in 5.) Then all\n\u00a7\nh = 2g f f\nn n\n\u2212| \u2212 |\nare measurable (even integrable) on A. 274 Chapter 8. Measurable Functions. Integration\nThus by Lemma 2,\n2g = limh lim (2g f f )\nn n\n\u2264 \u2212| \u2212 |\nZA ZA ZA\n= lim 2g + f f\nn\n\u2212| \u2212 |\n(cid:18)ZA ZA (cid:19)\n(cid:0) (cid:1)\n= 2g +lim f f\nn\n\u2212 | \u2212 |\nZA (cid:18) ZA (cid:19)\n= 2g lim f f .\nn\n\u2212 | \u2212 |\nZA ZA\n(See Problems 5 and 8 in Chapter 2, 13.)\n\u00a7\nCanceling 2g (finite!), we have\nA\nR\n0 lim f f .\nn\n\u2264 \u2212 | \u2212 |\nZA\nHence\n0 lim f f lim f f 0,\nn n\n\u2265 | \u2212 | \u2265 | \u2212 | \u2265\nZA ZA\nas f f 0. This yields\nn\n| \u2212 | \u2265\n0 = lim f f = lim f f = lim f f ,\nn n n\n| \u2212 | | \u2212 | | \u2212 |\nZA ZA ZA\nas required. (cid:3)\nNote 1. Theorem 5 holds also for complex and vector-valued functions (for\nf f is real).\nn\n| \u2212 |\nIn the extended-real case, Theorems 1(g) in 5 and Theorems 1 and 2 in 6\n\u00a7 \u00a7\nyield\nf f = (f f) f f 0,\nn n n\n\u2212 \u2212 \u2264 | \u2212 | \u2192\n(cid:12)ZA ZA (cid:12) (cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12) (cid:12) (cid:12)\ni.e., (cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\nf f.\nn\n\u2192\nZA ZA\nMoreover, f is integrable on A, being measurable (why?), with\nf g < .\n| | \u2264 \u221e\nZA ZA\nFor complex and vector-valued functions, this will follow from 7. Observe that\n\u00a7\nTheorem 5, unlike Theorem 4, requires the m-measurability of the f .\nn 6. Integrable Functions. Convergence Theorems 275\n\u00a7\nNote 2. Theorem 5 fails if there is no \u201cdominating\u201d\ng f with g < ,\nn\n\u2265 | | \u221e\nZA\neven if f and the f are integrable.\nn\nExample.\nLet m be Lebesgue measure in A = E1, f = 0, and\n1 on [n,n+1],\nf =\nn\n0 elsewhere.\n(cid:26)\nThen f f and f = 1; so\nn \u2192 A n\nR\nlim f = 1 = 0 = f.\nn\nn\u2192\u221e 6\nZA ZA\nThe trouble is that any\ng f (n = 1,2,...)\nn\n\u2265\nwould have to be 1 on B = [1, ); so\n\u2265 \u221e\ng g = 1 mB = ,\n\u2265 \u00b7 \u221e\nZA ZB\ninstead of g < .\nA \u221e\nThis example also shows that f f alone does not imply\nR n \u2192\nf f.\nn\n\u2192\nZA ZA\nTheorem 6 (absolute continuity of the integral). Given f: S E with\n\u2192\nf <\n| | \u221e\nZ A\nand \u03b5 > 0, there is \u03b4 > 0 such that\nf < \u03b5\n| |\nZ X\nwhenever\nmX < \u03b4 (A X, X ).\n\u2287 \u2208 M\nProof. By Lemma 2 in 5, fix h f , measurable on A, with\n\u00a7 \u2265 | |\nh = f < .\n| | \u221e\nZA Z A 276 Chapter 8. Measurable Functions. Integration\nNeglecting a null set, we assume that h < on A (Corollary 1 of 5). Now,\n| | \u221e \u00a7\n( n) set\n\u2200\nh(x), x A = A(h < n),\nn\ng (x) = \u2208\nn\n0, x A .\n(cid:26) \u2208 \u2212 n\nThen g n and g is measurable on A. (Why?)\nn n\n\u2264\nAlso, g 0 and g h (pointwise) on A.\nn n\n\u2265 \u2192\nFor let \u03b5 > 0, fix x A, and find k > h(x). Then\n\u2208\n( n k) h(x) n and g (x) = h(x).\nn\n\u2200 \u2265 \u2264\nSo\n( n k) g (x) h(x) = 0 < \u03b5.\nn\n\u2200 \u2265 | \u2212 |\nClearly, g h. Hence by Theorem 5\nn\n\u2264\nlim h g = 0.\nn\nn\u2192\u221e | \u2212 |\nZA\nThus we can fix n so large that\n1\n(h g ) < \u03b5.\nn\n\u2212 2\nZA\nFor that n, let\n\u03b5\n\u03b4 =\n2n\nand take any X A (X ), with mX < \u03b4.\n\u2286 \u2208 M\nAs g n (see above), Theorem 1(c) in 5 yields\nn\n\u2264 \u00a7\n1\ng (n) = n mX < n\u03b4 = \u03b5.\nn\n\u2264 \u00b7 2\nZX ZX\nHence as f h and\n| | \u2264\n1\n(h g ) (h g ) < \u03b5\nn n\n\u2212 \u2264 \u2212 2\nZX ZA\n(Theorem 1(f) of 5), we obtain\n\u00a7\n1 1\nf h = (h g )+ g < \u03b5+ \u03b5 = \u03b5,\nn n\n| | \u2264 \u2212 2 2\nZ X ZX ZX ZX\nas required. (cid:3) 6. Integrable Functions. Convergence Theorems 277\n\u00a7\nProblems on Integrability and Convergence Theorems\n1. Fill in the missing details in the proofs of this section.\n2. (i) Show that if f: S E\u2217 is bounded and m-measurable on A, with\n\u2192\nmA < , then f is m-integrable on A (Theorem 2) and\n\u221e\nf = c mA,\n\u00b7\nZA\nwhere inff[A] c supf[A].\n\u2264 \u2264\n(ii) Prove that if f also has the Darboux property on A, then\n( x A) c = f(x ).\n0 0\n\u2203 \u2208\n[Hint: Take g =1 in Theorem 3.]\n(iii) What results if A = [a,b] and m = Lebesgue measure?\n3. Prove Theorem 4 assuming that the f are measurable on A and that\nn\n( k) f >\nk\n\u2203 \u2212\u221e\nZA\ninstead of f 0.\nn\n\u2265\n[Hint: As fn , show that\n{ }\u2191\n( n k) fn > .\n\u2200 \u2265 \u2212\u221e\nZA\nIf\n( n) fn = ,\n\u2203 \u221e\nZA\nthen\nf =lim fn = .\n\u221e\nZA ZA\nOtherwise,\n( n k) fn < ;\n\u2200 \u2265 \u221e\n(cid:12)ZA (cid:12)\n(cid:12) (cid:12)\nso fn is integrable. (Why?) By Corollary(cid:12) (cid:12)1 in (cid:12) (cid:12)5, assume fn < . (Why?) Apply\n\u00a7 | | \u221e\nTheorem 4 to hn =fn f (n k), considering two cases:\nk\n\u2212 \u2265\nh< and h= .]\n\u221e \u221e\nZA ZA\n4. Show that if f f (pointwise) on A , there are -measurable\nn\n\u0580 \u2208 M M\nmaps F f and F f on A, with F F (pointwise) on A, such\nn n n\n\u2265 \u2265 \u0580\nthat\nF = f and F = f .\nn n\nZA Z A ZA Z A 278 Chapter 8. Measurable Functions. Integration\n[Hint: By Lemma 2 of 5, fix measurable maps h f and hn fn with the same\n\u00a7 \u2265 \u2265\nintegrals. Let\nFn = inf (h h k), n=1,2,... ,\nk n \u2227\n\u2265\nand F =sup nFn \u2264h. (Why?) Proceed.]\n5. For A and any (even nonmeasurable) functions f,f : S E\u2217,\nn\n\u2208 M \u2192\nprove the following.\n(i) If f f (a.e.) on A, then\nn\n\u0580\nf f,\nn\n\u0580\nZ A Z A\nprovided\n( n) f > .\nn\n\u2203 \u2212\u221e\nZ A\n(ii) If f f (a.e.) on A, then\nn\n\u0581\nf f,\nn\n\u0581\nZ A Z A\nprovided\n( n) f < .\nn\n\u2203 \u221e\nZ A\n[Hint: Replace f,fn by F,Fn as in Problem 4. Then apply Problem 3 to Fn; thus\nobtain (i). For (ii), use (i) and Theorem 1(e ) in 5. (All is orthodox; why?)]\n\u2032\n\u00a7\n6. Show by examples that\n(i) the conditions\nf > and f <\nn n\n\u2212\u221e \u221e\nZ A Z A\nin Problem 5 are essential; and\n(ii) Problem 5(i) fails for lower integrals. What about 5(ii)?\n[Hints: (i) Let A=(0,1) \u2282E1, m= Lebesgue measure, fn = on (0, n1), fn =1\n\u2212\u221e\nelsewhere.\n(ii) Let = E1, , mE1 = 1, m = 0, fn = 1 on ( n,n), fn = 0 elsewhere.\nM { \u2205} \u2205 \u2212\nIf f =1 on A=E1, then fn f, but not\n\u2192\nfn f.\n\u2192\nZ A Z A\nExplain!]\n7. Given f : S E\u2217 and A , let\nn\n\u2192 \u2208 M\ng = inf f and h = supf (n = 1,2,...).\nn k n k\nk\u2265n k\u2265n 6. Integrable Functions. Convergence Theorems 279\n\u00a7\nProve that\n(i) limf lim f provided ( n) g > ; and\nA n \u2264 A n \u2203 A n \u2212\u221e\n(ii) R limf limR f provided ( n) R h < .\nn n n\nA \u2264 A \u2203 A \u221e\n[ RHint: Apply Probl Rem 5 to gn and hn.]\nR\n(iii) Give examples for which\nlimf = lim f and limf = lim f .\nn n n n\n6 6\nZ A Z A Z A Z A\n(See Note 2).\n8. Let f 0 on A and f f (a.e.) on A. Let A X, X .\nn n\n\u2265 \u2208 M \u2192 \u2287 \u2208 M\nProve the following.\n(i) If\nf f < ,\nn\n\u2192 \u221e\nZ A Z A\nthen\nf f.\nn\n\u2192\nZ X Z X\n(ii) This fails for sign-changing f .\nn\n[Hints: If (i) fails, then\nlim fn < f or lim fn > f.\nZ X Z X Z X Z X\nFind a subsequence of\nfn or fn\n(cid:26)Z X (cid:27) (cid:26)Z A \u2212X (cid:27)\ncontradicting Lemma 2.\n(ii) Let m= Lebesgue measure; A=(0,1), X =(0, 1),\n2\nn on 0, 1 ,\nfn = 2n\n( n on (cid:0)1 1 (cid:3) ,1 .]\n\u2212 \u2212 2n\n(cid:0) (cid:1)\n\u21d29. (i) Showthatiff andg arem-measurableandnonnegativeonA, then\n( a,b 0) (af +bg) = a f +b g.\n\u2200 \u2265\nZA ZA ZA\n(ii) If, in addition, f < or g < , this formula holds for any\nA \u221e A \u221e\na,b E1.\n\u2208 R R\n[Hint: Proceed as in Theorem 1.] 280 Chapter 8. Measurable Functions. Integration\n\u21d210. If\n\u221e\nf = f ,\nn\nn=1\nX\nwith all f measurable and nonnegative on A, then\nn\n\u221e\nf = f .\nn\nZA n=1ZA\nX\n[Hint: Apply Theorem 4 to the maps\nn\ngn = f f.\nk\n\u0580\nk=1\nX\nUse Problem 9.]\n11. If\n\u221e\nq = f <\nn\n| | \u221e\nn=1ZA\nX\nand the f are m-measurable on A, then\nn\n\u221e\nf < (a.e.) on A\nn\n| | \u221e\nn=1\nX\n\u221e\nand f = f is m-integrable on A, with\nn=1 n\n\u221e\nP\nf = f .\nn\nZA n=1ZA\nX\n[Hint: Let g = \u221en=1|fn |. By Problem 10,\nP\n\u221e\ng = fn =q < ;\n| | \u221e\nZA n=1ZA\nX\nso g < (a.e.) on A. (Why?) Apply Theorem 5 and Note 1 to the maps\n\u221e\nn\ngn = f k;\nk=1\nX\nnote that gn g.]\n| |\u2264\n12. (Convergence in measure; see Problem 11(ii) of 3).\n\u00a7\n(i) Prove Riesz\u2019 theorem: If f f in measure on A S, there is a\nn\n\u2192 \u2286\nsubsequence f such that f f (almost uniformly), hence\nnk} nk\n{ \u2192\n(a.e.), on A.\n[Outline: Taking\n\u03c3 =\u03b4 =2\u2212k,\nk k 6. Integrable Functions. Convergence Theorems 281\n\u00a7\npick, step by step, naturals\nn <n < <n <\n1 2 k\n\u00b7\u00b7\u00b7 \u00b7\u00b7\u00b7\nand sets D such that ( k)\nk\n\u2208M \u2200\nmD <2\u2212k\nk\nand\n\u03c1\u2032(fnk,f)<2\u2212k\non A D . (Explain!) Let\nk\n\u2212\n\u221e\nEn = D k,\nk=n\n[\nmEn <21 \u2212n. (Why?) Show that\n( \u2200n) ( \u2200k >n) \u03c1\u2032(fnk,f)<21 \u2212n\non A En. Use Problem 11 in 3.]\n\u2212 \u00a7\n(ii) For maps f : S E and g: S E1 deduce that if\nn\n\u2192 \u2192\nf f\nn\n\u2192\nin measure on A and\n( n) f g (a.e.) on A,\nn\n\u2200 | | \u2264\nthen\nf g (a.e.) on A.\n| | \u2264\n[Hint: fnk \u2192f (a.e.) on A.]\n13. Continuing Problem 12(ii), let\nf f\nn\n\u2192\nin measure on A (f : S E) and\nn\n\u2208 M \u2192\n( n) f g (a.e.) on A,\nn\n\u2200 | | \u2264\nwith\ng < .\n\u221e\nZ A\nProve that\nlim f f = 0.\nn\nn\u2192\u221e | \u2212 |\nZ A\nDoes\nf f?\nn\n\u2192\nZ A Z A 282 Chapter 8. Measurable Functions. Integration\n[Outline: From Corollary 1 of 5, infer that g =0 on A C, where\n\u00a7 \u2212\n\u221e\nC = C (disjoint),\nk\nk=1\n[\nmC < . (We may assume g -measurable on A. Why?) Also,\nk\n\u221e M\n\u221e\n> g = g+ g =0+ g;\n\u221e\nZA ZA \u2212C ZC k X=1ZCk\nso the series converges. Hence\np\n( \u03b5>0) ( p) g \u03b5< g = g,\n\u2200 \u2203 \u2212\nZA k=1ZCk ZH\nX\nwhere\np\nH = C\nk\n\u2208M\nk=1\n[\nand mH < . As fn f 2g (a.e.), we get\n\u221e | \u2212 |\u2264\n(1) fn f fn f fn f + 2g < fn f +2\u03b5.\n| \u2212 |\u2264 | \u2212 |\u2264 | \u2212 | | \u2212 |\nZ A Z A Z H ZA \u2212H Z H\n(Explain!)\nAs mH < , we can fix \u03c3 >0 with\n\u221e\n\u03c3 mH <\u03b5.\n\u00b7\nAlso, by Theorem 6, fix \u03b4 such that\n2 g <\u03b5\nZX\nwhenever A X, X and mX <\u03b4.\n\u2287 \u2208M\nAs fn f in measure on H, we find -sets Dn H such that\n\u2192 M \u2286\n( n>n 0) mDn <\u03b4\n\u2200\nand\nfn f <\u03c3 on An =H Dn.\n| \u2212 | \u2212\n(We may use the standard metric, as f and fn < a.e. Why?) Thus from (1),\n| | | | \u221e\nwe get\nfn f fn f +2\u03b5\n| \u2212 |\u2264 | \u2212 |\nZ A Z H\n= fn f + fn f +2\u03b5\n| \u2212 | | \u2212 |\nZ An Z Dn\n< fn f +3\u03b5\n| \u2212 |\nZ An\n\u03c3 mH+3\u03b5<4\u03b5\n\u2264 \u00b7\nfor n>n . (Explain!) Hence\n0\nlim fn f =0.\n| \u2212 |\nZ A 6. Integrable Functions. Convergence Theorems 283\n\u00a7\nSee also Problem 7 in 5 and Note 1 of 6 (for measurable functions) as regards\n\u00a7 \u00a7\nlim fn.]\nZ A\n14. Do Problem 12 in 3 (Lebesgue\u2013Egorov theorems) for T = E, assuming\n\u00a7\n( n) f g (a.e.) on A,\nn\n\u2200 | | \u2264\nwith\ng <\n\u221e\nZA\n(instead of mA < ).\n\u221e\n[Hint: With Hi(k) as before, it suffices that\nlim m(A Hi(k))=0.\ni \u2212\n\u2192\u221e\n(Why?) Verify that\n( n) \u03c1\u2032(fn,f)= fn f 2g (a.e.) on A,\n\u2200 | \u2212 |\u2264\nand\n1\n( i,k) A Hi(k) A 2g Q (mQ=0).\n\u2200 \u2212 \u2286 \u2265 k \u222a\n(cid:16) (cid:17)\nInfer that\n( i,k) m(A Hi(k))< .\n\u2200 \u2212 \u221e\nNow, as ( k) Hi(k) (why?), right continuity applies.]\n\u2200 \u0581\u2205\n\u00a77. Integration of Complex and Vector-Valued Functions\nI. First we consider functions f: S En(Cn). For such functions, it is\n\u2192\nnatural (and easy) to define integration \u201ccomponentwise\u201d as follows.1\nDefinition 1.\nA function f: S En is said to be integrable on A iff its n (real)\n\u2192 \u2208 M\ncomponents, f ,... ,f , are. In this case, we define\n1 n\nn\n(1) f = f dm = f , f ,... , f = e\u00af f ,\n1 2 n k k\n\u00b7\nZA ZA (cid:18)ZA ZA ZA (cid:19) k=1 ZA\nX\nwhere the e\u00af are basic unit vectors (as in Chapter 3, 1\u20133, Theorem 2).\nk\n\u00a7\u00a7\n1As before, we presuppose an arbitrary (but fixed) measure space (S, ,m).\nM 284 Chapter 8. Measurable Functions. Integration\nIn particular, a complex function f is integrable on A iff its real and\nimaginary parts (f and f ) are. Then we also say that f exists.2\nre im A\nBy (1), we have\nR\n(2) f = f , f = f +i f .\nre im re im\nZA (cid:18)ZA ZA (cid:19) ZA ZA\nIf f: S Cn, we use (1), with complex components f .\nk\n\u2192\nWith this definition, integration of functions f: S En(Cn) reduces to\n\u2192\nthat of f : S E1(C), and one easily obtains the same theorems as in 4\u20136,\nk\n\u2192 \u00a7\u00a7\nas far as they make sense for vectors.\nTheorem 1. A function f: S En(Cn) is integrable on A iff it is\n\u2192 \u2208 M\nm-measurable on A and f < .\nA| | \u221e\n(Alternate definition!)R\nProof. Assume the range space is En.\nBy our definition, if f is integrable on A, then its components f are. Thus\nk\nby Theorem 2 and Corollary 1, both in 6, for k = 1,2,... ,n, the functions\n\u00a7\nf+ and f\u2212 are m-measurable; furthermore,\nk k\nf+ = and f\u2212 = .\nk 6 \u00b1\u221e k 6 \u00b1\u221e\nZA ZA\nThis implies\n> f+ + f\u2212 = f+ +f\u2212 = f , k = 1,2,... ,n.\n\u221e k k k k | k |\nZA ZA ZA ZA\n(cid:0) (cid:1)\nSince f is m-measurable by Problem 14 in 3 ( is a continuous mapping\n| | \u00a7 | \u00b7 |\nfrom En to E1), and\nn n n\nf = e\u00af f e\u00af f = f ,\nk k k k k\n| | \u2264 | || | | |\n(cid:12)k=1 (cid:12) k=1 k=1\n(cid:12)X (cid:12) X X\nwe get (cid:12) (cid:12)\n(cid:12) (cid:12)\nn n\nf f = f < .\nk k\n| | \u2264 | | | | \u221e\nZA ZA ZA\n1 1\nX X\nConversely, if f satisfies\nf <\n| | \u221e\nZA\nthen\n( k) f < .\nk\n\u2200 \u221e\n(cid:12)ZA (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n2For vector-valued functions, too, this p(cid:12)hrase m(cid:12)eans integrability. 7. Integration of Complex and Vector-Valued Functions 285\n\u00a7\nAlso, the f are m-measurable if f is (see Problem 2 in 3). Hence the f are\nk k\n\u00a7\nintegrable on A (by Theorem 2 of 6), and so is f.\n\u00a7\nThe proof for Cn is analogous. (cid:3)\nSimilarly for other theorems (see Problems 1 to 4 below). We have already\nnoted that Theorem 5 of 6 holds for complex and vector-valued functions. So\n\u00a7\ndoes Theorem 6 in 6. We prove another such proposition (Lemma 1) below.\n\u00a7\nII. Next we consider the general case, f: S E (E complete). We now adopt\n\u2192\nTheorem 1 as a definition. (It agrees with Definition 1 of 4. Verify!) Even\n\u00a7\nif E = E\u2217, we always assume f < a.e.; thus, dropping a null set, we can\n| | \u221e\nmake f finite and use the standard metric on E1.\nFirst, we take up the case mA < .\n\u221e\nLemma 1. If f f (uniformly) on A (mA < ), then\nn\n\u2192 \u221e\nf f 0.\nn\n| \u2212 | \u2192\nZA\nProof. By assumption,\n( \u03b5 > 0) ( k) ( n > k) f f < \u03b5 on A;\nn\n\u2200 \u2203 \u2200 | \u2212 |\nso\n( n > k) f f (\u03b5) = \u03b5 mA < .\nn\n\u2200 | \u2212 | \u2264 \u00b7 \u221e\nZA ZA\nAs \u03b5 is arbitrary, the result follows. (cid:3)\nOur goal is to prove results on linearity (Theorem 2) and additivity (Theo-\nrem 3) for general E; for a \u201climited approach,\u201d see Problem 2 for E = En(Cn).\n\u2217\nLemma 2. If\nf < (mA < )\n| | \u221e \u221e\nZA\nand\nf = lim f (uniformly) on A Q (mQ = 0)\nn\nn\u2192\u221e \u2212\nfor some elementary maps f on A, then all but finitely many f are elementary\nn n\nand integrable on A, and\nlim f\nn\nn\u2192\u221e\nZA\nexists in E; further, the latter limit does not depend on the sequence f .\nn\n{ }\nProof. By Lemma 1,\n( \u03b5 > 0) ( q) ( n,k > q) f f < \u03b5 and f f < \u03b5.\nn n k\n\u2200 \u2203 \u2200 | \u2212 | | \u2212 |\nZA ZA 286 Chapter 8. Measurable Functions. Integration\n(The latter can be achieved since\nlim f f = f f < \u03b5.3)\nn k n\nk\u2192\u221e | \u2212 | | \u2212 |\nZA ZA\nNow, as\nf f f + f ,\nn n\n| | \u2264 | \u2212 | | |\nProblem 7 in 5 yields\n\u00a7\n( n > k) f f f + f < \u03b5+ f < .\nn n\n\u2200 | | \u2264 | \u2212 | | | | | \u221e\nZA ZA ZA ZA\nThusf is elementary and integrable forn > k, asclaimed. Also, by Theorem 2\nn\nand Corollary 1(ii), both in 4,\n\u00a7\n( n,k > q) f f = (f f ) f f < \u03b5.\nn k n k n k\n\u2200 \u2212 \u2212 \u2264 | \u2212 |\n(cid:12)ZA ZA (cid:12) (cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12) (cid:12) (cid:12)\nThus f is a Ca(cid:12)uchy sequence(cid:12). A(cid:12)s E is compl(cid:12)ete,\n{ A n } (cid:12) (cid:12) (cid:12) (cid:12)\nR\nlim f =\nn\n6 \u00b1\u221e\nZA\nexists in E, as asserted.\nFinally, suppose g f (uniformly) on A Q for some other elementary\nn\n\u2192 \u2212\nand integrable maps g . By what was shown above, lim g exists, and\nn A n\nR\nlim g lim f = lim (g f ) lim g f 0 = 0\nn n n n n n\n\u2212 \u2212 \u2264 | \u2212 \u2212 |\n(cid:12) ZA ZA (cid:12) (cid:12) ZA (cid:12) ZA\n(cid:12) (cid:12) (cid:12) (cid:12)\nby L(cid:12)emma 1, as g f (cid:12) 0 ((cid:12)uniformly) on A(cid:12). Thus\n(cid:12) n \u2212 n \u2192(cid:12) (cid:12) (cid:12)\nlim g = lim f ,\nn n\nZA ZA\nand all is proved. (cid:3)\nThis leads us to the following definition.\n\u2217\nDefinition 2.\nIf f: S E is integrable on A (mA < ), we set\n\u2192 \u2208 M \u221e\nf = f dm = lim f\nn\nn\u2192\u221e\nZA ZA ZA\nfor any elementary and integrable maps f such that f f (uniformly)\nn n\n\u2192\non A Q, mQ = 0.\n\u2212\n3Indeed, fn f fn f (uniformly) on A as k ; so Lemma 1 applies.\nk\n\u2212 \u2192 \u2212 \u2192\u221e 7. Integration of Complex and Vector-Valued Functions 287\n\u00a7\nIndeed, such maps exist by Theorem 3 of 1, and Lemma 2 excludes ambi-\n\u00a7\nguity.\n\u2217\nNote 1. If f itself is elementary and integrable, Definition 2 agrees with\nthat of 4. For, choosing f = f (n = 1,2,...), we get\nn\n\u00a7\nf = f\nn\nZA ZA\n(the latter as in 4).\n\u00a7\n\u2217\nNote 2. We may neglect sets on which f = 0, along with null sets. For\nif f = 0 on A B (A B, B ), we may choose f = 0 on A B in\nn\n\u2212 \u2287 \u2208 M \u2212\nDefinition 2. Then\nf = lim f = lim f = f.\nn n\nZA ZA ZB ZB\nThus we now define\nf = f,\nZA ZB\neven if mA = , provided f = 0 on A B, i.e.,\n\u221e \u2212\nf = f C on A\nB\n(C = characteristic function of B), with A B, B , and mB < .\nB\n\u2287 \u2208 M \u221e\nIf such a B exists, we say that f has m-finite support in A.\n\u2217\nNote 3. By Corollary 1 in 5,\n\u00a7\nf <\n| | \u221e\nZA\nimplies that A(f = 0) is \u03c3-finite. Neglecting A(f = 0), we may assume that\n6\nA = B , mB < , and B\nn n n\n\u221e { }\u2191\nn [\n(if not, replace B by B ); so B A.\nn k=1 k n \u0580\n\u2217\nLemma 3. Let \u03c6: S E be integrable on A. Let B A, mB < ,\nS n n\n\u2192 \u0580 \u221e\nand set\nf = \u03c6C , n = 1,2,....\nn Bn\nThen f \u03c6 (pointwise) on A, all f are integrable on A, and\nn n\n\u2192\nlim f\nn\nn\u2192\u221e\nZA\nexists in E. Furthermore, this limit does not depend on the choice of B .\nn\n{ }\nProof. Fix any x A. As B A = B ,\nn n\n\u2208 \u0580\n( n 0) ( n >Sn 0) x B n.\n\u2203 \u2200 \u2208 288 Chapter 8. Measurable Functions. Integration\nBy assumption, f = \u03c6 on B . Thus\nn n\n( n > n ) f (x) = \u03c6(x);\n0 n\n\u2200\nso f \u03c6 (pointwise) on A.\nn\n\u2192\nMoreover, f = \u03c6C is m-measurable on A (as \u03c6 and C are); and\nn Bn Bn\nf = \u03c6 C\nn Bn\n| | | |\nimplies\nf \u03c6 < .\nn\n| | \u2264 | | \u221e\nZA ZA\nThus all f are integrable on A.\nn\nAs f = 0 on A B (mB < ),\nn n\n\u2212 \u221e\nf\nn\nZA\nis defined. Since f \u03c6 (pointwise) and f \u03c6 on A, Theorem 5 in 6,\nn n\n\u2192 | | \u2264 | | \u00a7\nwith g = \u03c6 , yields\n| |\nf \u03c6 0.\nn\n| \u2212 | \u2192\nZA\nThe rest is as in Lemma 2, with our present Theorem 2 below (assuming m-\nfinite support of f and g), replacing Theorem 2 of 4. Thus all is proved. (cid:3)\n\u00a7\n\u2217\nDefinition 3.\nIf \u03c6: S E is integrable on A , we set\n\u2192 \u2208 M\n\u03c6 = \u03c6dm = lim f ,\nn\nn\u2192\u221e\nZA ZA ZA\nwith the f as in Lemma 3 (even if \u03c6 has no m-finite support).\nn\nTheorem 2 (linearity). If f,g:S E are integrable on A , so is\n\u2192 \u2208 M\npf +qg\nfor any scalars p,q. Moreover,\n(pf +qg) = p f +q g.\nZA ZA ZA\nFurthermore if f and g are scalar valued, p and q may be vectors in E.\n\u2217\nProof. For the moment, f,g denotes mappings with m-finite support in A.\nIntegrability is clear since pf +qg is measurable on A (as f and g are), and\npf +qg p f + q g\n| | \u2264 | || | | || | 7. Integration of Complex and Vector-Valued Functions 289\n\u00a7\nyields\npf +qg g f + q g < .\n| | \u2264 | | | | | | | | \u221e\nZA ZA ZA\nNow, as noted above, assume that\nf = f C and g = gC\nB1 B2\nfor some B ,B A (mB +mB < ). Let B = B B ; so\n1 2 1 2 1 2\n\u2286 \u221e \u222a\nf = g = pf +qg = 0 on A B;\n\u2212\nadditionally,\nf = f, g = g, and (pf +qg) = (pf +qg).\nZA ZB ZA ZB ZA ZB\nAlso, mB < ; so by Definition 2,\n\u221e\nf = lim f and g = lim g\nn n\nZB ZB ZB ZB\nfor some elementary and integrable maps\nf f (uniformly) and g g (uniformly) on B Q, mQ = 0.\nn n\n\u2192 \u2192 \u2212\nThus\npf +qg pf +qg (uniformly) on B Q.\nn n\n\u2192 \u2212\nBut by Theorem 2 and Corollary 1(vii), both of 4 (for elementary and inte-\n\u00a7\ngrable maps),\n(pf +qg ) = p f +q g .\nn n n n\nZB ZB ZB\nHence\n(pf +qg) = (pf +qg) = lim (pf +qg )\nn n\nZA ZB ZB\n= lim p f +q g = p f +q g = p f +q g.\nn n\n(cid:18) ZB ZB (cid:19) ZB ZB ZA ZA\nThis proves the statement of the theorem, provided f and g have m-finite\nsupport in A. For the general case, we now resume the notation f,g,... for\nany functions, and extend the result to any integrable functions.\nUsing Definition 3, we set\n\u221e\nA = B , B , mB < ,\nn n n\n{ }\u2191 \u221e\nn=1\n[\nand\nf = f C , g = gC , n = 1,2,....\nn Bn n Bn 290 Chapter 8. Measurable Functions. Integration\nThen by definition,\nf = lim f and g = lim g ,\nn n\nn\u2192\u221e n\u2192\u221e\nZA ZA ZA ZA\nand so\np f +q g = lim p f +q g .\nn n\nn\u2192\u221e\nZA ZA (cid:18) ZA ZA (cid:19)\nAs f ,g have m-finite supports, the first part of the proof yields\nn n\np f +q g = (pf +qg ).\nn n n n\nZA ZA ZA\nThus as claimed,\np f +q g = lim (pf +qg ) = (pf +qg). (cid:3)\nn n\nZA ZA ZA ZA\nSimilarly, one extends Corollary 1(ii)(iii)(v) of 4 first to maps with m-finite\n\u00a7\nsupport, and then to all integrable maps. The other parts of that corollary\nneed no new proof. (Why?)\nTheorem 3 (additivity).\n(i) If f: S E is integrable on each of n disjoint -sets A , it is so on\nk\n\u2192 M\ntheir union\nn\nA = A ,\nk\nk=1\n[\nand\nn\nf = f.\nZA k=1ZAk\nX\n(ii) This holds for countable unions, too, if f is integrable on all of A.\n\u2217\nProof. Let f have m-finite support: f = f C on A, mB < . Then\nB\n\u221e\nf = f and f = f,\nZA ZB ZAk ZBk\nwhere\nB = A B, k = 1,2,... ,n.\nk k\n\u2229\nBy Definition 2, fix elementary and integrable maps f (on A) and a set Q\ni\n(mQ = 0) such that f f (uniformly) on B Q (hence also on B Q), with\ni k\n\u2192 \u2212 \u2212\nf = f = lim f and f = lim f , k = 1,2,... ,n.\ni i\ni\u2192\u221e i\u2192\u221e\nZA ZB ZB ZAk ZBk 7. Integration of Complex and Vector-Valued Functions 291\n\u00a7\nAs the f are elementary and integrable, Theorem 1 in 4 yields\ni\n\u00a7\nn n\nf = f = f = f .\ni i i i\nZA ZB k=1ZBk k=1ZAk\nX X\nHence\nn n n\nf = lim f = lim f = lim f = f.\ni i i\ni\u2192\u221e i\u2192\u221e i\u2192\u221e\nZA ZB k=1ZBk k=1(cid:18) ZAk (cid:19) k=1ZAk\nX X X\nThus clause (i) holds for maps with m-finite support. For other functions,\n(i) now follows quite similarly, from Definition 3. (Verify!)\nAs for (ii), let f be integrable on\n\u221e\nA = A (disjoint), A .\nk k\n\u2208 M\nk=1\n[\nn\nIn this case, set g = f C , where B = A , n = 1,2,.... By clause (i),\nn Bn n k=1 k\nwe have\nS\nn n\n(3) g = g = g = f,\nn n n\nZA ZBn k=1ZAk k=1ZAk\nX X\nsince g = f on each A B .\nn k n\n\u2286\nAlso, as is easily seen, g f on A and g f (pointwise) on A (proof\nn n\n| | \u2264 | | \u2192\nas in Lemma 3). Thus by Theorem 5 in 6,\n\u00a7\ng f 0.\nn\n| \u2212 | \u2192\nZA\nAs\ng f = (g f) g f ,\nn n n\n\u2212 \u2212 \u2264 | \u2212 |\n(cid:12)ZA ZA (cid:12) (cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12) (cid:12) (cid:12)\nwe obtain (cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\nf = lim g ,\nn\nn\u2192\u221e\nZA ZA\nand the result follows by (3). (cid:3)\nProblems on Integration of Complex\nand Vector-Valued Functions\n1. Prove Corollary 1(iii)\u2013(vii) in 4 componentwise for integrable maps\n\u00a7\nf: S En(Cn).\n\u2192\n2. Prove Theorems 2 and 3 componentwise for E = En(Cn).\n\u2032\n2 . Do it for Corollary 3 in 6.\n\u00a7 292 Chapter 8. Measurable Functions. Integration\n3. Prove Theorem 1 with\nf <\n| | \u221e\nZA\nreplaced by\nf < , k = 1,... ,n.\nk\n| | \u221e\nZA\n4. Prove that if f: S En(Cn) is integrable on A, so is f . Disprove the\n\u2192 | |\nconverse.\n5. Disprove Lemma 1 for mA = .\n\u221e\n\u2217\n6. Complete the proof of Lemma 3.\n\u2217\n7. Complete the proof of Theorem 3.\n\u2217 8. Do Problem 1 and 2\u2032 for f: S E.\n\u2192\n\u2217\n9. Prove formula (1) from definitions of Part II of this section.\n\u21d210. Show that\nf f\n\u2264 | |\n(cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12)\nfor integrable maps f: S (cid:12)E. Se(cid:12)e also Problem 14.\n\u2192 (cid:12) (cid:12)\n[Hint: If mA < , use Corollary 1(ii) of 4 and Lemma 1. If mA = , \u201cimitate\u201d\n\u221e \u00a7 \u221e\nthe proof of Lemma 3.]\n11. Do Problem 11 in 6 for f : S E. Do it componentwise for E =\nn\n\u00a7 \u2192\nEn(Cn).\n12. Show that if f,g: S E1(C) are integrable on A, then4\n\u2192\n2\nfg f 2 g 2.\n\u2264 | | \u00b7 | |\n(cid:12)ZA (cid:12) ZA ZA\n(cid:12) (cid:12)\nIn what case does equ(cid:12)ality h(cid:12)old? Deduce Theorem 4(c\u2032) in Chapter 3,\n(cid:12) (cid:12)\n1\u20133, from this result.\n\u00a7\u00a7\n[Hint: Argue as in that theorem. Consider the case\n( t E1) f tg =0.]\n\u2203 \u2208 | \u2212 |\nZA\n13. Show that if f: S E1(C) is integrable on A and\n\u2192\nf = f ,\n| |\n(cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12)\nthen (cid:12) (cid:12)\n(cid:12) (cid:12)\n( c C) cf = f a.e. on A.\n\u2203 \u2208 | |\n4One may assume that f 2 and g 2 are finite (otherwise, all is trivial).\nA| | A| |\nR R 7. Integration of Complex and Vector-Valued Functions 293\n\u00a7\n[Hint: Let a= f. The case a=0 is trivial. If a=0, let\nA 6\nR a\nc= | |; c =1; ca= a.\na | | | |\nLet r =(cf)re. Show that r cf = f ,\n\u2264| | | |\nf = cf = r f = f ,\n\u2264 | |\n(cid:12)ZA (cid:12) ZA ZA ZA (cid:12)ZA (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) f = r = (cf)re, (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n| |\nZA ZA ZA\n(cf)re = cf (a.e.), and cf = cf = f a.e. on A.]\n| | | | | |\n14. Do Problem 10 for E = C using the method of Problem 13.\n15. Show that if f: S E is integrable on A, it is integrable on each -set\n\u2192 M\nB A. If, in addition,\n\u2286\nf = 0\nZB\nfor all such B, show that f = 0 a.e. on A. Prove it for E = En first.\n[Hint for E =E : A=A(f >0) A(f 0). Use Theorems 1(h) and 2 from 5.]\n\u2217\n\u222a \u2264 \u00a7\n16. In Problem 15, show that\ns = f\nZ\nis a \u03c3-additive set function on\n= X X A\nA\nM { \u2208 M | \u2286 }\n(Note 4 in 5); s is called the indefinite integral of f in A.\n\u00a7\n\u00a78. Product Measures. Iterated Integrals\nLet (X, ,m) and (Y, ,n) be measure spaces, with X and Y . Let\nM N \u2208 M \u2208 N\nbe the family of all \u201crectangles,\u201d i.e., sets\nC\nA B,\n\u00d7\nwith A , B , mA < , and nB < .\n\u2208 M \u2208 N \u221e \u221e\nDefine a premeasure s: E1 by\nC \u2192\ns(A B) = mA nB, A B .\n\u00d7 \u00b7 \u00d7 \u2208 C\nLet p\u2217 be the s-induced outer measure in X Y and\n\u00d7\np: \u2217 E\u2217\nP \u2192\nthe p\u2217-induced measure (\u201cproduct measure,\u201d p = m n) on the \u03c3-field \u2217 of\n\u00d7 P\nall p\u2217-measurable sets in X Y (Chapter 7, 5\u20136).\n\u00d7 \u00a7\u00a7 294 Chapter 8. Measurable Functions. Integration\nWe consider functions f: X Y E\u2217 (extended-real).\n\u00d7 \u2192\nI. We begin with some definitions.\nDefinitions.\n(1) Given a function f: X Y E\u2217 (of two variables x,y), let f or f(x, )\nx\n\u2192 \u2192 \u00b7\ndenote the function on Y given by\nf (y) = f(x,y);\nx\nit arises from f by fixing x.\nSimilarly, fy or f( ,y) is given by fy(x) = f(x,y).\n\u00b7\n(2) Define g: X E\u2217 by\n\u2192\ng(x) = f(x, )dn,\n\u00b7\nZY\nand set\nf dndm = gdm,\nZX ZY ZX\nalso written\ndm(x) f(x,y)dn(y).\nZX ZY\nThis is called the iterated integral of f on Y and X, in this order.\nSimilarly,\nh(y) = fydm\nZX\nand\nf dmdn = hdn.\nZY ZX ZY\nNote that by the rules of 5, these integrals are always defined.\n\u00a7\n(3) With f,g,h as above, we say that f is a Fubini map or has the Fubini\nproperties (after the mathematician Fubini) iff\n(a) g is m-measurable on X and h is n-measurable on Y;\n(b) f is n-measurable on Y for almost all x (i.e., for x X Q,\nx\n\u2208 \u2212\nmQ = 0); fy is m-measurable on X for y Y Q\u2032, nQ\u2032 = 0; and\n\u2208 \u2212\n(c) the iterated integrals above satisfy\nf dndm = f dmdn = f dp\nZX ZY ZY ZX ZX\u00d7Y\n(the main point). 8. Product Measures. Iterated Integrals 295\n\u00a7\nFor monotone sequences\nf : X Y E\u2217 (k = 1,2,...),\nk\n\u00d7 \u2192\nwe now obtain the following lemma.\nLemma 1. If 0 f f (pointwise) on X Y and if each f has Fubini\nk k\n\u2264 \u0580 \u00d7\nproperty (a), (b), or (c), then f has the same property.\nProof. For k = 1,2,..., set\ng (x) = f (x, )dn\nk k\n\u00b7\nZY\nand\nh (y) = f ( ,y)dm.\nk k\n\u00b7\nZX\nBy assumption,\n0 f (x, ) f(x, )\nk\n\u2264 \u00b7 \u0580 \u00b7\npointwise on Y. Thus by Theorem 4 in 6,\n\u00a7\nf (x, ) f(x, )dn,\nk\n\u00b7 \u0580 \u00b7\nZY ZY\ni.e., g g (pointwise) on X, with g as in Definition 2.\nk\n\u0580\nAgain, by Theorem 4 of 6,\n\u00a7\ng dm gdm;\nk\n\u0580\nZX ZX\nor by Definition 2,\nf dndm = lim f dndm.\nk\nk\u2192\u221e\nZX ZY ZX ZY\nSimilarly for\nf dmdn\nZY ZX\nand\nf dp.\nZX\u00d7Y\nHence f satisfies (c) if all f do.\nk\nNext, let f have property (b); so ( k) f (x, ) is n-measurable on Y if\nk k\n\u2200 \u00b7\nx X Q (mQ = 0). Let\nk k\n\u2208 \u2212\n\u221e\nQ = Q ;\nk\nk=1\n[ 296 Chapter 8. Measurable Functions. Integration\nso mQ = 0, and all f (x, ) are n-measurable on Y, for x X Q. Hence\nk\n\u00b7 \u2208 \u2212\nso is\nf(x, ) = lim f (x, ).\nk\n\u00b7 k\u2192\u221e \u00b7\nSimilarly for f( ,y). Thus f satisfies (b).\n\u00b7\nProperty (a) follows from g g and h h. (cid:3)\nk k\n\u2192 \u2192\nUsing Problems 9 and 10 from 6, the reader will also easily verify the fol-\n\u00a7\nlowing lemma.\nLemma 2.\n(i) If f and f are nonnegative, p-measurable Fubini maps, so is af +bf\n1 2 1 2\nfor a,b 0.\n\u2265\n(ii) If, in addition,\nf dp < or f dp < ,\n1 2\n\u221e \u221e\nZX\u00d7Y ZX\u00d7Y\nthen f f is a Fubini map, too.\n1 2\n\u2212\n\u221e\nLemma 3. Let f = f (pointwise), with f 0 on X Y.\ni=1 i i \u2265 \u00d7\n(i) If all f are p-measurable Fubini maps, so is f.\ni P\n(ii) If the f have Fubini properties (a) and (b), then\ni\n\u221e\nf dndm = f dndm\ni\nZX ZY i=1ZX ZY\nX\nand\n\u221e\nf dmdn = f dmdn.\ni\nZY ZX i=1ZY ZX\nX\nII. By Theorem 4 of Chapter 7, 3, the family (see above) is a semiring,\n\u00a7 C\nbeing the product of two rings,\nA mA < and B nB < .\n{ \u2208 M | \u221e} { \u2208 N | \u221e}\n(Verify!) Thus using Theorem 2 in Chapter 7, 6, we now show that p is an\n\u00a7\nextension of s: E1.\nC \u2192\nTheorem 1. The productpremeasure s is \u03c3-additive on the semiring . Hence\nC\n(i) \u2217 and p = s < on , and\nC \u2286 P \u221e C\n(ii) the characteristic function C of any set D is a Fubini map.\nD\n\u2208 C 8. Product Measures. Iterated Integrals 297\n\u00a7\nProof. Let D = A B ; so\n\u00d7 \u2208 C\nC (x,y) = C (x) C (y).\nD A B\n\u00b7\n(Why?) Thus for a fixed x, C (x, ) is just a multiple of the -simple map\nD\n\u00b7 N\nC , hence n-measurable on Y. Also,\nB\ng(x) = C (x, )dn = C (x) C dn = C (x) nB;\nD A B A\n\u00b7 \u00b7 \u00b7\nZY ZY\nso g = C nB is -simple on X, with\nA\n\u00b7 M\nC dndm = gdm = nB C dm = nB mA = sD.\nD A\n\u00b7\nZX ZY ZX ZX\nSimilarly for C ( ,y), and\nD\n\u00b7\nh(y) = C ( ,y)dm.\nD\n\u00b7\nZX\nThus C has Fubini properties (a) and (b), and for every D\nD\n\u2208 C\n(1) C dndm = C dmdn = sD.\nD D\nZX ZY ZY ZX\nTo prove \u03c3-additivity, let\n\u221e\nD = D (disjoint), D ;\ni i\n\u2208 C\ni=1\n[\nso\n\u221e\nC = C .\nD Di\ni=1\nX\n(Why?) As shown above, each C has Fubini properties (a) and (b); so by (1)\nDi\nand Lemma 3,\n\u221e \u221e\nsD = C dndm = C dndm = sD ,\nD Di i\nZX ZY i=1ZX ZY\ni=1\nX X\nas required.\nAssertion (i) now follows by Theorem 2 in Chapter 7, 6. Hence\n\u00a7\nsD = pD = C dp;\nD\nZX\u00d7Y\nso by formula (1), C also has Fubini property (c), and all is proved. (cid:3)\nD\nNext, let be the \u03c3-ring generated by the semiring (so \u2217).\nP C C \u2286 P \u2286 P 298 Chapter 8. Measurable Functions. Integration\nLemma 4. is the least set family such that\nP R\n(i) ;\nR \u2287 C\n(ii) is closed under countable disjoint unions; and\nR\n(iii) H D if D and D H, H .\n\u2212 \u2208 R \u2208 R \u2286 \u2208 C\nThis is simply Theorem 3 in Chapter 7, 3, with changed notation.\n\u00a7\nLemma 5. If D (\u03c3-generated by ), then C is a Fubini map.\nD\n\u2208 P C\nProof. Let be the family of all D such that C is a Fubini map. We\nD\nR \u2208 P\nshall show that satisfies (i)\u2013(iii) of Lemma 4, and so .\nR P \u2286 R\n(i) By Theorem 1, each C (D ) is a Fubini map; so each D is in .\nD\n\u2208 C \u2208 C R\n(ii) Let\n\u221e\nD = D (disjoint), D .\ni i\n\u2208 R\ni=1\n[\nThen\n\u221e\nC = C ,\nD Di\ni=1\nX\nand each C is a Fubini map. Hence so is C by Lemma 3. Thus D ,\nDi D\n\u2208 R\nproving (ii).\n(iii) We must show that C is a Fubini map if C is and if D H, H .\nH\u2212D D\n\u2286 \u2208 C\nNow, D H implies\n\u2286\nC = C C .\nH\u2212D H D\n\u2212\n(Why?) Also, by Theorem 1, H implies\n\u2208 C\nC dp = pH = sH < ,\nH\n\u221e\nZX\u00d7Y\nand C is a Fubini map. So is C by assumption. So also is\nH D\nC = C C\nH\u2212D H D\n\u2212\nby Lemma 2(ii). Thus H D , proving (iii).\n\u2212 \u2208 R\nBy Lemma 4, then, . Hence ( D ) C is a Fubini map. (cid:3)\nD\nP \u2286 R \u2200 \u2208 P\nWe can now establish one of the main theorems, due to Fubini.\nTheorem 2 (Fubini I). Suppose f: X Y E\u2217 is measurable on X Y\n\u00d7 \u2192 P\u2212 \u00d7\n( as above) rom. Then f is a Fubini map if either\nP\n(i) f 0 on X Y, or\n\u2265 \u00d7 8. Product Measures. Iterated Integrals 299\n\u00a7\n(ii) one of\nf dp, f dndm, or f dmdn\n| | | | | |\nZX\u00d7Y ZX ZY ZY ZX\nis finite.1\nIn both cases,\n(2) f dndm = f dmdn = f dp.\nZX ZY ZY ZX ZX\u00d7Y\nProof. First, let\n\u221e\nf = a C (a 0, D ),\ni Di i i\n\u2265 \u2208 P\ni=1\nX\ni.e., f is -elementary, hence certainly p-measurable. (Why?) By Lemmas 5\nP\nand 2, each a C is a Fubini map. Hence so is f (Lemma 3). Formula (2) is\ni Di\nsimply Fubini property (c).\nNow take any -measurable f 0. By Lemma 2 in 2,\nP \u2265 \u00a7\nf = lim f on X Y\nk\nk\u2192\u221e \u00d7\nfor some sequence f of -elementary maps, f 0. As shown above, each\nk k\n{ }\u2191 P \u2265\nf is a Fubini map. Hence so is f by Lemma 1. This settles case (i).\nk\nNext, assume (ii). As f is -measurable, so are f+, f , and f (Theorem 2\n\u2212\nP | |\nin 2). As they are nonnegative, they are Fubini maps by case (i).\n\u00a7\nSo is f = f+ f\u2212 by Lemma 2(ii), since f+ f implies\n\u2212 \u2264 | |\nf+dp <\n\u221e\nZX\u00d7Y\nby our assumption (ii). (The three integrals are equal, as f is a Fubini map.)\n| |\nThus all is proved. (cid:3)\nIII. We now want to replace by \u2217 in Lemma 5 and Theorem 2. This works\nP P\nonly under certain \u03c3-finiteness conditions, as shown below.\nLemma 6. Let D \u2217 be \u03c3-finite, i.e.,\n\u2208 P\n\u221e\nD = D (disjoint)\ni\ni=1\n[\nfor some D \u2217, with pD < (i = 1,2,...).2\ni i\n\u2208 P \u221e\n1Note the use of absolute values; without them, Theorem 2 fails (see Problem 5 ).\n\u2032\n2See Note 2 in Chapter 7, 8.\n\u00a7 300 Chapter 8. Measurable Functions. Integration\nThen there is a K such that p(K D) = 0 and D K.\n\u2208 P \u2212 \u2286\nProof. As is a \u03c3-ring containing , it also contains . Thus by Theorem 3\n\u03c3\nP C C\nof Chapter 7, 5, p\u2217 is -regular.\n\u00a7 P\nFor the rest, proceed as in Theorems 1 and 2 in Chapter 7, 7. (cid:3)\n\u00a7\nLemma 7. If D \u2217 is \u03c3-finite (Lemma 6), then C is a Fubini map.\nD\n\u2208 P\nProof. By Lemma 6,\n( K ) p(K D) = 0, D K.\n\u2203 \u2208 P \u2212 \u2286\nLet Q = K D, so pQ = 0, and C = C C ; that is, C = C C and\nQ K D D K Q\n\u2212 \u2212 \u2212\nC dp = pQ = 0.\nQ\nZX\u00d7Y\nAs K , C is a Fubini map. Thus by Lemma 2(ii), all reduces to proving\nK\n\u2208 P\nthe same for C .\nQ\nNow, as pQ = 0, Q is certainly \u03c3-finite; so by Lemma 6,\n( Z ) Q Z, pZ = pQ = 0.\n\u2203 \u2208 P \u2286\nAgain C is a Fubini map; so\nZ\nC dndm = C dp = pZ = 0.\nZ Z\nZX ZY ZX\u00d7Y\nAs Q Z, we have C C , and so\nQ Z\n\u2286 \u2264\nC dndm = C (x, )dn dm\nQ Q\n\u00b7\n(3) ZX ZY ZX(cid:20)ZY (cid:21)\nC (x, )dn dm = C dp = 0.\nZ Z\n\u2264 \u00b7\nZX(cid:20)ZY (cid:21) ZX\u00d7Y\nSimilarly,\n(4) C dmdn = C ( ,y)dm dn = 0.\nQ Q\n\u00b7\nZY ZX ZY(cid:20)ZX (cid:21)\nThus setting\ng(x) = C (x, )dn and h(y) = C ( ,y)dm,\nQ Q\n\u00b7 \u00b7\nZY ZX\nwe have\ngdm = 0 = hdn.\nZX ZY\nHence by Theorem 1(h) in 5, g = 0 a.e. on X, and h = 0 a.e. on Y. So g and h\n\u00a7\nare \u201calmost\u201d measurable (Definition 2 of 3); i.e., C has Fubini property (a).\nQ\n\u00a7 8. Product Measures. Iterated Integrals 301\n\u00a7\nSimilarly, one establishes (b), and (3) yields Fubini property (c), since\nC dndm = C dmdn = C dp = 0,\nQ Q Q\nZX ZY ZY ZX ZX\u00d7Y\nas required. (cid:3)\nTheorem 3 (Fubini II). Suppose f: X Y E\u2217 is \u2217-measurable3 on X Y\n\u00d7 \u2192 P \u00d7\nand satisfies condition (i) or (ii) of Theorem 2.\nThen f is a Fubini map, provided f has \u03c3-finite support, i.e., f vanishes\noutside some \u03c3-finite set H X Y.\n\u2286 \u00d7\nProof. First, let\n\u221e\nf = a C (a > 0, D \u2217),\ni Di i i\n\u2208 P\ni=1\nX\nwith f = 0 on H (as above).\n\u2212\nAs f = a = 0 on A , we must have D H; so all D are \u03c3-finite. (Why?)\ni i i i\n6 \u2286\nThus by Lemma 7, each C is a Fubini map, and so is f. (Why?)\nDi\nIf f is \u2217-measurable and nonnegative, and f = 0 on H, we can proceed\nP \u2212\nas in Theorem 2, making all f vanish on H. Then the f and f are Fubini\nk k\n\u2212\nmaps by what was shown above.\nFinally, in case (ii), f = 0 on H implies\n\u2212\nf+ = f\u2212 = f = 0 on H.\n| | \u2212\nThus f+, f\u2212, and f are Fubini maps by part (i) and the argument of Theo-\nrem 2. (cid:3)\nNote 1. The \u03c3-finite support is automatic if f is p-integrable (Corollary 1\nin 5), or if p or both m and n are \u03c3-finite (see Problem 3). The condition is\n\u00a7\nalso redundant if f is -measurable (Theorem 2; see also Problem 4).\nP\nNote 2. By induction, our definitions and Theorems 2 and 3 extend to any\nfinite number q of measure spaces\n(X , ,m ), i = 1,... ,q.\ni i i\nM\nOne writes\np = m m\n1 2\n\u00d7\nif q = 2 and sets\nm m m = (m m ) m .\n1 2 q+1 1 q q+1\n\u00d7 \u00d7\u00b7\u00b7\u00b7\u00d7 \u00d7\u00b7\u00b7\u00b7\u00d7 \u00d7\n3Or, equivalently, p-measurable (Note 2 in 3), as p is complete (Theorem 1 of Chap-\n\u00a7\nter 7, 6).\n\u00a7 302 Chapter 8. Measurable Functions. Integration\nTheorems 2 and 3 with similar assumptions then state that the order of inte-\ngrations is immaterial.\nNote 3. Lebesgue measure in Eq can be treated as the product of q one-\ndimensional measures. Similarly for LS product measures (but this method is\nless general than that described in Problems 9 and 10 of Chapter 7, 9).\n\u00a7\nIV. Theorems 2(ii) and 3(ii) hold also for functions\nf: X Y En(Cn)\n\u00d7 \u2192\nif Definitions 2 and 3 are modified as follows (so that they make sense for such\nmaps): In Definition 2, set\ng(x) = f dn\nx\nZY\nif f is n-integrable on Y, and g(x) = 0 otherwise. Similarly for h(y). In\nx\nDefinition 3, replace \u201cmeasurable\u201d by \u201cintegrable.\u201d\nFor the proof of the theorems, apply Theorems 2(i) and 3(i) to f . This\n| |\nyields\nf dmdn = f dndm = f dp.\n| | | | | |\nZY ZX ZX ZY ZX\u00d7Y\nHence if one of these integrals is finite, f is p-integrable on X Y, and so are\n\u00d7\nits q components. The result then follows on noting that f is a Fubini map\n(in the modified sense) iff its components are. (Verify!) See also Problem 12\nbelow.\nV. In conclusion, note that integrals of the form\nf dp (D \u2217)\n\u2208 P\nZD\nreduce to\nf C dp.\nD\n\u00b7\nZX\u00d7Y\nThus it suffices to consider integrals over X Y.\n\u00d7\nProblems on Product Measures and Fubini Theorems\n1. Prove Lemmas 2 and 3.\n\u2032\n1 . Show that A mA < is a set ring.\n{ \u2208 M | \u221e}\n2. Fill in all proof details in Theorems 1 to 3.\n\u2032\n2 . Do the same for Lemmas 5 to 7. 8. Product Measures. Iterated Integrals 303\n\u00a7\n3. Prove that if m and nare \u03c3-finite, so is p = m n. Disprove the converse\n\u00d7\nby an example.\n[Hint: ( iAi) \u00d7( jBj)= i,j(Ai \u00d7Bj). Verify!]\n4. Prove tShe followSing. S\n(i) Each D (as in the text) is (p) \u03c3-finite.\n\u2208 P\n(ii) All -measurable maps f: X Y E\u2217 have \u03c3-finite support.\nP \u00d7 \u2192\n[Hints: (i) Use Problem 14(b) from Chapter 7, 3. (ii) Use (i) for -elementary and\n\u00a7 P\nnonnegative maps first.]\n5. (i) Find D \u2217 and x X such that C (x, ) is not n-measurable\nD\n\u2208 P \u2208 \u00b7\non Y. Does this contradict Lemma 7?\n[Hint: Let m = n = Lebesgue measure in E1; D = x Q, with Q non-\n{ }\u00d7\nmeasurable.]\n(ii) Which -sets have nonzero measure if X = Y = E1, m\u2217 is as in\nC\nProblem 2(b) of Chapter 7, 5 (with S = X), and n is Lebesgue\n\u00a7\nmeasure?\n\u2032\n5 . Let m = n = Lebesgue measure in [0,1] = X = Y. Let\n1 1\nk(k +1) on , and\nf = k +1 k\nk\n\uf8f1 (cid:16) i\n0 elsewhere.\n\uf8f2\nLet\n\uf8f3\n\u221e\nf(x,y) = [f (x) f (x)]f (y);\nk k+1 k\n\u2212\nk=1\nX\nthe series converges. (Why?) Show that\n(i) ( k) f = 1;\n\u2200 X k\n(ii) Rf dndm = 1 = 0 = f dmdn.\nX Y 6 Y X\nWhatRis Rwrong? Is f -measurRablRe?\nP\n[Hint: Explore\nf dndm.]\n| |\nZXZY\n6. Let X = Y = [0,1], m as in Example (c) of Chapter 7, 6, (S = X) and\n\u00a7\nn = Lebesgue measure in Y.\n(i) Show that p = m n is a topological measure under the standard\n\u00d7\nmetric in E2.\n(ii) Prove that D = (x,y) X Y x = y \u2217.\n{ \u2208 \u00d7 | } \u2208 P\n(iii) Describe .\nC\n[Hints: (i) Any subinterval of X Y is in ; (ii) D is closed. Verify!]\n\u2217\n\u00d7 P 304 Chapter 8. Measurable Functions. Integration\n7. Continuing Problem 6, let f = C .\nD\n(i) Show that\nf dndm = 0 = 1 = f dmdn.\n6\nZY ZX ZY ZX\nWhat is wrong?\n[Hint: D is not \u03c3-finite; for if\n\u221e\nD = Di,\ni=1\n[\nat least one Di is uncountable and has no finite basic covering values (why?),\nso p \u2217Di = .]\n\u221e\n(ii) Compute p\u2217 (x,0) x X and p\u2217 (0,y) y Y .\n{ | \u2208 } { | \u2208 }\n8. Show that D \u2217 is \u03c3-finite iff\n\u2208 P\n\u221e\nD D (disjoint)\ni\n\u2286\ni=1\n[\nfor some sets D .\ni\n\u2208 C\n[Hint: First let p D < . Use Corollary 1 from Chapter 7, 1.]\n\u2217\n\u221e \u00a7\n9. Given D , a X, and b Y, let Y\n\u2208 P \u2208 \u2208\nD = y Y (a,y) D\na\n{ \u2208 | \u2208 } D\nDa\nand\nDb = x X (x,b) D .\n{ \u2208 | \u2208 }\n(See Figure 34 for X = Y = E1.) X\na\nO\nProve that\nFigure 34\n(i) D , Db ;\na\n\u2208 N \u2208 M\n(ii) C (a, ) = C , nD = C (a, )dn, mDb = C ( ,b)dm.\nD Da a D D\n\u00b7 \u00b7 \u00b7\nZY ZX\n[Hint: Let\n= Z Za .\nR { \u2208P | \u2208N}\nShow that is a \u03c3-ring . Hence ; D ; Da . Similarly for Db.]\nR \u2287C R\u2287P \u2208R \u2208N\n\u21d210. Let m = n = Lebesgue measure in E1 = X = Y. Let f: E1 [0, )\n\u2192 \u221e\nbe m-measurable on X. Let\nH = (x,y) E2 0 y < f(x)\n{ \u2208 | \u2264 }\nand\nG = (x,y) E2 y = f(x,y)\n{ \u2208 | } 8. Product Measures. Iterated Integrals 305\n\u00a7\n(the \u201cgraph\u201d of f). Prove that\n(i) H \u2217 and\n\u2208 P\npH = f dm\nZX\n(= \u201cthe area under f\u201d);\n(ii) G \u2217 and pG = 0.\n\u2208 P\n[Hints: (i) First take f = C , and elementary and nonnegative maps. Then use\nD\nLemma 2in 2(lastclause). Fixelementaryandnonnegativemapsf f,assuming\nk\n\u00a7 \u0580\nf <f (if not, replace f by (1 1)f ). Let\nk k \u2212 k k\nH = (x,y) 0 y <f (x) .\nk k\n{ | \u2264 }\nShow that H H .\nk \u2217\n\u0580 \u2208P\n(ii) Set\n\u03c6(x,y)=y f(x).\n\u2212\nUsingCorollary 4of 1,showthat\u03c6isp-measurableonE2;soG=E2(\u03c6=0) .\n\u2217\n\u00a7 \u2208P\nDropping a null set (Lemma 6), assume G . By Problem 9(ii),\n\u2208P\n( x E1) C G(x, )dn=nGx =0,\n\u2200 \u2208 \u00b7\nZY\nas Gx = f(x) , a singleton.]\n{ }\n11. Let\nf(x,y) = \u03c6 (x)\u03c6 (y).\n1 2\nProve that if \u03c6 is m-integrable on X and \u03c6 is n-integrable on Y, then\n1 2\nf is p-integrable on X Y and\n\u00d7\nf dp = \u03c6 \u03c6 .\n1 2\n\u00b7\nZX\u00d7Y ZX ZY\n\u2217\n12. Prove Theorem 3(ii) for f: X Y E (E complete).\n\u00d7 \u2192\n[Outline: If f is -simple, use Lemma 7 above and Theorem 2 in 7.\n\u2217\nP \u00a7\nIf\n\u221e\nf = a kC Dk, D \u2208P\u2217,\nk\nk=1\nX\nlet\nk\nH = Di\nk\ni=1\n[\nand f = fC , so the f are -simple (hence Fubini maps), and f f (point-\nk Hk k P\u2217 k\n\u2192\nwise) on X Y, with f f and\nk\n\u00d7 | |\u2264| |\nf dp<\n| | \u221e\nZX \u00d7Y\n(by assumption). Now use Theorem 5 from 6.\n\u00a7 306 Chapter 8. Measurable Functions. Integration\nLet now f be -measurable; so\n\u2217\nP\nf = lim f (uniformly)\nk\nk\n\u2192\u221e\nfor some -elementary maps g (Theorem 3 in 1). By assumption, f = fC (H\n\u2217 k H\nP \u00a7\n\u03c3-finite); so we may assume g = g C . Then as shown above, all g are Fubini\nk k H k\nmaps. So is f by Lemma 1 in 7 (verify!), provided H D for some D .\n\u00a7 \u2286 \u2208C\nIn the general case, by Problem 8,\nH Di (disjoint), Di .\n\u2286 \u2208C\ni\n[\nLet Hi =H \u2229Di. By the previous step, each fC is a Fubini map; so is\nHi\nk\nf = fC\nk Hi\ni=1\nX\n(why?), hence so is f = lim f , by Theorem 5 of 6. (Verify!)]\nk\nk \u00a7\n\u2192\u221e\n13. Let m = Lebesgue measure in E1, p = Lebesgue measure in Es, X =\n(0, ), and\n\u221e\nY = y\u00af Es y\u00af = 1 .\n{ \u2208 | | | }\nGiven x\u00af Es \u00af0 , let\n\u2208 \u2212{ }\nx\u00af\nr = x\u00af and u\u00af = Y.\n| | r \u2208\nCall r and u\u00af the polar coordinates of x\u00af = \u00af0.\n6\nIf D Y, set\n\u2286\nn\u2217D = s p\u2217 ru\u00af u\u00af D, 0 < r 1 .\n\u00b7 { | \u2208 \u2264 }\nShow that n\u2217 is an outer measure in Y; so it induces a measure n in Y.\nThen prove that\nf dp = rs\u22121dm(r) f(ru\u00af)dn(u\u00af)\nZEs ZX ZY\nif f is p-measurable and nonnegative on Es.\n[Hint: Start with f =C ,\nA\nA= ru\u00af u\u00af H, a<r <b ,\n{ | \u2208 }\nfor some open set H Y (subspace of Es). Next, let A (Borel set in Y); then\n\u2286 \u2208 B\nA . Then let f be p-elementary, and so on.]\n\u2217\n\u2286P\n\u00a79. Riemann Integration. Stieltjes Integrals\nI. In this section, is the family of all intervals in En, and m is an additive\nC\nfinite premeasure on (or ), such as the volume function v (Chapter 7,\ns\nC C\n1\u20132).\n\u00a7\u00a7 9. Riemann Integration. Stieltjes Integrals 307\n\u00a7\nBy a -partition of A (or A ), we mean a finite family\ns\nC \u2208 C \u2208 C\n= A\ni\nP { } \u2282 C\nsuch that\nA = A (disjoint).\ni\ni\n[\nAs we noted in 5, the Riemann integral,\n\u00a7\nR f = R f dm,\nZA ZA\nof f: En E1 can be defined as its Lebesgue counterpart,\n\u2192\nf,\nZA\nwith elementary maps replaced by simple step functions (\u201c -simple\u201d maps.)\nC\nEquivalently, one can use the following construction, due to J. G. Darboux.\nDefinitions.\n(a) Given f: En E\u2217 and a -partition\n\u2192 C\n= A ,... ,A\n1 q\nP { }\nof A, we define the lower and upper Darboux sums, S and S, of f over\n(with respect to m) by\nP\nq q\n(1) S(f, ) = mA inff[A ] and S(f, ) = mA supf[A ].1\ni i i i\nP \u00b7 P \u00b7\ni=1 i=1\nX X\n(b) The lower and upper Riemann integrals (\u201cR-integrals\u201d) of f on A (with\nrespect to m) are\nR f = R f dm = supS(f, ) and\nP\nP\n(2) Z A Z A \uf8fc\n\uf8f4\n\uf8f4\nR f = R f dm = infS(f, ),2 \uf8f4 \uf8fd\nP P\nZ A Z A\n\uf8f4\n\uf8f4\nwhere the \u201cinf\u201d and \u201csup\u201d are taken over all -partit\uf8f4ions of A.\n\uf8fe\nC P\n(c) We say that f is Riemann-integrable (\u201cR-integrable\u201d) with respect to m\non A iff f is bounded on A and\nR f = R f.\nZ A Z A\n1,2These expressions exist in E (Chapter 4, 4, (2 )).\n\u2217 \u2217\n\u00a7 308 Chapter 8. Measurable Functions. Integration\nWe then set\nR f = R f = R f dm = R f dm\nZA Z A Z A ZA\nand call it the Riemann integral (\u201cR-integral\u201d) of f on A. \u201cClassical\u201d\nnotation:\nR f(x\u00af)dm(x\u00af).\nZA\nIf A = [a,b] E1, we also write\n\u2282\nb b\nR f = R f(x)dm(x)\nZa Za\ninstead.\nIf m is Lebesgue measure (or premeasure) in E1, we write \u201cdx\u201d for\n\u201cdm(x).\u201d\nFor Lebesgue integrals, we replace \u201cR\u201d by \u201cL,\u201d or we simply omit \u201cR.\u201d\nIf f is R-integrable on A, we also say that\nR f\nZA\nexists (note that this implies the boundedness of f); note that\nR f and R f\nZ A Z A\nare always defined in E\u2217.\nBelow, we always restrict f to a fixed A (or A ); , \u2032, \u2032\u2032, \u2217,\ns\n\u2208 C \u2208 C P P P P\nand denote -partitions of A.\nk\nP C\nWe now obtain the following result for any additive m: [0, ).\nC \u2192 \u221e\nCorollary 1. If refines \u2032 ( 1), then\nP P \u00a7\nS(f, \u2032) S(f, ) S(f, ) S(f, \u2032).\nP \u2264 P \u2264 P \u2264 P\nProof. Let \u2032 = A , = B , and\ni ik\nP { } P { }\n( i) A = B .\ni ik\n\u2200\nk\n[\nBy additivity,\nmA = mB .\ni ik\nk\nX 9. Riemann Integration. Stieltjes Integrals 309\n\u00a7\nAlso, B A implies\nik i\n\u2286\nf[B ] f[A ];\nik i\n\u2286\nsupf[B ] supf[A ]; and\nik i\n\u2264\ninff[B ] inff[A ].\nik i\n\u2265\nSo setting\na = inff[A ] and b = inff[B ],\ni i ik ik\nwe get\nS(f, \u2032) = a mA = a mB\ni i i ik\nP\ni i k\nX XX\nb mB = S(f, ).\nik ik\n\u2264 P\ni,k\nX\nSimilarly,\nS(f, \u2032) S(f, ),\nP \u2264 P\nand\nS(f, ) S(f, )\nP \u2264 P\nis obvious from (1). (cid:3)\nCorollary 2. For any \u2032 and \u2032\u2032,\nP P\nS(f, \u2032) S(f, \u2032\u2032).\nP \u2264 P\nHence\nR f R f.\n\u2264\nZ A Z A\nProof. Let = \u2032 \u2032\u2032 (see 1). As refines both \u2032 and \u2032\u2032, Corollary 1\nP P \u2229P \u00a7 P P P\nyields\nS(f, \u2032) S(f, ) S(f, ) S(f, \u2032\u2032).\nP \u2264 P \u2264 P \u2264 P\nThus, indeed, no lower sum S(f, \u2032) exceeds any upper sum S(f, \u2032\u2032).\nP P\nHence also\nsupS(f, \u2032) infS(f, \u2032\u2032),\nP\u2032 P \u2264 P\u2032\u2032 P\ni.e.,\nR f R f,\n\u2264\nZ A Z A\nas claimed. (cid:3) 310 Chapter 8. Measurable Functions. Integration\nLemma 1. A map f: A E1 is R-integrable iff f is bounded and, moreover,\n\u2192\n(3) ( \u03b5 > 0) ( ) S(f, ) S(f, ) < \u03b5.\n\u2200 \u2203P P \u2212 P\nProof. By formulas (1) and (2),\nS(f, ) R f R f S(f, ).\nP \u2264 \u2264 \u2264 P\nZ A Z A\nHence (3) implies\nR f R f < \u03b5.\n\u2212\n(cid:12) Z A Z A (cid:12)\n(cid:12) (cid:12)\nAs \u03b5 is arbitrary, we get (cid:12) (cid:12)\n(cid:12) (cid:12)\nR f = R f;\nZ A Z A\nso f is R-integrable.\nConversely, if so, definitions (b) and (c) imply the existence of \u2032 and \u2032\u2032\nP P\nsuch that\n1\nS(f, \u2032) > R f \u03b5\nP \u2212 2\nZA\nand\n1\nS(f, \u2032\u2032) < R f + \u03b5.\nP 2\nZA\nLet refine both \u2032 and \u2032\u2032. Then by Corollary 1,\nP P P\nS(f, ) S(f, ) S(f, \u2032\u2032) S(f, \u2032)\nP \u2212 P \u2264 P \u2212 P\n1 1\n< R f + \u03b5 R f \u03b5 = \u03b5,\n2 \u2212 \u2212 2\n(cid:18) ZA (cid:19) (cid:18) ZA (cid:19)\nas required. (cid:3)\nLemma 2. Let f be -simple; say, f = a on A for some -partition \u2217 =\ni i\nC C P\nA of A (we then write\ni\n{ }\nf = a C\ni Ai\ni\nX\non A; see Note 4 of 4).\n\u00a7\nThen\n(4) R f = R f = S(f, \u2217) = S(f, \u2217) = a mA .\ni i\nP P\nZ A Z A i\nX\nHence any finite -simple function is R-integrable, with R f as in (4).\nC A\nR 9. Riemann Integration. Stieltjes Integrals 311\n\u00a7\nProof. Given any -partition = B of A, consider\nk\nC P { }\n\u2217 . = A B .\ni k\nP \u2229P { \u2229 }\nAs f = a on A B (even on all of A ),\ni i k i\n\u2229\na = inff[A B ] = supf[A B ].\ni i k i k\n\u2229 \u2229\nAlso,\nA = (A B ) (disjoint)\ni k\n\u2229\ni,k\n[\nand\n( i) A = (A B );\ni i k\n\u2200 \u2229\nk\n[\nso\nmA = m(A B )\ni i k\n\u2229\nk\nX\nand\nS(f, ) = a m(A B ) = a mA = S(f, \u2217)\ni i k i i\nP \u2229 P\ni k i\nXX X\nfor any such .\nP\nHence also\na mA = supS(f, ) = R f.\ni i\nP\nP\ni Z A\nX\nSimilarly for R f. This proves (4).\nA\nIf, further, f is finite, it is bounded (by max a ) since there are only finitely\nR | i |\nmany a ; so f is R-integrable on A, and all is proved. (cid:3)\ni\nNote 1. Thus S and S are integrals of -simple maps, and definition (b)\nC\ncan be restated:\nR f = supR g and R f = infR h,\nZ A g ZA Z A h ZA\ntaking the sup and inf over all -simple maps g,h with\nC\ng f h on A.\n\u2264 \u2264\n(Verify by properties of glb and lub!)\nTherefore, we can now develop R-integration as in 4\u20135, replacing elemen-\n\u00a7\u00a7\ntary maps by -simple maps, with S = En. In particular, Problem 5 in 5\nC \u00a7\nworks out as before.\nHence linearity (Theorem 1 of 6) follows, with the same proof. One also\n\u00a7\nobtains additivity (limited to -partitions). Moreover, the R-integrability of f\nC\nand g implies that of fg, f g, f g, and f . (See the Problems.)\n\u2228 \u2227 | | 312 Chapter 8. Measurable Functions. Integration\nTheorem 1. If f f (uniformly) on A and if the f are R-integrable on A,\ni i\n\u2192\nso also is f. Moreover,\nlim R f f = 0 and lim R f = R f.\ni i\ni\u2192\u221e | \u2212 | i\u2192\u221e\nZA ZA ZA\nProof. As all f are bounded (definition (c)), so is f, by Problem 10 of Chap-\ni\nter 4, 12.\n\u00a7\nNow, given \u03b5 > 0, fix k such that\n\u03b5\n( i k) f f < on A.\ni\n\u2200 \u2265 | \u2212 | mA\nVerify that\n( i k) ( ) S(f f , ) < \u03b5 and S(f f , ) < \u03b5;\ni i\n\u2200 \u2265 \u2200P | \u2212 P | | \u2212 P |\nfix one such f and choose a such that\ni\nP\nS(f , ) S(f , ) < \u03b5,\ni i\nP \u2212 P\nwhich one can do by Lemma 1. Then for this ,\nP\nS(f, ) S(f, ) < 3\u03b5.\nP \u2212 P\n(Why?) By Lemma 1, then, f is R-integrable on A.\nFinally,\nR f R f R f f\ni i\n\u2212 \u2264 | \u2212 |\n(cid:12) ZA ZA (cid:12) ZA\n(cid:12) (cid:12) \u03b5 \u03b5\n(cid:12) (cid:12)\nR = mA = \u03b5\n(cid:12) (cid:12)\n\u2264 mA mA\nZA\n(cid:16) (cid:17) (cid:16) (cid:17)\nfor all i k. Hence the second clause of our theorem follows, too. (cid:3)\n\u2265\nCorollary 3. If f: E1 E1 is bounded and regulated (Chapter 5, 10) on\n\u2192 \u00a7\nA = [a,b], then f is R-integrable on A.\nIn particular, this applies if f is monotone, or of bounded variation, or\nrelatively continuous, or a step function, on A.\nProof. By Lemma 2, this applies to -simple maps.\nC\nNow, let f be regulated (e.g., of the kind specified above).\nThen by Lemma 2 of Chapter 5, 10,\n\u00a7\nf = lim g (uniformly)\ni\ni\u2192\u221e\nfor finite -simple g .\ni\nC\nThus f is R-integrable on A by Theorem 1. (cid:3) 9. Riemann Integration. Stieltjes Integrals 313\n\u00a7\nII. Henceforth, we assume that m is a measure on a \u03c3-ring in En,\nM \u2287 C\nwith m < on . (For a reader who took the \u201climited approach,\u201d it is now\n\u221e C\ntime to consider 4\u20136 in full.) The measure m may, but need not, be Lebesgue\n\u00a7\u00a7\nmeasure in En.\nTheorem 2. If f: En E1 is R-integrable on A , it is also Lebesgue\n\u2192 \u2208 C\nintegrable (with respect to m as above) on A, and\nL f = R f.\nZA ZA\nProof. Given a -partition = A of A, define the -simple maps\ni\nC P { } C\ng = a C and h = b C\ni Ai i Ai\ni i\nX X\nwith\na = inff[A ] and b = supf[A ].\ni i i i\nThen g f h on A with\n\u2264 \u2264\nS(f, ) = a mA = L g\ni i\nP\nZA\ni\nX\nand\nS(f, ) = b mA = L h.\ni i\nP\nZA\ni\nX\nBy Theorem 1(c) in 5,\n\u00a7\nS(f, ) = L g L f L f L h = S(f, ).\nP \u2264 \u2264 \u2264 P\nZA Z A Z A ZA\nAs this holds for any , we get\nP\n(5) R f = supS(f, ) L f L f = infS(f, ) = R f.\nZ A P P \u2264 Z A \u2264 Z A P P Z A\nBut by assumption,\nR f = R f.\nZ A Z A\nThus these inequalities become equations:\nR f = f = f = R f.\nZA Z A Z A ZA 314 Chapter 8. Measurable Functions. Integration\nAlso, by definition (c), f is bounded on A; so f < K < on A. Hence\n| | \u221e\nf f K mA < .3\n\u2264 | | \u2264 \u00b7 \u221e\n(cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12)\nThus (cid:12) (cid:12)\n(cid:12) (cid:12)\nf = f = ,\n6 \u00b1\u221e\nZ A Z A\ni.e., f is Lebesgue integrable, and\nL f = R f,\nZA ZA\nas claimed. (cid:3)\nNote 2. The converse fails. For example, as shown in the example in 4,\n\u00a7\nf = C (R = rationals) is L-integrable on A = [0,1].\nR\nYet f is not R-integrable.\nFor -partitions involve intervals containing both rationals (on which f = 1)\nC\nand irrationals (on which f = 0). Thus for any ,\nP\nS(f, ) = 0 and S(f, ) = 1 mA = 1.\nP P \u00b7\n(Why?) So\nR f = infS(f, ) = 1,\nP\nZ A\nwhile\nR f = 0 = R f.\n6\nZ A Z A\nNote 3. By Theorem 1, any R f is also a Lebesgue integral. Thus the\nA\nrules of 5\u20136 apply to R-integrals, provided that the functions involved are\n\u00a7\u00a7 R\nR-integrable. For a deeper study, we need a few more ideas.\nDefinitions (continued).\n(d) The mesh of a -partition = A ,... ,A is the largest of the\n1 q\n|P| C P { }\ndiagonals dA :\ni\n= max dA ,dA ,... ,dA .\n1 2 q\n|P| { }\nNote 4. For any A , there is a sequence of -partitions such that\nk\n\u2208 C C P\n(i) each P refines P and\nk+1 k\n(ii) lim P = 0.\nk\u2192\u221e k\n| |\n3This also shows that an R-integral, when one exists, is always finite. 9. Riemann Integration. Stieltjes Integrals 315\n\u00a7\nTo construct such a sequence, bisect the edges of A so as to obtain 2n subinter-\nvals of diagonal 1dA (Chapter 3, 7). Repeatthis with each of the subintervals,\n2 \u00a7\nand so on. Then\ndA\nP = 0.\n| k | 2k \u2192\nLemma 3. Let f: A E1 be bounded. Let satisfy (i) of Note 4. If\nk\n\u2192 {P }\nP = Ak,... ,Ak , put\nk { 1 qk}\nqk\ng = C inff[Ak]\nk Ak i\ni\ni=1\nX\nand\nqk\nh = C supf[Ak].\nk Ak i\ni\ni=1\nX\nThen the functions\ng = supg and h = infh\nk k\nk k\nare Lebesgue integrable on A,4 and\n(6) g = lim S(f, ) R f R f lim S(f, ) = h.\nk k\nk\u2192\u221e P \u2264 \u2264 \u2264 k\u2192\u221e P\nZA Z A Z A ZA\nProof. As in Theorem 2, we obtain g f h on A with\nk k\n\u2264 \u2264\ng = S(f, )\nk k\nP\nZA\nand\nh = S(f, ).\nk k\nP\nZA\nSince refines , it also easily follows that\nk+1 k\nP P\n(7) g g supg = g f h = infh h h .\nk k+1 k k k+1 k\n\u2264 \u2264 k \u2264 \u2264 k \u2264 \u2264\n(Verify!)\nThus g and h , and so\nk k\n{ }\u2191 { }\u2193\ng = supg = lim g and h = infh = lim h .\nk k k k\nk k\u2192\u221e k k\u2192\u221e\nAlso, as f is bounded,\n( K E1) f < K on A.\n\u2203 \u2208 | |\n4Integrability is with respect to the measure m mentioned above. 316 Chapter 8. Measurable Functions. Integration\nThe definition of g and h then implies\nk k\n( k) g K and h K (why?),\nk k\n\u2200 | | \u2264 | | \u2264\nwith\n(K) = K mA < .\n\u00b7 \u221e\nZA\nThe g and h are measurable (even simple) on A, with g g and h h.\nk k k k\n\u2192 \u2192\nThus by Theorem 5 and Note 1, both from 6, g and h are Lebesgue inte-\n\u00a7\ngrable,5 with\ng = lim g and h = lim h .\nk k\nk\u2192\u221e k\u2192\u221e\nZA ZA ZA ZA\nAs\ng = S(f, ) R f\nk k\nP \u2264\nZA Z A\nand\nh = S(f, ) R f,\nk k\nP \u2265\nZA Z A\npassage to the limit in equalities yields (6). Thus the lemma is proved. (cid:3)\nLemma 4. With all as in Lemma 3, let B be the union of the boundaries of\nall intervals from all . Let 0. Then we have the following.\nk k\nP |P | \u2192\n(i) If f is continuous at p A, then h(p) = g(p).\n\u2208\n(ii) The converse holds if p A B.\n\u2208 \u2212\nProof. For each k, p is in one of the intervals in ; call it A .\nk kp\nP\nIf p A B, p is an interior point of A ; so there is a globe\nkp\n\u2208 \u2212\nG (\u03b4 ) A .\np k kp\n\u2286\nAlso, by the definition of g and h ,\nk k\ng (p) = inff[A ] and h = supf[A ].\nk kp k kp\n(Why?)\nNow fix \u03b5 > 0. If g(p) = h(p), then\n0 = h(p) g(p) = lim [h (p) g (p)];\nk k\n\u2212 k\u2192\u221e \u2212\nso\n( k) h (p) g (p) = supf[A ] inff[A ] < \u03b5.\nk k kp kp\n\u2203 | \u2212 | \u2212\nAs G (\u03b4 ) A , we get\np k kp\n\u2286\n( x G (\u03b4 )) f(x) f(p) supf[A ] inff[A ] < \u03b5,\np k kp kp\n\u2200 \u2208 | \u2212 | \u2264 \u2212\n5Integrability is with respect to the measure m mentioned above. 9. Riemann Integration. Stieltjes Integrals 317\n\u00a7\nproving continuity (clause (ii)).\nFor (i), given \u03b5 > 0, choose \u03b4 > 0 so that\n( x,y A G (\u03b4)) f(x) f(y) < \u03b5.\np\n\u2200 \u2208 \u2229 | \u2212 |\nBecause\n( \u03b4 > 0) ( k ) ( k > k ) < \u03b4\n0 0 k\n\u2200 \u2203 \u2200 |P |\nfor k > k , A G (\u03b4). Deduce that\n0 kp p\n\u2286\n( k > k ) h (p) g (p) \u03b5. (cid:3)\n0 k k\n\u2200 | \u2212 | \u2264\nNote 5. The Lebesgue measure of B in Lemma 4 is zero; for B consists of\ncountably many \u201cfaces\u201d (degenerate intervals), each of measure zero.\nTheorem 3. A map f: A E1 is R-integrable on A (with m = Lebesgue\n\u2192\nmeasure) iff f is bounded on A and continuous on A Q for some Q with\n\u2212\nmQ = 0.\nNote that relative continuity on A Q is not enough\u2014take f = C of\nR\n\u2212\nNote 2.\nProof. If these conditions hold, choose as in Lemma 4.\nk\n{P }\nThen by the assumed continuity, g = h on A Q, mQ = 0.\n\u2212\nThus\ng = h\nZA ZA\n(Corollary 2 in 5).\n\u00a7\nHence by formula (6), f is R-integrable on A.\nConversely, if so, use Lemma 1 with\n1 1\n\u03b5 = 1, ,... , ,...\n2 k\nto get for each k some such that\nk\nP\n1\nS(f, ) S(f, ) < 0.\nk k\nP \u2212 P k \u2192\nBy Corollary 1, this will still hold if we refine each , step by step, so as to\nk\nP\nachieve properties (i) and (ii) of Note 4 as well. Then Lemmas 3 and 4 apply.\nAs\nS(f, ) S(f, ) 0,\nk k\nP \u2212 P \u2192\nformula (6) shows that\ng = lim S(f, ) = lim S(f, ) = h.\nk k\nk\u2192\u221e P k\u2192\u221e P\nZA ZA 318 Chapter 8. Measurable Functions. Integration\nAs h and g are integrable on A,\n(h g) = h g = 0.\n\u2212 \u2212\nZA ZA ZA\nAlso h g 0; so by Theorem 1(h) in 5, h = g on A Q\u2032, mQ\u2032 = 0 (under\n\u2212 \u2265 \u00a7 \u2212\nLebesgue measure). Hence by Lemma 4, f is continuous on\nA Q\u2032 B,\n\u2212 \u2212\nwith mB = 0 (Note 5).\nLet Q = Q\u2032 B. Then mQ = 0 and\n\u222a\nA Q = A Q\u2032 B;\n\u2212 \u2212 \u2212\nso f is continuous on A Q. This completes the proof. (cid:3)\n\u2212\nNote 6. The first part of the proof does not involve B and thus works even\nif m is not the Lebesgue measure. The second part requires that mB = 0.\nTheorem 3 shows that R-integrals are limited to a.e. continuous functions\nand hence are less flexible than L-integrals: Fewer functions are R-integrable,\nand convergence theorems ( 6, Theorems 4 and 5) fail unless R f exists.\n\u00a7 A\nn s s R\nIII. Functions f: E \u2192 E (C ). For such functions, R-integrals are defined\ncomponentwise (see 7). Thus f = (f ,... ,f ) is R-integrable on A iff all f\n1 s k\n\u00a7\n(k s) are, and then\n\u2264\ns\nR f = e\u00af R f .\nk k\nZA ZA\nk=1\nX\nA complex function f is R-integrable iff f and f are, and then\nre im\nR f = R f +iR f .\nre im\nZA ZA ZA\nVia components, Theorems 1 to 3, Corollaries 3 and 4, additivity, linearity,\netc., apply.\nIV. Stieltjes Integrals. Riemann used Lebesgue premeasure v only. But as we\nsaw, his method admits other premeasures, too.\nThus in E1, we may let m be the LS premeasure s or the LS measure m ,\n\u03b1 \u03b1\nwhere \u03b1 (Chapter 7, 5, Example (b), and Chapter 7, 9).\n\u2191 \u00a7 \u00a7\nThen\nR f dm\nZA\nis called the Riemann\u2013Stieltjes (RS) integral of f with respect to \u03b1, also written\nb\nR f d\u03b1 or R f(x)d\u03b1(x)\nZA Za 9. Riemann Integration. Stieltjes Integrals 319\n\u00a7\n(the latter if A = [a,b]); f and \u03b1 are called the integrand and integrator,\nrespectively.\nIf \u03b1(x) = x, m becomes the Lebesgue measure, and\n\u03b1\nR f(x)d\u03b1(x)\nZ\nturns into\nR f(x)dx.\nZ\nOur theory still remains valid; only Theorem 3 now reads as follows.\nCorollary 4. If f is bounded and a.e. continuous on A = [a,b] (under an\nLS measure m ) then\n\u03b1\nb\nR fd\u03b1\nZa\nexists. The converse holds if \u03b1 is continuous on A.\nFor by Notes 5 and 6, the \u201conly if\u201d in Theorem 3 holds if m B = 0. Here\n\u03b1\nB consists of countably many endpoints of partition subintervals. But (see\nChapter 7, 9) m p = 0 if \u03b1 is continuous at p. Thus the later implies\n\u03b1\n\u00a7 { }\nm B = 0.\n\u03b1\nRS-integrationhasbeenusedinmanyfields(e.g.,probabilitytheory, physics,\netc.), but it is superseded by LS-integration, i.e., Lebesgue integration with\nrespect to m , which is fully covered by the general theory of 1\u20138.\n\u03b1\n\u00a7\u00a7\nActually, Stieltjes himself used somewhat different definitions (see Prob-\nlems 10\u201313), which amount to applying the set function \u03c3 of Problem 9 in\n\u03b1\nChapter 7, 4, instead of s or m . We reserve the name \u201cStieltjes integrals,\u201d\n\u03b1 \u03b1\n\u00a7\ndenoted\nb\nS f d\u03b1,\nZa\nfor such integrals, and \u201cRS-integrals\u201d for those based on m or s (this termi-\n\u03b1 \u03b1\nnology is not standard).\nObserve that \u03c3 need not be 0. Thus for the first time, we encounter\n\u03b1\n\u2265\nintegration with respect to sign-changing set functions. A much more general\ntheory is presented in 10 (see Problem 10 there).\n\u00a7\nProblems on Riemann and Stieltjes Integrals\n1. Replacing \u201c \u201d by \u201c ,\u201d and \u201celementary and integrable\u201d or \u201celemen-\nM C\ntary and nonnegative\u201d by \u201c -simple,\u201d prove Corollary 1(ii)(iv)(vii) and\nC\nTheorems 1(i) and 2(ii), all in 4, and do Problem 5\u20137 in 4, for R-\n\u00a7 \u00a7\nintegrals.\n2. Verify Note 1. 320 Chapter 8. Measurable Functions. Integration\n\u2032\n2 . Do Problems 5\u20137 in 5 for R-integrals.\n\u00a7\n3. Do the following for R-integrals.\n(i) Prove Theorems 1(a)\u2013(g) and 2, both in 5 ( -partitions only).\n\u00a7 C\n(ii) Prove Theorem 1 and Corollaries 1 and 2, all in 6.\n\u00a7\n(iii) Show that definition (b) can be replaced by formulas analogous to\nformulas (1\u2032), (1\u2032\u2032), and (1) of Definition 1 in 5.\n\u00a7\n[Hint: Use Problems 1 and 2 .]\n\u2032\n4. Fill in all details in the proof of Theorem 1, Lemmas 3 and 4, and\nCorollary 4.\n5. For f,g: En Es(Cs), via components, prove the following.\n\u2192\n(i) Theorems 1\u20133 and\n(ii) additivity and linearity of R-integrals.\nDo also Problem 13 in 7 for R-integrals.\n\u00a7\n6. Prove that if f: A Es(Cs) is bounded and a.e. continuous on A, then\n\u2192\nR f R f .\n| | \u2265\nZA (cid:12) ZA (cid:12)\n(cid:12) (cid:12)\nFor m = Lebesgue measure, do it ass(cid:12)uming (cid:12)R-integrability only.\n(cid:12) (cid:12)\n7. Prove that if f,g: A E1 are R-integrable, then\n\u2192\n(i) so is f2, and\n(ii) so is fg.\n[Hints: (i) Use Lemma 1. Let h= f K < on A. Verify that\n| |\u2264 \u221e\n(infh[Ai])2 =inff2[Ai] and (suph[Ai])2 =supf2[Ai];\nso\nsupf2[Ai] inff2[Ai]=(suph[Ai]+infh[Ai])(suph[Ai] infh[Ai])\n\u2212 \u2212\n(suph[Ai] infh[Ai])2K.\n\u2264 \u2212\n(ii) Use\n1\nfg = [(f +g)2 (f g)2].\n4 \u2212 \u2212\n(iii) For m= Lebesgue measure, do it using Theorem 3.]\n8. Prove that if m = the volume function v (or LS function s for a contin-\n\u03b1\nuous \u03b1), then in formulas (1) and (2), one may replace A by A (closure\ni i\nof A ).\ni\n[Hint: Show that here mA=mA,\nR f =R f,\nZA ZA\nand additivity works even if the Ai have some common \u201cfaces\u201d (only their interiors\nbeing disjoint).] 9. Riemann Integration. Stieltjes Integrals 321\n\u00a7\n9. (Riemann sums.) Instead of S and S, Riemann used sums\nS(f, ) = f(x )dmA ,\ni i\nP\ni\nX\nwhere m = v (see Problem 8) and x is arbitrarily chosen from A .\ni i\nFor a bounded f, prove that\nr = R f dm\nZA\nexists on A = [a,b] iff for every \u03b5 > 0, there is such that\n\u03b5\nP\nS(f, ) r < \u03b5\n| P \u2212 |\nfor every refinement\n= A\ni\nP { }\nof and any choice of x A .\n\u03b5 i i\nP \u2208\n[Hint: Show that by Problem 8, this is equivalent to formula (3).]\n10. Replacing m by the \u03c3 of Problem 9 of Chapter 7, 4, write S(f, ,\u03b1)\n\u03b1\n\u00a7 P\nfor S(f, ) in Problem 9, treating Problem 9 as a definition of the\nP\nStieltjes integral,\nb b\nS f d\u03b1 or S f d\u03c3 .\n\u03b1\nZa (cid:18) Za (cid:19)\nHere f,\u03b1: E1 E1 (monotone or not; even f,\u03b1: E1 C will do).\n\u2192 \u2192\nProve that if \u03b1: E1 E1 is continuous and \u03b1 , then\n\u2192 \u2191\nb b\nS f d\u03b1 = R f d\u03b1,\nZa Za\nthe RS-integral.\n11. (Integration by parts.) Continuing Problem 10, prove that\nb\nS f d\u03b1\nZa\nexists iff\nb\nS \u03b1df\nZa\ndoes, and then\nb b\nS f d\u03b1+S \u03b1df = K,\nZa Za\nwhere\nK = f(b)\u03b1(b) f(a)\u03b1(a).\n\u2212 322 Chapter 8. Measurable Functions. Integration\n[Hints: Take any -partition = Ai of [a,b], with\nC P { }\nAi =[yi 1,yi],\n\u2212\nsay. For any xi Ai, verify that\n\u2208\nS(f, ,\u03b1)= f(xi)[\u03b1(yi) \u03b1(yi 1)]= f(xi)\u03b1(yi) f(xi)\u03b1(yi 1)\nP \u2212 \u2212 \u2212 \u2212\nX X X\nand\nK = f(xi)\u03b1(yi) f(xi 1)\u03b1(yi 1).\n\u2212 \u2212 \u2212\nX X\nDeduce that\nK S(f, ,\u03b1)=S(\u03b1, \u2032,f)= \u03b1(xi)[f(xi) f(yi)] \u03b1(xi 1)[f(yi) f(xi 1)];\n\u2212 P P \u2212 \u2212 \u2212 \u2212 \u2212\nX X\nhere results by combining the partition points xi and yi, so it refines .\n\u2032\nP P\nb\nNow, if S a \u03b1df exists, fix P\u03b5 as in Problem 9 and show that\nR b\nK S(f, ,\u03b1) S \u03b1df <\u03b5\n\u2212 P \u2212\n(cid:12) Za (cid:12)\n(cid:12) (cid:12)\nwhenever refines \u03b5.] (cid:12) (cid:12)\n(cid:12) (cid:12)\nP P\n12. If \u03b1: E1 E1 is of class CD1 on [a,b] and if\n\u2192\nb\nS f d\u03b1\nZa\nexists (see Problem 10), it equals\nb\nR f(x)\u03b1\u2032(x)dx.\nZa\n[Hints: Set \u03c6=f\u03b1 \u2032, = Ai , Ai =[ai 1,ai]. Then\nP { } \u2212\nS(\u03c6, )= f(xi)\u03b1\u2032(xi)(ai ai 1), xi Ai,\nP \u2212 \u2212 \u2208\nX\nand (Corollary 3 in Chapter 5, 2)\n\u00a7\nS(f, ,\u03b1)= f(xi)[\u03b1(ai) \u03b1(ai 1)]= f(xi)\u03b1\u2032(qi), qi Ai.\nP \u2212 \u2212 \u2208\nX X\nAs f is bounded and \u03b1 is uniformly continuous on [a,b] (why?), deduce that\n\u2032\n( \u03b5>0) ( \u03b5) ( refining \u03b5)\n\u2200 \u2203P \u2200P P\n1 b 1\nS(\u03c6, ) S(f, ,\u03b1) < \u03b5 and S(f, ,\u03b1) S fd\u03b1 < \u03b5.\n| P \u2212 P | 2 P \u2212 2\n(cid:12) Za (cid:12)\n(cid:12) (cid:12)\nProceed. Use Problem 9.] (cid:12) (cid:12)\n(cid:12) (cid:12)\n13. (Laws of the mean.) Let f,g,\u03b1: E1 E1; p f q on A = [a,b];\n\u2192 \u2264 \u2264\np,q E1. Prove the following.\n\u2208\n(i) If \u03b1 and if\n\u2191\nb\nS f d\u03b1\nZa 9. Riemann Integration. Stieltjes Integrals 323\n\u00a7\nexists, then ( c [p,q]) such that\n\u2203 \u2208\nb\nS f d\u03b1 = c[\u03b1(b) \u03b1(a)].\n\u2212\nZa\nSimilarly, if\nb\nR f d\u03b1\nZa\nexists, then ( c [p,q]) such that\n\u2203 \u2208\nb\nR f d\u03b1 = c[\u03b1(b+) \u03b1(a )].\n\u2212 \u2212\nZa\n(i\u2032) If f also has the Darboux property on A, then c = f(x ) for some\n0\nx A.\n0\n\u2208\n(ii) If \u03b1 is continuous, and f on A, then\n\u2191\nb b\nS f d\u03b1 = [f(b)\u03b1(b) f(a)\u03b1(a)] S \u03b1df\n\u2212 \u2212\nZa Za\nexists, and ( z A) such that\n\u2203 \u2208\nb z b\nS f d\u03b1 = f(a)S d\u03b1+f(b)S d\u03b1\nZa Za Zz\n= f(a)[\u03b1(z) \u03b1(a)]+f(b)[\u03b1(b) \u03b1(z)].\n\u2212 \u2212\n(ii\u2032) If g is continuous and f on A, then ( z A) such that\n\u2191 \u2203 \u2208\nb z b\nR f(x)g(x)dx = p R g(x)dx+q R g(x)dx.\n\u00b7 \u00b7\nZa Za Zz\nIf f , replace f by f. (See also Corollary 5 in Chapter 9, 1.)\n\u2193 \u2212 \u00a7\n[Hints: (i) As \u03b1 , we get\n\u2191\nb\np[\u03b1(b) \u03b1(a)] S fd\u03b1 q[\u03b1(b) \u03b1(a)].\n\u2212 \u2264 \u2264 \u2212\nZa\n(Why?) Now argue as in 6, Theorem 3 and Problem 2.\n\u00a7\n(ii) Use Problem 11, and apply (i) to \u03b1df.\n(ii ) By Theorem 2 of Chapter 5, 10, g has a primitive \u03b2 CD1. Apply Prob-\n\u2032 \u00a7 R \u2208\nb\nlem 12 to S fd\u03b2.]\na\nR\n\u00a710. Integration in Generalized Measure Spaces\nLet (S, ,s) be a generalized measure space. By Note 1 in 3, a map f is\nM \u00a7\ns-measurable iff it is v -measurable. This naturally leads us to the following\ns 324 Chapter 8. Measurable Functions. Integration\ndefinition.\nDefinition 1.\nA map f: S E is s-integrable on a set A iff it is v -integrable on A.\ns\n\u2192\n(Recall that v , the total variation of s, is a measure.)\ns\nNote 1. Here the range spaces of f and s are assumed complete and such\nthat f(x)sA is defined for x S and A . Thus if s is vector valued, f\n\u2208 \u2208 M\nmust be scalar valued, and vice versa. Later, if a factor p occurs, it must be\nsuch that pf(x)sA is defined, i.e., at least two of p, f(x), and sA are scalars.\nNote 2. Ifsisameasure ( 0), thenv = s+ = s(Corollary 3inChapter7,\ns\n\u2265\n11); so our present definition agrees with the previous ones (as in Theorem 1\n\u00a7\nof 7).\n\u00a7\nLemma 1. If m\u2032 and m\u2032\u2032 are measures, with m\u2032 m\u2032\u2032 on , then\n\u2265 M\nf dm\u2032 f dm\u2032\u2032\n| | \u2265 | |\nZA ZA\nfor all A and any f: S E.\n\u2208 M \u2192\nProof. First, take any elementary and nonnegative map g f ,\n\u2265 | |\ng = C a on A.\nAi i\ni\nX\nThen ( 4)\n\u00a7\ngdm\u2032 = a m\u2032A a m\u2032\u2032A = gdm\u2032\u2032.\ni i i i\n\u2265\nZA ZA\nX X\nHence by Definition 1 in 5,\n\u00a7\nf dm\u2032 = inf gdm\u2032 inf gdm\u2032\u2032 = f dm\u2032\u2032,\nZA| | g\u2265|f| ZA \u2265 g\u2265|f| ZA ZA| |\nas claimed. (cid:3)\nLemma 2.\n(i) If s: En(Cn) with s = (s ,... ,s ), and if f is s-integrable on\n1 n\nM \u2192\nA , then f is s -integrable on A for k = 1,2,... ,n.\nk\n\u2208 M\n(ii) If s is a signed measure and f is s-integrable on A, then f is integrable\non A with respect to both s+ and s\u2212 (with s+ and s\u2212 as in formula (3)\nin Chapter 7, 11).\n\u00a7\nNote 3. The converse statements hold if f is -measurable on A.\nM\nProof.\n(i) If s = (s ,... ,s ), then (Problem 4 of Chapter 7, 11)\n1 n\n\u00a7\nv v , k = 1,... ,n.\ns sk\n\u2265 10. Integration in Generalized Measure Spaces 325\n\u00a7\nHence by Definition 1 and Lemma 1, the s-integrability of f implies\n> f dv f dv .\ns sk\n\u221e | | \u2265 | |\nZA ZA\nAlso, f is v -measurable, i.e., -measurable on A Q, with\ns\nM \u2212\n0 = v Q v Q 0.\ns sk\n\u2265 \u2265\nThus f is s -integrable on A, k = 1,... ,n, as claimed.\nk\n(ii) If s = s+ s\u2212, then by Theorem 4 in Chapter 7, 11, and Corollary 3\n\u2212 \u00a7\nthere, s+ and s\u2212 are measures ( 0) and v = s+ +s\u2212, so that both\ns\n\u2265\nv s+ = v and v s\u2212 = v s\u2212.\ns s+ s\n\u2265 \u2265\nThus the desired result follows exactly as in part (i) of the proof. (cid:3)\nWe leave Note 3 as an exercise.\nDefinition 2.\nIf f is s-integrable on A , we set\n\u2208 M\n(i) in the case s: E\u2217,\nM \u2192\nf ds = f ds+ f ds\u2212,\n\u2212\nZA ZA ZA\nwith s+ and s\u2212 as in formula (3) of Chapter 7, 11;1\n\u00a7\n(ii) in the case s: En(Cn),\nM \u2192\nn\nf ds = ~e f ds ,\nk k\nZA ZA\nk=1\nX\nwith ~e as in Theorem 2 of Chapter 3, 1\u20133;\nk\n\u00a7\u00a7\n(iii) if s: C,\nM \u2192\nf ds = f ds +i f ds .\nre im\n\u00b7\nZA ZA ZA\n(See also Problems 2 and 3.)\nNote 4. If s is a measure, then\ns = s+ = s = s\nre 1\nand\n0 = s\u2212 = s = s ;\nim 2\n1By choosing s+ and s as in formula (3) of Chapter 7, 11, we avoid ambiguity.\n\u2212\n\u00a7 326 Chapter 8. Measurable Functions. Integration\nso Definition 2 agrees with our previous definitions. Similarly for s:\nM \u2192\nEn(Cn).\nBelow, s, t, and u are generalized measures on as in Definition 2, while\nM\nf,g: S E are functions, with E a complete normed space, as in Note 1.\n\u2192\nTheorem 1. The linearity, additivity, and \u03c3-additivity properties (as in 7,\n\u00a7\nTheorems 2 and 3) also apply to integrals\nf ds,\nZA\nwith s as in Definition 2.\nProof. (i) Linearity: Let f,g: S E be s-integrable on A . Let p,q be\n\u2192 \u2208 M\nsuitable constants (see Note 1).\nIf s is a signed measure, then by Lemma 2(ii) and Definitions 1 and 2, f is\nintegrable with respect to v , s+, and s\u2212. As these are measures, Theorem 2\ns\nin 7 shows that pf +qg is integrable with respect to v , s+, and s\u2212, and by\ns\n\u00a7\nDefinition 2,\n(pf +qg)ds = (pf +qg)ds+ (pf +qg)ds\u2212\n\u2212\nZA ZA ZA\n= p f ds+ +q gds+ p f ds\u2212 q gds\u2212\n\u2212 \u2212\nZA ZA ZA ZA\n= p f ds+q gds.\nZA ZA\nThus linearity holds for signed measures. Via components, it now follows\nfor s: En(Cn) as well. Verify!\nM \u2192\n(ii) Additivity and \u03c3-additivity follow in a similar manner. (cid:3)\nCorollary 1. Assume f is s-integrable on A, with s as in Definition 2.\n(i) If f is constant (f = c) on A, we have\nf ds = c sA.\n\u00b7\nZA\n(ii) If\nf = a C\ni Ai\ni\nX\nfor an -partition A of A, then\ni\nM { }\nf ds = a sA and f ds = a sA\ni i i i\n| | | |\nZA ZA\ni i\nX X\n(both series absolutely convergent). 10. Integration in Generalized Measure Spaces 327\n\u00a7\n(iii) f < a.e. on A.2\n| | \u221e\n(iv) f dv = 0 iff f = 0 a.e. on A.\nA| | s\n(v) TRhe set A(f = 0) is (v s) \u03c3-finite (Definition 4 in Chapter 7, 5).\n6 \u00a7\n(vi) f ds = f ds if v Q = 0 or f = 0 on Q (Q ).\nA A\u2212Q s \u2208 M\n(vii) fR is s-inteRgrable on any -set B A.\nM \u2286\nProof.\n(i) If s = s+ s\u2212 is a signed measure, we have by Definition 2 that\n\u2212\nf ds = f ds+ f ds\u2212 = c(s+A s\u2212A) = c sA,\n\u2212 \u2212 \u00b7\nZA ZA ZA\nas required.\nFor s: En(Cn), the result now follows via components. (Verify!)\nM \u2192\n(ii) As f = a on A , clause (i) yields\ni i\nf ds = a sA , i = 1,2,... .\ni i\nZAi\nHence by \u03c3-additivity,\nf ds = f ds = a sA ,\ni i\nZA ZAi\ni i\nX X\nas claimed.\nClauses (iii), (iv), and (v) follow by Corollary 1 in 5 and Theorem 1(b)(h)\n\u00a7\nthere, as v is a measure; (vi) is proved as 5, Corollary 2. We leave (vii) as an\ns\n\u00a7\nexercise. (cid:3)\nTheorem 2 (dominated convergence). If\nf = lim f (pointwise)\ni\ni\u2192\u221e\non A Q (v Q = 0) and if each f is s-integrable on A, so is f, and\ns i\n\u2212\nf ds = lim f ds,\ni\ni\u2192\u221e\nZA ZA\nall provided that\n( i) f g\ni\n\u2200 | | \u2264\nfor some map g with gdv < .\nA s \u221e\nProof. If s is a meaRsure, this follows by Theorem 5 in 6. Thus as v is a\ns\n\u00a7\nmeasure, f is v -integrable (hence s-integrable) on A, as asserted.\ns\n2That is, on A Q, vsQ=0.\n\u2212 328 Chapter 8. Measurable Functions. Integration\nNext, if s = s+ s\u2212 is a signed measure, Lemma 2 shows that f and the f\ni\n\u2212\nare s+ and s\u2212-integrable as well, with\nf ds+ f dv gdv < ;\ni i s s\n| | \u2264 | | \u2264 \u221e\nZA ZA ZA\nsimilarly for\nf ds\u2212.\ni\n| |\nZA\nAs s+ and s\u2212 are measures, Theorem 5 of 6 yields\n\u00a7\nf ds = f ds+ f ds\u2212 = lim f ds+ f ds\u2212 = lim f ds.\ni i i\n\u2212 \u2212\nZA ZA ZA (cid:18)ZA ZA (cid:19) ZA\nThus all is proved for signed measures.\nIn the case s: En(Cn), the result now easily follows by Defini-\nM \u2192\ntion 2(ii)(iii) via components. (cid:3)\nTheorem 3 (uniform convergence). If f f (uniformly) on A Q (v A <\ni s\n\u2192 \u2212\n, v Q = 0), and if each f is s-integrable on A, so is f, and\ns i\n\u221e\nf ds = lim f ds.\ni\ni\u2192\u221e\nZA ZA\nProof. Argue as in Theorem 2, replacing 6, Theorem 5, by 7, Lemma 1. (cid:3)\n\u00a7 \u00a7\nOur next theorem shows that integrals behave linearly with respect to mea-\nsures.\nTheorem 4. Let t,u: E\u2217(En, Cn), with v < on ,3 and let\nt\nM \u2192 \u221e M\ns = pt+qu\nfor finite constants p and q. Then the following statements are true.\n(a) If t and u are generalized measures, so is s.\n(b) If, further, f is -measurable on a set A and is both t- and u-integrable\nM\non A, it is also s-integrable on A, and\nf ds = p f dt+q f du.\nZA ZA ZA\nProof. We consider only assertion (b) for s = t+u; the rest is easy.\nFirst, let f be -elementary on A. By Corollary 1(ii), we set\nM\nf dt = a tA and f du = a uA .\ni i i i\nZA ZA\ni i\nX X\n3Or t < ; see Theorem 6 in Chapter 7, 11. The restriction is redundant if t:\n| | \u221e \u00a7 M \u2192\nEn(Cn). 10. Integration in Generalized Measure Spaces 329\n\u00a7\nAlso, by integrability,\n> f dv = a v A and > f dv = a v A .\nt i t i u i u i\n\u221e | | | | \u221e | | | |\nZA ZA\ni\nX X\nNow, by Problem 4 in Chapter 7, 11,\n\u00a7\nv = v v +v ;\ns t+u t u\n\u2264\nso\nf dv = a v A\ns i s i\n| | | |\nZA\ni\nX\na (v A +v A ) = f dv + f dv < .\ni t i u i t u\n\u2264 | | | | | | \u221e\nZA ZA\ni\nX\nAs f is also -measurable (even elementary), it is s-integrable on A (by Def-\nM\ninition 1), and\nf ds = a sA = a (tA +uA ) = f dt+ f du,\ni i i i i\nZA ZA ZA\ni i\nX X\nas claimed.\nNext, suppose f is -measurable on A and v A < . By assumption,\nu\nM \u221e\nv A < , too; so\nt\n\u221e\nv A v A+v A < .\ns t u\n\u2264 \u221e\nNow, by Theorem 3 in 1,\n\u00a7\nf = lim f (uniformly)\ni\ni\u2192\u221e\nfor some -elementary maps f on A. By Lemma 2 in 7, for large i, the f\ni i\nM \u00a7\nare integrable with respect to both v and v on A. By what was shown above,\nt u\nthey are also s-integrable, with\nf ds = f dt+ f du.\ni i i\nZA ZA ZA\nWith i , Theorem 3 yields the result.\n\u2192 \u221e\nFinally, let v A = . By Corollary 1(v), we may assume (as in Lemma 3\nu\n\u221e\nof 7) that A A, with v A < , and v A < (since v < , by\ni u i t i t\n\u00a7 \u0580 \u221e \u221e \u221e\nassumption). Set\nf = f C f (pointwise)\ni Ai\n\u2192\non A, with f f . (Why?)\ni\n| | \u2264 | |\nAs f = f on A and f = 0 on A A , all f are both t- and u-integrable on\ni i i i i\n\u2212\nA (for f is). Since v A < and v A < , the f are also s-integrable (as\nt i u i i\n\u221e \u221e 330 Chapter 8. Measurable Functions. Integration\nshown above), with\nf ds = f ds = f dt+ f du = f dt+ f du.\ni i i i i i\nZA ZAi ZAi ZAi ZA ZA\nWith i , Theorem 2 now yields the result.\n\u2192 \u221e\nTo complete the proof of (b), it suffices to consider, along similar lines, the\ncase s = pt (or s = qu). We leave this to the reader.\nFor (a), see Chapter 7, 11. (cid:3)\n\u00a7\nTheorem 5. If f is s-integrable on A, so is f , and\n| |\nf ds f dv .\ns\n\u2264 | |\n(cid:12)ZA (cid:12) ZA\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nProof. By Definition 1, and(cid:12)Theore(cid:12)m 1 of 1, f and f are -measurable on\n\u00a7 | | M\nA Q, v Q = 0, and\ns\n\u2212\nf dv < ;\ns\n| | \u221e\nZA\nso f is s-integrable on A.\n| |\nThe desired inequality is immediate by Corollary 1(ii) if f is elementary.\nNext, exactly as in Theorem 4, one obtains it for the case v A < , and\ns\n\u221e\nthen for v A = . We omit the details. (cid:3)\ns\n\u221e\nDefinition 3.\nWe write\n\u201cds = gdt in A\u201d\nor\n\u201cs = gdt in A\u201d\nZ\niff g is t-integrable on A, and\nsX = gdt\nZX\nfor A X, X .\n\u2287 \u2208 M\nWe then call s the indefinite integral of g in A. ( gdt may be\nX\ninterpreted as in Problems 2\u20134 below.)\nR\nLemma 3. If A and\n\u2208 M\nds = gdt in A,\nthen\ndv = g dv in A.\ns t\n| | 10. Integration in Generalized Measure Spaces 331\n\u00a7\nProof. By assumption, g and g are v -integrable on X, and\nt\n| |\nsX = gdt\nZX\nfor A X, X . We must show that\n\u2287 \u2208 M\nv X = g dv\ns t\n| |\nZX\nfor such X.\nThis is easy if g = c (constant) on X. For by definition,\nv X = sup sX ,\ns i\n| |\nP\ni\nX\nover all -partitions = X of X. As\ni\nM P { }\nsX = gdt = c tX ,\ni i\n\u00b7\nZXi\nwe have\nv X = sup c tX = c sup tX = c v X;\ns i i t\n| || | | | | | | |\nP P\ni i\nX X\nso\nv X = g dv .\ns t\n| |\nZX\nThus all is proved for constant g.\nHence by \u03c3-additivity, the lemma holds for -elementary maps g. (Why?)\nM\nIn the general case, g is t-integrable on X, hence -measurable and finite\nM\non X Q, v Q = 0. By Corollary 1(iii), we may assume g finite and measurable\nt\n\u2212\non X; so\ng = lim g (uniformly)\nk\nk\u2192\u221e\non X for some -elementary maps g , all integrable on X, with respect to v\nk t\nM\n(and t).\nLet\ns = g dt\nk k\nZ\nin X. By what we just proved for elementary and integrable maps,\nv X = g dv , k = 1,2,... .\nsk k t\n| |\nZX\nNow, if v X < , Theorem 3 yields\nt\n\u221e\ng dv = lim g dv = lim v X = v X\nt k t sk s\n| | k\u2192\u221e | | k\u2192\u221e\nZX ZX 332 Chapter 8. Measurable Functions. Integration\n(see Problem 6). Thus all is proved if v X < .\nt\n\u221e\nIf, however, v X = , argue as in Theorem 4 (the last step), using the left\nt\n\u221e\ncontinuity of v and of\ns\ng dv .\nt\n| |\nZ\nVerify! (cid:3)\nTheorem 6 (change of measure). If f is s-integrable on A , with\n\u2208 M\nds = gdt in A,\nthen (subject to Note 1) fg is t-integrable on A and\nf ds = fgdt.\nZA ZA\n(Note the formal substitution of \u201cgdt\u201d for \u201cds.\u201d)\nProof. The proof is easy if f is constant or elementary on A (use Corol-\nlary 1(ii)). We leave this case to the reader, and next we assume g is bounded\nand v A < .\nt\n\u221e\nBy s-integrability, f is -measurable and finite on A Q, with\nM \u2212\n0 = v Q = g dv\ns t\n| |\nZQ\nby Lemma 3. Hence 0 = g = fg on Q Z, v Z = 0. Therefore,\nt\n\u2212\nfgdt = 0 = f ds\nZQ ZQ\nfor v Q = 0. Thus we may neglect Q and assume that f is finite and -\ns\nM\nmeasurable on A.\nAs ds = gdt, Definition 3 and Lemma 3 yield\nv A = g dv < .\ns t\n| | \u221e\nZA\nAlso (Theorem 3 in Chapter 8, 1),\n\u00a7\nf = lim f (uniformly)\nk\nk\u2192\u221e\nfor elementary maps f , all v -integrable on A (Lemma 2 in 7). As g is\nk s\n\u00a7\nbounded, we get on A\nfg = lim f g (uniformly).\nk\nk\u2192\u221e 10. Integration in Generalized Measure Spaces 333\n\u00a7\nMoreover, as the theorem holds for elementary and integrable maps, f g is\nk\nt-integrable on A, and\nf ds = f gdt, k = 1,2,....\nk k\nZA ZA\nSince v A < and v A < , Theorem 3 shows that fg is t-integrable on\ns t\n\u221e \u221e\nA, and\nf ds = lim f ds = lim f gdt = fgdt.\nk k\nk\u2192\u221e k\u2192\u221e\nZA ZA ZA ZA\nThus all is proved if v A < and g is bounded on A.\nt\n\u221e\nIn the general case, we again drop a null set to make f and g finite and\n-measurable on A. By Corollary 1(v), we may again assume A A, with\ni\nM \u0580\nv A < ( i).\nt i\n\u221e \u2200\nNow for i = 1,2,... set\ng on A ( g i),\ni\ng = | | \u2264\ni\n0 elsewhere.\n(cid:26)\nThen each g is bounded,\ni\ng g (pointwise),\ni\n\u2192\nand\ng g\ni\n| | \u2264 | |\non A. We also set f = f C ; so f f (pointwise) and f f on A. Then\ni Ai i i\n\u2192 | | \u2264 | |\nf ds = f ds = f g dt = f g dt.\ni i i i i i\nZA ZAi ZAi ZA\n(Why?) Since f g fg and f g fg, the result follows by Theorem 2. (cid:3)\ni i i i\n| | \u2264 | | \u2192\nProblems on Generalized Integration\nRecall that in this section E is assumed to be a complete normed space.\n1. Fill in the missing details in the proofs of this section. Prove Note 3.\n2. Treat Corollary 1(ii) as a definition of\nfds\nZA\nfor s: E and elementary and integrable f, even if E = En(Cn).\nM \u2192 6\nHence deduce Corollary 1(i)(vi) for this more general case.\n3. Using Lemma 2 in 7, with m = v , s: E, construct\ns\n\u00a7 M \u2192\nf ds\nZA 334 Chapter 8. Measurable Functions. Integration\nas in Definition 2 of 7 for the case v A = . Show that this agrees\ns\n\u00a7 6 \u221e\nwith Problem 2 if f is elementary and integrable. Then prove linearity\nfor functions with v -finite support as in 7.\ns\n\u00a7\n4. Define\nf ds (s: E)\nM \u2192\nZA\nalso for v A = .\ns\n\u221e\n[Hint: Set m=vs in Lemma 3 of 7.]\n\u00a7\n5. Prove Theorems 1 to 3 for the general case, s: E (see Problem 4).\nM \u2192\n[Hint: Argue as in 7.]\n\u00a7\n\u2032\n5 . From Problems 2\u20134, deduce Definition 2 as a theorem in the case E =\nEn(Cn).\n6. Let s,s : E (k = 1,2,...) be any set functions. Let A and\nk\nM \u2192 \u2208 M\n= X X A .\nA\nM { \u2208 M | \u2286 }\nProve that if\n( X ) lim s X = sX,\nA k\n\u2200 \u2208 M k\u2192\u221e\nthen\nlim v A = v A,\nsk s\nk\u2192\u221e\nprovided lim v exists.\nsk\nk\u2192\u221e\n[Hint: UsingProblem 2inChapter7, 11,fixafinite disjointsequence Xi A.\n\u00a7 { }\u2286M\nThen\n|sXi |= klim |s kXi |= klim |s kXi |\u2264klim vskA.\ni i \u2192\u221e \u2192\u221e i \u2192\u221e\nX X X\nInfer that\nvsA \u2264klim vskA.\n\u2192\u221e\nAlso,\n( \u03b5>0) ( k 0) ( k >k 0) s kXi sXi +\u03b5 vsA+\u03b5.\n\u2200 \u2203 \u2200 | |\u2264 | | \u2264\ni i\nX X\nProceed.]\n7. Let (X, ,m) and (Y, ,n) be two generalized measure spaces (X\nM N \u2208\n, Y ) such that mn is defined (Note 1). Set\nM \u2208 N\n= A B A , B , v A < , v B <\nm n\nC { \u00d7 | \u2208 M \u2208 N \u221e \u221e}\nand s(A B) = mA nB for A B .\n\u00d7 \u00b7 \u00d7 \u2208 C\nDefine a Fubini map as in 8, Part IV, dropping, however, f dp\n\u00a7 X\u00d7Y\nfrom Fubini property (c) temporarily.\nR 10. Integration in Generalized Measure Spaces 335\n\u00a7\nThen prove Theorem 1 in 8, including formula (1), for Fubini maps\n\u00a7\nso modified.\n[Hint: For \u03c3-additivity, use our present Theorem 2 twice. Omit .]\n\u2217\nP\n8. Continuing Problem 7, let be the \u03c3-ring generated by in X Y.\nP C \u00d7\nProve that ( D ) C is a Fubini map (as modified).\nD\n\u2200 \u2208 P\n[Outline: Proceed as in Lemma 5 of 8. For step (ii), use Theorem 2 in 10 twice.]\n\u00a7 \u00a7\n9. Further continuing Problems 7 and 8, define\n( D ) pD = C dndm.\nD\n\u2200 \u2208 P\nZX ZY\nShow that p is a generalized measure, with p = s on , and that\nC\n( D ) pD = C dp,\nD\n\u2200 \u2208 P\nZX\u00d7Y\nwith the following convention: If X Y , we set\n\u00d7 6\u2208 P\nf dp = f dp\nZX\u00d7Y ZH\nwhenever H , f is p-integrable on H, and f = 0 on H.\n\u2208 P \u2212\nVerify that this is unambiguous, i.e.,\nf dp\nZX\u00d7Y\nso defined is independent of the choice of H.\nFinally, let p be the completion of p (Chapter 7, 6, Problem 15); let\n\u00a7\n\u2217 be its domain.\nP\nDevelop the rest of Fubini theory \u201cimitating\u201d Problem 12 in 8.\n\u00a7\n10. Signed Lebesgue\u2013Stieltjes (LS) measures in E1 are defined as shown in\nChapter 7, 11, Part V. Using the notation of that section, prove the\n\u00a7\nfollowing:\n(i) Given a Borel\u2013Stieltjes measure \u03c3\u2217 in an interval I E1 (or an\n\u03b1 \u2286\nLS measure s = \u03c3\u2217 in I), there are two monotone functions g\n\u03b1 \u03b1\n\u2191\nand h (\u03b1 = g h) such that\n\u2191 \u2212\nm = s+ and m = s\u2212,\ng \u03b1 h \u03b1\nboth satisfying formula (3) of Chapter 7, 11, inside I.\n\u00a7\n(ii) If f is s -integrable on A I, then\n\u03b1\n\u2286\nf ds = f dm f dm\n\u03b1 g h\n\u2212\nZA ZA ZA\nfor any g and h (finite) such that \u03b1 = g h.\n\u2191 \u2191 \u2212 336 Chapter 8. Measurable Functions. Integration\n[Hints: (i) Define s+ and s\u2212\u03b1 by formula (3) of Chapter 7, 11. Then arguing as in\n\u03b1\n\u00a7\nTheorem 2 in Chapter 7, 9, find g and h with mg =s+ \u03b1 and m h =s\u2212\u03b1.\n\u00a7 \u2191 \u2191\n(ii) First let A=(a,b] I, then A . Proceed.]\n\u2286 \u2208B\n\u2217\n\u00a711. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition\nI. As you know, the indefinite integral\nf dm\nZ\nis a generalized measure. We now seek conditions under which a given gener-\nalized measure \u00b5 can be represented as\n\u00b5 = f dm\nZ\nfor some f (to be found). We start with two lemmas.\nLemma 1. Let m,\u00b5: [0, ) be finite measures in S. Suppose S ,\nM \u2192 \u221e \u2208 M\n\u00b5S > 0 (i.e., \u00b5 0) and \u00b5 is m-continuous (Chapter 7, 11).\n6\u2261 \u00a7\nThen there is \u03b4 > 0 and a set P such that mP > 0 and\n\u2208 M\n( X ) \u00b5X \u03b4 m(X P).\n\u2200 \u2208 M \u2265 \u00b7 \u2229\nProof. As m < and \u00b5S > 0, there is \u03b4 > 0 such that\n\u221e\n\u00b5S \u03b4 mS > 0.\n\u2212 \u00b7\nFix such a \u03b4 and define a signed measure (Lemma 2 of Chapter 7, 11)\n\u00a7\n\u03a6 = \u00b5 \u03b4m,\n\u2212\nso that\n(1) ( Y ) \u03a6Y = \u00b5Y \u03b4 mY;\n\u2200 \u2208 M \u2212 \u00b7\nhence\n\u03a6S = \u00b5S \u03b4 mS > 0.\n\u2212 \u00b7\nBy Theorem 3 in Chapter 7, 11 (Hahn decomposition), there is a \u03a6-positive\n\u00a7\nset P with a \u03a6-negative complement P = S P .\n\u2208 M \u2212 \u2212 \u2208 M\nClearly, mP > 0; for if mP = 0, the m-continuity of \u00b5 would imply \u00b5P = 0,\nhence\n\u03a6P = \u00b5P \u03b4 mP = 0,\n\u2212 \u00b7\ncontrary to \u03a6P \u03a6S > 0.\n\u2265 11. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition 337\n\u2217\n\u00a7\nAlso, P Y and Y implies \u03a6Y 0; so by (1),\n\u2287 \u2208 M \u2265\n0 \u00b5Y \u03b4 mY.\n\u2264 \u2212 \u00b7\nTaking Y = X P, we get\n\u2229\n\u03b4 m(X P) \u00b5(X P) \u00b5X,\n\u00b7 \u2229 \u2264 \u2229 \u2264\nas required. (cid:3)\nLemma 2. With m, \u00b5, and S as in Lemma 1, let be the set of all maps\nH\ng: S E\u2217, -measurable and nonnegative on S, such that\n\u2192 M\ngdm \u00b5X\n\u2264\nZX\nfor every set X from .\nM\nThen there is f with\n\u2208 H\nf dm = max gdm.\ng\u2208H\nZS ZS\nProof. is not empty; e.g., g = 0 is in . We now show that\nH H\n(2) ( g,h ) g h = max(g,h) .\n\u2200 \u2208 H \u2228 \u2208 H\nIndeed, g h is 0 and -measurable on S, as g and h are.\n\u2228 \u2265 M\nNow, given X , let Y = X(g > h) and Z = X(g h). Dropping \u201cdm\u201d\n\u2208 M \u2264\nfor brevity, we have\n(g h) = (g h)+ (g h) = g + h \u00b5Y +\u00b5Z = \u00b5X,\n\u2228 \u2228 \u2228 \u2264\nZX ZY ZZ ZY ZZ\nproving (2).\nLet\nk = sup gdm E\u2217.\n\u2208\ng\u2208H ZS\nProceeding as in Problem 13 of Chapter 7, 6, and using (2), one easily finds\n\u00a7\na sequence g , g , such that\nn n\n{ }\u2191 \u2208 H\nlim g dm = k.\nn\nn\u2192\u221e\nZS\n(Verify!) Set\nf = lim g .\nn\nn\u2192\u221e\n(It exists since g .) By Theorem 4 in 6,\nn\n{ }\u2191 \u00a7\nk = lim g = f.\nn\nn\u2192\u221e\nZS ZS 338 Chapter 8. Measurable Functions. Integration\nAlso, f is -measurable and 0 on S, as all g are; and if X , then\nn\nM \u2265 \u2208 M\n( n) g \u00b5X;\nn\n\u2200 \u2264\nZX\nhence\nf = lim g \u00b5X.\nn\nn\u2192\u221e \u2264\nZX ZX\nThus f and\n\u2208 H\nf = k = sup g,\nZS g\u2208H ZS\ni.e.,\nf = max g \u00b5S < .\ng\u2208H \u2264 \u221e\nZS ZS\nThis completes the proof. (cid:3)\nNote 1. As \u00b5 < and f 0, Corollary 1 in 5 shows that f can be made\n\u221e \u2265 \u00a7\nfinite on all of S. Also, f is m-integrable on S.\nTheorem 1 (Radon\u2013Nikodym). If (S, ,m) is a \u03c3-finite measure space, if\nM\nS , and if\n\u2208 M\n\u00b5: En(Cn)\nM \u2192\nis a generalized m-continuous measure, then\n\u00b5 = f dm on\nM\nZ\nfor at least one map\nf: S En(Cn),\n\u2192\n-measurable on S.\nM\nMoreover, if h is another such map, then mS(f = h) = 0\n6\nThe last part of Theorem 1 means that f is \u201cessentially unique.\u201d We call f\nthe Radon\u2013Nikodym (RN) derivative of \u00b5, with respect to m.\nProof. Via components (Theorem 5 in Chapter 7, 11), all reduces to the case\n\u00a7\n\u00b5: E1.\nM \u2192\nThen Theorem 4 (Jordan decomposition) in Chapter 7, 11, yields\n\u00a7\n\u00b5 = \u00b5+ \u00b5\u2212,\n\u2212\nwhere \u00b5+ and \u00b5\u2212 are finite measures ( 0), both m-continuous (Corollary 3\n\u2265\nfrom Chapter 7, 11). Therefore, all reduces to the case 0 \u00b5 < .\n\u00a7 \u2264 \u221e\nSuppose first that m, too, is finite. Then if \u00b5 = 0, just take f = 0. 11. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition 339\n\u2217\n\u00a7\nIf, however, \u00b5S > 0, take f asin Lemma2and Note 1; f is nonnegative,\n\u2208 H\nbounded, and -measurable on S,\nM\nf \u00b5 < ,\n\u2264 \u221e\nZ\nand\nf dm = k = sup gdm.\nZS g\u2208H ZS\nWe claim that f is the required map.\nIndeed, let\n\u03bd = \u00b5 f dm;\n\u2212\nZ\nso \u03bd is a finite m-continuous measure ( 0) on . (Why?) We must show\n\u2265 M\nthat \u03bd = 0.\nSeeking a contradiction, suppose \u03bdS > 0. Then by Lemma 1, there are\nP and \u03b4 > 0 such that mP > 0 and\n\u2208 M\n( X ) \u03bdX \u03b4 m(X P).\n\u2200 \u2208 M \u2265 \u00b7 \u2229\nNow let\ng = f +\u03b4 C ;\nP\n\u00b7\nso g is -measurable and 0. Also,\nM \u2265\n( X ) g = f +\u03b4 C = f +\u03b4 m(X P)\nP\n\u2200 \u2208 M \u00b7 \u2229\nZX ZX ZX ZX\nf +\u03bd(X P)\n\u2264 \u2229\nZX\nf +\u03bdX = \u00b5X\n\u2264\nZX\nby our choice of \u03b4 and \u03bd. Thus g . On the other hand,\n\u2208 H\ng = f +\u03b4 C = k +\u03b4mP > k,\nP\nZS ZS ZS\ncontrary to\nk = sup g.\ng\u2208H ZS\nThis proves that f = \u00b5, indeed.\nNow suppose there is another map h with\nR \u2208 H\n\u00b5 = hdm = f dm = ;\n6 \u221e\nZ Z 340 Chapter 8. Measurable Functions. Integration\nso\n(f h)dm = 0.\n\u2212\nZ\n(Why?) Let\nY = S(f h) and Z = S(f < h);\n\u2265\nso Y,Z (Theorem 3 of 2) and f h is sign-constant on Y and Z. Also,\n\u2208 M \u00a7 \u2212\nby construction,\n(f h)dm = 0 = (f h)dm.\n\u2212 \u2212\nZY ZZ\nThusbyTheorem 1(h)in 5, f h = 0a.e.onY, onZ, andhenceonS = Y Z;\n\u00a7 \u2212 \u222a\nthat is,\nmS(f = h) = 0.\n6\nThus all is proved for the case mS < .\n\u221e\nNext, let m be \u03c3-finite:\n\u221e\nS = S (disjoint)\nk\nk=1\n[\nfor some sets S with mS < .\nk k\n\u2208 M \u221e\nBy whatwasshown above, on eachS thereis an -measurablemapf 0\nk k\nM \u2265\nsuch that\nf dm = \u00b5X\nk\nZX\nfor all -sets X S . Fixing such an f for each k, define f: S E1 by\nk k\nM \u2286 \u2192\nf = f on S , k = 1,2,....\nk k\nThen (Corollary 3 in 1) f is -measurable and 0 on S.\n\u00a7 M \u2265\nTaking any X , set X = X S . Then\nk k\n\u2208 M \u2229\n\u221e\nX = X (disjoint)\nk\nk=1\n[\nand X . Also,\nk\n\u2208 M\n( k) f dm = f dm = \u00b5X .\nk k\n\u2200\nZXk ZXk\nThus by \u03c3-additivity (Theorem 2 in 5),\n\u00a7\n\u221e\nf dm = f dm = \u00b5X = \u00b5X < (\u00b5 is finite!).\nk\n\u221e\nZX k=1ZXk\nk\nX X\nThus f is as required, and its \u201cuniqueness\u201d follows as before. (cid:3) 11. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition 341\n\u2217\n\u00a7\nNote 2. By Definition 3 in 10, we may write\n\u00a7\n\u201cd\u00b5 = f dm\u201d\nfor\n\u201c f dm = \u00b5.\u201d\nZ\nNote 3. Using Definition 2 in 10 and an easy \u201ccomponentwise\u201d proof, one\n\u00a7\nshows that Theorem 1 holds also with m replaced by a generalized measure s.\nThe formulas\n\u00b5 = f dm and mS(f = h) = 0\n6\nZ\nthen are replaced by\n\u00b5 = f ds and v S(f = h) = 0.\ns\n6\nZ\nII. Theorem 1 requires \u00b5 to be m-continuous (\u00b5 m). We want to generalize\n\u226a\nTheorem 1 so as to lift this restriction. First, we introduce a new concept.\nDefinition.\nGiven two set functions s,t: E ( 2S), we say that s is t-\nM \u2192 M \u2286\nsingular (s t) iff there is a set P such that v P = 0 and\nt\n\u22a5 \u2208 M\n(3) ( X X P) sX = 0.\n\u2200 \u2208 M | \u2286 \u2212\n(We then briefly say \u201cs resides in P.\u201d)\nFor generalized measures, this means that\n( X ) sX = s(X P).\n\u2200 \u2208 M \u2229\nWhy?\nCorollary 1. If the generalized measures s,u: E are t-singular, so is\nM \u2192\nks for any scalar k (if s is scalar valued, k may be a vector).\nSo also are s u, provided t is additive.\n\u00b1\n(Exercise! See Problem 3 below.)\nCorollary 2. If a generalized measure s: E is t-continuous (s t) and\nM \u2192 \u226a\nalso t-singular (s t), then s = 0 on .\n\u22a5 M\nProof. As s t, formula (3) holds for some P , v P = 0. Hence for all\nt\n\u22a5 \u2208 M\nX ,\n\u2208 M\ns(X P) = 0 (for X P P)\n\u2212 \u2212 \u2286 \u2212\nand\nv (X P) = 0 (for X P P).\nt\n\u2229 \u2229 \u2286 342 Chapter 8. Measurable Functions. Integration\nAs s t, we also have s(X P) = 0 by Definition 3(i) in Chapter 7, 11. Thus\n\u226a \u2229 \u00a7\nby additivity,\nsX = s(X P)+s(X P) = 0,\n\u2229 \u2212\nas claimed. (cid:3)\nTheorem 2 (Lebesgue decomposition). Let s,t: E be generalized mea-\nM \u2192\nsures.\nIf v is t-finite (Definition 3(iii) in Chapter 7, 11), there are generalized\ns\n\u00a7\nmeasures s\u2032,s\u2032\u2032: E such that\nM \u2192\ns\u2032 t and s\u2032\u2032 t\n\u226a \u22a5\nand\ns = s\u2032 +s\u2032\u2032.\nProof. Let v be the restriction of v to\n0 s\n= X v X = 0 .\no t\nM { \u2208 M | }\nAs v is a measure (Theorem 1 of Chapter 7, 11), so is v (for is a \u03c3-ring;\ns 0 0\n\u00a7 M\nverify!).\nThus by Problem 13 in Chapter 7, 6, we fix P , with\n0\n\u00a7 \u2208 M\nv P = v P = max v X X .\ns 0 s 0\n{ | \u2208 M }\nAs P , we have v P = 0; hence\n0 t\n\u2208 M\nsP v P <\ns\n| | \u2264 \u221e\n(for v is t-finite).\ns\nNow define s\u2032, s\u2032\u2032, v\u2032, and v\u2032\u2032 by setting, for each X ,\n\u2208 M\n(4) s\u2032X = s(X P);\n\u2212\n(5) s\u2032\u2032X = s(X P);\n\u2229\n(6) v\u2032X = v (X P);\ns\n\u2212\n(7) v\u2032\u2032X = v (X P).\ns\n\u2229\nAs s and v are \u03c3-additive, so are s\u2032, s\u2032\u2032, v\u2032, and v\u2032\u2032. (Verify!) Thus\ns\ns\u2032,s\u2032\u2032: E are generalized measures, while v\u2032 and v\u2032\u2032 are measures ( 0).\nM \u2192 \u2265\nWe have\n( X ) sX = s(X P)+s(X P) = s\u2032X +s\u2032\u2032X;\n\u2200 \u2208 M \u2212 \u2229\ni.e.,\ns = s\u2032 +s\u2032\u2032.\nSimilarly one obtains v = v\u2032 +v\u2032\u2032.\ns 11. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition 343\n\u2217\n\u00a7\nAlso, by (5), since X P = ,\n\u2229 \u2205\nP X and X = s\u2032\u2032X = 0,\n\u2212 \u2287 \u2208 M \u21d2\nwhile v P = 0 (see above). Thus s\u2032\u2032 is t-singular, residing in P.\nt\nTo prove s\u2032 t, it suffices to show that v\u2032 t (for by (4) and (6), v\u2032X = 0\n\u226a \u226a\nimplies s\u2032X = 0).\n| |\nAssume the opposite. Then\n( Y ) v Y = 0\nt\n\u2203 \u2208 M\n(i.e., Y ), but\n0\n\u2208 M\n0 < v\u2032Y = v (Y P).\ns\n\u2212\nSo by additivity,\nv (Y P) = v P +v (Y P) > v P,\ns s s s\n\u222a \u2212\nwith Y P , contrary to\n0\n\u222a \u2208 M\nv P = max v X X .\ns s 0\n{ | \u2208 M }\nThis contradiction completes the proof. (cid:3)\nNote 4. The set function s\u2032\u2032 in Theorem 2 is bounded on . Indeed, s\u2032\u2032 t\nM \u22a5\nyields a set P such that\n\u2208 M\n( X ) s\u2032\u2032(X P) = 0;\n\u2200 \u2208 M \u2212\nand v P = 0 implies v P < . (Why?) Hence\nt s\n\u221e\ns\u2032\u2032X = s\u2032\u2032(X P)+s\u2032\u2032(X P) = s\u2032\u2032(X P).\n\u2229 \u2212 \u2229\nAs s = s\u2032 +s\u2032\u2032, we have\ns\u2032\u2032 s + s\u2032 v +v s\u2032;\ns\n| | \u2264 | | | | \u2264\nso\ns\u2032\u2032X = s\u2032\u2032(X P) v sP +v s\u2032P.\n| | | \u2229 | \u2264\nBut v s\u2032P = 0 by t-continuity (Theorem 2 of Chapter 7, 11). Thus s\u2032\u2032\n\u00a7 | | \u2264\nv P < on .\ns\n\u221e M\nNote 5. The Lebesgue decomposition s = s\u2032 +s\u2032\u2032 in Theorem 2 is unique.\nFor if also\nu\u2032 t and u\u2032\u2032 t\n\u226a \u22a5\nand\nu\u2032 +u\u2032\u2032 = s = s\u2032 +s\u2032\u2032,\nthen with P as in Problem 3, ( X )\n\u2200 \u2208 M\n(8) s\u2032(X P)+s\u2032\u2032(X P) = u\u2032(X P)+u\u2032\u2032(X P)\n\u2229 \u2229 \u2229 \u2229 344 Chapter 8. Measurable Functions. Integration\nand v (X P) = 0. But\nt\n\u2229\ns\u2032(X P) = 0 = u\u2032(X P)\n\u2229 \u2229\nby t-continuity; so (8) reduces to\ns\u2032\u2032(X P) = u\u2032\u2032(X P),\n\u2229 \u2229\nor s\u2032\u2032X = u\u2032\u2032X (for s\u2032\u2032 and u\u2032\u2032 reside in P). Thus s\u2032\u2032 = u\u2032\u2032 on .\nM\nBy Note 4, we may cancel s\u2032\u2032 and u\u2032\u2032 in\ns\u2032 +s\u2032\u2032 = u\u2032 +u\u2032\u2032\nto obtain s\u2032 = u\u2032 also.\nNote 6. If E = En(Cn), the t-finiteness of v in Theorem 2 is redundant,\ns\nfor v is even bounded (Theorem 6 in Chapter 7, 11).\ns\n\u00a7\nWe now obtain the desired generalization of Theorem 1.\nCorollary 3. If (S, ,m) is a \u03c3-finite measure space (S ), then for any\nM \u2208 M\ngeneralized measure\n\u00b5: En(Cn),\nM \u2192\nthere is a unique m-singular generalized measure\ns\u2032\u2032: En(Cn)\nM \u2192\nand a (\u201cessentially\u201d unique) map\nf: S En(Cn),\n\u2192\n-measurable and m-integrable on S, with\nM\n\u00b5 = f dm+s\u2032\u2032.\nZ\n(Note 3 applies here.)\nProof. By Theorem 2 and Note 5, \u00b5 = s\u2032 +s\u2032\u2032 for some (unique) generalized\nmeasures s\u2032,s\u2032\u2032: En(Cn), with s\u2032 m and s\u2032\u2032 m.\nM \u2192 \u226a \u22a5\nNow use Theorem 1 to represent s\u2032 as f dm, with f as stated. This yields\nthe result. (cid:3)\nR\nProblems on Radon\u2013Nikodym\nDerivatives and Lebesgue Decomposition\n1. Fill in all proof details in Lemma 2 and Theorem 1.\n2. Verify the statement following formula (3). Also prove the following:\n(i) If P along with P , then s t implies t s;\n\u2208 M \u2212 \u2208 M \u22a5 \u22a5\n(ii) s t iff v t.\ns\n\u22a5 \u22a5 11. The Radon\u2013Nikodym Theorem. Lebesgue Decomposition 345\n\u2217\n\u00a7\n3. Prove Corollary 1.\n[Hints: Here is a \u03c3-ring. Suppose s and u reside in P and P , respectively, and\n\u2032 \u2032\u2032\nM\nvtP = 0 = vtP \u2032\u2032. Let P = P P . Verify that vtP = 0 (use Problem 8 in\n\u2032 \u2032 \u2032\u2032\n\u222a \u2208 M\nChapter 7, 11). Then show that both s and u reside in P.]\n\u00a7\n4. Show that if s: E\u2217 is a signed measure in S , then s+ s\u2212\nM \u2192 \u2208 M \u22a5\nand s\u2212 s+.\n\u22a5\n5. Fill in all details in the proof of Theorem 2. Also prove the following:\n(i) s\u2032 and v s\u2032 are absolutely t-continuous.\n[Hint: Use Theorem 2 in Chapter 7, 11.]\n\u00a7\n(ii) v s = v s\u2032 +v s\u2032\u2032, v s\u2032\u2032 t.\n\u22a5\n(iii) If s is a measure ( 0), so are s\u2032 and s\u2032\u2032.\n\u2265\n6. Verify Note 3 for Theorem 1 and Corollary 3. State and prove both\ngeneralized propositions precisely.\n\u2217\n\u00a712. Integration and Differentiation\nI. We shall now link RN-derivatives ( 11) to those of Chapter 7, 12.\n\u00a7 \u00a7\nBelow, we use the notation of Definition 3 in Chapter 7, 10 and Definition 1\n\u00a7\nof Chapter 7, 12. (Review them!) In particular,\n\u00a7\nm: \u2217 E\u2217\nM \u2192\nis Lebesgue measure in En (presupposed in such terms as \u201ca.e.,\u201d etc.); s is an\narbitrary set function. For convenience, we set\ns\u2032(p\u00af) = 0\nand\nf dm = 0,\nZX\nunless defined otherwise; thus s\u2032 and f exist always.\nX\nWe start with several lemmas that go back to Lebesgue.\nR\nLemma 1. With the notation of Definition 3 of Chapter 7, 10, the functions\n\u00a7\nDs, Ds, and s\u2032\nare Lebesgue measurable on En for any set function\ns: \u2032 E\u2217 ( \u2032 ).\nM \u2192 M \u2287 K\nProof. By definition,\nDs(p\u00af) = infh (p\u00af),\nr\nr 346 Chapter 8. Measurable Functions. Integration\nwhere\nsI\nh (p\u00af) = sup I r\nr mI \u2208 Kp\u00af\n(cid:26) (cid:27)\n(cid:12)\n(cid:12)\nand\n(cid:12)\n1\nr = I p\u00af I, dI < , r = 1,2,... .\nKp\u00af \u2208 K \u2208 r\n(cid:26) (cid:27)\n(cid:12)\n(cid:12)\nAs is easily seen (verify!),\n(cid:12)\nsI 1\n(1) En(h > a) = I a < , dI < , a E\u2217.\nr\n\u2208 K mI r \u2208\n(cid:26) (cid:27)\n[ (cid:12)\n(cid:12)\nTheright-sideunionisLebesguem(cid:12)easurablebyProblem 2inChapter7, 10.\n\u00a7\nThus by Theorem 1 of 2, the function h is measurable on En for r = 1,2,...,\nr\n\u00a7\nand so is\nDs = infh\nr\nr\nby Lemma 1 of 2 and Definition 3 in Chapter 7, 10. Similarly for Ds.\n\u00a7 \u00a7\nHence by Corollary 1 in 2, the set\n\u00a7\nA = En(Ds = Ds)\nis measurable. As s\u2032 = Ds on A, s\u2032 is measurable on A and also on A (by\n\u2212\nconvention, s\u2032 = 0 on A), hence on all of En. (cid:3)\n\u2212\nLemma 2. With the same notation, let s: \u2032 E\u2217 ( \u2032 ) be a regular\nM \u2192 M \u2287 K\nmeasure in En. Let A \u2217 and B \u2032 with A B, and a E1.\n\u2208 M \u2208 M \u2286 \u2208\nIf\nDs > a on A,\nthen\na mA sB.\n\u00b7 \u2264\nProof. Fix \u03b5 > 0. By regularity (Definition 4 in Chapter 7, 7), there is an\n\u00a7\nopen set G B, with\n\u2287\nsB +\u03b5 sG.\n\u2265\nNow let\n\u03b5 = I I G, sI (a \u03b5)mI .\nK \u2208 K \u2286 \u2265 \u2212\nAs Ds > a, the definiti(cid:8)on of D(cid:12)s implies that \u03b5 is a V(cid:9)itali covering of A.\n(cid:12)\nK\n(Verify!)\nThus Theorem 1 in Chapter 7, 10, yields a disjoint sequence I \u03b5,\nk\n\u00a7 { } \u2286 K\nwith\nm A I = 0\nk\n\u2212\n(cid:16) [k (cid:17) 12. Integration and Differentiation 347\n\u2217\n\u00a7\nand\nmA m A I +m I = 0+m I = mI .\nk k k k\n\u2264 \u2212\nk\n(cid:0) [ (cid:1) [ [ X\nAs\nI G and sB +\u03b5 sG\nk\n\u2286 \u2265\n[\n(by our choice of \u03b5 and G), we obtain\nK\nsB +\u03b5 s I = sI (a \u03b5) mI (a \u03b5)mA.\nk k k\n\u2265 \u2265 \u2212 \u2265 \u2212\nk k k\n[ X X\nThus\n(a \u03b5)mA sB +\u03b5.\n\u2212 \u2264\nMaking \u03b5 0, we obtain the result. (cid:3)\n\u2192\nLemma 3. If\nt = s u,\n\u00b1\nwith s,t,u: \u2032 E\u2217 and \u2032 , and if u is differentiable at a point p\u00af En,\nM \u2192 M \u2287 K \u2208\nthen\nDt = Ds u\u2032 and Dt = Ds u\u2032 at p\u00af.\n\u00b1 \u00b1\nThe proof, from definitions, is left to the reader(Chapter 7, 12, Problem 7).\n\u00a7\nLemma 4. Any m-continuous measure s: \u2217 E1 is strongly regular.\nM \u2192\nProof. By Corollary 3 of Chapter 7, 11, v = s < (s is finite!). Thus v is\ns s\n\u00a7 \u221e\ncertainly m-finite.\nHence by Theorem 2 in Chapter 7, 11, s is absolutely m-continuous. So\n\u00a7\ngiven \u03b5 > 0, there is \u03b4 > 0 such that\n( X \u2217 mX < \u03b4) sX < \u03b5.\n\u2200 \u2208 M |\nNow, let A \u2217. By the strong regularity of Lebesgue measure m (Chap-\n\u2208 M\nter 7, 8, Theorem 3(b)), there is an open set G A and a closed F A such\n\u00a7 \u2287 \u2286\nthat\nm(A F) < \u03b4 and m(G A) < \u03b4.\n\u2212 \u2212\nThus by our choice of \u03b4,\ns(A F) < \u03b5 and s(G A) < \u03b5,\n\u2212 \u2212\nas required. (cid:3) 348 Chapter 8. Measurable Functions. Integration\nLemma 5. Let s,s (k = 1,2,...) be finite m-continuous measures, with\nk\ns s or s s on \u2217.\nk k\n\u0580 \u0581 M\nIf the s are a.e. differentiable, then\nk\nDs = Ds = lim s\u2032 a.e.\nk\nk\u2192\u221e\nProof. Let first s s. Set\nk\n\u0580\nt = s s .\nk k\n\u2212\nBy Corollary 2 in Chapter 7, 11, all t are m-continuous, hence strongly reg-\nk\n\u00a7\nular (Lemma 4). Also, t 0 (since s s). Hence\nk k\n\u0581 \u0580\nt I t I 0\nk k+1\n\u2265 \u2265\nfor each cube I; and the definition of Dt implies that\nk\nDt Dt Dt 0.\nk k+1 k+1\n\u2265 \u2265 \u2265\nAs Dt , lim Dt exists (pointwise). Now set\nk k\n{ }\u2193 k\u2192\u221e\n1\nA = En lim Dt , r = 1,2,....\nr k\nk\u2192\u221e \u2265 r\n(cid:16) (cid:17)\nBy Lemma 1 (and Lemma 1 in 2), A \u2217. Since\nr\n\u00a7 \u2208 M\n1\nDt lim Dt\nk i\n\u2265 i\u2192\u221e \u2265 r\non A , Lemma 2 yields\nr\n1\nmA t A .\nr k r\nr \u2264\nAs t 0, we have\nk\n\u0581\n1\nmA lim t A = 0.\nr k r\nr \u2264 k\u2192\u221e\nThus\nmA = 0, r = 1,2,....\nr\nAlso, as is easily seen,\n\u221e \u221e\n1\nEn lim Dt > 0 = En lim Dt = A\nk k r\nk\u2192\u221e k\u2192\u221e \u2265 r\n(cid:16) (cid:17) r [=1 (cid:16) (cid:17) r [=1\nand\n\u221e\nm A = 0.\nr\nr=1\n[\nHence\nlim Dt 0 a.e.\nk\nk\u2192\u221e \u2264 12. Integration and Differentiation 349\n\u2217\n\u00a7\nAs\nDt Dt 0\nk k\n\u2265 \u2265\n(see above), we get\nlim Dt = 0 = lim Dt a.e. on En.\nk k\nk\u2192\u221e k\u2192\u221e\nNow, as t = s s and as the s are differentiable, Lemma 3 yields\nk k k\n\u2212\nDt = Ds s\u2032 and Dt = Ds s\u2032 a.e.\nk \u2212 k k \u2212 k\nThus\nlim (Ds s\u2032 ) = 0 = lim(Ds s\u2032 ),\nk\u2192\u221e \u2212 k \u2212 k\ni.e.,\nDs = lim s\u2032 = Ds a.e.\nk\nk\u2192\u221e\nThis settles the case s s.\nk\n\u0580\nIn the case s s, one only has to set t = s s and proceed as before.\nk k k\n\u0581 \u2212\n(Verify!) (cid:3)\nLemma 6. Given A \u2217, mA < , let\n\u2208 M \u221e\ns = C dm\nA\nZ\non \u2217. Then s is a.e. differentiable, and\nM\ns\u2032 = C a.e. on En.\nA\n(C = characteristic function of A.)\nA\nProof.1 First, let A be open and let p\u00af A.\n\u2208\nThen A contains some G (\u03b4) and hence also all cubes I with dI < \u03b4\np\u00af\n\u2208 K\nand p\u00af I.\n\u2208\nThus for such I ,\n\u2208 K\nsI = C dm = (1)dm = mI;\nA\nZI ZI\ni.e.,\nsI\n= 1 = C (p\u00af), p\u00af A.\nA\nmI \u2208\nHence by Definition 1 of Chapter 7, 12,\n\u00a7\ns\u2032(p\u00af) = 1 = C (p\u00af)\nA\nif p\u00af A; i.e., s\u2032 = C on A.\nA\n\u2208\n1Differentiability follows by Theorem 4 of Chapter 7, 12, but we obtain it anyway.\n\u00a7 350 Chapter 8. Measurable Functions. Integration\nWe claim that\nDs = s\u2032 = 0 a.e. on A.\n\u2212\nTo prove it, note that\ns = C dm\nA\nZ\nis a finite (why?) m-continuous measure on \u2217. By Lemma 4, s is strongly\nM\nregular. Also, as sI 0 for any I , we certainly have\n\u2265 \u2208 K\nDs Ds 0.\n\u2265 \u2265\n(Why?) Now let\n\u221e\n(2) B = En(Ds > 0) = B ,\nr\nr=1\n[\nwhere\n1\n(3) B = En Ds , r = 1,2,....\nr\n\u2265 r\n(cid:16) (cid:17)\nWe have to show that m(B A) = 0.\n\u2212\nSuppose\nm(B A) > 0.\n\u2212\nThen by (2), we must have m(B A) > 0 for at least one B ; we fix this B .\nr r r\n\u2212\nAlso, by (3),\n1\nDs on B A\nr\n\u2265 r \u2212\n(even on all of B ). Thus by Lemma 2,\nr\n1\n(4) 0 < m(B A) s(B A) = C dm.\nr r A\nr \u2212 \u2264 \u2212\nZBr\u2212A\nBut this is impossible. Indeed, as C = 0 on A (hence on B A), the\nA r\n\u2212 \u2212\nintegral in (4) cannot be > 0. This refutes the assumption m(B A) > 0; so\n\u2212\nby (2),\nm(En(Ds > 0) A) = 0;\n\u2212\ni.e.,\nDs = 0 = Ds a.e. on A.\n\u2212\nWe see that\ns\u2032 = 0 = C a.e. on A,\nA\n\u2212\nand\ns\u2032 = 1 = C on A,\nA\nproving the lemma for open sets A. 12. Integration and Differentiation 351\n\u2217\n\u00a7\nNow take any A \u2217, mA < . As Lebesgue measure is regular (Chap-\n\u2208 M \u221e\nter 7, 8, Theorem 3(b)), we find for each k N an open set G A, with\nk\n\u00a7 \u2208 \u2287\n1\nm(G A) < and G G .\nk k k+1\n\u2212 k \u2287\nLet\ns = C dm.\nk Gk\nZ\nThen s s on \u2217 (see Problem 5(ii) in 6). Also, by what was shown above,\nk\n\u0581 M \u00a7\nthe s are differentiable, with s\u2032 = C a.e.\nk k Gk\nHence by Lemma 5,\nDs = Ds = lim C = C (a.e.).\nGk A\nk\u2192\u221e\nThe lemma is proved. (cid:3)\nTheorem 1. Let f: En E\u2217(Er, Cr) be m-integrable, at least on each cube\n\u2192\nin En. Then the set function\ns = f dm\nZ\nis differentiable, with s\u2032 = f, a.e. on En.2\nThus s\u2032 is the RN-derivative of s with respect to Lebesgue measure m\n(Theorem 1 in 11).\n\u00a7\nProof. As En is a countable union of cubes (Lemma 2 in Chapter 7, 2), it\n\u00a7\nsuffices to show that s\u2032 = f a.e. on each open cube J, with s differentiable\na.e. on J.\nThus fix such a J = and restrict s and m to\n6 \u2205\n= X \u2217 X J .\n0\nM { \u2208 M | \u2286 }\nThis does not affect s\u2032 on J; for as J is open, any sequence of cubes\nI p\u00af J\nk\n\u2192 \u2208\nterminates inside J anyway.\nWhen so restricted,\ns = f\nZ\nis a generalized measure in J; for is a \u03c3-ring (verify!), and f is integrable\n0\nM\non J. Also, m is strongly regular, and s is m-continuous.\n2Recall that f is always defined by our convention.\nR 352 Chapter 8. Measurable Functions. Integration\nFirst, suppose f is -simple on J, say,\n0\nM\nq\nf = a C ,\ni Ai\ni=1\nX\nsay, with 0 < a < , A \u2217, and\ni i\n\u221e \u2208 M\nq\nJ = A (disjoint).\ni\ni=1\n[\nThen\nq\ns = f = a C .\ni Ai\nZ i=1 Z\nX\nHence by Lemma 6 above and by Theorem 1 in Chapter 7, 12, s is differen-\n\u00a7\ntiable a.e. (as each C is), and\nAi\nR q \u2032 q\ns\u2032 = a C = a C = f (a.e.),\ni Ai i Ai\ni=1 (cid:18)Z (cid:19) i=1\nX X\nas required.\nThe general case reduces (via components and the formula f = f+ f\u2212) to\n\u2212\nthe case f 0, with f measurable (even integrable) on J.\n\u2265\nBy Problem 6 in 2, then, we have f f for some simple maps f 0. Let\nk k\n\u00a7 \u0580 \u2265\ns = f on M , k = 1,2,....\nk k 0\nZ\nThen all s and s = f are finite measures and s s, by Theorem 4 in 6.\nk k\n\u0580 \u00a7\nAlso, by what was shown above, each s is differentiable a.e. on J, with s\u2032 = f\nR k k k\n(a.e.). Thus as in Lemma 5,\nDs = Ds = s\u2032 = lim s\u2032 = limf = f (a.e.) on J,\nk k\nk\u2192\u221e\nwith s\u2032 = f = (a.e.), as f is integrable on J. Thus all is proved. (cid:3)\n6 \u00b1\u221e\nII. So far we have considered Lebesgue ( ) differentiation. However, our re-\nK\nsults easily extend to \u2126-differentiation (Definition 2 in Chapter 7, 12).\n\u00a7\nThe proof is even simpler. Thus in Lemma 1, the union in formula (1)\nis countable (as is replaced by the countable set family \u2126); hence it is\nK\n\u00b5-measurable. In Lemma 2, the use of the Vitali theorem is replaced by\nTheorem 3 in Chapter 7, 12. Otherwise, one only has to replace Lebesgue\n\u00a7\nmeasure m by \u00b5 on . Once the lemmas are established (reread the proofs!),\nM\nwe obtain the following. 12. Integration and Differentiation 353\n\u2217\n\u00a7\nTheorem 2. Let S, \u03c1, \u2126, and \u00b5: E\u2217 be as in Definition 2 of Chapter\nM \u2192\n7, 12. Let f: S E\u2217(Er, Cr) be \u00b5-integrable on each A with \u00b5A < .\n\u00a7 \u2192 \u2208 M \u221e\nThen the set function\ns = f d\u00b5\nZ\nis \u2126-differentiable, with s\u2032 = f, (a.e.) on S.\nProof. Recall that S is a countable union of sets Ui \u2126 with 0 < \u00b5Ui < .\nn \u2208 n \u221e\nAs \u00b5\u2217 is -regular, each Ui lies in an open set Ji with\nG n n \u2208 M\n\u00b5Ji < \u00b5Ui +\u03b5i < .\nn n n \u221e\nAlso, f is \u00b5-measurable (even integrable) on Ji. Dropping a null set, assume\nn\nthat f is -measurable on J = Ji.\nM n\nFrom here, proceed exactly as in Theorem 1, replacing m by \u00b5. (cid:3)\nBoth theorems combined yield the following result.\nCorollary 1. If s: \u2032 E\u2217(Er, Cr) is an m-continuous and m-finite gen-\nM \u2192\neralized measure in En, then s is -differentiable a.e. on En, and ds = s\u2032dm\nK\n(see Definition 3 in 10) in any A \u2217 (mA < ).3\n\u00a7 \u2208 M \u221e\nSimilarly for \u2126-differentiation.\nProof. Given A \u2217 (mA < ), there is an open set J A such that\n\u2208 M \u221e \u2287\nmJ < mA+\u03b5 < .\n\u221e\nAs before, restrict s and m to\n= X \u2217 X J .\n0\nM { \u2208 M | \u2286 }\nThen by assumption, s is finite and m-continuous on (a \u03c3-ring); so by\n0\nM\nTheorem 1 in 11,\n\u00a7\ns = f dm\nZ\non for some m-integrable map f on J.\n0\nM\nHence by our present Theorem 1, s is differentiable, with s\u2032 = f a.e. on J,\nand so\ns = f = s\u2032 on .\n0\nM\nZ Z\nThis implies ds = s\u2032dm in A.\nFor \u2126-differentiation, use Theorem 2. (cid:3)\n3The restriction mA< is redundant if s is finite.\n\u221e 354 Chapter 8. Measurable Functions. Integration\nCorollary 2 (changeofmeasure). Let s be as in Corollary 1. Subjectto Note 1\nin 10, if f is s-integrable on A \u2217 (mA < ),4 then fs\u2032 is m-integrable\n\u00a7 \u2208 M \u221e\non A and\nf ds = fs\u2032dm.\nZA ZA\nSimilarly for \u2126-derivatives, with m replaced by \u00b5.\nProof. By Corollary 1, ds = s\u2032dm in A. Thus Theorem 6 of 10 yields the\n\u00a7\nresult. (cid:3)\nNote 1. In particular, Corollary 2 applies to m-continuous signed LS mea-\nsures s = s in E1 (see end of 11). If A = [a,b], then s is surely finite on\n\u03b1 \u03b1\n\u00a7\ns -measurable subsets of A; so Corollaries 1 and 2 show that\n\u03b1\nf ds = fs\u2032 dm = f\u03b1\u2032dm,\n\u03b1 \u03b1\nZA ZA ZA\nsince s\u2032 = \u03b1\u2032. (See Problem 9 in Chapter 7, 12.)\n\u03b1 \u00a7\nNote 2. Moreover, s = s (see Note 1) is absolutely m-continuous iff \u03b1 is\n\u03b1\nabsolutely continuous in the stronger sense (Problem 2 in Chapter 4, 8).\n\u00a7\nIndeed, assuming the latter, fix \u03b5 > 0 and choose \u03b4 as in Definition 3 of\nChapter 7, 11. Then if mX < \u03b4, we have\n\u00a7\nX I (disjoint)\nk\n\u2286\nfor some intervals I = (a ,b ], wi[th\nk k k\n\u03b4 > mI = (b a ).\nk k k\n\u2212\nHence X X\nsX sI < \u03b5.\nk\n| | \u2264 | |\n(Why?) Similarly for the converse.5 X\nProblems on Differentiation and Related Topics\n1. Fill in all proof details in this section. Verify footnote 4 and Note 2.\n2. Given a measure s: \u2032 E\u2217 ( \u2032 ), prove that\nM \u2192 M \u2287 K\n(i) s is topological;\n(ii) its Borel restriction \u03c3 is strongly regular; and\n(iii) Ds, Ds, and s\u2032 do not change if s or m are restricted to the\nBorel field in En; neither does this affect the propositions on\nB\n-differentiation proved here.\nK\n4The restriction mA< is redundant if s is finite.\n\u221e\n5Note that s a =0 if s is m-continuous.\n{ } 12. Integration and Differentiation 355\n\u2217\n\u00a7\n[Hints: (i) Use Lemma 2 of Chapter 7, 2. (ii) Use also Problem 10 in Chapter 7,\n\u00a7\n7. (iii) All depends on .]\n\u00a7 K\n3. What analogues to 2(i)\u2013(iii) apply to \u2126-differentiation in En? In (S,\u03c1)?\n4. (i) Show that any m-singular measure s in En, finite on , has a zero\nK\nderivative (a.e.).\n(ii) For \u2126-derivatives, prove that this holds if s is also regular.\n[Hint for (i): By Problem 2, we may assume s regular (if not, replace it by \u03c3).\nSuppose\nmEn(Ds>0)>a>0\nand find a contradiction to Lemma 2.]\n5. Give another proof for Theorem 4 in Chapter 7, 12.\n\u00a7\n[Hint: Fix an open cube J . By Problem 2(iii), restrict s and m to\n\u2208K\n= X X J\n0\nM { \u2208B | \u2286 }\ntomakethemfinite. ApplyCorollary 2in 11tos. ThenuseProblem4, Theorem1\n\u00a7\nof the present section, and Theorem 1 of Chapter 7, 12.\n\u00a7\nFor\u2126-differentiation, assumesregular; argueasinCorollary1,usingCorollary 2\nof 11.]\n\u00a7\n6. Prove that if\nx\nF(x) = L f dm (a x b),6\n\u2264 \u2264\nZa\nwith f: E1 E\u2217(En, Cn) m-integrable on A = [a,b], then F is differ-\n\u2192\nentiable, with F\u2032 = f, a.e. on A.\n[Hint: Via components, reduce all to the case f 0, F on A.\n\u2265 \u2191\nLet\ns= fdm\nZ\non . Let t=m be the F-induced LS measure. Show that s=t on intervals in\n\u2217 F\nM\nA; so s =t =F a.e. on A (Problem 9 in Chapter 7, 11). Use Theorem 1.]\n\u2032 \u2032 \u2032\n\u00a7\n6Here L x fdm= fdm; m=Lebesgue measure.\na [a,x]\nR R  Chapter 9\nCalculus Using Lebesgue Theory\n\u00a71. L-Integrals and Antiderivatives\nI. Lebesgue theory makes it possible to strengthen many calculus theorems.\nWe shall start with functions on E1, f: E1 E. (A reader who has omit-\n\u2192\nted the \u201cstarred\u201d part of Chapter 8, 7, will have to set E = E\u2217(En, Cn)\n\u00a7\nthroughout.)\nBy L-integrals of such functions, we mean integrals with respect to Lebesgue\nmeasure m in E1. Notation:\nb b\nL f = L f(x)dx = L f\nZa Za Z[a,b]\nand\na b\nL f = L f.\n\u2212\nZb Za\nFor Riemann integrals, we replace \u201cL\u201d by \u201cR.\u201d We compare such integrals\nwith antiderivatives (Chapter 5, 5), denoted\n\u00a7\nb\nf,\nZa\nwithout the \u201cL\u201d or \u201cR.\u201d Note that\nL f = L f,\nZ[a,b] Z(a,b)\netc., since m a = m b = 0 here.\n{ } { }\nTheorem 1. Let f: E1 E be L-integrable on A = [a,b]. Set\n\u2192\nx\nH(x) = L f, x A.\n\u2208\nZa 358 Chapter 9. Calculus Using Lebesgue Theory\nThen the following are true.\n(i) The function f is the derivative of H at any p A at which f is finite\n\u2208\nand continuous. (At a and b, continuity and derivatives may be one-sided\nfrom within.)\n(ii) The function H is absolutely continuous on A;1 hence V [A] < .2,3\nH\n\u221e\nProof. (i) Let p (a,b], q = f(p) = . Let f be left continuous at p; so,\n\u2208 6 \u00b1\u221e\ngiven \u03b5 > 0, we can fix c (a,p) such that\n\u2208\nf(x) q < \u03b5 for x (c,p).\n| \u2212 | \u2208\nThen\np p\n( x (c,p)) L (f q) L f q\n\u2200 \u2208 \u2212 \u2264 | \u2212 |\n(cid:12) Zx (cid:12) Zx\n(cid:12) (cid:12) p\n(cid:12) (cid:12)\nL (\u03b5) = \u03b5 m[x,p] = \u03b5(p x).\n(cid:12) (cid:12)\n\u2264 \u00b7 \u2212\nZx\nBut\np p p\nL (f q) = L f L q,\n\u2212 \u2212\nZx Zx Zx\np\nL q = q(p x), and\n\u2212\nZx\np p x\nL f = L f L f\n\u2212\nZx Za Za\n= H(p) H(x).\n\u2212\nThus\nH(p) H(x) q(p x) \u03b5(p x);\n| \u2212 \u2212 \u2212 | \u2264 \u2212\ni.e.,\nH(p) H(x)\n\u2212 q \u03b5 (c < x < p).\np x \u2212 \u2264\n(cid:12) \u2212 (cid:12)\n(cid:12) (cid:12)\nHence (cid:12) (cid:12)\n\u2206H\nf(p) = q = lim = H\u2032 (p).\nx\u2192p\u2212 \u2206x \u2212\nIf f is right continuous at p [a,b), a similar formula results for H\u2032 (p). This\n\u2208 +\nproves clause (i).\n1This is true even in the stronger sense, as in Problem 2 of Chapter 5, 8, or in 2 (next\n\u00a7 \u00a7\nto this).\n2Recall that V [A] is the total variation of H on A (Chapter 5, 7\u20138).\nH\n\u00a7\u00a7\n3Part (ii) is true even if f is not L-integrable, only L b f < is needed.\na | | \u221e\nR 1. L-Integrals and Antiderivatives 359\n\u00a7\n(ii) Let \u03b5 > 0 be given. Then Theorem 6 in Chapter 8, 6, yields a \u03b4 > 0\n\u00a7\nsuch that\n(1) L f L f < \u03b5\n\u2264 | |\n(cid:12) ZX (cid:12) ZX\n(cid:12) (cid:12)\nwhenever (cid:12) (cid:12)\n(cid:12) (cid:12)\nmX < \u03b4 and A X, X .\n\u2287 \u2208 M\nHere we may set\nr\nX = A (disjoint)\ni\ni=1\n[\nfor some intervals\nA = (a ,b ) A\ni i i\n\u2286\nso that\nmX = mA = (b a ) < \u03b4.\ni i i\n\u2212\ni i\nX X\nThen (1) implies that\nbi\n\u03b5 > L f = L f L f = H(b ) H(a ) .\ni i\n| | | | \u2265 | \u2212 |\nZX i ZAi i (cid:12) Zai (cid:12) i\nX X(cid:12) (cid:12) X\nThus (cid:12) (cid:12)\n(cid:12) (cid:12)\nH(b ) H(a ) < \u03b5\ni i\n| \u2212 |\ni\nX\nwhenever\n(b a ) < \u03b4\ni i\n\u2212\ni\nX\nand\nA (a ,b ) (disjoint).\ni i\n\u2287\ni\n[\n(Thisiswhatwecall\u201cabsolute continuity in the stronger sense.\u201d) ByProblem2\nin Chapter 5, 8, this implies \u201cabsolute continuity\u201d in the sense of Chapter 5,\n\u00a7\n8, hence V [A] < . (cid:3)\nH\n\u00a7 \u221e\nNote 1. The converse to (i) fails: the differentiability of H at p does not\nimply the continuity of its derivative f at p (Problem 6 in Chapter 5, 2).\n\u00a7\nNote 2. If f is continuous on A Q (Q countable), Theorem 1 shows that\n\u2212\nH is a primitive (antiderivative): H = f on A.4 Recall that \u201cQ countable\u201d\nimplies mQ = 0, but not conversely. Observe that we may always assume\nR\na,b Q.\n\u2208\n4See Definition 1 in Chapter 5, 5.\n\u00a7 360 Chapter 9. Calculus Using Lebesgue Theory\nWe can now prove a generalizedversion of the so-calledfundamental theorem\nof calculus, widely used for computing integrals via antiderivatives.\nTheorem 2. If f: E1 E has a primitive F on A = [a,b], and if f is bounded\n\u2192\non A P for some P with mP = 0, then f is L-integrable on A, and\n\u2212\nx\n(2) L f = F(x) F(a) for all x A.\n\u2212 \u2208\nZa\nProof. By Definition 1 of Chapter 5, 5, F is relatively continuous and finite\n\u00a7\non A = [a,b], hence bounded on A (Theorem 2 in Chapter 4, 8).\n\u00a7\nIt is also differentiable, with F\u2032 = f, on A Q for a countable set Q A,\n\u2212 \u2286\nwith a,b Q. We fix this Q along with P.\n\u2208\nAs we deal with A only, we surely may redefine F and f on A:\n\u2212\nF(a) if x < a,\nF(x) =\nF(b) if x > b,\n(cid:26)\nand f = 0 on A. Then f is bounded on P, while F is bounded and\n\u2212 \u2212\ncontinuous on E1, and F\u2032 = f on Q; so F = f on E1.5\n\u2212\nAlso, for n = 1,2,... and t E1, set\n\u2208 R\n1 F(t+1/n) F(t)\n(3) f (t) = n F t+ F(t) = \u2212 .\nn\nn \u2212 1/n\nh (cid:16) (cid:17) i\nThen\nf F\u2032 = f on Q;\nn\n\u2192 \u2212\ni.e., f f (a.e.) on E1 (as mQ = 0).\nn\n\u2192\nBy (3), each f is bounded and continuous (as F is). Thus by Theorem 1\nn\nof Chapter 8, 3, F and all f are m-measurable on A (even on E1). So is f\nn\n\u00a7\nby Corollary 1 of Chapter 8, 3.\n\u00a7\nMoreover, by boundedness, F and f are L-integrable on finite intervals. So\nn\nis f. For example, let\nf K < on A P;\n| | \u2264 \u221e \u2212\nas mP = 0,\nf (K) = K mA < ,\n| | \u2264 \u00b7 \u221e\nZA ZA\nproving integrability. Now, as\n1\nF = f on any interval t,t+ ,\nn\nZ h i\n5See Definition 1 from Chapter 5, 5.\n\u00a7 1. L-Integrals and Antiderivatives 361\n\u00a7\nCorollary 1 in Chapter 5, 4 yields\n\u00a7\n1 1 K\n( t E1) F t+ F(t) sup F\u2032(t) .\n\u2200 \u2208 n \u2212 \u2264 | | n \u2264 n\nt\u2208\u2212Q\n(cid:12) (cid:16) (cid:17) (cid:12)\n(cid:12) (cid:12)\nHence (cid:12) (cid:12)\n1\nf (t) = n F t+ F(t) K;\nn\n| | n \u2212 \u2264\n(cid:12) (cid:16) (cid:17) (cid:12)\ni.e., f K for all n. (cid:12) (cid:12)\n| n | \u2264 (cid:12) (cid:12)\nThus f and f satisfy Theorem 5 of Chapter 8, 6, with g = K. By Note 1\nn\n\u00a7\nthere,\nx x\nlim L f = L f.\nn\nn\u2192\u221e\nZa Za\nIn the next lemma, we show that also\nx\nlim L f = F(x) F(a),\nn\nn\u2192\u221e \u2212\nZa\nwhich will complete the proof. (cid:3)\nLemma 1. Given a finite continuous F: E1 E and given f as in (3),\nn\n\u2192\nwe have\nx\n(4) lim L f = F(x) F(a) for all x E1.\nn\nn\u2192\u221e \u2212 \u2208\nZa\nProof. As before, F and f are bounded, continuous, and L-integrable on any\nn\n[a,x] or [x,a]. Fixing a, let\nx\nH(x) = L F, x E1.\n\u2208\nZa\nBy Theorem 1 and Note 2, H = F also in the sense of Chapter 5, 5, with\n\u00a7\nF = H\u2032 (derivative of H) on E1.\nR\nHence by Definition 2 the same section,\nx x\nF = H(x) H(a) = H(x) 0 = L F;\n\u2212 \u2212\nZa Za\ni.e.,\nx x\nL F = F,\nZa Za\nand so\nx x 1 x\nL f (t)dt = n F t+ dt n F(t)dt\nn\nn \u2212\nZa Za Za\n(cid:16) (cid:17)\nb+1/n x\n= n F(t)dt n F(t)dt.\n\u2212\nZa+1/n Za 362 Chapter 9. Calculus Using Lebesgue Theory\n(We computed\nF(t+1/n)dt\nZ\nby Theorem 2 in Chapter 5, 5, with g(t) = t+1/n.) Thus by additivity,\n\u00a7\nx x+1/n x x+1/n a+1/n\n(5) L f = n F n F = n F n F.\nn\n\u2212 \u2212\nZa Za+1/n Za Zx Za\nBut\nx+1/n H(x+ 1) H(x)\nn F = n \u2212 H\u2032(x) = F(x).\n1 \u2192\nZx n\nSimilarly,\na+1/n\nlim n F = F(a).\nn\u2192\u221e\nZa\nThis combined with (5) proves (4), and hence Theorem 2, too. (cid:3)\nWe also have the following corollary.\nCorollary 1. If f: E1 E\u2217(En, Cn) is R-integrable on A = [a,b], then\n\u2192\nx b\n(6) ( x A) R f = L f = F(x) F(a),\n\u2200 \u2208 \u2212\nZa Za\nprovided F is primitive to f on A.6\nThis follows from Theorem 2 by Definition (c) and Theorem 2 of Chap-\nter 8, 9.\n\u00a7\nCaution. Formulas (2) and (6) may fail if f is unbounded, or if F is not\na primitive in the sense of Definition 1 of Chapter 5, 5: We need F\u2032 = f\n\u00a7\non A Q, Q countable (mQ = 0 is not enough!). Even R-integrability (which\n\u2212\nmakes f bounded and a.e. continuous) does not suffice if\nF = f.\n6\nZ\nFor examples, see Problems 2\u20135.\nCorollary 2. If f is relatively continuous and finite on A = [a,b] and has a\nbounded derivative on A Q (Q countable), then f\u2032 is L-integrable on A and\n\u2212\nx\n(7) L f\u2032 = f(x) f(a) for x A.\n\u2212 \u2208\nZa\nThis is simply Theorem 2 with F,f,P replaced by f,f\u2032,Q, respectively.\n6We assumed that E =E (En, Cn) since R-integrals were defined for that case only.\n\u2217 1. L-Integrals and Antiderivatives 363\n\u00a7\nCorollary 3. If in Theorem 2 the primitive\nF = f\nZ\nis exact on some B A, then\n\u2286\nd x\n(8) f(x) = L f, x B.\ndx \u2208\nZa\n(Recall that d F(x) is classical notation for F\u2032(x).)\ndx\nProof. By (2), this holds on B A if F\u2032 = f there. (cid:3)\n\u2286\nII. Note that under the assumptions of Theorem 2,\nx x\nL f = F(x) F(a) = f.\n\u2212\nZa Za\nThus all laws governing the primitive f apply to L f. For example, Theo-\nrem 2 of Chapter 5, 5, yields the following corollary.\n\u00a7 R R\nCorollary 4 (change of variable). Let g: E1 E1 be relatively continuous on\n\u2192\nA = [a,b] and have a bounded derivative on A Q (Q countable).\n\u2212\nSuppose that f: E1 E (real or not) has a primitive on g[A], exact on\n\u2192\ng[A Q], and that f is bounded on g[A Q].\n\u2212 \u2212\nThen f is L-integrable on g[A], the function\n(f g)g\u2032\n\u25e6\nis L-integrable on A, and\nb q\n(9) L f(g(x))g\u2032(x)dx = L f(y)dy,\nZa Zp\nwhere p = g(a) and q = g(b).\nFor this and other applications of primitives, see Problem 9. However, often\na direct approach is stronger (though not simpler), as we illustrate next.\nLemma 2 (Bonnet). Suppose f: E1 E1 is 0 and monotonically decreas-\n\u2192 \u2265\ning on A = [a,b]. Then, if g: E1 E1 is L-integrable on A, so also is fg,\n\u2192\nand\nb c\n(10) L fg = f(a) L g for some c A.\n\u00b7 \u2208\nZa Za\nProof. TheL-integrability offg followsby Theorem 3inChapter8, 6, asf is\n\u00a7\nmonotoneandbounded,henceevenR-integrable (Corollary 3inChapter8, 9).\n\u00a7 364 Chapter 9. Calculus Using Lebesgue Theory\nUsing this and Lemma 1 of the same section, fix for each n a -partition\nC\n= A (i = 1,2,... ,q )\nn ni n\nP { }\nof A so that\nqn\n1\n(11) ( n) > S(f, ) S(f, ) = w mA ,\nn n ni ni\n\u2200 n P \u2212 P\ni=1\nX\nwhere we have set\nw = supf[A ] inff[A ].\nni ni ni\n\u2212\nConsider any such = A , i = 1,...,q (we drop the \u201cn\u201d for brevity). If\ni\nP { }\nA = [a ,a ], then since f ,\ni i\u22121 i\n\u2193\nw = f(a ) f(a ) f(x) f(a ) , x A .\ni i\u22121 i i\u22121 i\n\u2212 \u2265 | \u2212 | \u2208\nUnder Lebesgue measure (Problem 8 of Chapter 8, 9), we may set\n\u00a7\nA = [a ,a ] ( i)\ni i\u22121 i\n\u2200\nand still get\nq\nL fg = f(a )L g(x)dx\ni\u22121\nZA ZAi\ni=1\n(12) X\nq\n+ L [f(x) f(a )]g(x)dx.\ni\u22121\n\u2212\nZAi\ni=1\nX\n(Verify!) Here a = a and a = b.\n0 q\nNow, set\nx\nG(x) = L g\nZa\nand rewrite the first sum (call it r or r ) as\nn\nq\nr = f(a )[G(a ) G(a )]\ni\u22121 i i\u22121\n\u2212\ni=1\nX\nq\u22121\n= G(a )[f(a ) f(a )]+G(b)f(a ),\ni i\u22121 i q\u22121\n\u2212\ni=1\nX\nor\nq\u22121\n(13) r = G(a )w +G(b)f(a ),\ni i q\u22121\ni=1\nX\nbecause f(a ) f(a ) = w and G(a) = 0.\ni\u22121 i i\n\u2212\nNow, by Theorem 1 (with H,f replaced by G,g), G is continuous on A =\n[a,b]; so G attains a largest value K and a least value k on A. 1. L-Integrals and Antiderivatives 365\n\u00a7\nAs f and f 0 on A, we have\n\u2193 \u2265\nw 0 and f(a ) 0.\ni q\u22121\n\u2265 \u2265\nThus, replacing G(b) and G(a ) by K (or k) in (13) and noting that\ni\nq\u22121\nw = f(a) f(a ),\ni q\u22121\n\u2212\ni=1\nX\nwe obtain\nkf(a) r Kf(a);\n\u2264 \u2264\nmore fully, with k = minG[A] and K = maxG[A],\n(14) ( n) kf(a) r Kf(a).\nn\n\u2200 \u2264 \u2264\nNext, let s (or rather s ) be the second sum in (12). Noting that\nn\nw f(x) f(a ) ,\ni i\u22121\n\u2265 | \u2212 |\nsuppose first that g B (bounded) on A.\n| | \u2264\nThen for all n,\nqn qn\nB\ns L (w B) = B w mA < 0 (by (11)).\nn ni ni ni\n| | \u2264 n \u2192\nZAni\ni=1 i=1\nX X\nBut by (12),\nL fg = r +s ( n).\nn n\n\u2200\nZA\nAs s 0,\nn\n\u2192\nL fg = lim r ,\nn\nn\u2192\u221e\nZA\nand so by (14),\nkf(a) L fg Kf(a).\n\u2264 \u2264\nZA\nBy continuity, f(a)G(x) takes on the intermediate value L fg at some\nA\nc A; so\n\u2208 c R\nL fg = f(a)G(c) = f(a)L g,\nZA Za\nsince\nx\nG(x) = L f.\nZa\nThus all is proved for a bounded g.\nThe passage to an unbounded g is achieved by the so-called truncation\nmethod described in Problems 12 and 13. (Verify!) (cid:3) 366 Chapter 9. Calculus Using Lebesgue Theory\nCorollary 5 (second law of the mean). Let f: E1 E1 be monotone on\n\u2192\nA = [a,b]. Then if g: E1 E1 is L-integrable on A, so also is fg, and\n\u2192\nb c b\n(15) L fg = f(a)L g +f(b)L g for some c A.\n\u2208\nZa Za Zc\nProof. If, say, f on A, set\n\u2193\nh(x) = f(x) f(b).\n\u2212\nThen h 0 and h on A; so by Lemma 2,\n\u2265 \u2193\nb c\ngh = h(a)L g for some c A.\n\u2208\nZa Za\nAs\nh(a) = f(a) f(b),\n\u2212\nthis easily implies (15).\nIf f , apply this result to f to obtain (15) again. (cid:3)\n\u2191 \u2212\nNote 3. We may restate (15) as\nb c b\n( c A) L fg = pL g +qL g,\n\u2203 \u2208\nZa Za Zc\nprovided either\n(i) f and p f(a+) f(b ) q, or\n\u2191 \u2264 \u2264 \u2212 \u2264\n(ii) f and p f(a+) f(b ) q.\n\u2193 \u2265 \u2265 \u2212 \u2265\nThis statement slightly strengthens (15).\nTo prove clause (i), redefine\nf(a) = p and f(b) = q.\nThen still f ; so (15) applies and yields the desired result. Similarly for (ii).\n\u2191\nFor a continuous g, see also Problem 13(ii\u2032) in Chapter 8, 9, based on Stieltjes\n\u00a7\ntheory.\nIII. We now give a useful analogue to the notion of a primitive.\nDefinition.\nA map F: E1 E is called an L-primitive or an indefinite L-integral of\n\u2192\nf: E1 E, on A = [a,b] iff f is L-integrable on A and\n\u2192\nx\n(16) F(x) = c+L f\nZa\nfor all x A and some fixed finite c E.\n\u2208 \u2208 1. L-Integrals and Antiderivatives 367\n\u00a7\nNotation:\nF = L f not F = f\nZ (cid:18) Z (cid:19)\nor\nF(x) = L f(x)dx on A.\nZ\nBy (16), all L-primitives of f on A differ by finite constants only.\nIf E = E\u2217(En, Cn), one can use this concept to lift the boundedness re-\nstriction on f in Theorem 2 and the corollaries of this section. The proof will\nbe given in 2. However, for comparison, we state the main theorems already\n\u00a7\nnow.\n\u2217\nTheorem 3. Let\nF = L f on A = [a,b]\nZ\nfor some f: E1 E\u2217(En, Cn).\n\u2192\nThen F is differentiable, with\nF\u2032 = f a.e. on A.\nIn classical notation,\nd x\n(17) f(x) = L f(t)dt for almost all x A.\ndx \u2208\nZa\nAproofwas sketchedin Problem 6of Chapter8, 12. (Itis briefbutrequires\n\u00a7\nmore \u201cstarred\u201d material than used in 2.)\n\u00a7\n\u2217 Theorem 4. Let F: E1 En(Cn) be differentiable on A = [a,b] (at a and\n\u2192\nb differentiability may be one sided). Let F\u2032 = f be L-integrable on A.\nThen\nx\n(18) L f = F(x) F(a) for all x A.\n\u2212 \u2208\nZa\nProblems on L-Integrals and Antiderivatives\n1. Fill in proof details in Theorems 1 and 2, Lemma 1, and Corollaries 1\u20133.\n\u2032\n1 . Verify Note 2.\n2. Let F be Cantor\u2019s function (Problem 6 in Chapter 4, 5). Let\n\u00a7\nG = G\nki\nk,i\n[\n(G as in that problem). So [0,1] G = P (Cantor\u2019s set); mP = 0\nki\n\u2212\n(Problem 10 in Chapter 7, 8).\n\u00a7 368 Chapter 9. Calculus Using Lebesgue Theory\nShow that F is differentiable (F\u2032 = 0) on G. By Theorems 2 and 3\nof Chapter 8, 9,\n\u00a7\n1 1\nR F\u2032 = L F\u2032 = L F\u2032 = 0\nZ0 Z0 ZG\nexists, yet F(1) F(0) = 1 0 = 0.\n\u2212 \u2212 6\nDoes this contradict Corollary 1? Is F a genuine antiderivative of f?\nIf not, find one.\n3. Let\n0 on [0, 1), and\nF = 2\n1 on [1,1].\n(cid:26) 2\nShow that\n1\nR F\u2032 = 0\nZ0\nexists, yet\nF(1) F(0) = 1 0 = 1.\n\u2212 \u2212\nWhat is wrong?\n[Hint: A genuine primitive of F (call it \u03c6) has to be relatively continuous on [0,1];\n\u2032\nfind \u03c6 and show that \u03c6(1) \u03c6(0)=0.]\n\u2212\n4. What is wrong with the following computations?\n1 2 dx 1 21\n(i) L = = 1.\nZ\u22121 x2 \u2212x (cid:12)\u22121 \u2212\n1 dx (cid:12) (cid:12) 1\n(ii) L = ln x = 0. Is there a primitive on the whole\nintZ e\u2212 r1 val?x | | (cid:12)\u22121\n(cid:12)\n(cid:12)\n[Hint: See hint to Problem 3.]\n1 x\n(iii) How about L | | dx (cf. examples (a) and (b) of Chap-\nx\nZ\u22121\nter 5, 5)?\n\u00a7\n5. Let\n\u03c0\nF(x) = x2cos , F(0) = 1.\nx2\nProve the following:\n(i) F is differentiable on A = [0,1].\n(ii) f = F\u2032 is bounded on any [a,b] (0,1), but not on A.\n\u2282 1. L-Integrals and Antiderivatives 369\n\u00a7\n(iii) Let\n2 1\na = and b = for n = 1,2,....\nn n\n4n+1 \u221a2n\nr\nShow that\n\u221e\nA [a ,b ] (disjoint)\nn n\n\u2287\nn=1\n[\nand\nbn 1\nL f = ;\n2n\nZan\nso\nb \u221e 1\nL f L f = ,\nZa \u2265 ZS\u221e n=1[an,bn] \u2265 2n \u221e\nn=1\nX\nand f = F\u2032 is not L-integrable on A.\nWhat is wrong? Is there a contradiction to Theorem 2?\n6. Consider both\nsinx\n(a) f(x) = , f(0) = 1, and\nx\n1 e\u2212x\n(b) f(x) = \u2212 , f(0) = 1.\nx\nIn each case, show that f is continuous on A = [0,1] and\nR f 1\n\u2264\nZA\nexists, yet it does not \u201cwork out\u201d via primitives. What is wrong? Does\na primitive exist?\nTo use Corollary 1, first expand sinx and e\u2212x in a Taylor series and\nfind the series for\nf\nZ\nby Theorem 3 of Chapter 5, 9.\n\u00a7\nFind\nR f\nZA\napproximately, to within 1/10, using the remainder term of the series to\nestimate accuracy.\n[Hint: Primitives exist, by Theorem 2 of Chapter 5, 11, even though they are none\n\u00a7\nof the known \u201ccalculus functions.\u201d] 370 Chapter 9. Calculus Using Lebesgue Theory\n7. Take A, G = (a ,b ), and P (mP > 0) as in Problem 17(iii) of Chap-\nn n n\nter 7, 8.\n\u00a7\nDefine F = 0 on P and\n1\nF(x) = (x a )2(x b )2sin if x P.\nn n\n\u2212 \u2212 (b a )(x a )(x b ) 6\u2208\nn n n n\n\u2212 \u2212 \u2212\nProve that F has a bounded derivative f, yet f is not R-integrable on\nA; so Theorem 2 applies, but Corollary 1 does not.\n[Hints: If p P, compute F (p) as in calculus.\n\u2032\n6\u2208\nIf p P and x p+ over A P, then x is always in some (an,bn), p an <x.\n\u2208 \u2192 \u2212 \u2264\n(Why?) Deduce that \u2206x=x p>x an and\n\u2212 \u2212\n\u2206F\n(x an)(b a)2 \u2206x(b a)2;\n\u2206x \u2264 \u2212 \u2212 \u2264| | \u2212\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nso F +\u2032 (p)=0. (What(cid:12) (cid:12)if x \u2192(cid:12) (cid:12) p+ over P?) Similarly, show that F \u2212\u2032 =0 on P.\nProve however that F \u2032(x) oscillates from1 to 1 as x an+ or x bn , hence\n\u2212 \u2192 \u2192 \u2212\nalso as x p P (why?); so F is discontinuous on all of P, with mP > 0. Now\n\u2032\n\u2192 \u2208\nuse Theorem 3 in Chapter 8, 9.]\n\u00a7\n\u21d28. If\nQ A = [a,b]\n\u2286\nand mQ = 0, find a continuous map g: A E1, g 0, g , with\n\u2192 \u2265 \u2191\ng\u2032 = + on Q.\n\u221e\n[Hints: By Theorem 2 of Chapter 7, 8, fix ( n) an open Gn Q, with\n\u00a7 \u2200 \u2287\nmGn <2\u2212n.\nSet\ngn(x)=m(Gn [a,x])\n\u2229\nand\n\u221e\ng = gn\nn=1\nX\non A; gn converges uniformly on A. (Why?)\nBy PProblem 4 in Chapter 7, \u00a79, and Theorem 2 of Chapter 7, \u00a74, each gn (hence\ng) is continuous. (Why?) If [p,x] Gn, show that\n\u2286\ngn(x)=gn(p)+(x p),\n\u2212\nso\n\u2206gn\n=1\n\u2206x\nand\n\u2206g \u221e \u2206gn\n= .]\n\u2206x \u2206x \u2192\u221e\nn=1\nX 1. L-Integrals and Antiderivatives 371\n\u00a7\n9. (i) Prove Corollary 4.\n(ii) State and prove earlier analogues for Corollary 5 of Chapter 5, 5,\n\u00a7\nand Theorems 3 and 4 from Chapter 5, 10.\n\u00a7\n[Hint for(i): For primitives, this is Problem 3 in Chapter 5, 5. As g[Q]is countable\n\u00a7\n(Problem 2 in Chapter 1, 9) and f is bounded on\n\u00a7\ng[A] g[Q] g[A Q],\n\u2212 \u2286 \u2212\nf satisfies Theorem 2 on g[A], with P =g[Q], while (f g)g satisfies it on A.]\n\u2032\n\u25e6\n\u21d210. Show that if h: E1 E\u2217 is L-integrable on A = [a,b], and\n\u2192\nx\n( x A) L h = 0,\n\u2200 \u2208\nZa\nthen h = 0 a.e. on A.\n[Hints: Let K =A(h>0) and H =A K, with, say, mK =\u03b5>0.\n\u2212\nThen by Corollary 1 in Chapter 7, 1 and Definition 2 of Chapter 7, 5,\n\u00a7 \u00a7\nH Bn (disjoint)\n\u2286\nn\n[\nfor some intervals Bn A, with\n\u2286\nmBn <mH+\u03b5=mH+mK =mA.\nn\nX\n(Why?) Set B = nBn; so\nS\nh= h=0\nZB n ZBn\nX\n(for L h=0 on intervals Bn). Thus\nR\nh= h h=0.\n\u2212\nZA \u2212B ZA ZB\nBut B H; so\n\u2287\nA B A H =K,\n\u2212 \u2286 \u2212\nwhere h>0, even though m(A B)>0. (Why?)\n\u2212\nHence find a contradiction to Theorem 1(h) of Chapter 8, 5. Similarly, disprove\n\u00a7\nthat mA(h<0)=\u03b5>0.]\n\u21d211. Let F on A = [a,b], F < , with derived function F\u2032 = f. Taking\n\u2191 | | \u221e\nTheorem 3 from Chapter 7, 10, for granted, prove that\n\u00a7\nx\nL f F(x) F(a), x A.\n\u2264 \u2212 \u2208\nZa\n[Hints: Withfn asin(3),F andfn areboundedonAandmeasurablebyTheorem 1\nof Chapter 8, 2. (Why?) Deduce that fn f (a.e.) on A. Argue as in Lemma 1\n\u00a7 \u2192\nusing Fatou\u2019s lemma (Chapter 8, 6, Lemma 2).]\n\u00a7 372 Chapter 9. Calculus Using Lebesgue Theory\n12. (\u201cTruncation.\u201d) Prove that if g: S E is m-integrable on A\n\u2192 \u2208 M\nin a measure space (S, ,m), then for any \u03b5 > 0, there is a bounded,\nM\n-measurable and integrable on A map g : S E such that\n0\nM \u2192\ng g dm < \u03b5.\n0\n| \u2212 |\nZA\n[Outline: Redefine g = 0 on a null set, to make g -measurable on A. Then for\nM\nn=1,2,... set\ng on A(g <n), and\ngn = | |\n( 0 elsewhere.\n(The function gn is called the nth truncate of g.)\nEach gn is bounded and -measurable on A (why?), and\nM\ng dm<\n| | \u221e\nZA\nby integrability. Also, gn g and gn g (pointwise) on A. (Why?)\n| |\u2264| | \u2192\nNow use Theorem 5 from Chapter 8, 6, to show that one of the gn may serve as\n\u00a7\nthe desired go.]\n13. Fill in all proof details in Lemma 2. Prove it for unbounded g.\n[Hints: By Problem 12, fix a bounded go (go B), with\n| |\u2264\n1 \u03b5\nL g go < .\n| \u2212 | 2f(a) f(b)\nZA\n\u2212\nVerify that\nqn\nsn wni g wni go + wni g go\n| |\u2264 | |\u2264 | | | \u2212 |\ni=1ZAni i ZAni i ZAni\nX X X\nB wnimAni+ [f(a) f(b)] g go\n\u2264 \u2212 | \u2212 |\ni i ZAni\nX X\n1 1 1\n< + [f(a) f(b)] g go < + \u03b5.\nn \u2212 | \u2212 | n 2\nZA\nFor all n > 2/\u03b5, we get |sn < 1 2\u03b5+ 21\u03b5 = \u03b5. Hence sn 0. Now finish as in the\n| \u2192\ntext.]\n14. Show that Theorem 4 fails if F is not differentiable at some p A.\n\u2208\n[Hint: See Problems 2 and 3.]\n\u00a72. More on L-Integrals and Absolute Continuity\nI. In this section, we presuppose the \u201cstarred\u201d 10 in Chapter 7. First, how-\n\u00a7\never, we add some new ideas that do not require any starred material. The\nnotation is as in 1.\n\u00a7 2. More on L-Integrals and Absolute Continuity 373\n\u00a7\nDefinition 1.\nGiven F: E1 E, p E1, and q E, we write\n\u2192 \u2208 \u2208\nq DF(p)\n\u223c\nand call q an F-derivate at p iff\nF(x ) F(p)\nk\nq = lim \u2212\nk\u2192\u221e x k p\n\u2212\nfor at least one sequence x p (x = p).1\nk k\n\u2192 6\nIf F has a derivative at p, it is the only F-derivate at p; otherwise,\nthere may be many derivates at p (finite or not).\nSuch derivates must exist if E = E1(E\u2217). Indeed, given any p E1, let\n\u2208\n1\nx = p+ p;\nk\nk \u2192\nlet\nF(x ) F(p)\nk\ny = \u2212 , k = 1,2,...\nk\nx p\nk\n\u2212\nBy the compactness of E\u2217 (Chapter 4, 6, example (d)), y must have a\nk\n\u00a7 { }\nsubsequence y with a limit q E\u2217 (e.g.,takeq = limy ),andsoq DF(p).\nki} k\n{ \u2208 \u223c\nWe also obtain the following lemma.\nLemma 1. If F : E1 E\u2217 has no negative derivates on A Q, where A =\n\u2192 \u2212\n[a,b] and mQ = 0, and if no derivate of F on A equals , then F on A.\n\u2212\u221e \u2191\nProof. First, suppose F has no negative derivates on A at all. Fix \u03b5 > 0\nand set\nG(x) = F(x)+\u03b5x.\nSeeking a contradiction, suppose a p < q b, yet G(q) < G(p). Then if\n\u2264 \u2264\n1\nr = (p+q),\n2\none of the intervals [p,r] and [r,q] (call it [p ,q ]) satisfies G(q ) < G(p ).\n1 1 1 1\nLet\n1\nr = (p +q ).\n1 1 1\n2\nAgain, one of [p ,r ] and [r ,q ] (call it [p ,q ]) satisfies G(q ) < G(p ). Let\n1 1 1 1 2 2 2 2\n1\nr = (p +q ),\n2 2 2\n2\nand so on.\n1\u201cDF(p)\u201d stands for \u201can F-derivate at p.\u201d 374 Chapter 9. Calculus Using Lebesgue Theory\nThus obtain contracting intervals [p ,q ], with\nn n\nG(q ) < G(p ), n = 1,2,....\nn n\nNow, by Theorem 5 of Chapter 4, 6, let\n\u00a7\n\u221e\np [p ,q ].\no n n\n\u2208\nn=1\n\\\nThen set x = q if G(q ) < G(p ), and x = p otherwise. Then\nn n n o n n\nG(x ) G(p )\nn o\n\u2212 < 0\nx p\nn o\n\u2212\nand x p . By the compactness of E\u2217, fix a subsequence\nn o\n\u2192\nG(x ) G(p )\nnk \u2212 o c E\u2217,\nx p \u2192 \u2208\nnk o\n\u2212\nsay. Then c 0 is a G-derivate at p A.\no\n\u2264 \u2208\nBut this is impossible; for by our choice of G and our assumption, all\nderivates of G are > 0. (Why?)\nThis contradiction shows that a p < q b implies G(p) G(q), i.e.,\n\u2264 \u2264 \u2264\nF(p)+\u03b5p F(q)+\u03b5q.\n\u2264\nMaking \u03b5 0, we obtain F(p) F(q) when a p < q b, i.e., F on A.\n\u2192 \u2264 \u2264 \u2264 \u2191\nNow, for the general case, let Q be the set of all p A that have at least\n\u2208\none DF(p) < 0; so mQ = 0.\nLet g be as in Problem 8 of 1; so g\u2032 = on Q. Given \u03b5 > 0, set\n\u00a7 \u221e\nG = F +\u03b5g.\nAs g , we have\n\u2191\nG(x) G(p) F(x) F(p)\n( x,p A) \u2212 \u2212 .\n\u2200 \u2208 x p \u2265 x p\n\u2212 \u2212\nHence DG(p) 0 if p Q.\n\u2265 6\u2208\nIf, however, p Q, then g\u2032(p) = implies DG(p) 0. (Why?) Thus all\n\u2208 \u221e \u2265\nDG(p) are 0; so by what was proved above, G on A. It follows, as before,\n\u2265 \u2191\nthat F on A, also. The lemma is proved. (cid:3)\n\u2191\nWe now proceed to prove Theorems 3 and 4 of 1. To do this, we shall need\n\u00a7\nonly one \u201cstarred\u201d theorem (Theorem 3 of Chapter 7, 10).\n\u00a7\nProof of Theorem 3 of \u00a71. (1) First, let f be bounded:\nf K on A.\n| | \u2264 2. More on L-Integrals and Absolute Continuity 375\n\u00a7\nVia components and by Corollary 1 of Chapter 8, 6, all reduces to the real\n\u00a7\npositive case f 0 on A. (Explain!)\n\u2265\nThen (Theorem 1(f) of Chapter 8, 5) a x < y b implies\n\u00a7 \u2264 \u2264\nx y\nL f L f,\n\u2264\nZa Za\ni.e., F(x) F(y); so F and F\u2032 0 on A.\n\u2264 \u2191 \u2265\nNow, by Theorem 3 of Chapter 7, 10, F is a.e. differentiable on A. Thus\n\u00a7\nexactly as in Theorem 2 in 1, we set\n\u00a7\nF(t+ 1) F(t)\nf (t) = n \u2212 F\u2032(t) a.e.\nn 1 \u2192\nn\nSince all f are m-measurable on A (why?), so is F\u2032. Moreover, as f K,\nn\n| | \u2264\nwe obtain (as in Lemma 1 of 1)\n\u00a7\nx+1/n K\nf (x) = n L f n = K.\nn\n| | \u2264 \u00b7 n\n(cid:18) Zx (cid:19)\nThus by Theorem 5 from Chapter 8, 6 (with g = K),\n\u00a7\nx x x\nL F\u2032 = lim L f = L f\nn\nn\u2192\u221e\nZa Za Za\n(Lemma 1 of 1). Hence\n\u00a7\nx\nL (F\u2032 f) = 0, x A,\n\u2212 \u2208\nZa\nand so (Problem 10 in 1) F\u2032 = f (a.e.) as claimed.\n\u00a7\n(2)Iff isnotbounded,westillcanreducealltothecasef 0, f: E1 E\u2217,\n\u2265 \u2192\nso that F and F\u2032 0 on A.\n\u2191 \u2265\nIf so, we use \u201ctruncation\u201d: For n = 1,2,..., set\nf on A(f n), and\ng = \u2264\nn\n0 elsewhere.\n(cid:26)\nThen (see Problem 12 in 1) the g are L-measurable and bounded, hence L-\nn\n\u00a7\nintegrable on A, with g f and\nn\n\u2192\n0 g f\nn\n\u2264 \u2264\non A. By the first part of the proof, then,\nd x\nL g = g a.e. on A, n = 1,2,....\nn n\ndx\nZa 376 Chapter 9. Calculus Using Lebesgue Theory\nAlso, set ( n)\n\u2200 x\nF (x) = L (f g ) 0;\nn n\n\u2212 \u2265\nZa\nso F is monotone ( ) on A. (Why?)\nn\n\u2191\nThus by Theorem 3 in Chapter 7, 10, each F has a derivative at almost\nn\n\u00a7\nevery x A,\n\u2208\nd x x\nF\u2032(x) = L f L g = F\u2032(x) g (x) 0 a.e. on A.\nn dx \u2212 n \u2212 n \u2265\n(cid:18) Za Za (cid:19)\nMaking n and recalling that g f on A, we obtain\nn\n\u2192 \u221e \u2192\nF\u2032(x) f(x) 0 a.e. on A.\n\u2212 \u2265\nThus\nx\nL (F\u2032 f) 0.\n\u2212 \u2265\nZa\nBut as F (see above), Problem 11 of 1 yields\n\u2191 \u00a7\nx x\nL F\u2032 F(x) F(a) = L f;\n\u2264 \u2212\nZa Za\nso\nx x x\nL (F\u2032 f) = L F\u2032 L f 0.\n\u2212 \u2212 \u2264\nZa Za Za\nCombining, we get\nx\n( x A) L (F\u2032 f) = 0;\n\u2200 \u2208 \u2212\nZa\nso by Problem 10 of 1, F\u2032 = f a.e. on A, as required. (cid:3)\n\u00a7\nProof of Theorem 4 of \u00a71. Via components, all again reduces to a real f.2\nLet ( n)\n\u2200\nf on A(f n),\ng = \u2264\nn\n0 on A(f > n);\n(cid:26)\nso g f (pointwise), g f, g n, and g f .\nn n n n\n\u2192 \u2264 \u2264 | | \u2264 | |\nThis makes each g L-integrable on A. Thus as before, by Theorem 5 of\nn\nChapter 8, 6,\n\u00a7\nx x\n(1) lim L g = L f, x A.\nn\nn\u2192\u221e \u2208\nZa Za\nNow, set\nx\nF (x) = F(x) L g .\nn n\n\u2212\nZa\n2Not f 0, though, since Corollary 1 in Chapter 8, 6, does not apply to differentiation.\n\u2265 \u00a7 2. More on L-Integrals and Absolute Continuity 377\n\u00a7\nThen by Theorem 3 of 1 (already proved),\n\u00a7\nd x\nF\u2032(x) = F\u2032(x) L g = f(x) g (x) 0 a.e. on A\nn \u2212 dx n \u2212 n \u2265\nZa\n(since g f).\nn\n\u2264\nThus F has solely nonnegative derivates on A Q (mQ = 0). Also, as\nn\n\u2212\ng n, we get\nn\n\u2264 1 x\nL g n,\nn\nx p \u2264\nZa\n\u2212\neven if x < p. (Why?) Hence\n\u2206F \u2206F\nn\nn,\n\u2206x \u2265 \u2206x \u2212\nas\nx\nF (x) = F(x) L g .\nn n\n\u2212\nZa\nThus none of the F -derivates on A can be .\nn\n\u2212\u221e\nBy Lemma 1, then, F is monotone ( ) on A; so F (x) F (a), i.e.,\nn n n\n\u2191 \u2265\nx a\nF(x) L g F(a) L g = F(a),\nn n\n\u2212 \u2265 \u2212\nZa Za\nor\nx\nF(x) F(a) L g , x A, n = 1,2,....\nn\n\u2212 \u2265 \u2208\nZa\nHence by (1),\nx\nF(x) F(a) L f, x A.\n\u2212 \u2265 \u2208\nZa\nFor the reverse inequality, apply the same formula to f. Thus we obtain the\n\u2212\ndesired result:\nx\n(2) F(x) = F(a)+L f for x A. (cid:3)\n\u2208\nZa\nNote 1. Formula (2) is equivalent to F = L f on A (see the last part of\n1). For if (2) holds, then\n\u00a7 x R\nF(x) = c+L f,\nZa\nwith c = F(a); so F = L f by definition.\nConversely, if\nR\nx\nF(x) = c+L f,\nZa\nset x = a to find c = F(a). 378 Chapter 9. Calculus Using Lebesgue Theory\nII. Absolute continuity redefined.\nDefinition 2.\nA map f: E1 E is absolutely continuous on an interval I E1 iff for\n\u2192 \u2286\nevery \u03b5 > 0, there is \u03b4 > 0 such that\nr r\n(b a ) < \u03b4 implies f(b ) f(a ) < \u03b5\ni i i i\n\u2212 | \u2212 |\ni=1 i=1\nX X\nfor any disjoint intervals (a ,b ), with a ,b I.\ni i i i\n\u2208\nFrom now on, this replaces the \u201cweaker\u201d definition given in Chapter 5, 8.\n\u00a7\nThe reader will easily verify the next three \u201croutine\u201d propositions.\nTheorem 1. If f,g,h: E1 E\u2217(C) are absolutely continuous on A = [a,b],\n\u2192\nso are\nf g, hf, and f .\n\u00b1 | |\nSo also is f/h if\n( \u03b5 > 0) h \u03b5 on A.\n\u2203 | | \u2265\nAll this also holds if f,g: E1 E are vector valued and h is scalar valued.\n\u2192\nFinally, if E E\u2217, then\n\u2286\nf g, f g, f+, and f\u2212\n\u2228 \u2227\nare absolutely continuous along with f and g.\nCorollary 1. A function F: E1 En(Cn) is absolutely continuous on A =\n\u2192\n[a,b] iff all its components F ,...,F are.\n1 n\nHence a complex function F: E1 C is absolutely continuous iff its real\n\u2192\nand imaginary parts, F and F , are.\nre im\nCorollary 2. If f: E1 E is absolutely continuous on A = [a,b], it is\n\u2192\nbounded, is uniformly continuous, and has bounded variation, V [a,b] < ,\nf\n\u221e\nall on A.\nLemma 2. If F: E1 En(Cn) is of bounded variation on A = [a,b], then\n\u2192\n(i) F is a.e. differentiable on A, and\n(ii) F\u2032 is L-integrable on A.\nProof. Via components (Theorem 4 of Chapter 5, 7), all reduces to the real\n\u00a7\ncase, F: E1 E1.\n\u2192\nThen since V [A] < , we have\nF\n\u221e\nF = g h\n\u2212\nfor some nondecreasing g and h (Theorem 3 in Chapter 5, 7).\n\u00a7 2. More on L-Integrals and Absolute Continuity 379\n\u00a7\nNow, by Theorem 3 from Chapter 7, 10, g and h are a.e. differentiable on\n\u00a7\nA. Hence so is\ng h = F.\n\u2212\nMoreover, g\u2032 0 and h\u2032 0 since g and h .\n\u2265 \u2265 \u2191 \u2191\nThus for the L-integrability of F\u2032, proceed as in Problem 11 in 1, i.e., show\n\u00a7\nthat F\u2032 is measurable on A and that\nb b b\nL F\u2032 = L g\u2032 L h\u2032\n\u2212\nZa Za Za\nis finite. This yields the result. (cid:3)\nTheorem 2 (Lebesgue). If F: E1 En(Cn) is absolutely continuous on\n\u2192\nA = [a,b], then the following are true:\n(i\u2217) F is a.e. differentiable, and F\u2032 is L-integrable, on A.\n(ii\u2217) If, in addition, F\u2032 = 0 a.e. on A, then F is constant on A.\nProof. Assertion (i\u2217) is immediate from Lemma 2, since any absolutely con-\ntinuous function is of bounded variation by Corollary 2.\n(ii\u2217) Now let F\u2032 = 0 a.e. on A. Fix any\nB = [a,c] A\n\u2286\nand let Z consist of all p B at which the derivative F\u2032 = 0.\n\u2208\nGiven \u03b5 > 0, let be the set of all closed intervals [p,x], p < x, such that\nK\n\u2206F F(x) F(p)\n= \u2212 < \u03b5.\n\u2206x x p\n(cid:12) (cid:12) (cid:12) \u2212 (cid:12)\nBy assumption, (cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n\u2206F\nlim = 0 (p Z),\nx\u2192p \u2206x \u2208\nand m(B Z) = 0; B = [a,c] \u2217. If p Z, and x p is small enough, then\n\u2212 \u2208 M \u2208 \u2212\n\u2206F\n< \u03b5,\n\u2206x\n(cid:12) (cid:12)\ni.e., [p,x] . (cid:12) (cid:12)\n\u2208 K (cid:12) (cid:12)\nIt easily follows that covers Z in the Vitali sense (verify!); so for any\nK\n\u03b4 > 0, Theorem 2 of Chapter 7, 10 yields disjoint intervals\n\u00a7\nI = [p ,x ] , I B,\nk k k k\n\u2208 K \u2286\nwith\nq\nm\u2217 Z I < \u03b4,\nk\n\u2212\n(cid:18) k=1 (cid:19)\n[ 380 Chapter 9. Calculus Using Lebesgue Theory\nhence also\nq\nm B I < \u03b4\nk\n\u2212\n(cid:18) k=1 (cid:19)\n[\n(for m(B Z) = 0). But\n\u2212\nq q\u22121\nB I = [a,c] [p ,x ]\nk k k\n\u2212 \u2212\nk=1 k=1\n[ [\nq\u22121\n= [a,p ) [x ,p ) [x ,c] (if x < p < x );\n1 k k+1 q k k k+1\n\u222a \u222a\nk=1\n[\nso\nq q\u22121\n(3) m B I = (p a)+ (p x )+(c x ) < \u03b4.\nk 1 k+1 k q\n\u2212 \u2212 \u2212 \u2212\n(cid:18) k=1 (cid:19) k=1\n[ X\nNow, as F is absolutely continuous, we can choose \u03b4 > 0 so that (3) implies\nq\u22121\n(4) F(p ) F(a) + F(p ) F(x ) + F(c) F(x ) < \u03b5.\n1 k+1 k q\n| \u2212 | | \u2212 | | \u2212 |\nk=1\nX\nBut I also implies\nk\n\u2208 K\nF(x ) F(p ) < \u03b5(x p ) = \u03b5 mI .\nk k k k k\n| \u2212 | \u2212 \u00b7\nHence\nq q\n[F(x ) F(p )] < \u03b5 mI \u03b5 mB = \u03b5(c p).\nk k k\n\u2212 \u2264 \u00b7 \u2212\n(cid:12)k=1 (cid:12) k=1\n(cid:12)X (cid:12) X\n(cid:12) (cid:12)\nCombinin(cid:12)g with (4), we get (cid:12)\nF(c) F(a) \u03b5(1+c a) 0 as \u03b5 0;\n| \u2212 | \u2264 \u2212 \u2192 \u2192\nso F(c) = F(a). As c A was arbitrary, F is constant on A, as claimed. (cid:3)\n\u2208\nNote 2. This shows that Cantor\u2019s function (Problem 6 of Chapter 4, 5) is\n\u00a7\nnot absolutely continuous, even though it is continuous and monotone, hence\nof bounded variation on [0,1]. Indeed (see Problem 2 in 1), it has a zero\n\u00a7\nderivative a.e. on [0,1] but is not constant there. Thus absolute continuity, as\nnow defined, differs from its \u201cweak\u201d counterpart (Chapter 5, 8).\n\u00a7\nTheorem 3. A map F : E1 E1(Cn) is absolutely continuous on A =\n\u2192\n[a,b] iff\nF = L f on A\nZ 2. More on L-Integrals and Absolute Continuity 381\n\u00a7\nfor some function f;3 and then\nx\nF(x) = F(a)+L f, x A.\n\u2208\nZa\nBriefly: Absolutely continuous maps are exactly all L-primitives.\nProof. If F = L f, then by Theorem 1 of 1, F is absolutely continuous on\n\u00a7\nA, and by Note 1,\nR x\nF(x) = F(a)+L f, x A.\n\u2208\nZa\nConversely, if F is absolutely continuous, then by Theorem 2, it is a.e. dif-\nferentiable and F\u2032 = f is L-integrable (all on A). Let\nx\nH(x) = L f, x A.\n\u2208\nZa\nThen H, too, is absolutely continuous and so is F H. Also, by Theorem 3\n\u2212\nof 1,\n\u00a7\nH\u2032 = f = F\u2032,\nand so\n(F H)\u2032 = 0 a.e. on A.\n\u2212\nBy Theorem 2, F H = c; i.e.,\n\u2212\nx\nF(x) = c+H(x) = c+L f,\nZa\nand so F = L f on A, as claimed. (cid:3)\nCorollary 3.RIf f,F : E1 E\u2217(En, Cn), we have\n\u2192\nF = L f\nZ\non an interval I E1 iff F is absolutely continuous on I and F\u2032 = f a.e. on I.\n\u2286\n(Use Problem 3 in 1 and Theorem 3.)\n\u00a7\nNote 3. This (or Theorem 3) could serve as a definition. Comparing ordi-\nnary primitives\nF = f\nZ\nwith L-primitives\nF = L f,\nZ\n3Such as F , the derived function of F.\n\u2032 382 Chapter 9. Calculus Using Lebesgue Theory\nwe see that the former require F to be just relatively continuous but allow only\na countable \u201cexceptional\u201d set Q, while the latter require absolute continuity\nbut allow Q to even be uncountable, provided mQ = 0.\nThe simplest and \u201cstrongest\u201d kind of absolutely continuous functions are\nso-called Lipschitz maps (see Problem 6). See also Problems 7 and 10.\nIII. We conclude with another important idea, due to Lebesgue.\nDefinition 3.\nWe call p E1 a Lebesgue point (\u201cL-point\u201d) of f: E1 E iff\n\u2208 \u2192\n(i) f is L-integrable on some G (\u03b4);\np\n(ii) q = f(p) is finite; and\n1 x\n(iii) lim L f q = 0.\nx\u2192p x p | \u2212 |\nZp\n\u2212\nThe Lebesgue set of f consists of all such p.\nCorollary 4. Let\nF = L f on A = [a,b].\nZ\nIf p A is an L-point of f, then f(p) is the derivative of F at p (but the\n\u2208\nconverse fails).\nProof. By assumption,\nx\nF(x) = c+L f, x G (\u03b4),\np\n\u2208\nZp\nand\n1 x 1 x\nL (f q) L f q 0\n\u2206x \u2212 \u2264 \u2206x | \u2212 | \u2192\n| | (cid:12) Zp (cid:12) | | Zp\n(cid:12) (cid:12)\nas x p. (Here q = f(cid:12)(p) and \u2206x =(cid:12) x p.)\n\u2192 (cid:12) (cid:12) \u2212\nThus with x p, we get\n\u2192\nF(x) F(p) 1 x\n\u2212 q = L f (x p)q\nx p \u2212 x p \u2212 \u2212\n(cid:12) \u2212 (cid:12) | \u2212 | (cid:12) Zp (cid:12)\n(cid:12) (cid:12) 1 (cid:12) (cid:12) x x (cid:12) (cid:12)\n(cid:12) (cid:12) = (cid:12)L f L (q)(cid:12) 0,\nx p \u2212 \u2192\n| \u2212 | (cid:12) Zp Zp (cid:12)\n(cid:12) (cid:12)\nas required. (cid:3) (cid:12) (cid:12)\n(cid:12) (cid:12)\nCorollary 5. Let f: E1 En(Cn). Then p is an L-point of f iff it is an\n\u2192\nL-point for each of the n components, f ,...,f , of f.\n1 n\n(Exercise!) 2. More on L-Integrals and Absolute Continuity 383\n\u00a7\nTheorem 4. If f: E1 E\u2217(En, Cn) is L-integrable on A = [a,b], then\n\u2192\nalmost all p A are Lebesgue points of f.\n\u2208\nNote that this strengthens Theorem 3 of 1.\n\u00a7\nProof. By Corollary 5, we need only consider the case f: E1 E\u2217.\n\u2192\nFor any r E1, f r is L-integrable on A; so by Theorem 3 of 1, setting\n\u2208 | \u2212 | \u00a7\nx\nF (x) = L f r ,\nr\n| \u2212 |\nZa\nwe get\n1 x\n(5) F\u2032(p) = lim L f r = f(p) r\nr x\u2192p x p | \u2212 | | \u2212 |\nZp\n| \u2212 |\nfor almost all p A.\n\u2208\nNow, for each r, let A be the set of those p A for which (5) fails; so\nr\n\u2208\nmA = 0. Let r be the sequence of all rationals in E1. Let\nr k\n{ }\n\u221e\nQ = A a,b A ,\nrk \u221e\n\u222a{ }\u222a\nk=1\n[\nwhere\nA = A( f = );\n\u221e\n| | \u221e\nso mQ = 0. (Why?)\nTo finish, we show that all p A Q are L-points of f. Indeed, fix any\n\u2208 \u2212\np A Q and any \u03b5 > 0. Let q = f(p). Fix a rational r such that\n\u2208 \u2212\n\u03b5\nq r < .\n| \u2212 | 3\nThen\n\u03b5\nf r f q (f r) (f q) = q r < on A A .\n\u221e\n| \u2212 |\u2212| \u2212 | \u2264 \u2212 \u2212 \u2212 | \u2212 | 3 \u2212\n(cid:12) (cid:12) (cid:12) (cid:12)\nHence as mA = 0, we have\n(cid:12) \u221e (cid:12) (cid:12) (cid:12)\nx x x \u03b5 \u03b5\n(6) L f r L f q L = x p .\n| \u2212 |\u2212 | \u2212 | \u2264 3 3| \u2212 |\n(cid:12) Zp Zp (cid:12) Zp\n(cid:16) (cid:17)\n(cid:12) (cid:12)\nSince (cid:12) (cid:12)\n(cid:12) (cid:12)\np Q A ,\nrk\n6\u2208 \u2287\nk\n[\nformula (5) applies. So there is \u03b4 > 0 such that x p < \u03b4 implies\n| \u2212 |\n1 x \u03b5\nL f r f(p) r < .\nx p | \u2212 | \u2212| \u2212 | 3\n(cid:12)(cid:18)| \u2212 | Zp (cid:19) (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12) 384 Chapter 9. Calculus Using Lebesgue Theory\nAs\n\u03b5\nf(p) r = q r < ,\n| \u2212 | | \u2212 | 3\nwe get\n1 x 1 x\nL f r L f r q r + q r\nx p | \u2212 | \u2264 x p | \u2212 | \u2212| \u2212 | | \u2212 |\n| \u2212 | Zp (cid:12)(cid:18)| \u2212 | Zp (cid:19) (cid:12)\n(cid:12)\u03b5 \u03b5 2\u03b5 (cid:12)\n(cid:12) (cid:12)\n< + = .\n(cid:12) (cid:12)\n3 3 3\nHence\nx 2\u03b5\nL f r < x p .\n| \u2212 | 3 | \u2212 |\nZp\nCombining with (6), we have\n1 x \u03b5 2\u03b5\nL f q < + = \u03b5\nx p | \u2212 | 3 3\nZp\n| \u2212 |\nwhenever x p < \u03b4. Thus\n| \u2212 |\n1 x\nlim L f q = 0,\nx\u2192p x p | \u2212 |\nZp\n| \u2212 |\nas required. (cid:3)\nProblems on L-Integrals and Absolute Continuity\n1. Fill in all details in the proof of Lemma 1 and of Theorems 3 and 4\nfrom 1.\n\u00a7\n2. Prove Theorem 1 and Corollaries 1, 2, and 5.\n\u2032\n2 . Disprove the converse to Corollary 4. (Give an example!)\n\u21d23. Show that if F: E1 E is L-integrable on A = [a,b] and continuous at\n\u2192\np A, then p is an L-point of F.\n\u2208\n[Hint: Use the \u03b5,\u03b4 definition of continuity.]\n4. Complete all proof details for Lemma 2, Theorems 3 and 4, and Corol-\nlary 3.\n5. Let F = 1 on R (= rationals) and F = 0 on E1 R (Dirichlet function).\n\u2212\nShow that F has exactly three derivates (0, + , and ) at every\n\u221e \u2212\u221e\np E1.\n\u2208\n\u21d26. We say that F is a Lipschitz map, or has the uniform Lipschitz property\non A, iff\n( K E1) ( x,y A) F(x) F(y) K x y .\n\u2203 \u2208 \u2200 \u2208 | \u2212 | \u2264 | \u2212 | 2. More on L-Integrals and Absolute Continuity 385\n\u00a7\nProve the following:\n(i) Any such F is absolutely continuous on A = [a,b].\n(ii) If all derivates of f satisfy\nDf(x) k < , x A = [a,b],\n| | \u2264 \u221e \u2208\nthen f is a Lipschitz map on A.\n\u21d27. Let g: E1 E1 and f: E1 E (real or not) be absolutely continuous\n\u2192 \u2192\non A = [a,b] and g[A], respectively.\nProve that h = f g is absolutely continuous on A, provided that\n\u25e6\neither f is as in Problem 6, or g is strictly monotone on A.\n8. Prove that if F: E1 E1 is absolutely continuous on A = [a,b], if\n\u2192\nQ A, and if mQ = 0, then m\u2217F[Q] = 0 (m = Lebesgue measure).\n\u2286\n[Outline: We may assume Q (a,b). (Why?)\n\u2286\nFix \u03b5>0 and take \u03b4 as in Definition 2. As m is regular, there is an open G,\nQ G (a,b),\n\u2286 \u2286\nwith mG<\u03b4. By Lemma 2 of Chapter 7, 2,\n\u00a7\n\u221e\nG= I (disjoint)\nk\nk=1\n[\nfor some I =(a ,b ].\nk k k\nLet u =infF[I ], v =supF[I ]; so\nk k k k\nF[I ] [u ,v ]\nk k k\n\u2286\nand\nm\u2217F[I k] v u k.\nk\n\u2264 \u2212\nAlso,\n(b a )= mI =mG<\u03b4.\nk k k\n\u2212\nX X\nFrom Definition 2, show that\n\u221e\n(v u ) \u03b5\nk k\n\u2212 \u2264\nk=1\nX\n(first consider partial sums). As\nF[Q] F[G] F[I ],\nk\n\u2286 \u2286\nk\n[\nget\nm\u2217F[Q] m\u2217F[I k]= (v u k) \u03b5 0.]\nk\n\u2264 \u2212 \u2264 \u2192\nk k\nX X 386 Chapter 9. Calculus Using Lebesgue Theory\n9. Show that if F is as in Problem 8 and if\nA = [a,b] B, B \u2217\n\u2287 \u2208 M\n(L-measurable sets), then\nF[B] \u2217.\n\u2208 M\n(\u201cF preserves \u2217-sets.\u201d)\nM\n[Outline: (i) If B is closed, it is compact, and so is F[B] (Theorems 1 and 4 of\nChapter 4, 6).\n\u00a7\n(ii) If B \u03c3, then\n\u2208F\nB = Bi, Bi ;\n\u2208F\ni\n[\nso by (i),\nF[B]= F[Bi] \u03c3 \u2217.\n\u2208F \u2286M\ni\n[\n(iii) If B , then by Theorem 2 of Chapter 7, 8,\n\u2217\n\u2208M \u00a7\n( K \u03c3) K B, m(B K)=0.\n\u2203 \u2208F \u2286 \u2212\nNow use Problem 8, with Q=B K.]\n\u2212\n\u21d210. (Change of variable.) Suppose g: E1 E1 is absolutely continuous and\n\u2192\none-to-one on A = [a,b], while f: E1 E\u2217(En, Cn) is L-integrable\n\u2192\non g[A].\nProve that (f g)g\u2032 is L-integrable on A and\n\u25e6\nb q\nL (f g)g\u2032 = L f,\n\u25e6\nZa Zp\nwhere p = g(a) and q = g(b).\n[Hints: Let F =L f and H =F g on A.\n\u25e6\nBy Theorems 2 and 3 and Problem 7 (end), F and H are absolutely continuous\nR\non g[A] and A, respectively; and H is L-integrable on A. So by Theorem 3,\n\u2032\nH =L H\u2032 =L (f g)g\u2032,\n\u25e6\nZ Z\nas H =(f g)g a.e. on A.]\n\u2032 \u2032\n\u25e6\n11. Setting f(x) = 0 if not defined otherwise, find the intervals (if any) on\nwhich f is absolutely continuous if f(x) is defined by\n(a) sinx;\n(b) cos2x;\n(c) 1/x;\n(d) tanx;\n(e) xx; 2. More on L-Integrals and Absolute Continuity 387\n\u00a7\n(f) xsin(1/x);\n(g) x2sinx\u22122 (Problem 5 in 1);\n\u00a7\n(h) \u221ax3 sin(1/x) (verify that f\u2032(x) 3 +x\u22121 2).\n\u00b7 | | \u2264 2\n[Hint: Use Problems 6 and 7.]\n\u00a73. Improper (Cauchy) Integrals\nCauchy extended R-integration to unbounded sets and functions as follows.\nGiven f: E1 E and assuming that the right-hand side R-integrals and\n\u2192\nlimits exist, define (first for unbounded sets, then for unbounded functions)\n\u221e x\n(i) f = f = lim R f;\nx\u2192\u221e\nZa Z[a,\u221e) Za\na a\n(ii) f = f = lim R f.\nx\u2192\u2212\u221e\nZ\u2212\u221e Z(\u2212\u221e,a] Zx\nIf both\n\u221e 0\nf and f\nZ0 Z\u2212\u221e\nexist, define\n\u221e\nf = f + f.\nZ\u2212\u221e Z(\u2212\u221e,0) Z[0,\u221e)\nNow, suppose f is unbounded near some p A = [a,b], i.e., unbounded on\n\u2208\nA G\n\u00acp\n\u2229\nfor every deleted globe G about p (such points p are called singularities).\n\u00acp\nThen (again assuming existence of the R-integrals and limits), we define\n(1) in case of a singularity p = a,\nb b\nf = f = lim R f;\nx\u2192a+\nZa+ Z(a,b] Zx\n(2) if p = b, then\nb\u2212 x\nf = f = lim R f;\nx\u2192b\u2212\nZa Z[a,b) Za\n(3) if a < p < b and if\np\u2212 b\nf and f\nZa Zp+ 388 Chapter 9. Calculus Using Lebesgue Theory\nexist, then\nb p\u2212 p b\nf = f + f + f.\nZa Za Zp Zp+\nThe term\np\nf = f\nZp Z[p,p]\nis necessary if RS- or LS-integrals are used.1\nFinally, if A contains several singularities, it must be split into subintervals,\neach with at most one endpoint singularity; and b f is split accordingly.2\na\nWe call all such integrals improper or Cauchy (C) integrals. A C-integral is\nR\nsaid to converge iff it exists and is finite.\nThis theory is greatly enriched if in the above definitions, one replaces R-\nintegrals by Lebesgue integrals, using Lebesgue or LS measure in E1. (This\nmakessenseevenwhenaLebesgueintegral(proper)doesexist; seeTheorem1.)\nBelow, m shall denote such a measure unless stated otherwise.\nC-integrals with respect to m will be denoted by\n\u221e\nC f dm, C f, etc.\nZa Z[a,b)\n\u201cClassical\u201d notation:\nC f(x)dm(x) or C f(x)dx\nZ Z\n(the latter if m is Lebesgue measure). We omit the \u201cC\u201d if confusion with proper\nx\nintegrals f is unlikely.\na\nNote R1. C-integrals are limits of integrals, not integrals proper. Yet they\nmay equal the latter (Theorem 1 below) and then may be used to compute\nthem.\nCaution. \u201cSingularities\u201d in [a,b] may affect the primitive used in compu-\nb\ntations (cf. Problem 4 in 1). Then [a,b] must be split (see above), and C f\n\u00a7 a\nsplits accordingly. (Additivity applies to C-integrals; see Problem 9, below.)\nR\nExamples.\n(A) The integral\n1/2 dx\nL\nx2\nZ\u22121\n1For RS- and LS-integrals, we may well have p f =0, f = f, etc.\np 6 [a,b] 6 (a,b)\n2This also applies if an infinite interval has an inside singularity.\nR R R 3. Improper (Cauchy) Integrals 389\n\u00a7\nhas a singularity at 0. By Theorem 1 below,3 we get\n1/2 dx 0\u2212 dx 1/2 dx\nL = +\nx2 x2 x2\nZ\u22121 Z\u22121 Z0+\n1 1\n= lim 1 + lim 2+ = + = .\nx\u21920\u2212 \u2212x \u2212 x\u21920+ \u2212 x \u221e \u221e \u221e\n(cid:16) (cid:17) (cid:16) (cid:17)\n(B) We have\n\u221e dx 1\nC = lim +2 = 2.\nx2 x\u2192\u221e \u2212x\nZ1/2\n(cid:16) (cid:17)\nHence\n\u221e dx 1/2 dx \u221e dx\nC = C +C = +2 = .\nx2 x2 x2 \u221e \u221e\nZ\u22121 Z\u22121 Z1/2\n(C) The integral\n1 x\nL | |dx\nx\nZ\u22121\nhas no singularities (consider deleted globes about 0). The primitive\nF(x) = x exists (example (b) in Chapter 5, 5); so\n| | \u00a7\n1 x 1\nL | |dx = x = 0.\nZ\u22121 x | | (cid:12)\u22121\n(cid:12)\nIn the rest of this section, we state our th(cid:12)eorems mainly for\n\u221e\nC f,\nZa\nbut they apply, with similar proofs, to\n\u221e b\u2212\nC f, C f, etc.\nZ\u2212\u221e Za\nThe measure m is as explained above.\nTheorem 1. Let A = [a, ), f: E1 E (E complete).\n\u221e \u2192\n(i) If f 0 on A, then\n\u2265 \u221e\nC f dm\nZa\nexists ( ) and equals\n\u2264 \u221e\nf dm.4\nZA\n3It applies to finite intervals A, too.\n4That is, the proper integral. 390 Chapter 9. Calculus Using Lebesgue Theory\n(ii) The map f is m-integrable on A iff\n\u221e\nC f <\n| | \u221e\nZa\nand f is m-measurable on A; then again,\n\u221e\nC f dm = f dm.\nZa ZA\nProof. (i) Let f 0 on A. By the rules of Chapter 8, 5, f is always\n\u2265 \u00a7 A\ndefined for such f; so we may set\nR\nx\nF(x) = f dm, x a.\n\u2265\nZa\nThen by Theorem 1(f) in Chapter 8, 5, F on A; for a x y implies\n\u00a7 \u2191 \u2264 \u2264\nx y\nF(x) = f f = F(y).\n\u2264\nZa Za\nNow, by the properties of monotone limits,\nx \u221e\nlim F(x) = lim f = C f\nx\u2192\u221e x\u2192\u221e\nZa Za\nexists in E\u2217; so by Theorem 1 of Chapter 4, 2, it can be found by making x\n\u00a7\nrun over some sequence x , say, x = k.\nk k\n\u2192 \u221e\nThus set\nA = [a,k], k = 1,2,....\nk\nThen A and\nk\n{ }\u2191\nA = A = [a, ),\nk\n\u221e\ni.e., A A. [\nk\n\u0580\nMoreover, by Note 4 in Chapter 8, 5, the set function s = f is \u03c3-additive\n\u00a7\nand semifinite ( 0). Thus by Theorem 2 of Chapter 7, 4 (left continuity)\n\u2265 \u00a7 R\nk \u221e\n(1) f dm = lim f = lim f = C f,\nk\u2192\u221e k\u2192\u221e\nZA ZAk Za Za\nproving (i).\n(ii) By clause (i),\n\u221e\nC f = f dm\n| | | |\nZa ZA\nexists, as f 0. Hence\n| | \u2265 \u221e\nC f <\n| | \u221e\nZa 3. Improper (Cauchy) Integrals 391\n\u00a7\nplus measurability amounts to integrability (Theorem 2 of Chapter 8, 6).\n\u00a7\nMoreover,\n\u221e\nC f <\n| | \u221e\nZa\n\u221e\nimplies the convergence of C f (see Corollary 1 below). Thus as\na\nx\nR\nlim f\nx\u2192\u221e\nZa\nexists, weproceedexactlyasbefore(heres = f isfinite), proving(ii)also. (cid:3)\nNote 2. If E E\u2217, formula (1) results evRen if f is not m-measurable.5\n\u2286\nNote 3. Whilef cannotbeintegrable unless f is(Corollary 2ofChapter8,\n| |\n6), it can happen that\n\u00a7\nC f\nZ\nconverges even if\nC f =\n| | \u221e\nZ\n(this is called conditional convergence). A case in point is\n\u221e sinx\nC dx;\nx\nZ0\nsee Problem 8.\nThusC-integrals may be finite where proper integrals are or fail to exist (a\n\u221e\ngreat advantage!). Yet they are deficient in other respects (see Problem 9(c)).\nFor our next theorem, we need the previously \u201cstarred\u201d Theorem 2 in Chap-\nter 4, 2. (Review it!) As we shall see, C-integrals resemble infinite series.\n\u00a7\nTheorem 2 (Cauchy criterion). Let A = [a, ), f: E1 E, E complete.\n\u221e \u2192\nSuppose\nx\nf dm\nZa\nexists for each x A. (This is automatic if E E\u2217; see Chapter 8, 5.)\n\u2208 \u2286 \u00a7\nThen\n\u221e\nC f\nZa\nconverges iff for every \u03b5 > 0, there is b A such that\n\u2208\nx\n(2) f dm < \u03b5 whenever b v x < ,6\n\u2264 \u2264 \u221e\n(cid:12)Zv (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n5This is true prov(cid:12)ided fd(cid:12)m is finite or orthodox, so that s= f is semifinite.\nA\nR R 392 Chapter 9. Calculus Using Lebesgue Theory\nand\nb\n(2\u2032) f dm < .\n\u221e\n(cid:12)Za (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nProof. By additivity (Chapter(cid:12)8, 5, Th(cid:12)eorem 2; Chapter 8, 7, Theorem 3),\n\u00a7 \u00a7\nx v x\nf = f + f\nZa Za Zv\nif a v x < . (In case E E\u2217, this holds even if f is not integrable; see\n\u2264 \u2264 \u221e \u2286\nTheorem 2, of Chapter 8, 5.)\n\u00a7\nNow, if\n\u221e\nC f\nZa\nconverges, let\nx\nr = lim f dm = .\nx\u2192\u221e 6 \u00b1\u221e\nZa\nThen for any \u03b5 > 0, there is some\nb [a, ) = A\n\u2208 \u221e\nsuch that\nx 1\nf dm r < \u03b5 for x b.\n\u2212 2 \u2265\n(cid:12)Za (cid:12)\n(cid:12) (cid:12)\n(Why may we use the s(cid:12)tandard metr(cid:12)ic here?)\n(cid:12) (cid:12)\nTaking x = b, we get (2\u2032). Also, if a b v x, we have\n\u2264 \u2264 \u2264\nx 1\nf dm r < \u03b5\n\u2212 2\n(cid:12)Za (cid:12)\n(cid:12) (cid:12)\nand (cid:12) (cid:12)\n(cid:12) \u03bd (cid:12) 1\nr f dm < \u03b5.\n\u2212 2\n(cid:12) Za (cid:12)\n(cid:12) (cid:12)\nHence by the triangle law, (2(cid:12)) follows also.(cid:12) Thus this b satisfies (2).\n(cid:12) (cid:12)\nConversely, suppose such a b exists for every given \u03b5 > 0. Fixing b, we thus\nhave (2) and (2\u2032). Now, with A = [a, ), define F: A E by\n\u221e \u2192\nx\nF(x) = f dm,\nZa\nso\n\u221e\nC f = lim F(x)\nx\u2192\u221e\nZa\n6Here and later, for LS integrals, replace x by and x by .\nv (v,x] b (b,x]\nR R R R 3. Improper (Cauchy) Integrals 393\n\u00a7\nif this limit exists. By (2),\nx b x b\nF(x) = f dm f dm + f dm < f dm +\u03b5\n| | \u2264\n(cid:12)Za (cid:12) (cid:12)Za (cid:12) (cid:12)Zb (cid:12) (cid:12)Za (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\nif x b. Thus F(cid:12) is finite(cid:12)on(cid:12)[b, ), a(cid:12)nd (cid:12)so we may(cid:12) ag(cid:12)ain use t(cid:12)he standard\n\u2265 (cid:12) (cid:12) (cid:12) \u221e (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\nmetric\nx v x\n\u03c1(F(x),F(v)) = F(x) F(v) = f dm f dm f dm < \u03b5\n| \u2212 | \u2212 \u2264\n(cid:12)Za Za (cid:12) (cid:12)Zv (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\nif x,v b. The existence of (cid:12) (cid:12) (cid:12) (cid:12)\n\u2265 (cid:12) (cid:12) (cid:12) (cid:12)\n\u221e\nC f dm = lim F(x) =\nx\u2192\u221e 6 \u00b1\u221e\nZa\nnow follows by Theorem 2 of Chapter 4, 2. (We shall henceforth presuppose\n\u00a7\nthis \u201cstarred\u201d theorem.)\nThus all is proved. (cid:3)\nCorollary 1. Under the same assumptions as in Theorem 2, the conver-\ngence of\n\u221e\nC f dm\n| |\nZa\nimplies that of\n\u221e\nC f dm.\nZa\nIndeed,\nx x\nf f\n\u2264 | |\n(cid:12)Zv (cid:12) Zv\n(cid:12) (cid:12)\n(Theorem 1(g) of Chapter 8, 5(cid:12), and(cid:12)Problem 10 in Chapter 8, 7).\n\u00a7(cid:12) (cid:12) \u00a7\nNote 4. We say that C f converges absolutely iff C f converges.\n| |\nCorollary 2 (comparison test). If f g a.e. on A = [a, ) for some\nR R\n| | \u2264 | | \u221e\nf,g: E1 E, then\n\u2192 \u221e \u221e\nC f C g ;\n| | \u2264 | |\nZa Za\nso the convergence of\n\u221e\nC g\n| |\nZa\nimplies that of\n\u221e\nC f .\n| |\nZa\nFor as f , g 0, Theorem 1 reduces all to Theorem 1(c) of Chapter 8, 5.\n| | | | \u2265 \u00a7 394 Chapter 9. Calculus Using Lebesgue Theory\nNote 5. As we see, absolutely convergent C-integrals coincide with proper\n(finite) Lebesgue integrals of nonnegative or m-measurable maps. For condi-\ntional (i.e., nonabsolute) convergence, see Problems 6\u20139, 13, and 14.\nIterated C-Integrals. Let the product space X Y of Chapter 8, 8 be\n\u00d7 \u00a7\nE1 E1 = E2,\n\u00d7\nand let p = m n, where m and n are Lebesgue measure or LS measures in\n\u00d7\nE1. Let\nA = [a,b], B = [c,d], and D = A B.\n\u00d7\nThen the integral\nf dmdn = f C dmdn\nD\nZB ZA ZY ZX\nis also written\nd b\nf dmdn\nZc Za\nor\nd b\nf(x,y)dm(x)dn(y).\nZc Za\nAs usual, we write \u201cdx\u201d for \u201cdm(x)\u201d if m is Lebesgue measure in E1; similarly\nfor n.\nWe now define\n\u221e \u221e b d\nC f dndm = lim lim f(x,y)dn(y) dm(x)\nb\u2192\u221e d\u2192\u221e\n(3) Za Zc Za (cid:18) Zc (cid:19)\n\u221e \u221e\n= C f(x,y)dn(y)dm(x),\nZa Zc\nprovided the limits and integrals involved exist.\nIf the integral (3) is finite, we say that it converges. Again, convergence\nis absolute if it holds also with f replaced by f , and conditional otherwise.\n| |\nSimilar definitions apply to\n\u221e \u221e b \u221e\nC f dmdn, C f dndm, etc.\nZc Za Z\u2212\u221eZc\nTheorem 3. Let f: E2 E\u2217 be p-measurable on E2 (p,m,n as above). Then\n\u2192\nwe have the following.\n(i\u2217) The Cauchy integrals\n\u221e \u221e \u221e \u221e\nC f dndm and C f dmdn\n| | | |\nZ\u2212\u221eZ\u2212\u221e Z\u2212\u221eZ\u2212\u221e 3. Improper (Cauchy) Integrals 395\n\u00a7\nexist ( ), and both equal\n\u2264 \u221e\nf dp.\n| |\nZE2\n(ii\u2217) If one of these three integrals is finite, then\n\u221e \u221e \u221e \u221e\nC f dndm and C f dmdn\nZ\u2212\u221eZ\u2212\u221e Z\u2212\u221eZ\u2212\u221e\nconverge, and both equal\nf dp.\nZE2\n\u221e b\n(Similarly for C f dndm, etc.)\na \u2212\u221e\nProof. As m andRn aRre \u03c3-finite (finite on intervals!), f surely has \u03c3-finite\nsupport.\nAs f 0, clause (i\u2217) easily follows from our present Theorem 1(i) and\n| | \u2265\nTheorem 3(i) of Chapter 8, 8.\n\u00a7\nSimilarly, clause (ii\u2217) follows from Theorem 3(ii) of the same section. (cid:3)\nTheorem 4 (passage to polars). Let p = Lebesgue measure in E2. Suppose\nf: E2 E\u2217 is p-measurable on E2. Set\n\u2192\nF(r,\u03b8) = f(rcos\u03b8,rsin\u03b8), r > 0.\nThen\n\u221e \u221e \u221e 2\u03c0\n(a) C f dxdy = C rdr F d\u03b8, and\nZ\u2212\u221eZ\u2212\u221e Z0 Z0\n\u221e \u221e \u221e \u03c0/2\n(b) C f dxdy = C rdr F d\u03b8,\nZ0 Z0 Z0 Z0\nprovided f is nonnegative or p-integrable on E2 (for (a)) or on (0, ) (0, )\n\u221e \u00d7 \u221e\n(for (b)).7\nProof Outline. First let f = C , with D a \u201ccurved rectangle\u201d\nD\n(r,\u03b8) r < r r , \u03b8 < \u03b8 \u03b8\n1 2 1 2\n{ | \u2264 \u2264 }\nfor some r < r in X = (0, ) and \u03b8 < \u03b8 in Y = [0,2\u03c0). By elementary\n1 2 1 2\n\u221e\ngeometry (or calculus), the area\n1\npD = (r2 r2)(\u03b8 \u03b8 )\n2 2 \u2212 1 2 \u2212 1\n(the difference between two circular sectors).\n7Hence the integrals in (a) and (b) can also be treated as proper integrals. 396 Chapter 9. Calculus Using Lebesgue Theory\nFor f = C , formulas (a) and (b) easily follow from\nD\npD = L C dp.\nD\nZE2\n(Verify!) Now, curved rectangles behave like half-open intervals\n(r ,r ] (\u03b8 ,\u03b8 ]\n1 2 1 2\n\u00d7\nin E2, since Theorem 1 in Chapter 7, 1, and Lemma 2 of Chapter 7, 2, apply\n\u00a7 \u00a7\nwith the same proof. Thus they form a semiring generating the Borel field\nin E2.\nHence show (as in Chapter 8, 8) that Theorem 4 holds for f = C (D ).\nD\n\u00a7 \u2208 B\nThen take D \u2217. Next let f be elementary and nonnegative, and so on, as\n\u2208 M\nin Theorems 2 and 3 in Chapter 8, 8. (cid:3)\n\u00a7\nExamples (continued).\n(D) Let\n\u221e\ne\u2212x2\nJ = L dx;\nZ0\nso\n\u221e \u221e\nJ2 = C e\u2212x2 dx C e\u2212y2 dy\n(cid:18) Z0 (cid:19)(cid:18) Z0 (cid:19)\n\u221e \u221e\ne\u2212(x2+y2)dxdy.\n= C (Why?)\nZ0 Z0\nSet\ne\u2212(x2+y2)\nf(x,y) =\ne\u2212r2\nin Theorem 4(b). Then F(r,\u03b8) = ; hence\n\u221e \u03c0\nJ2 = C rdr 2 e\u2212r2 d\u03b8\nZ0 (cid:18)Z0 (cid:19)\n\u221e \u03c0 1 \u221e 1\n= C re\u2212r2 dr = \u03c0e\u2212t = \u03c0.\nZ0 \u00b7 2 \u22124 (cid:12)0 4\n(cid:12)\n(Here we computed (cid:12)\nre\u2212r2\ndr\nZ\nby substituting r2 = t.) Thus\n\u221e \u221e 1 1\ne\u2212x2 e\u2212x2\n(4) C dx = L dx = \u03c0 = \u221a\u03c0.\n4 2\nZ0 Z0 r 3. Improper (Cauchy) Integrals 397\n\u00a7\nProblems on Cauchy Integrals\n1. Fill in all proof details in Theorems 1\u20133. Verify also at least some of the\n\u221e\ncases other than f. Check the validity for LS-integrals (footnote 6).\na\n2. Prove Theorem 4Rin detail.\n\u2032\n2 . Verify Notes 2 and 3 and examples (A)\u2013(D).\n3. Assuming a > 0, verify the following:\n\u221e 1 \u221e 1\n(i) e\u2212tdt e\u2212tdt = .\nt \u2264 e\nZ1 Z1\n[Hint: Use Corollary 2.]\n\u221e e\u2212a\n(ii) e\u2212atdt = .\na\nZ1\n\u221e 1\n(iii) e\u2212atdt = .\na\nZ0\n\u221e b\n(iv) e\u2212atsinbtdt = .\na2 +b2\nZ0\n4. Verify the following:\n\u221e \u221e \u221e 1 1\n(i) e\u2212xydydx = e\u2212xdx (converges, by 3(i)).\nx \u2264 e\nZ1 Z1 Z1\n\u221e \u221e \u221e \u221e \u221e 1\n(ii) e\u2212xydydx e\u2212xydydx = (1 e\u2212x)dx\n\u2265 x \u2212 \u2265\nZ0 \u221eZ0 Z1 Z0 Z1\n1\ne\u2212x dx = .\nx \u2212 \u221e\nZ1\n(cid:16) (cid:17)\nDoesthiscontradictformula(4)inthetext, orProblem5,whichfollows?\n5. Let f(x,y) = e\u2212xy and\n1\ng(x) = L e\u2212xydy;\nZ0\nso g(0) = 1. (Why?)\n(i) Is g R-integrable on A = [0,1]? Is f so on A A?\n\u00d7\n(ii) Find g(x) using Corollary 1 in 1.\n\u00a7\n(iii) Find the value of\n1 1 1\nR e\u2212xydydx = R g\nZ0 Z0 Z0\nto within 1/10.\n[Hint: Reduce it to Problem 6(b) in 1.]\n\u00a7 398 Chapter 9. Calculus Using Lebesgue Theory\n\u21d26. Let f,g: E1 E\u2217 be m-measurable on A = [a,b), b . Prove the\n\u2192 \u2264 \u221e\nfollowing:\n(i) If\nb\u2212 b\u2212\nC f+ < or C f\u2212 < ,\n\u221e \u221e\nZa Za\nb\u2212\nthen C f exists and equals\na\nR b\u2212 b\u2212\nC f+ C f\u2212 = f dm (proper).\n\u2212\nZa Za ZA\nb\u2212\n(ii) If f converges conditionally only, then\na\nR b\u2212 b\u2212\nf+ = f\u2212 = + .\n\u221e\nZa Za\nb\u2212\n(iii) In case C f < , we have\na | | \u221e\nR b\u2212\nC f g =\n| \u00b1 | \u221e\nZa\nb\u2212\niff C g = ; also,\na | | \u221e\nR b\u2212 b\u2212 b\u2212\nC (f g) = C f C g\n\u00b1 \u00b1\nZa Za Za\nb\u2212\nif C g exists (finite or not).\na\n\u21d27. Suppose fR: E1 E\u2217 is m-integrable and sign-constant on each\n\u2192\nA = [a ,a ), n = 1,2,...,\nn n n+1\nbut changes sign from A to A , with\nn n+1\n\u221e\nA = [a, )\nn\n\u221e\nn=1\n[\nand a fixed.\nn\n{ }\u2191\nProve that if\nf dm 0\n\u0581\n(cid:12)ZAn (cid:12)\n(cid:12) (cid:12)\nas n , then (cid:12) (cid:12)\n\u2192 \u221e (cid:12) \u221e(cid:12)\nC f\nZa\nconverges.\n[Hint: Use Problem 10 in Chapter 4, 13.]\n\u00a7 3. Improper (Cauchy) Integrals 399\n\u00a7\n\u21d28. Let\nsinx\nf(x) = , f(0) = 1.\nx\nProve that\n\u221e\nC f(x)dx\nZ0\nconverges conditionally only.\n[Hints: Use Problem 7. Show that\nC \u221e f =L f =L \u221e f+ =L \u221e f\u2212 = .]\n| | | | \u221e\nZ0 Z(0, \u221e) Z0 Z0\n\u21d29. (Additivity.) Given f: E1 E (E complete) and a < b < c ,\n\u2192 \u2264 \u221e\nsuppose that\nx\nf dm =\n6 \u00b1\u221e\nZa\n(proper) exists for each x [a,c). Prove the following:\n\u2208\nb\u2212 b\n(a) C f and C f converge.\na a+\n(b) If R R\nc\u2212\nC f\nZb\nconverges, so does\nc\u2212 b\u2212 c\u2212\nC f = C f +C f.\nZa Za Zb\n(c) Countable additivity does not necessarily hold for C-integrals.\n[Hint: Use Problem 8 suitably splitting [0, ).]\n\u221e\n10. (Refined comparison test.) Given f,g: E1 E (E complete) and b\n\u2192 \u2264\n, prove the following:\n\u221e\n(i) If for some a < b and k E1,\n\u2208\nf kg on [a,b)\n| | \u2264 | |\nthen\nb\u2212 b\u2212\ng < implies f < .\n| | \u221e | | \u221e\nZa Za\n(ii) Such a,k E1 do exist if\n\u2208\nf(t)\nlim | | <\nt\u2192b\u2212 g(t) \u221e\n| |\nexists. 400 Chapter 9. Calculus Using Lebesgue Theory\n(iii) If this limit is not zero, then\nb\u2212 b\u2212\ng < iff f < .\n| | \u221e | | \u221e\nZa Za\nb\n(Similarly in the case of with a .)\na+ \u2265 \u2212\u221e\n11. Prove that R\n\u221e\n(i) tpdt < iff p < 1;\n\u221e \u2212\nZ1\n1\n(ii) tpdt < iff p > 1;\n\u221e \u2212\nZ0+\n\u221e\n(iii) tpdt = .\n\u221e\nZ0+\n12. Use Problems 10 and 11 to test for convergence of the following:\n\u221e t3/2dt\n(a) ;\n1+t2\nZ0\n\u221e dt\n(b) ;\nt\u221a1+t2\nZ1\n\u221e P(t)\n(c) dt\nQ(t)\nZa\n(Q,P polynomials of degree s and r, s > r; Q = 0 for t a);\n6 \u2265\n1\u2212 dt\n(d) ;\n\u221a1 t4\nZ0\n\u2212\n1\n(e) tplntdt;\nZ0+\n1\u2212 dt\n(f) ;\nlnt\nZ0\n\u03c0\n\u2212\n2\n(g) tanptdt.\nZ0+\n\u21d213. (The Abel\u2013Dirichlet test.) Given f,g: E1 E1, suppose that\n\u2192\n(a) f , with lim f(t) = 0;\n\u2193 t\u2192\u221e\n(b) g is L-measurable on A = [a, );8 and\n\u221e\n(c) ( K E1) ( x A) L x g < K.\n\u2203 \u2208 \u2200 \u2208 a\n(cid:12) R (cid:12)\n8And hence L-integrable on each [u,v] (cid:12) A, by(cid:12)(c).\n\u2282 3. Improper (Cauchy) Integrals 401\n\u00a7\n\u221e\nThen C f(x)g(x)dx converges.\na\n[Outline: Set\nR\nx\nG(x)= g;\nZa\nso G < K on A. By Lemma 2 of 1, fg is L-integrable on each [u,v] A, and\n| | \u00a7 \u2282\n( c [u,v]) such that\n\u2203 \u2208\nv c\nL fg = f(u) g = f(u)[G(c) G(u)] <2Kf(u).\n\u2212\n(cid:12) Zu (cid:12) (cid:12) Zu (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\nNow, by (a),(cid:12) (cid:12) (cid:12) (cid:12)\n\u03b5\n( \u03b5>0) ( k A) ( u k) f(u) < ;\n\u2200 \u2203 \u2208 \u2200 \u2265 | | 2K\nso\nv\n( v u k) L fg <\u03b5.\n\u2200 \u2265 \u2265\n(cid:12) Zu (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nNow use Theorem 2. (cid:12) (cid:12)\nNow extend this to g: E1 En(Cn).]\n\u2192\n\u21d214. Do Problem 13, replacing assumptions (a) and (c) by\n(a\u2032) f is monotone and bounded on [a, ) = A, and\n\u221e\n(c\u2032) C \u221e g(x)dx converges.\na\n[Hint: If fR , say, set q = lim f(t) and F =q f; so\n\u2191 t \u2212\n\u2192\u221e\nfg =qg Fg.\n\u2212\nApply Problem 13 to\n\u221e\nC F(x)g(x)dx.]\nZa\n15. Use Problems 13 and 14 to test the convergence of the following:\n\u221e\n(a) tpsintdt.\nZ0\n[Hint: The integral converges iff p<0.]\n\u221e cost\n(b) dt.\n\u221at\nZ0+\nv cost\n[Hint: Integrate dt by parts; then let u 0 and v .]\n\u221at \u2192 \u2192\u221e\nZu\n\u221e cost\n(c) dt.\ntp\nZ1\n\u221e\n(d) sint2dt.\nZ0\n[Hint: Substitute t2 =u; then use (a).] 402 Chapter 9. Calculus Using Lebesgue Theory\n\u221e\n16. The Cauchy principal value (CPV) of C f(t)dt is defined by\n\u2212\u221e\n\u221e R x\n(CPV) f = lim f(t)dt\nx\u2192\u221e\nZ\u2212\u221e Z\u2212x\n(if it exists). Prove the following:\n(i) If C f(t)dt exists, so does (CPV) f, and the two are equal.\nDisprove the converse.\nR R\n[Hint: Take f(t)=sign(t)/ t.]\n| |\n(ii) Do the same for p\nb p\u2212\u03b4 b\n(CPV) f = lim f + f ,\n\u03b4\u21920+\nZa (cid:18)Za Zp+\u03b4 (cid:19)\np being the only singularity in (a,b).\n\u00a74. Convergence of Parametrized Integrals and Functions\nI. We now consider C-integrals of the form\nC f(t,u)dm(t),\nZ\nwhere m is Lebesgue or LS measure in E1. Here the variable u, called a param-\neter, remains fixed in the process of integration; but the end result depends on\nu, of course.\nWe assume f: E2 E (E complete) even if not stated explicitly. As before,\n\u2192\nwe give our definitions and theorems for the case\n\u221e\nC .\nZa\na b\u2212\nThe other cases (C , C , etc.) are analogous; they are treated in Prob-\n\u2212\u221e a\nlems 2 and 3. We assume\nR R\na,b,c,x,t,u,v E1\n\u2208\nthroughout, and write \u201cdt\u201d for \u201cdm(t)\u201d iff m is Lebesgue measure.\nIf\n\u221e\nC f(t,u)dm(t)\nZa 4. Convergence of Parametrized Integrals and Functions 403\n\u00a7\nconverges for each u in a set B E1,1 we can define a map F: B E by\n\u2286 \u2192\n\u221e x\nF(u) = C f(t,u)dm(t) = lim f(t,u)dm(t).\nx\u2192\u221e\nZa Za\nThis means that\nx\n(1) ( u B) ( \u03b5 > 0) ( b > a) ( x b) f(t,u)dm(t) F(u) < \u03b5,\n\u2200 \u2208 \u2200 \u2203 \u2200 \u2265 \u2212\n(cid:12)Za (cid:12)\n(cid:12) (cid:12)\nso F < on B. (cid:12) (cid:12)\n| | \u221e (cid:12) (cid:12)\nHere b depends on both \u03b5 and u (convergence is \u201cpointwise\u201d). However, it\nmay occur that one and the same b fits all u B, so that b depends on \u03b5 alone.\n\u2208\nWe then say that\n\u221e\nC f(t,u)dm(t)\nZa\nconverges uniformly on B (i.e., for u B), and write\n\u2208\n\u221e\nF(u) = C f(t,u)dm(t) (uniformly) on B.\nZa\nExplicitly, this means that\nx\n(2) ( \u03b5 > 0) ( b > a) ( u B) ( x b) f(t,u)dm(t) F(u) < \u03b5.\n\u2200 \u2203 \u2200 \u2208 \u2200 \u2265 \u2212\n(cid:12)Za (cid:12)\n(cid:12) (cid:12)\nClearly, this implies (1), but not conversely(cid:12). We now obtain the foll(cid:12)owing.\n(cid:12) (cid:12)\nTheorem 1 (Cauchy criterion). Suppose\nx\nf(t,u)dm(t)\nZa\nexists for x a and u B E1. (This is automatic if E E\u2217; see Chapter 8,\n\u2265 \u2208 \u2286 \u2286\n5.)\n\u00a7\nThen\n\u221e\nC f(t,u)dm(t)\nZa\nconverges uniformly on B iff for every \u03b5 > 0, there is b > a such that\nx\n(3) ( v,x [b, )) ( u B) f(t,u)dm(t) < \u03b5,2\n\u2200 \u2208 \u221e \u2200 \u2208\n(cid:12)Zv (cid:12)\n(cid:12) (cid:12)\nand (cid:12) (cid:12)\nb (cid:12) (cid:12)\nf(t,u)dm(t) < .\n\u221e\n(cid:12)Za (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n1This statement shall imply t(cid:12)hat x f(t,u)dm(t)(cid:12)= exists for x a, u B.\n2For LS-integrals, replace x by a here and in6 t\u00b1 he\u221e proof below. \u2265 \u2208\nv R(x,v]\nR R 404 Chapter 9. Calculus Using Lebesgue Theory\nProof. The necessity of (3) follows as in Theorem 2 of 3. (Verify!)\n\u00a7\nTo prove sufficiency, suppose the desired b exists for every \u03b5 > 0. Then for\neach (fixed) u B,\n\u2208\n\u221e\nC f(t,u)dm(t)\nZa\nsatisfies Theorem 2 of 3. Hence\n\u00a7\nx\n(4) F(u) = lim f(t,u)dm(t) =\nx\u2192\u221e 6 \u00b1\u221e\nZa\nexists for every u B (pointwise). Now, from (3), writing briefly f for\n\u2208\nf(t,u)dm(t), we obtain\nR\nR x x v\nf = f f < \u03b5\n\u2212\n(cid:12)Zv (cid:12) (cid:12)Za Za (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\nfor all u B and all x >(cid:12)v b.(cid:12) (cid:12) (cid:12)\n\u2208 (cid:12) \u2265 (cid:12) (cid:12) (cid:12)\nMaking x (with u and v temporarily fixed), we have by (4) that\n\u2192 \u221e\nv\n(5) F(u) f \u03b5\n\u2212 \u2264\n(cid:12) Za (cid:12)\n(cid:12) (cid:12)\nwhenever v b. (cid:12) (cid:12)\n\u2265 (cid:12) (cid:12)\nBut by our assumption, b depends on \u03b5 alone (not on u). Thus unfixing u,\nwe see that (5) establishes the uniform convergence of\n\u221e\nf,\nZa\nas required.3 (cid:3)\nCorollary 1. Under the assumptions of Theorem 1,\n\u221e\nC f(t,u)dm(t)\nZa\nconverges uniformly on B if\n\u221e\nC f(t,u) dm(t)\n| |\nZa\ndoes.\nIndeed,\nx x\nf f < \u03b5.\n\u2264 | |\n(cid:12)Zv (cid:12) Zv\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\n3Note that Theorem 1 essentially depends on the assumed completeness of E. 4. Convergence of Parametrized Integrals and Functions 405\n\u00a7\nCorollary 2 (comparison test). Let f: E2 E and M: E2 E\u2217 satisfy\n\u2192 \u2192\nf(t,u) M(t,u)\n| | \u2264\nfor u B E1 and t a.\n\u2208 \u2286 \u2265\nThen\n\u221e\nC f(t,u) dm(t)\n| |\nZa\nconverges uniformly on B if\n\u221e\nC M(t,u)dm(t)\nZa\ndoes.\nIndeed, Theorem 1 applies, with\nx x\nf M < \u03b5.\n\u2264\n(cid:12)Zv (cid:12) Zv\n(cid:12) (cid:12)\nHence we have the following(cid:12)corolla(cid:12)ry.\n(cid:12) (cid:12)\nCorollary 3 (\u201cM-test\u201d). Let f: E2 E and M: E1 E\u2217 satisfy\n\u2192 \u2192\nf(t,u) M(t)\n| | \u2264\nfor u B E1 and t a. Suppose\n\u2208 \u2286 \u2265\n\u221e\nC M(t)dm(t)\nZa\nconverges. Then\n\u221e\nC f(t,u) dm(t)\n| |\nZa\nconverges (uniformly) on B. So does\n\u221e\nC f(t,u)dm(t)\nZa\nby Corollary 1.\nProof. Set\nh(t,u) = M(t) f(t,u) .\n\u2265 | |\nThen Corollary 2 applies (with M replaced by h there). Indeed, the conver-\ngence of\nC h = C M\nZ Z\nis trivially \u201cuniform\u201d for u B, since M does not depend on u at all. (cid:3)\n\u2208 406 Chapter 9. Calculus Using Lebesgue Theory\nNote 1. Observe also that, if h(t,u) does not depend on u, then the (point-\nwise) and (uniform) convergence of C h are trivially equivalent.\nWe also have the following result.\nR\nCorollary 4. Suppose\n\u221e\nC f(t,u)dm(t)\nZa\nconverges (pointwise) on B E1. Then this convergence is uniform iff\n\u2286\n\u221e\nlim C f(t,u)dm(t) = 0 (uniformly) on B,\n\u03bd\u2192\u221e\nZv\ni.e., iff\n\u221e\n( \u03b5 > 0) ( b > a) ( u B) ( v b) C f(t,u)dm(t) < \u03b5.\n\u2200 \u2203 \u2200 \u2208 \u2200 \u2265\n(cid:12) Zv (cid:12)\n(cid:12) (cid:12)\n(cid:12) (cid:12)\nThe proof (based on Theorem 1) is left to th(cid:12)e reader, along with(cid:12)that of the\nfollowing corollary.\nCorollary 5. Suppose\nb\nf(t,u)dm(t) =\n6 \u00b1\u221e\nZa\nexists for each u B E1.\n\u2208 \u2286\nThen\n\u221e\nC f(t,u)dm(t)\nZa\nconverges (uniformly) on B iff\n\u221e\nC f(t,u)dm(t)\nZb\ndoes.\nII. The Abel\u2013Dirichlet tests for uniform convergence of series (Problems 9\nand 11 in Chapter 4, 13) have various analogues for C-integrals. We give two\n\u00a7\nof them, using the second law of the mean (Corollary 5 in 1).\n\u00a7\nFirst, however, we generalize our definitions, \u201cunstarring\u201d some ideas of\nChapter 4, 11. Specifically, given\n\u00a7\nH: E2 E (E complete),\n\u2192\nwe say that H(x,y) converges to F(y), uniformly on B, as x q (q E\u2217),\n\u2192 \u2208\nand write\nlim H(x,y) = F(y) (uniformly) on B\nx\u2192q 4. Convergence of Parametrized Integrals and Functions 407\n\u00a7\niff we have\n(6) ( \u03b5 > 0) ( G ) ( y B) ( x G ) H(x,y) F(y) < \u03b5;\n\u00acq \u00acq\n\u2200 \u2203 \u2200 \u2208 \u2200 \u2208 | \u2212 |\nhence F < on B.\n| | \u221e\nIf here q = , the deleted globe G has the form (b, ). Thus if\n\u00acq\n\u221e \u221e\nx\nH(x,u) = f(t,u)dt,\nZa\n(6) turns into (2) as a special case. If (6) holds with \u201c( G )\u201d and \u201c( y B)\u201d\n\u00acq\n\u2203 \u2200 \u2208\ninterchanged, as in (1), convergence is pointwise only.\nAs in Chapter 8, 8, we denote by f( ,y), or fy, the function of x alone\n\u00a7 \u00b7\n(on E1) given by\nfy(x) = f(x,y).\nSimilarly,\nf (y) = f(x,y).\nx\nOf course, we may replace f(x,y) by f(t,u) or H(t,u), etc.\nWe use Lebesgue measure in Theorems 2 and 3 below.\nTheorem 2. Assume f,g: E2 E1 satisfy\n\u2192\n\u221e\n(i) C g(t,u)dt converges (uniformly) on B;\na\n(ii) eacRh gu (u B) is L-measurable on A = [a, );\n\u2208 \u221e\n(iii) each fu (u B) is monotone ( or ) on A;4 and\n\u2208 \u2193 \u2191\n(iv) f < K E1 (bounded) on A B.\n| | \u2208 \u00d7\nThen\n\u221e\nC f(t,u)g(t,u)dt\nZa\nconverges uniformly on B.\nProof. Given \u03b5 > 0, use assumption (i) and Theorem 1 to choose b > a so that\nx \u03b5\n(7) L g(t,u)dt < ,\n2K\n(cid:12) Zv (cid:12)\n(cid:12) (cid:12)\nwritten briefly as (cid:12) (cid:12)\n(cid:12) (cid:12)\nx \u03b5\nL gu < ,\n2K\n(cid:12) Zv (cid:12)\n(cid:12) (cid:12)\nfor all u B and x > v b, w(cid:12)ith K as(cid:12)in (iv).\n\u2208 \u2265 (cid:12) (cid:12)\n4Briefly: \u201cf(t,u) is monotone in t, and g(t,u) is measurable in t (t A).\u201d It should be\n\u2208\nwell noted that all fu and gu are functions of t on E1. 408 Chapter 9. Calculus Using Lebesgue Theory\nHence by (ii), each gu (u B) is L-integrable on any interval [v,x] A,\n\u2208 \u2282\nwith x > v b. Thus given such u and [v,x], we can use (iii) and Corollary 5\n\u2265\nfrom 1 to find that\n\u00a7\nx c x\nL fugu = fu(v)L gu +fu(x)L gu\nZv Zv Zc\nfor some c [v,x].\n\u2208\nCombining with (7) and using (iv), we easily obtain\nx\nL f(t,u)g(t,u)dt < \u03b5\n(cid:12) Zv (cid:12)\n(cid:12) (cid:12)\nwhenever u B and x > v(cid:12) b. (Verify!) (cid:12)\n\u2208 (cid:12) \u2265 (cid:12)\nOur assertion now follows by Theorem 1. (cid:3)\nTheorem 3 (Abel\u2013Dirichlet test). Let f,g: E2 E\u2217 satisfy\n\u2192\n(a) lim f(t,u) = 0 (uniformly) for u B;\nt\u2192\u221e \u2208\n(b) each fu (u B) is nonincreasing ( ) on A = [0, );\n\u2208 \u2193 \u221e\n(c) each gu (u B) is L-measurable on A; and\n\u2208\n(d) ( K E1) ( x A) ( u B) L x g(t,u)dt < K.\n\u2203 \u2208 \u2200 \u2208 \u2200 \u2208 a\nThen\n(cid:12) R (cid:12)\n\u221e\n(cid:12) (cid:12)\nC f(t,u)g(t,u)dt\nZa\nconverges uniformly on B.\nProof Outline. Argue as in Problem 13 of 3, replacing Theorem 2 in 3 by\n\u00a7 \u00a7\nTheorem 1 of the present section.\nBy Lemma 2 in 1, obtain\n\u00a7\nx x\nL fugu = fu(v)L gu Kf(v,u)\n\u2264\n(cid:12) Zv (cid:12) (cid:12) Za (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\nfor u B and x >(cid:12) v a. (cid:12) (cid:12) (cid:12)\n\u2208 (cid:12) \u2265 (cid:12) (cid:12) (cid:12)\nThen use assumption (a) to fix k so that\n\u03b5\nf(t,u) <\n| | 2K\nfor t > k and u B. (cid:3)\n\u2208\nNote 2. Via components, Theorems 2 and 3 extend to the case g: E2\n\u2192\nEn(Cn).\nNote 3. While Corollaries 2 and 3 apply to absolute convergence only,\nTheorems 2 and 3 cover conditional convergence, too (a great advantage!). The\ntheorems also apply if f or g is independent of u (see Note 1). This supersedes\nProblems 13 and 14 in 3.\n\u00a7 4. Convergence of Parametrized Integrals and Functions 409\n\u00a7\nExamples.\n(A) The integral\n\u221e sintu\ndt\nt\nZ0\nconvergesuniformlyonB = [\u03b4, )if \u03b4 > 0, andpointwiseonB = [0, ).\n\u03b4\n\u221e \u221e\nIndeed, we can use Theorem 3, with\ng(t,u) = sintu\nand\n1\nf(t,u) = , f(0,u) = 1,\nt\nsay. Then the limit\n1\nlim = 0\nt\u2192\u221e t\nis trivially uniform for u B , as f is independent of u. Thus assumption\n\u03b4\n\u2208\n(a) is satisfied. So is (d) because\nx 1 xu 1\nsintudt = sin\u03b8d\u03b8 2.\nu \u2264 \u03b4 \u00b7\n(cid:12)Z0 (cid:12) (cid:12) Z0 (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\n(Explain!) Th(cid:12)e rest is easy(cid:12). (cid:12) (cid:12)\n(cid:12) (cid:12) (cid:12) (cid:12)\nNote that Theorem 2 fails here since assumption (i) is not satisfied.\n(B) The integral\n\u221e 1\ne\u2212tusinatdt\nt\nZ0\nconverges uniformly on B = [0, ). It does so absolutely on B = [\u03b4, ),\n\u03b4\n\u221e \u221e\nif \u03b4 > 0.\nHere we shall use Theorem 2 (though Theorem 3 works, too). Set\nf(t,u) = e\u2212tu\nand\nsinat\ng(t,u) = , g(0,u) = a.\nt\nThen\n\u221e\ng(t,u)dt\nZ0\nconverges (substitute x = at in Problem 8 or 15 in 3). Convergence is\n\u00a7\ntrivially uniform, by Note 1. Thus assumption (i) holds, and so do the\nother assumptions. Hence the result.\nFor absolute convergence on B , use Corollary 3 with\n\u03b4\nM(t) = e\u2212\u03b4t, 410 Chapter 9. Calculus Using Lebesgue Theory\nso M fg .\n\u2265 | |\nNote that, quite similarly, one treats C-integrals of the form\n\u221e \u221e\ne\u2212tug(t)dt, e\u2212t2ug(t)dt, etc.,\nZa Za\nprovided\n\u221e\ng(t)dt\nZa\nconverges (a 0).\n\u2265\nIn fact, Theorem 2 states (roughly) that the uniform convergence of\nC g implies that of C fg, provided f is monotone (in t) and bounded.\nR R\nIII. We conclude with some theorems on uniform convergence of functions\nH: E2 E (see (6)). In Theorem 4, m is again an LS (or Lebesgue) measure\n\u2192\nin E1; the deleted globe G\u2217 is fixed.\n\u00acq\nTheorem 4. Suppose\nlim H(x,y) = F(y) (uniformly)5\nx\u2192q\nfor y B E1. Then we have the following:\n\u2208 \u2286\n(i) If all H (x G\u2217 ) are continuous6 or m-measurable on B, so also is F.\nx \u2208 \u00acq\n(ii) The same applies to m-integrability on B, provided mB < ; and then\n\u221e\n(8) lim H F = 0;\nx\nx\u2192q | \u2212 |\nZB\nhence\n(8\u2032) lim H = F = lim H .\nx x\nx\u2192q x\u2192q\nZB ZB ZB\n(cid:16) (cid:17)\nFormula (8\u2032) is known as the rule of passage to the limit under the integral\nsign.\nProof. (i) Fix a sequence x q (x in the deleted globe G\u2217 ), and set\nk \u2192 k \u00acq\nH = H (k = 1,2,...).\nk xk\nThe uniform convergence\nH(x,y) F(y)\n\u2192\n5Pointwise or a.e. convergence suffices for m-measurability in clause (i).\n6Here and in Theorem 5, as functions of y: Hx(y)=H(x,y). Continuity may be relative\nor uniform. 4. Convergence of Parametrized Integrals and Functions 411\n\u00a7\nis preserved as x runs over that sequence (see Problem 4). Hence if all H are\nk\ncontinuousor measurable, sois F (Theorem2 in Chapter4, 12and Theorem 4\n\u00a7\nin Chapter 8, 1). Thus clause (i) is proved.\n\u00a7\n(ii) Now let all H be m-integrable on B; let\nx\nmB < .\n\u221e\nThen the H are m-measurable on B, and so is F, by (i). Also, by (6),\nk\n( \u03b5 > 0) ( G ) ( x G ) H F (\u03b5) = \u03b5mB < ,\n\u00acq \u00acq x\n\u2200 \u2203 \u2200 \u2208 | \u2212 | \u2264 \u221e\nZB ZB\nproving (8). Moreover, as\nH F < ,\nx\n| \u2212 | \u221e\nZB\nH F is m-integrable on B, and so is\nx\n\u2212\nF = H (H F).\nx x\n\u2212 \u2212\nHence\nH F = (H F) H F 0,\nx x x\n\u2212 \u2212 \u2264 | \u2212 | \u2192\n(cid:12)ZB ZB (cid:12) (cid:12)ZB (cid:12) ZB\n(cid:12) (cid:12) (cid:12) (cid:12)\nas x q, by(cid:12)(8). Thus (8\u2032)(cid:12)is p(cid:12)roved, too. (cid:12)(cid:3)\n\u2192 (cid:12) (cid:12) (cid:12) (cid:12)\nQuite similarly (keeping E complete and using sequences), we obtain the\nfollowing result.\nTheorem 5. Suppose that\n(i) all H (x G\u2217 ) are continuous and finite on a finite interval B E1,\nx \u2208 \u00acq \u2282\nand differentiable on B Q, for a fixed countable set Q;\n\u2212\n(ii) lim H(x,y ) = exists for some y B; and\n0 0\nx\u2192q 6 \u00b1\u221e \u2208\n(iii) lim D H(x,y) = f(y) (uniformly) exists on B Q.\n2\nx\u2192q \u2212\nThen f, so defined, has a primitive F on B, exact on B Q (so F\u2032 = f on\n\u2212\nB Q); moreover,\n\u2212\nF(y) = lim H(x,y) (uniformly) for y B.\nx\u2192y \u2208\nOutline of proof. Note that\nd\nD H(x,y) = H (y).\n2 x\ndy\nUse Theorem 1 of Chapter 5, 9, with F = H , x q. (cid:3)\nn xn n\n\u00a7 \u2192\nNote 4. If x q over a path P (clustering at q), one must replace G\n\u00acq\n\u2192\nand G\u2217 by P G and P G\u2217 in (6) and in Theorems 4 and 5.\n\u00acq \u2229 \u00acq \u2229 \u00acq 412 Chapter 9. Calculus Using Lebesgue Theory\nProblems on Uniform Convergence\nof Functions and C-Integrals\n1. Fill in all proof details in Theorems 1\u20135, Corollaries 4 and 5, and exam-\nples (A) and (B).\n\u2032\n1 . Using (6), prove that\nlim H(x,y) (uniformly)\nx\u2192q\nexists on B E1 iff\n\u2286\n( \u03b5 > 0) ( G ) ( y B) ( x,x\u2032 G ) H(x,y) H(x\u2032,y) < \u03b5.\n\u00acq \u00acq\n\u2200 \u2203 \u2200 \u2208 \u2200 \u2208 | \u2212 |\nAssume E complete and H < on G B.\n\u00acq\n| | \u221e \u00d7\n[Hint: \u201cImitate\u201d the proof of Theorem 1, using Theorem 2 of Chapter 4, 2.]\n\u00a7\na b\u2212 b\n2. State formulas analogous to (1) and (2) for , , and .\n\u2212\u221e a a+\n3. State and prove Theorems 1 to 3 and CorollRaries 1R to 3 forR\na b\u2212 b\n, , and .\nZ\u2212\u221e Za Za+\nIn Theorems 2 and 3 explore absolute convergence for\nb\u2212 b\nand .\nZa Za+\nDo at least some of the cases involved.\n[Hint: Use Theorem 1 of 3 and Problem 1 , if already solved.]\n\u2032\n\u00a7\n4. Prove that\nlim H(x,y) = F(y) (uniformly)\nx\u2192q\non B iff\nlim H(x , ) = F (uniformly)\nn\nn\u2192\u221e \u00b7\non B for all sequences x q (x = q).\nn n\n\u2192 6\n[Hint: \u201cImitate\u201d Theorem 1 in Chapter 4, 2. Use Definition 1 of Chapter 4, 12.]\n\u00a7 \u00a7\n5. Prove that if\nlim H(x,y) = F(y) (uniformly)\nx\u2192q\non A and on B, then this convergence holds on A B. Hence deduce\n\u222a\nsimilar propositions on C-integrals.\n6. Show thatthe integrals listed below violate Corollary 4 andhencedo not\nconverge uniformly on P = (0,\u03b4)7 though proper L-integrals exist for\n7Here and below, \u03b4 >0 is arbitrarily small. 4. Convergence of Parametrized Integrals and Functions 413\n\u00a7\neach u P. Thus show that Theorem 1(ii) does not apply to uniform\n\u2208\nconvergence.\n1 udt\n(a) ;\nt2 u2\nZ0+\n\u2212\n1 u2 t2\n(b) \u2212 dt;\n(t2 +u2)2\nZ0+\n1 tu(t2 u2)\n(c) \u2212 dt.\n(t2 +u2)2\nZ0+\n[Hint for (b): To disprove uniform convergence, fix any \u03b5,v >0. Then\nv u2 t2 v 1\n\u2212 dt=\n(t2+u2)2 v2+u2 \u2192 v\nZ0\nas u 0. Thus if v < 1 ,\n\u2192 2\u03b5\nv u2 t2 1\n( u P) \u2212 dt> >\u03b5.]\n\u2203 \u2208 (t2+u2)2 2v\nZ0\n7. Using Corollaries 3 to 5, show that the following integrals converge (uni-\nformly) on U (as listed) but only pointwise on P (for the latter, proceed\nas in Problem 6). Specify P and M(t) in each case where they are not\ngiven.\n\u221e\ne\u2212ut2\n(a) dt; U = [\u03b4, ); P = (0,\u03b4).\n\u221e\nZ0\n[Hint: Set M(t)=e \u03b4t for t 1 (Corollaries 3 and 5).]\n\u2212\n\u2265\n\u221e\n(b) e\u2212uttacostdt (a 0); U = [\u03b4, ).\n\u2265 \u221e\nZ0\n1\n(c) tu\u22121dt; U = [\u03b4, ).\n\u221e\nZ0+\n1\n(c\u2032) tu\u22121(lnt)ndt; U = [\u03b4, ).\n\u221e\nZ0+\n1\n(d) t\u2212usintdt; U = [0,\u03b4], 0 < \u03b4 < 2; P = [\u03b4,2); M(t) = t1\u2212\u03b4.\nZ0+\n[Hint: Fix v so small that\nsint 1\n( t (0,v)) > .\n\u2200 \u2208 t 2\nThen, if u 2,\n\u2192\nv 1 v dt\nt\u2212usintdt .]\n\u2265 2 tu 1 \u2192\u221e\nZ0 Z0 \u2212 414 Chapter 9. Calculus Using Lebesgue Theory\n8. In example (A), disprove uniform convergence on P = (0, ).\n\u221e\n[Hint: Proceed as in Problem 6.]\n9. Do example (B) using Theorem 3 and Corollary 5. Disprove uniform\nconvergence on B.\n10. Show that\n\u221e sintu\ncostdt\nt\nZ0+\nconverges uniformly on any closed interval U, with 1 U.\n\u00b1 6\u2208\n[Hint: Transform into\n1 1\n\u221e\nsin[(u+1)t]+sin[(u 1)t] dt.]\n2 t \u2212\nZ0+\n(cid:8) (cid:9)\n11. Show that\n\u221e\nt sint3 sintudt\nZ0\nconverges (uniformly) on any finite interval U.\n[Hint: Integrate\ny\nt sint3 sintudt\nZx\nby parts twice. Then let y and x 0.]\n\u2192\u221e \u2192\n12. Show that\n\u221e cost\ne\u2212tu dt (0 < a < 1)\nta\nZ0+\nconverges (uniformly) for u 0.\n\u2265\n[Hints: For t 0+, use M(t)=t a. For t , use example (B) and Theorem 2.]\n\u2212\n\u2192 \u2192\u221e\n13. Prove that\n\u221e costu\ndt (0 < a < 1)\nta\nZ0+\nconverges (uniformly) for u \u03b4 > 0, but (pointwise) for u > 0.\n\u2265\n[Hint: Use Theorem 3 with g(t,u)=costu and\nx sinxu 1\ng = .\nu \u2264 \u03b4\nFor u>0, (cid:12) (cid:12) (cid:12) (cid:12)Z0 (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12)\ncostu cosz\n\u221e dt=ua \u22121 \u221e dz\nta z \u2192\u221e\nZv Zvu\nif v =1/u and u 0. Use Corollary 4.]\n\u2192\n\u21d214. Given A,B E1 (mA < ) and f: E2 E, suppose that\n\u2286 \u221e \u2192\n(i) each f(x, ) = f (x A) is relatively (or uniformly) continuous\nx\n\u00b7 \u2208\non B; and\n(ii) each f( ,y) = fy (y B) is m-integrable on A.\n\u00b7 \u2208 4. Convergence of Parametrized Integrals and Functions 415\n\u00a7\nSet\nF(y) = f(x,y)dm(x), y B.\n\u2208\nZA\nThen show that F is relatively (or uniformly) continuous on B.\n[Hint: We have\n( \u2200x \u2208A) ( \u2200\u03b5>0) ( \u2200y \u2208B) ( \u2203\u03b4 >0) ( \u2200y \u2208B \u2229Gy0(\u03b4))\n0\n\u03b5\nF(y) F(y ) f(x,y) f(x,y ) dm(x) dm=\u03b5.\n0 0\n| \u2212 |\u2264 | \u2212 | \u2264 mA\nZA ZA\n(cid:16) (cid:17)\nSimilarly for uniform continuity.]\n\u21d215. Suppose that\n(a) C \u221e f(t,y)dm(t) = F(y) (uniformly) on B = [b,d] E1;\na \u2286\n(b) eacRh f(x, ) = f (x a) is relatively continuous on B; and\nx\n\u00b7 \u2265\n(c) each f( ,y) = fy (y B) is m-integrable on every [a,x] E1,\n\u00b7 \u2208 \u2282\nx a.\n\u2265\nThen show that F is relatively continuous, hence integrable, on B and\nthat\nF = lim H ,\nx\nx\u2192\u221e\nZB ZB\nwhere\nx\nH(x,y) = f(t,y)dm(t).\nZa\n(Passage to the limit under the -sign.)\n[Hint: Use Problem 14 and Theorem 4; note that\nR\nC \u221e f(t,y)dm(t)= lim H(x,y) (uniformly).]\nx\nZ0 \u2192\u221e  Index\nAbel\u2013Dirichlet test integration of functions with values in,\nfor convergence of improper integrals, 285\u2013291, 305\n400 open map principle, 75\nfor uniform convergence of parametrized uniform boundedness principle, 75\nC-integrals, 408 Banach-Steinhaus uniform boundedness\nAbsolute principle, 75\nextrema, 82 Basic covering of a set, 138\nmaxima, 82\nBasic covering value of a set, 138\nminima, 82\nBasis of a vector space, 16\nAbsolute continuity of the integral, 275\nBicontinuous maps, 70\nAbsolute convergence of improper inte-\nBijective\ngrals, 393\nfunctions, 52\nAbsolutely continuous functions on E1,\nlinear maps, 53\n378\nBorel\nand L-integrals, 380\nfields, 162\nAbsolutely continuous with respect to a set\nmeasurable functions, 222\nfunction t, 197\nmeasures, 162\nAdditive extensions of set functions, 129\nrestrictions of measures, 162\nAdditive set functions, 126, 126\nsets, 162\nAdditivity of the integral, 260, 290\nBoundedness, linear, 9\nAdditivity of volume\ncountable, 104\nof intervals, 101 \u03c3-sets, 104\nC\n\u03c3-additivity, 104 volume of, 107\nAlmost everywhere (a.e.), 231 -simple sets, 99\nC\nconvergence of functions, 231 Cs\u2032, family of C-simple sets, 99\nAlmost measurable functions, 231, 231 C-integrals, see Improper integrals\nAlmost uniform convergence of functions, parametrized, 402; see also Parametrized\n239 C-integrals\nEgorov\u2019s theorem, 240, 283 Cantor\u2019s set, 76\nAntiderivatives, 357 Carath\u00b4eodory property (CP), 145, 146, 157\nand L-integrals, 357 Cauchy criterion\nand R-integrals, 362 for convergence of improper integrals,\nchange of variable in, 363 391\nprimitives, 359 for uniform convergence of parametrized\nC-integrals, 403\nBaire categories (of sets), 70 Cauchy integrals (C-integrals), see Im-\nsets of Category I, 71 proper integrals\nsets of Category II, 71 parametrized, 402; see also Parametrized\nBaire\u2019s theorem, 71 C-integrals\nBanach spaces, 76 Cauchy principal value (CPV), 402 418 Index\nChain rule Coverings of sets, 137\nclassical notation for, 31 basic, 138\nfor differentiable functions, 28 -coverings of a set, 137\nM\non En and Cn, 30 \u2126-coverings of a set, 213\nChange of measure in generalized integrals, Vitali, 180; see also Vitali coverings\n332 CP, the Carath\u00b4eodory property, 145\nChange of variable Critical points, 82\nin antiderivatives, 363\nin Lebesgue integration, 386 Darboux sums (upper and lower), 307\nCharacteristic functions, 246 Decompositions\nLebesgue, 342\nClopen maps, 61\nof generalized measures, 344\nClosed maps, 59\nDerivates\nClosed sets in topologies, 161\nof point functions, 373\nCompact regular (CR) set functions on\nof set functions (D(p\u00af), D(p\u00af)), 187\ntopological spaces, 209\nDerivatives\nComparison test directional, see Directional derivatives\nfor improper integrals, 393, 399\nof set functions, 210\nfor uniform convergence of parametrized\nRadon\u2013Nikodym, 338, 351\nC-integrals,405 partial, see Partial derivatives\nComplete measures, 148 Determinants\nComplete normed spaces, see Banach functional, 49\nspaces of matrices, 47, 96\nCompletions of measures, 159 Differentiable functions, 17\ncompletions of generalized measures, 205 and directional derivatives, 19\nCompletely additive set functions, see \u03c3- chain rule for, 28\nadditive set functions continuously, 38, 57\ndifferentials of, 17\nContinuous\nand partial derivatives, 19, 22\nfunctions between topological spaces,\nin a normed space, 17\n161\nm times differentiable, 38\nlinear map, 13\nset functions, 131, 147 Differentiable set functions, 210\nwith respect to a set function t (t- Differentials, 17\ncontinuous), 197 chain rule for, 28\nContinuously differentiable functions, 38, of functions in a normed space, 17\n57 of order m, 39\nConvergence of functions Differentiation of set functions, 210\u2013216\nalmost everywhere, 231 -differentiation, 211\nK\nalmost uniform, 239 Lebesgue differentiation, 211, 351\nEgorov\u2019s theorem, 240, 283 \u2126-differentiation, 211, 353\nin measure, 239, 280 Directional derivatives, 1\nLebesgue\u2019s theorem, 240, 283 differentiable functions and, 19\nRiesz\u2019 theorem, 280 Finite Increments Law for, 7\nhigher order, 35\nConvergence of improper integrals, 388\nof linear maps, 15\nabsolute, 393\nCauchy criterion for, 391 Discriminant of a quadratic polynomial, 80\ncomparison test for, 393, 399 Disjoint set families, 99\nconditional, 391 Dominated convergence theorem, 273, 327\nAbel\u2013Dirichlet test for, 400 Dot products, linear functionals on En and\nConvergent sequences of sets, 180 Cn as, 10\nCountably-additive set functions, see \u03c3- Double series, 110, 115\nadditive set functions Index 419\nEn Generalized measure spaces, 194\nintervals in, 97 integration in, 323ff.\nvolume of open sets in, 108 Generalized measures, 194\nElementary functions, 218 completion of, 205\nintegrable, 241 decomposition of, 344\nintegrals of, 241 signed measures, 194, 199\nintegration of, 241\u2013250 Gradient of a function, 20\nEuler\u2019s theorem for homogeneous func-\ntions, 34 Hadamard\u2019s theorem, 96\nExtended-real functions Hahn decomposition theorem, 201\nintegration of, 251\u2013267; see also Integra-\nHereditary set families, 123\ntion of extended-real functions\nHomeomorphisms, 70\nintegrable, 252\nHomogeneous functions, 34\nlower integrals of, 251\nEuler\u2019s theorem for, 34\nupper integrals of, 251\nExtremum, extrema\nImplicit\nabsolute, 82\ndifferentiation, 66, 87\nconditional, 88\nfunction theorem, 64\nlocal, 79, 89\nImproper integrals, 388\nabsolute convergence of, 393\nFatou\u2019s lemma, 272\nCauchy criterion for, 391\nFields of sets, 116\nCauchy principal value (CPV) of, 402\ngenerated by a set family, 117\ncomparison test for, 393, 399\nFinite Increments Law for directional\nconditional convergence of, 391\nderivatives 7\nAbel\u2013Dirichelet test for convergence of,\nFinite set functions, 125\n400\nFinite with respect to a set function t (t- iterated, 394\nfinite), 197 convergence of, 388\nFinitely additive set functions, 126, 126 singularities of, 387\nFr\u00b4echet\u2019s theorem, 237 Indefinite integrals, 263, 293, 330\nFubini indefinite L-integrals, 366\nmap, 294 Independence, linear, 16\ntheorem, 298, 301, 305, 334 Inner products representing linear func-\nFunctional determinants, 49 tionals on En and Cn, 10\nFunctionals, linear, see Linear functionals Integrable functions\nFunctions. See also Maps elementary, 241\nbijective, 52 extended-real, 252\ncontinuous, 161 with values in complete normed spaces,\ndifferentiable, see Differentiable func- 285\ntions Riemann, 307, 317\nhomeomorphisms, 70 Integrals\nhomogeneous, 34 Cauchy (C-integrals), 388; see also Im-\nimplicit function theorem, 64 proper integrals\ninverse function theorem, 61 in generalized measure spaces, 323ff.\npartially derived, 2 indefinite, 263, 293, 330\nFundamental theorem of calculus, 360 improper, 388; see also Improper inte-\ngrals\nGeneralized integration, 323ff. iterated, 294\nchange of measure, 332 Lebesgue, 357\ndominated convergence theorem, 327 Lebesgue integrals and Riemann inte-\nFubini property in, 334 grals, 313\nindefinite integrals in, 330 lower, 251 420 Index\nof elementary functions, 241 Lagrange form of the remainder in Taylor\u2019s\northodox, 247 Theorem, 42\nparametrized C-integrals, 402; see also Lagrange multipliers, 89\nParametrized C-integrals Lebesgue\nRiemann (R-integrals), 308ff.; see also decompositions, 342\nRiemann integrals extensions, 154, 168\nRiemann\u2013Stieltjes, 318 Lebesgue-integrable functions, 241\nStieltjes, 319, 321ff. Lebesgue-measurable functions, 222\nunorthodox, 247 Lebesgue-measurable sets, 168\nupper, 251 measure, 168\u2013175\nwith respect to Lebesgue measure (L- outer measure, 138\nintegrals), 357 nonmeasurable sets under Lebesgue\nIntegration measure, 173\nabsolute continuity of the integral, 275 points of functions, 382\nadditivity of the integral, 260, 290 premeasure, 126, 138, 168\nby parts, 321 premeasure space, 138\ndominated convergence theorem, 273, sets of functions, 382\n327\nLebesgue\u2013Stieltjes\nFatou\u2019s lemma, 272\nmeasurable functions, 222\nin generalized measure spaces, 323ff.\nmeasures, 176\nof elementary functions, 241\u2013250 measures in En, 179\nof extended-real functions, 251\u2013267\nouter measures, 146, 176\nof functions with values in Banach\npremeasures, 176\nspaces, 285\u2013291, 305\nset functions, 127, 135, 176\nlinearity of the integral, 267, 288\nsigned Lebesgue\u2013Stieltjes measures, 206,\nmonotone convergence theorem, 271\n335\nweighted law of the mean, 269\nLeft-continuous set functions, 131\nIntervals in En, 97\nLinear boundedness, 9\nadditivity of volume of, 101\nLinear functionals, 7\nsimple step functions on, 218\non En and Cn as dot products, 10\nstep functions on, 218\nLinear independence, 16\nInverse function theorem, 61\nLinear maps, 7\nIterated integrals, 294\nas a normed linear space, 13\niterated improper integrals, 394\nbijective, 53\nFubini map, 294\nbounded, 9\nFubini theorem, 298, 301, 305, 334\ncontinuous, 9, 13\ndirectional derivatives of, 15\nJacobian matrix, 18\nmatrix representation of composite, 12\nJacobians, 49\nmatrix representation of, 11\nJordan components, 203 norm of, 13\nJordan decompositions, 202 uniformly continuous on En or Cn, 10\nJordan components, 203 Linear operator, 7\nJordan outer content, 140\nLinear subspaces of a vector space, 16\nLinearity of the integral\n(the set of all cubes in En), 186, 210 of extended-real functions, 267\nK\nof functions with values in Banach\nL-measurable, see Lebesgue-measurable. spaces, 288\nL-integrable, see Lebesgue-integrable. Lipschitz condition, 25, 384\nL-integrals, 357 uniform, 9\nand absolutely continuous functions, 380 Local\nindefinite, 366 extremum, extrema, 79, 89\nL-primitive, 366 maximum, maxima, 79 Index 421\nminimum, minimima, 79 Borel restrictions of, 162\nLower as extensions of premeasures, 154\nDarboux sums, 307 Borel, 162\nintegrals, 251 complete, 148\nRiemann integrals, 308 completions of, 159\nLS, see Lebesgue\u2013Stieltjes. constructed from outer measures, 152\ngeneralized, 194\nLuzin\u2019s theorem, 234\nLebesgue, 168\u2013175\nLebesgue extensions, 154\nM-test for uniform convergence of param-\nLebesgue\u2013Stieltjes, 176\netrized C-integrals, 405\nLebesgue\u2013Stieltjes measures in En, 179\nMaps. See also Functions\nouter, 138, 139; see also Outer measures\nbicontinuous, 70\nproduct, 293\nclopen, 61\nregular, 162\nclosed, 59\nrotation-invariant, 192\nlinear, see Linear maps\nsigned, 194, 199\nopen, 59\nsigned Lebesgue-Stieltjes, 206, 335\nopen map principle, 75\nstrongly regular, 162\nMatrix, matrices totally \u03c3-finite, 169\nas elements of a vector space, 15 translation-invariant, 171\ndeterminants of, 47, 96\nMetric spaces\nJacobian, 18\nas topological spaces, 161\nn n matrices as a noncommutative ring\n\u00d7 networks of sets in, 212\nwith identity, 15\nMinimum, minima\nof composite linear maps, 12\nabsolute, 82\nrepresentation of a linear map, 11\nconditional, 88\nMaximum, maxima\nlocal, 79\nabsolute, 82\nMonotone convergence theorem, 271\nconditional, 88\nMonotone set functions, 136, 117\nlocal, 79\nMeagre sets, 71\nNetworks of sets in metric spaces, 212\nMeasurable covers of sets, 156\nNonmeasurable sets under Lebesgue mea-\nMeasurable functions\nsure, 173\nalmost, 231\nBorel, 222 Norm of a linear map, 13\nFr\u00b4echet\u2019s theorem, 237 Normal Vitali coverings, 192\nLebesgue (L), 222 Nowhere-dense sets, 70\nLebesgue\u2013Stieltjes (LS), 222\nLuzin\u2019s theorem, 234\n\u2126-coverings of a set, 213\n-measurable functions, 218\nM \u2126-differentiation, 211\nm-measurable functions, 231\nand Radon\u2013Nikodym derivative, 353\nTietze\u2019s theorem, 236\nOpen map principle, 75\nMeasurable sets, 147\nOpen maps, 59\nnonmeasurable sets under Lebesgue\nOpen sets\nmeasure, 173\nin topologies, 161\nouter, 149\nvolume of, 108\nMeasurable spaces, 217\nOperator, linear, 7\nMeasure spaces, 147\nalmost measurable functions on sets in, Orthodox integrals, 247\n231 Outer content, 140\nprobability spaces as, 148 Jordan, 140\ntopological, 162 Outer measurable sets, 149\nMeasures, 147, 194. See also Set functions Outer measure spaces, 149 422 Index\nOuter measures, 138, 139 Regular measures, 162\nCarath\u00b4eodory property (CP), 145 Regular set functions, 140\nconstructing measures from, 152 compact, 209\nLebesgue outer measure, 138, 146, 176 outer measures as, 155, 156\nLebesgue\u2013Stieltjes, 146 Regulated functions, 312\nouter measurable sets, 149\nResidual sets, 71\nregular, 155, 156\nRiemann-integrable functions, 307, 317\nRiemann integrals, 308ff.\n(S), the power set of S, 116\nDarboux sums (lower and upper), 307\nP\nParametrized C-integrals, 402 Lebesgue integrals and, 313\nAbel\u2013Dirichlet test for uniform conver- lower, 307\ngence of, 408 regulated functions, 312\nCauchy criterion for uniform conver- Riemann sums, 321\ngence of, 403 upper, 307\ncomparison test for uniform convergence\nRiemann sums, 321\nof, 405\nRiemann\u2013Stieltjes integrals, 318\nM-test for uniform convergence of, 405\nRight-continuous set functions, 131\nPartial derivatives, 3\nRing\ndifferentiable functions and, 19, 22\nn n matrices as a noncommutative ring\nhigher order, 35 \u00d7\nwith identity, 15\nPartially derived function, 2\nRings of sets, 101, 115\nPartitions of sets, 195, 217\ngenerated by a set family, 117\nelementary functions on, 218\nRotation-invariant measures, 192\nrefinements of, 218, 308\nsimple functions on, 218\n\u03c3-additive set functions, 126, 147\nPermutable series, 110\n\u03c3-additivity of volume, 104\nPolar coordinates, 46, 50, 55, 306, 395\n\u03c3-algebras of sets, 116. See also \u03c3-field\nPositive series, 111\n\u03c3-fields of sets, 116\nPower set (S), 116\nP Borel fields, 162\nPremeasures, 137, 147\ngenerated by a set family , 117\nmeasures as extensions of, 154 M\n\u03c3-finite set functions, 140\ninduced outer measures from, 138\ntotally, 140, 169\nLebesgue, 126, 138, 168\n\u03c3-rings of sets, 116, 147\nLebesgue\u2013Stieltjes, 176\nBorel fields, 162\nPremeasure spaces, 138\ngenerated by a semiring, 119\nLebesgue, 138\ngenerated by a set family, 117\nPrimitives, see Antiderivatives\n\u03c3-subadditive set functions, 137, 147\nProbability spaces, 148\n\u03c30-finiteness, 167\nProduct measures, 293\nSemifinite set functions, 126\nProducts of set families, 120\nSemirings of sets, 98\nPseudometric spaces, 165\nSeparable sets, 223\nPseudometrics, 165\nSeries\ndouble, 110, 115\nQuadratic forms, symmetric, 80\npermutable, 110\npositive, 111\nR-integrals, see Riemann integrals\nSets\nRadon\u2013Nikodym derivatives, 338 Borel, 162\nand Lebesgue differentiation, 351 \u03c3, 104\nand \u2126-differentiation, 353 C -simple, 99\nC\nRadon\u2013Nikodym theorem, 338 Cantor\u2019s set, 76\nRefinements of partitions of sets, 218, 308 convergent sequences of, 180 Index 423\nfamilies of, see Set families generalized measures, 194\nLebesgue-measurable, 168 Lebesgue premeasure, 126\nmeagre, 71 Lebesgue\u2013Stieltjes, 127, 135, 176\nmeasurable, 147 left-continuous, 131\nnonmeagre, 71 monotone, 136, 147\nnowhere dense, 70 outer measures, 138; see also Outer mea-\nof Category I, 71 sures\nof Category II, 71 premeasures, 137\nouter measurable, 149 regular, 140, 155\npartitions of, 195 right-continuous, 131\nresidual, 71 rotation-invariant, 192\nrings of, 101, 115 \u03c3-additive, 126\n\u03c3-algebras of, 116 \u03c3-finite, 140\n\u03c3-fields of, 116 \u03c3-subadditive, 137\n\u03c3-rings of, 116 semifinite, 126\nsemirings of, 98 signed measures, 194, 199\nseparable, 223 signed Lebesgue\u2013Stieltjes measures, 206,\nsymmetric difference of, 122 335\nVitali coverings of, 180 singular with respect to a set function t\nvolume of, see Volume (t-singular), 341\nSet algebras, 116. See also Set fields. total variation of, 194\ntotally \u03c3-finite, 140, 169\nSet families, 98\ntranslation-invariant, 171\nset algebras, 116\nvolume of sets, see Volume\n-simple sets , 99\nCs\u2032\nC\ndisjoint, 99 Set rings, 101, 115\nfields, 116 generated by a set family, 117\nhereditary, 123 Signed Lebesgue\u2013Stieltjes measure spaces,\nproducts of, 120 206\nrings, 101, 115 induced by a function of bounded varia-\n\u03c3-algebras, 116 tion, 206\n\u03c3-fields, 116 integration in, 335\n\u03c3-rings, 116 Signed measure spaces, 194, 199\nsemirings, 98 Hahn decomposition theorem, 201\nSet fields, 116 Jordan components, 203\ngenerated by a set family, 117 Jordan decompositions, 202\nSet functions, 125 negative sets in, 199\nabsolutely continuous with respect positive sets in, 199\nto a set function t (absolutely t- Simple functions, 218\ncontinuous), 197 simple step functions, 218\nadditive, 126, 137 Singular with respect to a set function t\nadditive extension of, 129 (t-singular), 341\ncompact regular (CR) set functions on Singularities of improper integrals, 387\ntopological spaces, 209\nSpan of vectors in a vector space, 16\ncontinuous, 131, 147\nStep functions, 218\ncontinuous with respect to a set function\nsimple, 218\nt (t-continuous), 197\nStieltjes integrals, 319, 321ff.\nderivates of (D(p\u00af), D(p\u00af)), 187\nintegration by parts, 321\nderivatives of, 210\nlaws of the mean, 322\ndifferentiable, 210\nStrongly regular measures, 162, 234, 237,\nfinite, 125\n347\nfinite with respect to a set function t (t-\nfinite), 197 Sylvester\u2019s theorem, 80\nfinitely additive, 126, 126 Symmetric difference of sets, 122 424 Index\nSymmetric quadratic forms, 80 of sets, 125\nSylvester\u2019s theorem, 80 \u03c3-subadditivity of, 109\nTaylor polynomial, 43 Weighted law of the mean, 269\nTaylor\u2019s Theorem, 40\ngeneralized, 45\nLagrange form of remainder, 42\nTaylor polynomial, 43\nTietze\u2019s theorem, 236\nTopological measure spaces, 162\nTopological spaces, 161\ncompact regular (CR) set functions on,\n209\ncontinuous functions between, 161\nmetric spaces as, 161\npseudometric spaces as, 165\nTopologies, 161\nclosed sets in, 161\nopen sets in, 161\nTotal variation of set functions, 194\nTotally \u03c3-finite set functions, 140, 169\nTranslation-invariant set functions, 171\nUniform boundedness principle of Banach\nand Steinhaus, 75\nUniformly normal Vitali coverings, 192\nUniversal Vitali coverings, 192\nUnorthodox integrals, 247\nUpper\nDarboux sums, 307\nintegrals, 251\nRiemann integrals, 307\nV-coverings, see Vitali coverings\nVectors\nspan of a set of, 16\nVector spaces\nbasis of, 16\ndimension of, 16\nlinear subspaces of, 16\nmatrices as elements of, 15\nspan of vectors in, 16\nVitali coverings, 180\nnormal, 192\nuniformly normal, 192\nuniversal, 192\nVolume\nadditivity of volume of intervals, 101\nmonotinicity of, 109\nof \u03c3-sets in En, 107\nC\nof open sets in En, 108"
}